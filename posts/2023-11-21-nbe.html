<!doctype html>
<html lang="en">
    <head>
        <style>
          @font-face { font-family: PressStart2P; src: url('/fonts/PressStart2P.ttf'); }
          html { font-family: PressStart2P }
        </style>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Emmanuel Suárez Acevedo - Normalization by Evaluation</title>
        <link rel="stylesheet" href="../css/default.css" />
        <link rel="stylesheet" href="../css/agda.css" />
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.0/css/all.css" integrity="sha384-Mmxa0mLqhmOeaE8vgOSbKacftZcsNYDjQzuCOm6D02luYSzBG8vpaOykv9lFQ51Y" crossorigin="anonymous" />
        <link rel="shortcut icon" type="image/x-icon" href="../files/favicon.ico" />
    </head>
    <body>
        <header>
            <div class="logo">
              <a href="../">Emmanuel Suárez Acevedo</a>
            </div>
            <nav>
                <a href="../posts.html">Posts</a>
                <a href="../research.html">Research</a>
                <a href="../files/resume.pdf">CV</a>
            </nav>
        </header>

        <main role="main">
            <article>
    <section class="header">
        <h2>Normalization by Evaluation</h2>
        <h4>posted on November 21, 2023</h4>
        
    </section>
    <section class="post">
        <p>* This post has the content of a <a href="https://emmanueljs1.github.io/nbe/NbE.html">tutorial</a> I
wrote before creating this website.</p>
<h3 id="background">Background</h3>
<p>This site is both an overview of normalization by evaluation and a formalization
in Agda of the algorithm for the simply typed lambda calculus, based largely on
its presentation in Chapter 2 of Andreas Abel’s habilitation thesis,
“Normalization by Evaluation: Dependent Types and Impredicativity”. It
was compiled from a literate Agda file available
<a href="https://github.com/emmanueljs1/nbe/blob/main/NbE.lagda.md">here</a> by following
the helpful advice in <a href="https://jesper.sikanda.be/posts/literate-agda.html">this</a>
blog post by Jesper Cockx.</p>
<p>For clarity and readability, some parts of the source file are left out in this
rendering, and this will be called out when possible.</p>
<p>Some familiarity with Agda (e.g. such as having worked through the first part of
<a href="https://plfa.inf.ed.ac.uk/22.08/">Programming Languages Foundations in Agda</a>)
is assumed along with some knowledge of programming language foundations, though
the content is mostly self contained.</p>
<h3 id="introduction">Introduction</h3>
<p>Consider the following term in the lambda calculus:</p>
<pre><code>λx. (λy. y) x</code></pre>
<p>This term is not in its <em>normal form</em>, that is, it can still undergo some
reductions. In this case, we can apply a beta reduction under the first binder
and arrive at:</p>
<pre><code>λx. x</code></pre>
<p>This new term is now the normal form of <code>λx. (λy. y) x</code>. What we’ve just done,
believe it or not, is normalization by evaluation!</p>
<p>Normalization by evaluation is a technique for deriving the normal form of a
term in an object language by <em>evaluating</em> the term in a meta language (a
language we are using to describe the object language). In this case, our
object language was the untyped lambda calculus, and our meta language was,
well, just plain English.</p>
<p>In essence, you can reduce a term by evaluating the parts that <em>can</em> be
evaluated while leaving the parts that <em>can’t</em> untouched. That is the intuition
behind normalization by evaluation.</p>
<p>To actually formalize normalization by evaluation and prove its correctness in
Agda, the algorithm may seem to become less intuitive, but it will still be
based on this initial idea.</p>
<!---
### Imports

<pre class="Agda"><a id="2273" class="Keyword">import</a> <a id="2280" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="2318" class="Symbol">as</a> <a id="2321" class="Module">Eq</a>
<a id="2324" class="Keyword">open</a> <a id="2329" class="Keyword">import</a> <a id="2336" href="Data.Empty.html" class="Module">Data.Empty</a> <a id="2347" class="Keyword">using</a> <a id="2353" class="Symbol">(</a><a id="2354" href="Data.Empty.html#526" class="Datatype">⊥</a><a id="2355" class="Symbol">;</a> <a id="2357" href="Data.Empty.html#628" class="Function">⊥-elim</a><a id="2363" class="Symbol">)</a>
<a id="2365" class="Keyword">open</a> <a id="2370" class="Keyword">import</a> <a id="2377" href="Data.Unit.html" class="Module">Data.Unit</a> <a id="2387" class="Keyword">using</a> <a id="2393" class="Symbol">(</a><a id="2394" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a><a id="2395" class="Symbol">;</a> <a id="2397" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a><a id="2399" class="Symbol">)</a>
<a id="2401" class="Keyword">open</a> <a id="2406" class="Keyword">import</a> <a id="2413" href="Data.Sum.html" class="Module">Data.Sum</a> <a id="2422" class="Keyword">using</a> <a id="2428" class="Symbol">(</a><a id="2429" href="Data.Sum.Base.html#734" class="Datatype Operator">_⊎_</a><a id="2432" class="Symbol">;</a> <a id="2434" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a><a id="2438" class="Symbol">;</a> <a id="2440" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a><a id="2444" class="Symbol">)</a>
<a id="2446" class="Keyword">open</a> <a id="2451" class="Keyword">import</a> <a id="2458" href="Data.Product.html" class="Module">Data.Product</a> <a id="2471" class="Keyword">using</a> <a id="2477" class="Symbol">(</a><a id="2478" href="Data.Product.html#1167" class="Function Operator">_×_</a><a id="2481" class="Symbol">;</a> <a id="2483" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a><a id="2488" class="Symbol">;</a> <a id="2490" href="Data.Product.html#1369" class="Function">∃</a><a id="2491" class="Symbol">;</a> <a id="2493" href="Data.Product.html#1806" class="Function">∃-syntax</a><a id="2501" class="Symbol">)</a> <a id="2503" class="Keyword">renaming</a> <a id="2512" class="Symbol">(</a><a id="2513" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="2517" class="Symbol">to</a> <a id="2520" class="InductiveConstructor Operator">⟨_,_⟩</a><a id="2525" class="Symbol">)</a>
<a id="2527" class="Keyword">open</a> <a id="2532" class="Keyword">import</a> <a id="2539" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="2556" class="Keyword">using</a> <a id="2562" class="Symbol">(</a><a id="2563" href="Relation.Nullary.html#1511" class="Record">Dec</a><a id="2566" class="Symbol">;</a> <a id="2568" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a><a id="2571" class="Symbol">;</a> <a id="2573" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a><a id="2575" class="Symbol">;</a> <a id="2577" href="Relation.Nullary.html#656" class="Function Operator">¬_</a><a id="2579" class="Symbol">)</a>
<a id="2581" class="Keyword">open</a> <a id="2586" href="Relation.Binary.PropositionalEquality.html" class="Module">Eq</a> <a id="2589" class="Keyword">using</a> <a id="2595" class="Symbol">(</a><a id="2596" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="2600" class="Symbol">;</a> <a id="2602" href="Relation.Binary.PropositionalEquality.Core.html#1729" class="Function">trans</a><a id="2607" class="Symbol">;</a> <a id="2609" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a><a id="2612" class="Symbol">;</a> <a id="2614" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="2617" class="Symbol">;</a> <a id="2619" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a><a id="2623" class="Symbol">;</a> <a id="2625" href="Relation.Binary.PropositionalEquality.Core.html#1367" class="Function">cong₂</a><a id="2630" class="Symbol">;</a> <a id="2632" href="Relation.Binary.PropositionalEquality.Core.html#1461" class="Function">cong-app</a><a id="2640" class="Symbol">)</a>
<a id="2642" class="Keyword">open</a> <a id="2647" href="Relation.Binary.PropositionalEquality.Core.html#2708" class="Module">Eq.≡-Reasoning</a> <a id="2662" class="Keyword">using</a> <a id="2668" class="Symbol">(</a><a id="2669" href="Relation.Binary.PropositionalEquality.Core.html#2864" class="Function Operator">_≡⟨⟩_</a><a id="2674" class="Symbol">;</a> <a id="2676" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">step-≡</a><a id="2682" class="Symbol">;</a> <a id="2684" href="Relation.Binary.PropositionalEquality.Core.html#2806" class="Function Operator">begin_</a><a id="2690" class="Symbol">;</a> <a id="2692" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">_∎</a><a id="2694" class="Symbol">)</a>

<a id="2697" class="Keyword">module</a> <a id="2704" href="lagda.2023-11-21-nbe.html" class="Module">lagda.2023-11-21-nbe</a> <a id="2725" class="Keyword">where</a>

<a id="2732" class="Keyword">postulate</a>
  <a id="extensionality"></a><a id="2744" href="lagda.2023-11-21-nbe.html#2744" class="Postulate">extensionality</a> <a id="2759" class="Symbol">:</a> <a id="2761" class="Symbol">∀</a> <a id="2763" class="Symbol">{</a><a id="2764" href="lagda.2023-11-21-nbe.html#2764" class="Bound">A</a> <a id="2766" href="lagda.2023-11-21-nbe.html#2766" class="Bound">B</a> <a id="2768" class="Symbol">:</a> <a id="2770" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="2773" class="Symbol">}</a> <a id="2775" class="Symbol">{</a><a id="2776" href="lagda.2023-11-21-nbe.html#2776" class="Bound">f</a> <a id="2778" href="lagda.2023-11-21-nbe.html#2778" class="Bound">g</a> <a id="2780" class="Symbol">:</a> <a id="2782" href="lagda.2023-11-21-nbe.html#2764" class="Bound">A</a> <a id="2784" class="Symbol">→</a> <a id="2786" href="lagda.2023-11-21-nbe.html#2766" class="Bound">B</a><a id="2787" class="Symbol">}</a>
    <a id="2793" class="Symbol">→</a> <a id="2795" class="Symbol">(∀</a> <a id="2798" class="Symbol">(</a><a id="2799" href="lagda.2023-11-21-nbe.html#2799" class="Bound">x</a> <a id="2801" class="Symbol">:</a> <a id="2803" href="lagda.2023-11-21-nbe.html#2764" class="Bound">A</a><a id="2804" class="Symbol">)</a> <a id="2806" class="Symbol">→</a> <a id="2808" href="lagda.2023-11-21-nbe.html#2776" class="Bound">f</a> <a id="2810" href="lagda.2023-11-21-nbe.html#2799" class="Bound">x</a> <a id="2812" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2814" href="lagda.2023-11-21-nbe.html#2778" class="Bound">g</a> <a id="2816" href="lagda.2023-11-21-nbe.html#2799" class="Bound">x</a><a id="2817" class="Symbol">)</a>
      <a id="2825" class="Comment">-----------------------</a>
    <a id="2853" class="Symbol">→</a> <a id="2855" href="lagda.2023-11-21-nbe.html#2776" class="Bound">f</a> <a id="2857" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2859" href="lagda.2023-11-21-nbe.html#2778" class="Bound">g</a>
</pre>--->
<h3 id="stlc">STLC</h3>
<p>The object language that will be used here to define normalization by evaluation
will be the simply-typed lambda calculus with <code>𝟙</code> (“unit”) as a base type. It
has variables, functions, application, and a single value of type <code>𝟙</code>: <code>unit</code>.</p>
<pre class="Agda"><a id="3128" class="Keyword">data</a> <a id="Type"></a><a id="3133" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a> <a id="3138" class="Symbol">:</a> <a id="3140" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="3144" class="Keyword">where</a>
  <a id="3152" class="Comment">-- unit</a>
  <a id="Type.𝟙"></a><a id="3162" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a>   <a id="3166" class="Symbol">:</a> <a id="3168" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a>

  <a id="3176" class="Comment">-- functions</a>
  <a id="Type._⇒_"></a><a id="3191" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">_⇒_</a> <a id="3195" class="Symbol">:</a> <a id="3197" class="Symbol">∀</a> <a id="3199" class="Symbol">(</a><a id="3200" href="lagda.2023-11-21-nbe.html#3200" class="Bound">S</a> <a id="3202" href="lagda.2023-11-21-nbe.html#3202" class="Bound">T</a> <a id="3204" class="Symbol">:</a> <a id="3206" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="3210" class="Symbol">)</a> <a id="3212" class="Symbol">→</a> <a id="3214" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a>
</pre>
<!---
<pre class="Agda"><a id="3238" class="Keyword">infixr</a> <a id="3245" class="Number">7</a> <a id="3247" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">_⇒_</a>
</pre>--->
<p>A typing context (for which the metavariable <code>Γ</code> will be used) is either the
empty context <code>∅</code> or an extension to a context <code>Γ , x:S</code> mapping an object
language variable to a type (here, <code>Γ</code> is extended with the variable <code>x</code> mapped
to the type <code>S</code>).</p>
<p>The Agda definition does not actually mention variable names at all, and is
really just a list of types. This is because a de Brujin representation will be
used for variables, so instead of a name, a variable will be an index into the
list of types making up the context (i.e. a de Brujin index). For example, the
variable <code>x</code> in the context <code>Γ, x:S</code> would be represented simply as the zeroth
index.</p>
<pre class="Agda"><a id="3921" class="Keyword">data</a> <a id="Ctx"></a><a id="3926" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a> <a id="3930" class="Symbol">:</a> <a id="3932" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="3936" class="Keyword">where</a>
  <a id="Ctx.∅"></a><a id="3944" href="lagda.2023-11-21-nbe.html#3944" class="InductiveConstructor">∅</a> <a id="3946" class="Symbol">:</a> <a id="3948" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a>
  <a id="Ctx._,_"></a><a id="3954" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">_,_</a> <a id="3958" class="Symbol">:</a> <a id="3960" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a> <a id="3964" class="Symbol">→</a> <a id="3966" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a> <a id="3971" class="Symbol">→</a> <a id="3973" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a>
</pre>
<!---
<pre class="Agda"><a id="3992" class="Keyword">infixl</a> <a id="3999" class="Number">5</a> <a id="4001" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">_,_</a>
</pre>--->
<p>The de Brujin index representing a variable will not actually be a natural
number “index”, but rather a lookup judgements into a context. These lookup
judgements are very similar to natural numbers (and their contructors have been
named suggestively based on this similarity: <code>𝑍</code> for zero and <code>𝑆</code> for
successor). Defining them this way instead of simply using Agda’s natural
numbers will allow for an index into a context to always be well-defined (and
for variables to be intrinsically typed, as will be shown in a moment).</p>
<pre class="Agda"><a id="4549" class="Keyword">data</a> <a id="_∋_"></a><a id="4554" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">_∋_</a> <a id="4558" class="Symbol">:</a> <a id="4560" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a> <a id="4564" class="Symbol">→</a> <a id="4566" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a> <a id="4571" class="Symbol">→</a> <a id="4573" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="4577" class="Keyword">where</a>
  <a id="_∋_.𝑍"></a><a id="4585" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a> <a id="4587" class="Symbol">:</a> <a id="4589" class="Symbol">∀</a> <a id="4591" class="Symbol">{</a><a id="4592" href="lagda.2023-11-21-nbe.html#4592" class="Bound">Γ</a> <a id="4594" class="Symbol">:</a> <a id="4596" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="4599" class="Symbol">}</a> <a id="4601" class="Symbol">{</a><a id="4602" href="lagda.2023-11-21-nbe.html#4602" class="Bound">T</a> <a id="4604" class="Symbol">:</a> <a id="4606" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="4610" class="Symbol">}</a>
        <a id="4620" class="Comment">---------</a>
      <a id="4636" class="Symbol">→</a> <a id="4638" href="lagda.2023-11-21-nbe.html#4592" class="Bound">Γ</a> <a id="4640" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="4642" href="lagda.2023-11-21-nbe.html#4602" class="Bound">T</a> <a id="4644" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="4646" href="lagda.2023-11-21-nbe.html#4602" class="Bound">T</a>

  <a id="_∋_.𝑆_"></a><a id="4651" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆_</a> <a id="4654" class="Symbol">:</a> <a id="4656" class="Symbol">∀</a> <a id="4658" class="Symbol">{</a><a id="4659" href="lagda.2023-11-21-nbe.html#4659" class="Bound">Γ</a> <a id="4661" class="Symbol">:</a> <a id="4663" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="4666" class="Symbol">}</a> <a id="4668" class="Symbol">{</a><a id="4669" href="lagda.2023-11-21-nbe.html#4669" class="Bound">S</a> <a id="4671" href="lagda.2023-11-21-nbe.html#4671" class="Bound">T</a> <a id="4673" class="Symbol">:</a> <a id="4675" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="4679" class="Symbol">}</a>
      <a id="4687" class="Symbol">→</a> <a id="4689" href="lagda.2023-11-21-nbe.html#4659" class="Bound">Γ</a> <a id="4691" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="4693" href="lagda.2023-11-21-nbe.html#4671" class="Bound">T</a>
        <a id="4703" class="Comment">---------</a>
      <a id="4719" class="Symbol">→</a> <a id="4721" href="lagda.2023-11-21-nbe.html#4659" class="Bound">Γ</a> <a id="4723" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="4725" href="lagda.2023-11-21-nbe.html#4669" class="Bound">S</a> <a id="4727" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="4729" href="lagda.2023-11-21-nbe.html#4671" class="Bound">T</a>
</pre>
<!---
<pre class="Agda"><a id="4746" class="Keyword">infix</a> <a id="4752" class="Number">4</a> <a id="4754" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">_∋_</a>
<a id="4758" class="Keyword">infix</a> <a id="4764" class="Number">9</a> <a id="4766" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆_</a>
</pre>--->
<p>Using these, the context <code>∅, x:S, y:T</code> can be represented along with the
variable names <code>"x"</code> and <code>"y"</code> as is done in the following example.</p>
<pre class="Agda"><a id="4929" class="Keyword">module</a> <a id="Example"></a><a id="4936" href="lagda.2023-11-21-nbe.html#4936" class="Module">Example</a> <a id="4944" class="Symbol">(</a><a id="4945" href="lagda.2023-11-21-nbe.html#4945" class="Bound">S</a> <a id="4947" href="lagda.2023-11-21-nbe.html#4947" class="Bound">T</a> <a id="4949" class="Symbol">:</a> <a id="4951" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="4955" class="Symbol">)</a> <a id="4957" class="Keyword">where</a>
  <a id="Example.∅,x:S,y:T"></a><a id="4965" href="lagda.2023-11-21-nbe.html#4965" class="Function">∅,x:S,y:T</a> <a id="4975" class="Symbol">=</a> <a id="4977" href="lagda.2023-11-21-nbe.html#3944" class="InductiveConstructor">∅</a> <a id="4979" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="4981" href="lagda.2023-11-21-nbe.html#4945" class="Bound">S</a> <a id="4983" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="4985" href="lagda.2023-11-21-nbe.html#4947" class="Bound">T</a>

  <a id="Example.x"></a><a id="4990" href="lagda.2023-11-21-nbe.html#4990" class="Function">x</a> <a id="4992" class="Symbol">:</a> <a id="4994" href="lagda.2023-11-21-nbe.html#4965" class="Function">∅,x:S,y:T</a> <a id="5004" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="5006" href="lagda.2023-11-21-nbe.html#4945" class="Bound">S</a>
  <a id="5010" href="lagda.2023-11-21-nbe.html#4990" class="Function">x</a> <a id="5012" class="Symbol">=</a> <a id="5014" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="5016" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>

  <a id="Example.y"></a><a id="5021" href="lagda.2023-11-21-nbe.html#5021" class="Function">y</a> <a id="5023" class="Symbol">:</a> <a id="5025" href="lagda.2023-11-21-nbe.html#4965" class="Function">∅,x:S,y:T</a> <a id="5035" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="5037" href="lagda.2023-11-21-nbe.html#4947" class="Bound">T</a>
  <a id="5041" href="lagda.2023-11-21-nbe.html#5021" class="Function">y</a> <a id="5043" class="Symbol">=</a> <a id="5045" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>
</pre>
<p>STLC terms will be embedded in Agda using an <em>intrinsically</em> typed
representation. Types are defined first, and terms are only every considered
with respect to their type.</p>
<p>Using this representation, terms that are not well-typed don’t even have to be
considered, as they are impossible to represent. An STLC term <code>t</code> embedded in
Agda as an expression of type <code>Γ ⊢ T</code> is, by definition, a well-typed STLC
term of type <code>T</code> in the context <code>Γ</code> (written as <code>Γ ⊢ t : T</code>).</p>
<p>For clarity, when talking about terms their representation in the STLC will be
used over their intrinsically typed representation using de Brujin indices, and
all terms will be assumed to be well-typed. (e.g. the variable <code># 𝑍</code> will be
referred to as <code>Γ, x:T ⊢ x : T</code>, or just <code>x</code>.)</p>
<pre class="Agda"><a id="5812" class="Keyword">data</a> <a id="_⊢_"></a><a id="5817" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">_⊢_</a> <a id="5821" class="Symbol">(</a><a id="5822" href="lagda.2023-11-21-nbe.html#5822" class="Bound">Γ</a> <a id="5824" class="Symbol">:</a> <a id="5826" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="5829" class="Symbol">)</a> <a id="5831" class="Symbol">:</a> <a id="5833" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a> <a id="5838" class="Symbol">→</a> <a id="5840" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="5844" class="Keyword">where</a>
  <a id="5852" class="Comment">-- unit term</a>
  <a id="_⊢_.unit"></a><a id="5867" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a> <a id="5872" class="Symbol">:</a> <a id="5874" href="lagda.2023-11-21-nbe.html#5822" class="Bound">Γ</a> <a id="5876" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="5878" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a>

  <a id="5883" class="Comment">-- variable</a>
  <a id="_⊢_.#_"></a><a id="5897" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#_</a> <a id="5900" class="Symbol">:</a> <a id="5902" class="Symbol">∀</a> <a id="5904" class="Symbol">{</a><a id="5905" href="lagda.2023-11-21-nbe.html#5905" class="Bound">S</a> <a id="5907" class="Symbol">:</a> <a id="5909" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="5913" class="Symbol">}</a>
     <a id="5920" class="Symbol">→</a> <a id="5922" href="lagda.2023-11-21-nbe.html#5822" class="Bound">Γ</a> <a id="5924" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="5926" href="lagda.2023-11-21-nbe.html#5905" class="Bound">S</a>
       <a id="5935" class="Comment">-----</a>
     <a id="5946" class="Symbol">→</a> <a id="5948" href="lagda.2023-11-21-nbe.html#5822" class="Bound">Γ</a> <a id="5950" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="5952" href="lagda.2023-11-21-nbe.html#5905" class="Bound">S</a>

  <a id="5957" class="Comment">-- abstraction</a>
  <a id="_⊢_.ƛ_"></a><a id="5974" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ_</a> <a id="5977" class="Symbol">:</a> <a id="5979" class="Symbol">∀</a> <a id="5981" class="Symbol">{</a><a id="5982" href="lagda.2023-11-21-nbe.html#5982" class="Bound">S</a> <a id="5984" href="lagda.2023-11-21-nbe.html#5984" class="Bound">T</a> <a id="5986" class="Symbol">:</a> <a id="5988" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="5992" class="Symbol">}</a>
     <a id="5999" class="Symbol">→</a> <a id="6001" href="lagda.2023-11-21-nbe.html#5822" class="Bound">Γ</a> <a id="6003" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="6005" href="lagda.2023-11-21-nbe.html#5982" class="Bound">S</a> <a id="6007" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="6009" href="lagda.2023-11-21-nbe.html#5984" class="Bound">T</a>
       <a id="6018" class="Comment">---------</a>
     <a id="6033" class="Symbol">→</a> <a id="6035" href="lagda.2023-11-21-nbe.html#5822" class="Bound">Γ</a> <a id="6037" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="6039" href="lagda.2023-11-21-nbe.html#5982" class="Bound">S</a> <a id="6041" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="6043" href="lagda.2023-11-21-nbe.html#5984" class="Bound">T</a>

  <a id="6048" class="Comment">-- application</a>
  <a id="_⊢_._·_"></a><a id="6065" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">_·_</a> <a id="6069" class="Symbol">:</a> <a id="6071" class="Symbol">∀</a> <a id="6073" class="Symbol">{</a><a id="6074" href="lagda.2023-11-21-nbe.html#6074" class="Bound">S</a> <a id="6076" href="lagda.2023-11-21-nbe.html#6076" class="Bound">T</a> <a id="6078" class="Symbol">:</a> <a id="6080" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="6084" class="Symbol">}</a>
      <a id="6092" class="Symbol">→</a> <a id="6094" href="lagda.2023-11-21-nbe.html#5822" class="Bound">Γ</a> <a id="6096" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="6098" href="lagda.2023-11-21-nbe.html#6074" class="Bound">S</a> <a id="6100" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="6102" href="lagda.2023-11-21-nbe.html#6076" class="Bound">T</a>
      <a id="6110" class="Symbol">→</a> <a id="6112" href="lagda.2023-11-21-nbe.html#5822" class="Bound">Γ</a> <a id="6114" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="6116" href="lagda.2023-11-21-nbe.html#6074" class="Bound">S</a>
        <a id="6126" class="Comment">---------</a>
      <a id="6142" class="Symbol">→</a> <a id="6144" href="lagda.2023-11-21-nbe.html#5822" class="Bound">Γ</a> <a id="6146" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="6148" href="lagda.2023-11-21-nbe.html#6076" class="Bound">T</a>
</pre>
<!---
<pre class="Agda"><a id="6169" class="Keyword">infix</a> <a id="6175" class="Number">4</a> <a id="6177" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">_⊢_</a>
<a id="6181" class="Keyword">infix</a> <a id="6187" class="Number">5</a> <a id="6189" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ_</a>
<a id="6192" class="Keyword">infixl</a> <a id="6199" class="Number">7</a> <a id="6201" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">_·_</a>
<a id="6205" class="Keyword">infix</a> <a id="6211" class="Number">9</a> <a id="6213" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#_</a>
</pre>--->
<p>Here are some sample programs in STLC embedded here using these constructors:</p>
<pre class="Agda"><a id="6313" class="Keyword">module</a> <a id="SamplePrograms"></a><a id="6320" href="lagda.2023-11-21-nbe.html#6320" class="Module">SamplePrograms</a> <a id="6335" class="Keyword">where</a>
  <a id="6343" class="Comment">-- Γ ⊢ λx. x : T → T</a>
  <a id="SamplePrograms.ex0"></a><a id="6366" href="lagda.2023-11-21-nbe.html#6366" class="Function">ex0</a> <a id="6370" class="Symbol">:</a> <a id="6372" class="Symbol">∀</a> <a id="6374" class="Symbol">{</a><a id="6375" href="lagda.2023-11-21-nbe.html#6375" class="Bound">Γ</a> <a id="6377" class="Symbol">:</a> <a id="6379" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="6382" class="Symbol">}</a> <a id="6384" class="Symbol">{</a><a id="6385" href="lagda.2023-11-21-nbe.html#6385" class="Bound">T</a> <a id="6387" class="Symbol">:</a> <a id="6389" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="6393" class="Symbol">}</a> <a id="6395" class="Symbol">→</a> <a id="6397" href="lagda.2023-11-21-nbe.html#6375" class="Bound">Γ</a> <a id="6399" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="6401" href="lagda.2023-11-21-nbe.html#6385" class="Bound">T</a> <a id="6403" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="6405" href="lagda.2023-11-21-nbe.html#6385" class="Bound">T</a>
  <a id="6409" href="lagda.2023-11-21-nbe.html#6366" class="Function">ex0</a> <a id="6413" class="Symbol">=</a> <a id="6415" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="6417" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="6419" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>

  <a id="6424" class="Comment">-- ∅ ⊢ (λx. x) unit : 𝟙</a>
  <a id="SamplePrograms.ex1"></a><a id="6450" href="lagda.2023-11-21-nbe.html#6450" class="Function">ex1</a> <a id="6454" class="Symbol">:</a> <a id="6456" href="lagda.2023-11-21-nbe.html#3944" class="InductiveConstructor">∅</a> <a id="6458" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="6460" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a>
  <a id="6464" href="lagda.2023-11-21-nbe.html#6450" class="Function">ex1</a> <a id="6468" class="Symbol">=</a> <a id="6470" href="lagda.2023-11-21-nbe.html#6366" class="Function">ex0</a> <a id="6474" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="6476" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a>
</pre>
<p>With this embedding of the simply typed lambda calculus in Agda, an algorithm
for normalization by evaluation can actually be written. However, to prove
properties about the algorithm (e.g. that it is actually correct), a few more
language constructs are still needed. They are: context extension,
substitutions, and definitional equality. These will be defined before getting
into the details of the algorithm itself.</p>
<h4 id="context-extension">Context extension</h4>
<p>When defining the algorithm for normalization by evaluation, it will be
necessary to determine whether or not a context is an extension of another. A
context <code>Γ′</code> extends another context <code>Γ</code> if every mapping in <code>Γ</code> is also in
<code>Γ′</code>.</p>
<p>Since contexts are really just lists in their Agda representation, <code>Γ′</code> will be
an extension of <code>Γ</code> if <code>Γ</code> is a “sublist” of <code>Γ′</code>. The relation for context
extension is defined inductively based somewhat on this idea: a context extends
itself, and given that a context <code>Γ′</code> extends another context <code>Γ</code>, an extension
of <code>Γ′</code> is still an extension of <code>Γ′</code>.</p>
<pre class="Agda"><a id="7527" class="Keyword">data</a> <a id="_≤_"></a><a id="7532" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">_≤_</a> <a id="7536" class="Symbol">:</a> <a id="7538" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a> <a id="7542" class="Symbol">→</a> <a id="7544" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a> <a id="7548" class="Symbol">→</a> <a id="7550" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="7554" class="Keyword">where</a>
  <a id="_≤_.≤-id"></a><a id="7562" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a> <a id="7567" class="Symbol">:</a> <a id="7569" class="Symbol">∀</a> <a id="7571" class="Symbol">{</a><a id="7572" href="lagda.2023-11-21-nbe.html#7572" class="Bound">Γ</a> <a id="7574" class="Symbol">:</a> <a id="7576" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="7579" class="Symbol">}</a> <a id="7581" class="Symbol">→</a> <a id="7583" href="lagda.2023-11-21-nbe.html#7572" class="Bound">Γ</a> <a id="7585" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="7587" href="lagda.2023-11-21-nbe.html#7572" class="Bound">Γ</a>

  <a id="_≤_.≤-ext"></a><a id="7592" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="7598" class="Symbol">:</a> <a id="7600" class="Symbol">∀</a> <a id="7602" class="Symbol">{</a><a id="7603" href="lagda.2023-11-21-nbe.html#7603" class="Bound">Γ</a> <a id="7605" href="lagda.2023-11-21-nbe.html#7605" class="Bound">Γ′</a> <a id="7608" class="Symbol">:</a> <a id="7610" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="7613" class="Symbol">}</a> <a id="7615" class="Symbol">{</a><a id="7616" href="lagda.2023-11-21-nbe.html#7616" class="Bound">T</a> <a id="7618" class="Symbol">:</a> <a id="7620" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="7624" class="Symbol">}</a>
        <a id="7634" class="Symbol">→</a> <a id="7636" href="lagda.2023-11-21-nbe.html#7605" class="Bound">Γ′</a> <a id="7639" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="7641" href="lagda.2023-11-21-nbe.html#7603" class="Bound">Γ</a>
          <a id="7653" class="Comment">----------</a>
        <a id="7672" class="Symbol">→</a> <a id="7674" href="lagda.2023-11-21-nbe.html#7605" class="Bound">Γ′</a> <a id="7677" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="7679" href="lagda.2023-11-21-nbe.html#7616" class="Bound">T</a> <a id="7681" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="7683" href="lagda.2023-11-21-nbe.html#7603" class="Bound">Γ</a>
</pre>
<!---
<pre class="Agda"><a id="7704" class="Keyword">infix</a> <a id="7710" class="Number">4</a> <a id="7712" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">_≤_</a>
</pre>--->
<!---

The relation is invertible: if `Γ′ ≤ Γ , T`, then `Γ′ ≤ Γ`.

<pre class="Agda"><a id="invert-≤"></a><a id="7802" href="lagda.2023-11-21-nbe.html#7802" class="Function">invert-≤</a> <a id="7811" class="Symbol">:</a> <a id="7813" class="Symbol">∀</a> <a id="7815" class="Symbol">{</a><a id="7816" href="lagda.2023-11-21-nbe.html#7816" class="Bound">Γ</a> <a id="7818" href="lagda.2023-11-21-nbe.html#7818" class="Bound">Γ′</a> <a id="7821" class="Symbol">:</a> <a id="7823" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="7826" class="Symbol">}</a> <a id="7828" class="Symbol">{</a><a id="7829" href="lagda.2023-11-21-nbe.html#7829" class="Bound">T</a> <a id="7831" class="Symbol">:</a> <a id="7833" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="7837" class="Symbol">}</a>
         <a id="7848" class="Symbol">→</a> <a id="7850" href="lagda.2023-11-21-nbe.html#7818" class="Bound">Γ′</a> <a id="7853" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="7855" href="lagda.2023-11-21-nbe.html#7816" class="Bound">Γ</a> <a id="7857" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="7859" href="lagda.2023-11-21-nbe.html#7829" class="Bound">T</a>
           <a id="7872" class="Comment">----------</a>
         <a id="7892" class="Symbol">→</a> <a id="7894" href="lagda.2023-11-21-nbe.html#7818" class="Bound">Γ′</a> <a id="7897" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="7899" href="lagda.2023-11-21-nbe.html#7816" class="Bound">Γ</a>
<a id="7901" href="lagda.2023-11-21-nbe.html#7802" class="Function">invert-≤</a> <a id="7910" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a> <a id="7915" class="Symbol">=</a> <a id="7917" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="7923" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a>
<a id="7928" href="lagda.2023-11-21-nbe.html#7802" class="Function">invert-≤</a> <a id="7937" class="Symbol">(</a><a id="7938" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="7944" href="lagda.2023-11-21-nbe.html#7944" class="Bound">x</a><a id="7945" class="Symbol">)</a> <a id="7947" class="Symbol">=</a> <a id="7949" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="7955" class="Symbol">(</a><a id="7956" href="lagda.2023-11-21-nbe.html#7802" class="Function">invert-≤</a> <a id="7965" href="lagda.2023-11-21-nbe.html#7944" class="Bound">x</a><a id="7966" class="Symbol">)</a>
</pre>--->
<p>The relation is antisymmetric, meaning that if <code>Γ′ ≤ Γ</code> and <code>Γ ≤ Γ′</code>, then
<code>Γ′</code> and <code>Γ</code> must be the same context. This proof is left out in the rendering,
though it is proven mutually with the fact that <code>Γ</code> is never an extension of
<code>Γ, x:T</code>.</p>
<pre class="Agda"><a id="≤-antisym"></a><a id="8229" href="lagda.2023-11-21-nbe.html#8229" class="Function">≤-antisym</a> <a id="8239" class="Symbol">:</a> <a id="8241" class="Symbol">∀</a> <a id="8243" class="Symbol">{</a><a id="8244" href="lagda.2023-11-21-nbe.html#8244" class="Bound">Γ</a> <a id="8246" href="lagda.2023-11-21-nbe.html#8246" class="Bound">Γ′</a> <a id="8249" class="Symbol">:</a> <a id="8251" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="8254" class="Symbol">}</a>
          <a id="8266" class="Symbol">→</a> <a id="8268" href="lagda.2023-11-21-nbe.html#8244" class="Bound">Γ</a> <a id="8270" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="8272" href="lagda.2023-11-21-nbe.html#8246" class="Bound">Γ′</a>
          <a id="8285" class="Symbol">→</a> <a id="8287" href="lagda.2023-11-21-nbe.html#8246" class="Bound">Γ′</a> <a id="8290" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="8292" href="lagda.2023-11-21-nbe.html#8244" class="Bound">Γ</a>
            <a id="8306" class="Comment">------</a>
          <a id="8323" class="Symbol">→</a> <a id="8325" href="lagda.2023-11-21-nbe.html#8244" class="Bound">Γ</a> <a id="8327" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="8329" href="lagda.2023-11-21-nbe.html#8246" class="Bound">Γ′</a>

<a id="Γ≰Γ,T"></a><a id="8333" href="lagda.2023-11-21-nbe.html#8333" class="Function">Γ≰Γ,T</a> <a id="8339" class="Symbol">:</a> <a id="8341" class="Symbol">∀</a> <a id="8343" class="Symbol">{</a><a id="8344" href="lagda.2023-11-21-nbe.html#8344" class="Bound">Γ</a> <a id="8346" class="Symbol">:</a> <a id="8348" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="8351" class="Symbol">}</a> <a id="8353" class="Symbol">{</a><a id="8354" href="lagda.2023-11-21-nbe.html#8354" class="Bound">T</a> <a id="8356" class="Symbol">:</a> <a id="8358" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="8362" class="Symbol">}</a> <a id="8364" class="Symbol">→</a> <a id="8366" href="Relation.Nullary.html#656" class="Function Operator">¬</a> <a id="8368" class="Symbol">(</a><a id="8369" href="lagda.2023-11-21-nbe.html#8344" class="Bound">Γ</a> <a id="8371" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="8373" href="lagda.2023-11-21-nbe.html#8344" class="Bound">Γ</a> <a id="8375" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="8377" href="lagda.2023-11-21-nbe.html#8354" class="Bound">T</a><a id="8378" class="Symbol">)</a>
</pre>
<!---
<pre class="Agda"><a id="≤-ext-uniq-T"></a><a id="8399" href="lagda.2023-11-21-nbe.html#8399" class="Function">≤-ext-uniq-T</a> <a id="8412" class="Symbol">:</a> <a id="8414" class="Symbol">∀</a> <a id="8416" class="Symbol">{</a><a id="8417" href="lagda.2023-11-21-nbe.html#8417" class="Bound">Γ</a> <a id="8419" href="lagda.2023-11-21-nbe.html#8419" class="Bound">Γ′</a> <a id="8422" class="Symbol">:</a> <a id="8424" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="8427" class="Symbol">}</a> <a id="8429" class="Symbol">{</a><a id="8430" href="lagda.2023-11-21-nbe.html#8430" class="Bound">S</a> <a id="8432" href="lagda.2023-11-21-nbe.html#8432" class="Bound">T</a> <a id="8434" class="Symbol">:</a> <a id="8436" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="8440" class="Symbol">}</a>
           <a id="8453" class="Symbol">→</a> <a id="8455" href="lagda.2023-11-21-nbe.html#8419" class="Bound">Γ′</a> <a id="8458" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="8460" href="lagda.2023-11-21-nbe.html#8417" class="Bound">Γ</a> <a id="8462" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="8464" href="lagda.2023-11-21-nbe.html#8432" class="Bound">T</a>
           <a id="8477" class="Symbol">→</a> <a id="8479" href="lagda.2023-11-21-nbe.html#8419" class="Bound">Γ′</a> <a id="8482" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="8484" href="lagda.2023-11-21-nbe.html#8417" class="Bound">Γ</a> <a id="8486" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="8488" href="lagda.2023-11-21-nbe.html#8430" class="Bound">S</a>
             <a id="8503" class="Comment">----------</a>
           <a id="8525" class="Symbol">→</a> <a id="8527" href="lagda.2023-11-21-nbe.html#8432" class="Bound">T</a> <a id="8529" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="8531" href="lagda.2023-11-21-nbe.html#8430" class="Bound">S</a>

<a id="8534" href="lagda.2023-11-21-nbe.html#8399" class="Function">≤-ext-uniq-T</a> <a id="8547" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a> <a id="8552" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a> <a id="8557" class="Symbol">=</a> <a id="8559" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="8564" href="lagda.2023-11-21-nbe.html#8399" class="Function">≤-ext-uniq-T</a> <a id="8577" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a> <a id="8582" class="Symbol">(</a><a id="8583" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="8589" href="lagda.2023-11-21-nbe.html#8589" class="Bound">c</a><a id="8590" class="Symbol">)</a> <a id="8592" class="Symbol">=</a> <a id="8594" href="Data.Empty.html#628" class="Function">⊥-elim</a> <a id="8601" class="Symbol">(</a><a id="8602" href="lagda.2023-11-21-nbe.html#8333" class="Function">Γ≰Γ,T</a> <a id="8608" href="lagda.2023-11-21-nbe.html#8589" class="Bound">c</a><a id="8609" class="Symbol">)</a>
<a id="8611" href="lagda.2023-11-21-nbe.html#8399" class="Function">≤-ext-uniq-T</a> <a id="8624" class="Symbol">(</a><a id="8625" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="8631" href="lagda.2023-11-21-nbe.html#8631" class="Bound">c</a><a id="8632" class="Symbol">)</a> <a id="8634" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a> <a id="8639" class="Symbol">=</a> <a id="8641" href="Data.Empty.html#628" class="Function">⊥-elim</a> <a id="8648" class="Symbol">(</a><a id="8649" href="lagda.2023-11-21-nbe.html#8333" class="Function">Γ≰Γ,T</a> <a id="8655" href="lagda.2023-11-21-nbe.html#8631" class="Bound">c</a><a id="8656" class="Symbol">)</a>
<a id="8658" href="lagda.2023-11-21-nbe.html#8399" class="Function">≤-ext-uniq-T</a> <a id="8671" class="Symbol">(</a><a id="8672" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="8678" href="lagda.2023-11-21-nbe.html#8678" class="Bound">p₁</a><a id="8680" class="Symbol">)</a> <a id="8682" class="Symbol">(</a><a id="8683" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="8689" href="lagda.2023-11-21-nbe.html#8689" class="Bound">p₂</a><a id="8691" class="Symbol">)</a>
  <a id="8695" class="Keyword">rewrite</a> <a id="8703" href="lagda.2023-11-21-nbe.html#8399" class="Function">≤-ext-uniq-T</a> <a id="8716" href="lagda.2023-11-21-nbe.html#8678" class="Bound">p₁</a> <a id="8719" href="lagda.2023-11-21-nbe.html#8689" class="Bound">p₂</a> <a id="8722" class="Symbol">=</a> <a id="8724" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="8730" href="lagda.2023-11-21-nbe.html#8229" class="Function">≤-antisym</a> <a id="8740" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a> <a id="8745" href="lagda.2023-11-21-nbe.html#8745" class="Bound">Γ′≤Γ</a> <a id="8750" class="Symbol">=</a> <a id="8752" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="8757" href="lagda.2023-11-21-nbe.html#8229" class="Function">≤-antisym</a> <a id="8767" class="Symbol">(</a><a id="8768" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="8774" href="lagda.2023-11-21-nbe.html#8774" class="Bound">Γ≤Γ′</a><a id="8778" class="Symbol">)</a> <a id="8780" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a> <a id="8785" class="Symbol">=</a> <a id="8787" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="8792" href="lagda.2023-11-21-nbe.html#8229" class="Function">≤-antisym</a> <a id="8802" class="Symbol">(</a><a id="8803" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="8809" class="Symbol">{</a><a id="8810" class="Argument">T</a> <a id="8812" class="Symbol">=</a> <a id="8814" href="lagda.2023-11-21-nbe.html#8814" class="Bound">T₁</a><a id="8816" class="Symbol">}</a> <a id="8818" href="lagda.2023-11-21-nbe.html#8818" class="Bound">p₁</a><a id="8820" class="Symbol">)</a> <a id="8822" class="Symbol">(</a><a id="8823" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="8829" class="Symbol">{</a><a id="8830" class="Argument">T</a> <a id="8832" class="Symbol">=</a> <a id="8834" href="lagda.2023-11-21-nbe.html#8834" class="Bound">T₂</a><a id="8836" class="Symbol">}</a> <a id="8838" href="lagda.2023-11-21-nbe.html#8838" class="Bound">p₂</a><a id="8840" class="Symbol">)</a>
  <a id="8844" class="Keyword">with</a> <a id="8849" href="lagda.2023-11-21-nbe.html#7802" class="Function">invert-≤</a> <a id="8858" href="lagda.2023-11-21-nbe.html#8818" class="Bound">p₁</a> <a id="8861" class="Symbol">|</a> <a id="8863" href="lagda.2023-11-21-nbe.html#7802" class="Function">invert-≤</a> <a id="8872" href="lagda.2023-11-21-nbe.html#8838" class="Bound">p₂</a>
<a id="8875" class="Symbol">...</a>  <a id="8880" class="Symbol">|</a> <a id="8882" href="lagda.2023-11-21-nbe.html#8882" class="Bound">≤→</a>         <a id="8893" class="Symbol">|</a> <a id="8895" href="lagda.2023-11-21-nbe.html#8895" class="Bound">≤←</a>
  <a id="8900" class="Keyword">with</a> <a id="8905" href="lagda.2023-11-21-nbe.html#8229" class="Function">≤-antisym</a> <a id="8915" href="lagda.2023-11-21-nbe.html#8882" class="Bound">≤→</a> <a id="8918" href="lagda.2023-11-21-nbe.html#8895" class="Bound">≤←</a>
<a id="8921" class="Symbol">...</a>  <a id="8926" class="Symbol">|</a> <a id="8928" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="8935" class="Keyword">rewrite</a> <a id="8943" href="lagda.2023-11-21-nbe.html#8399" class="Function">≤-ext-uniq-T</a> <a id="8956" class="Bound">p₁</a> <a id="8959" class="Bound">p₂</a>     <a id="8966" class="Symbol">=</a> <a id="8968" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="8974" href="lagda.2023-11-21-nbe.html#8333" class="Function">Γ≰Γ,T</a> <a id="8980" class="Symbol">{</a><a id="8981" href="lagda.2023-11-21-nbe.html#8981" class="Bound">Γ</a><a id="8982" class="Symbol">}</a> <a id="8984" class="Symbol">{</a><a id="8985" href="lagda.2023-11-21-nbe.html#8985" class="Bound">T</a><a id="8986" class="Symbol">}</a> <a id="8988" href="lagda.2023-11-21-nbe.html#8988" class="Bound">Γ≤Γ,T</a>
  <a id="8996" class="Keyword">with</a> <a id="9001" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="9007" class="Symbol">{</a><a id="9008" class="Argument">T</a> <a id="9010" class="Symbol">=</a> <a id="9012" href="lagda.2023-11-21-nbe.html#8985" class="Bound">T</a><a id="9013" class="Symbol">}</a> <a id="9015" class="Symbol">(</a><a id="9016" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a> <a id="9021" class="Symbol">{</a><a id="9022" href="lagda.2023-11-21-nbe.html#8981" class="Bound">Γ</a><a id="9023" class="Symbol">})</a>
<a id="9026" class="Symbol">...</a>  <a id="9031" class="Symbol">|</a> <a id="9033" href="lagda.2023-11-21-nbe.html#9033" class="Bound">Γ,T≤Γ</a>
  <a id="9041" class="Keyword">with</a> <a id="9046" href="lagda.2023-11-21-nbe.html#8229" class="Function">≤-antisym</a> <a id="9056" class="Bound">Γ≤Γ,T</a> <a id="9062" href="lagda.2023-11-21-nbe.html#9033" class="Bound">Γ,T≤Γ</a>
<a id="9068" class="Symbol">...</a>  <a id="9073" class="Symbol">|</a> <a id="9075" class="Symbol">()</a>
</pre>--->
<p>This relation is also transitive, a proof that follows by induction:</p>
<pre class="Agda"><a id="≤-trans"></a><a id="9166" href="lagda.2023-11-21-nbe.html#9166" class="Function">≤-trans</a> <a id="9174" class="Symbol">:</a> <a id="9176" class="Symbol">∀</a> <a id="9178" class="Symbol">{</a><a id="9179" href="lagda.2023-11-21-nbe.html#9179" class="Bound">Γ″</a> <a id="9182" href="lagda.2023-11-21-nbe.html#9182" class="Bound">Γ′</a> <a id="9185" href="lagda.2023-11-21-nbe.html#9185" class="Bound">Γ</a> <a id="9187" class="Symbol">:</a> <a id="9189" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="9192" class="Symbol">}</a>
         <a id="9203" class="Symbol">→</a> <a id="9205" href="lagda.2023-11-21-nbe.html#9179" class="Bound">Γ″</a> <a id="9208" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="9210" href="lagda.2023-11-21-nbe.html#9182" class="Bound">Γ′</a>
         <a id="9222" class="Symbol">→</a> <a id="9224" href="lagda.2023-11-21-nbe.html#9182" class="Bound">Γ′</a> <a id="9227" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="9229" href="lagda.2023-11-21-nbe.html#9185" class="Bound">Γ</a>
           <a id="9242" class="Comment">-------</a>
         <a id="9259" class="Symbol">→</a> <a id="9261" href="lagda.2023-11-21-nbe.html#9179" class="Bound">Γ″</a> <a id="9264" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="9266" href="lagda.2023-11-21-nbe.html#9185" class="Bound">Γ</a>
<a id="9268" href="lagda.2023-11-21-nbe.html#9166" class="Function">≤-trans</a> <a id="9276" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a> <a id="9281" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a>               <a id="9300" class="Symbol">=</a> <a id="9302" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a>
<a id="9307" href="lagda.2023-11-21-nbe.html#9166" class="Function">≤-trans</a> <a id="9315" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a> <a id="9320" class="Symbol">(</a><a id="9321" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="9327" href="lagda.2023-11-21-nbe.html#9327" class="Bound">pf</a><a id="9329" class="Symbol">)</a>         <a id="9339" class="Symbol">=</a> <a id="9341" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="9347" href="lagda.2023-11-21-nbe.html#9327" class="Bound">pf</a>
<a id="9350" href="lagda.2023-11-21-nbe.html#9166" class="Function">≤-trans</a> <a id="9358" class="Symbol">(</a><a id="9359" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="9365" href="lagda.2023-11-21-nbe.html#9365" class="Bound">pf</a><a id="9367" class="Symbol">)</a> <a id="9369" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a>         <a id="9382" class="Symbol">=</a> <a id="9384" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="9390" href="lagda.2023-11-21-nbe.html#9365" class="Bound">pf</a>
<a id="9393" href="lagda.2023-11-21-nbe.html#9166" class="Function">≤-trans</a> <a id="9401" class="Symbol">(</a><a id="9402" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="9408" href="lagda.2023-11-21-nbe.html#9408" class="Bound">pf₁</a><a id="9411" class="Symbol">)</a> <a id="9413" class="Symbol">(</a><a id="9414" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="9420" href="lagda.2023-11-21-nbe.html#9420" class="Bound">pf₂</a><a id="9423" class="Symbol">)</a> <a id="9425" class="Symbol">=</a> <a id="9427" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="9433" class="Symbol">(</a><a id="9434" href="lagda.2023-11-21-nbe.html#9166" class="Function">≤-trans</a> <a id="9442" href="lagda.2023-11-21-nbe.html#9408" class="Bound">pf₁</a> <a id="9446" class="Symbol">(</a><a id="9447" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="9453" href="lagda.2023-11-21-nbe.html#9420" class="Bound">pf₂</a><a id="9456" class="Symbol">))</a>
</pre>
<p>Finally, this relation can be made decidable. Its decidability requires that
equality between contexts (and by extension, type) also be decidable; these
proofs are also left out in the rendering.</p>
<pre class="Agda"><a id="_≟Tp_"></a><a id="9669" href="lagda.2023-11-21-nbe.html#9669" class="Function Operator">_≟Tp_</a> <a id="9675" class="Symbol">:</a> <a id="9677" class="Symbol">∀</a> <a id="9679" class="Symbol">(</a><a id="9680" href="lagda.2023-11-21-nbe.html#9680" class="Bound">S</a> <a id="9682" href="lagda.2023-11-21-nbe.html#9682" class="Bound">T</a> <a id="9684" class="Symbol">:</a> <a id="9686" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="9690" class="Symbol">)</a> <a id="9692" class="Symbol">→</a> <a id="9694" href="Relation.Nullary.html#1511" class="Record">Dec</a> <a id="9698" class="Symbol">(</a><a id="9699" href="lagda.2023-11-21-nbe.html#9680" class="Bound">S</a> <a id="9701" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="9703" href="lagda.2023-11-21-nbe.html#9682" class="Bound">T</a><a id="9704" class="Symbol">)</a>
</pre>
<!---
<pre class="Agda"><a id="9725" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a>         <a id="9735" href="lagda.2023-11-21-nbe.html#9669" class="Function Operator">≟Tp</a> <a id="9739" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a>                                    <a id="9776" class="Symbol">=</a> <a id="9778" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="9782" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="9787" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a>         <a id="9797" href="lagda.2023-11-21-nbe.html#9669" class="Function Operator">≟Tp</a> <a id="9801" class="Symbol">(</a><a id="9802" href="lagda.2023-11-21-nbe.html#9802" class="Bound">S</a> <a id="9804" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="9806" href="lagda.2023-11-21-nbe.html#9806" class="Bound">T</a><a id="9807" class="Symbol">)</a>                              <a id="9838" class="Symbol">=</a> <a id="9840" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="9843" class="Symbol">λ()</a>
<a id="9847" class="Symbol">(</a><a id="9848" href="lagda.2023-11-21-nbe.html#9848" class="Bound">S₁</a> <a id="9851" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="9853" href="lagda.2023-11-21-nbe.html#9853" class="Bound">T₁</a><a id="9855" class="Symbol">)</a> <a id="9857" href="lagda.2023-11-21-nbe.html#9669" class="Function Operator">≟Tp</a> <a id="9861" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a>                                    <a id="9898" class="Symbol">=</a> <a id="9900" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="9903" class="Symbol">λ()</a>
<a id="9907" class="Symbol">(</a><a id="9908" href="lagda.2023-11-21-nbe.html#9908" class="Bound">S₁</a> <a id="9911" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="9913" href="lagda.2023-11-21-nbe.html#9913" class="Bound">T₁</a><a id="9915" class="Symbol">)</a> <a id="9917" href="lagda.2023-11-21-nbe.html#9669" class="Function Operator">≟Tp</a> <a id="9921" class="Symbol">(</a><a id="9922" href="lagda.2023-11-21-nbe.html#9922" class="Bound">S₂</a> <a id="9925" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="9927" href="lagda.2023-11-21-nbe.html#9927" class="Bound">T₂</a><a id="9929" class="Symbol">)</a> <a id="9931" class="Keyword">with</a> <a id="9936" href="lagda.2023-11-21-nbe.html#9908" class="Bound">S₁</a> <a id="9939" href="lagda.2023-11-21-nbe.html#9669" class="Function Operator">≟Tp</a> <a id="9943" href="lagda.2023-11-21-nbe.html#9922" class="Bound">S₂</a> <a id="9946" class="Symbol">|</a> <a id="9948" href="lagda.2023-11-21-nbe.html#9913" class="Bound">T₁</a> <a id="9951" href="lagda.2023-11-21-nbe.html#9669" class="Function Operator">≟Tp</a> <a id="9955" href="lagda.2023-11-21-nbe.html#9927" class="Bound">T₂</a>
<a id="9958" class="Symbol">...</a>                        <a id="9985" class="Symbol">|</a> <a id="9987" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="9990" href="lagda.2023-11-21-nbe.html#9990" class="Bound">¬pf</a>    <a id="9997" class="Symbol">|</a> <a id="9999" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="10002" class="Symbol">_</a>      <a id="10009" class="Symbol">=</a> <a id="10011" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="10014" class="Symbol">λ{</a><a id="10016" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="10021" class="Symbol">→</a> <a id="10023" href="lagda.2023-11-21-nbe.html#9990" class="Bound">¬pf</a> <a id="10027" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="10031" class="Symbol">}</a>
<a id="10033" class="Symbol">...</a>                        <a id="10060" class="Symbol">|</a> <a id="10062" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="10065" href="lagda.2023-11-21-nbe.html#10065" class="Bound">¬pf</a>    <a id="10072" class="Symbol">|</a> <a id="10074" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="10078" class="Symbol">_</a>     <a id="10084" class="Symbol">=</a> <a id="10086" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="10089" class="Symbol">λ{</a><a id="10091" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="10096" class="Symbol">→</a> <a id="10098" href="lagda.2023-11-21-nbe.html#10065" class="Bound">¬pf</a> <a id="10102" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="10106" class="Symbol">}</a>
<a id="10108" class="Symbol">...</a>                        <a id="10135" class="Symbol">|</a> <a id="10137" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="10141" class="Symbol">_</a>     <a id="10147" class="Symbol">|</a> <a id="10149" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="10152" href="lagda.2023-11-21-nbe.html#10152" class="Bound">¬pf</a>    <a id="10159" class="Symbol">=</a> <a id="10161" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="10164" class="Symbol">λ{</a><a id="10166" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="10171" class="Symbol">→</a> <a id="10173" href="lagda.2023-11-21-nbe.html#10152" class="Bound">¬pf</a> <a id="10177" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="10181" class="Symbol">}</a>
<a id="10183" class="Symbol">...</a>                        <a id="10210" class="Symbol">|</a> <a id="10212" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="10216" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>  <a id="10222" class="Symbol">|</a> <a id="10224" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="10228" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>  <a id="10234" class="Symbol">=</a> <a id="10236" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="10240" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
</pre>--->
<pre class="Agda"><a id="_≟Ctx_"></a><a id="10263" href="lagda.2023-11-21-nbe.html#10263" class="Function Operator">_≟Ctx_</a> <a id="10270" class="Symbol">:</a> <a id="10272" class="Symbol">(</a><a id="10273" href="lagda.2023-11-21-nbe.html#10273" class="Bound">Γ</a> <a id="10275" href="lagda.2023-11-21-nbe.html#10275" class="Bound">Γ′</a> <a id="10278" class="Symbol">:</a> <a id="10280" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="10283" class="Symbol">)</a> <a id="10285" class="Symbol">→</a> <a id="10287" href="Relation.Nullary.html#1511" class="Record">Dec</a> <a id="10291" class="Symbol">(</a><a id="10292" href="lagda.2023-11-21-nbe.html#10273" class="Bound">Γ</a> <a id="10294" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="10296" href="lagda.2023-11-21-nbe.html#10275" class="Bound">Γ′</a><a id="10298" class="Symbol">)</a>
</pre>
<!---
<pre class="Agda"><a id="10319" href="lagda.2023-11-21-nbe.html#3944" class="InductiveConstructor">∅</a>       <a id="10327" href="lagda.2023-11-21-nbe.html#10263" class="Function Operator">≟Ctx</a> <a id="10332" href="lagda.2023-11-21-nbe.html#3944" class="InductiveConstructor">∅</a>                                  <a id="10367" class="Symbol">=</a> <a id="10369" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="10373" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="10378" href="lagda.2023-11-21-nbe.html#3944" class="InductiveConstructor">∅</a>       <a id="10386" href="lagda.2023-11-21-nbe.html#10263" class="Function Operator">≟Ctx</a> <a id="10391" class="Symbol">(_</a> <a id="10394" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="10396" class="Symbol">_)</a>                            <a id="10426" class="Symbol">=</a> <a id="10428" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="10431" class="Symbol">λ()</a>
<a id="10435" class="Symbol">(_</a> <a id="10438" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="10440" class="Symbol">_)</a> <a id="10443" href="lagda.2023-11-21-nbe.html#10263" class="Function Operator">≟Ctx</a> <a id="10448" href="lagda.2023-11-21-nbe.html#3944" class="InductiveConstructor">∅</a>                                  <a id="10483" class="Symbol">=</a> <a id="10485" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="10488" class="Symbol">λ()</a>
<a id="10492" class="Symbol">(</a><a id="10493" href="lagda.2023-11-21-nbe.html#10493" class="Bound">Γ′</a> <a id="10496" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="10498" href="lagda.2023-11-21-nbe.html#10498" class="Bound">S</a><a id="10499" class="Symbol">)</a> <a id="10501" href="lagda.2023-11-21-nbe.html#10263" class="Function Operator">≟Ctx</a> <a id="10506" class="Symbol">(</a><a id="10507" href="lagda.2023-11-21-nbe.html#10507" class="Bound">Γ</a> <a id="10509" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="10511" href="lagda.2023-11-21-nbe.html#10511" class="Bound">T</a><a id="10512" class="Symbol">)</a> <a id="10514" class="Keyword">with</a> <a id="10519" href="lagda.2023-11-21-nbe.html#10493" class="Bound">Γ′</a> <a id="10522" href="lagda.2023-11-21-nbe.html#10263" class="Function Operator">≟Ctx</a> <a id="10527" href="lagda.2023-11-21-nbe.html#10507" class="Bound">Γ</a> <a id="10529" class="Symbol">|</a> <a id="10531" href="lagda.2023-11-21-nbe.html#10498" class="Bound">S</a> <a id="10533" href="lagda.2023-11-21-nbe.html#9669" class="Function Operator">≟Tp</a> <a id="10537" href="lagda.2023-11-21-nbe.html#10511" class="Bound">T</a>
<a id="10539" class="Symbol">...</a>                      <a id="10564" class="Symbol">|</a> <a id="10566" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="10569" href="lagda.2023-11-21-nbe.html#10569" class="Bound">¬pf</a>    <a id="10576" class="Symbol">|</a> <a id="10578" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="10581" class="Symbol">_</a>     <a id="10587" class="Symbol">=</a> <a id="10589" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="10592" class="Symbol">λ{</a><a id="10594" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="10599" class="Symbol">→</a> <a id="10601" href="lagda.2023-11-21-nbe.html#10569" class="Bound">¬pf</a> <a id="10605" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="10609" class="Symbol">}</a>
<a id="10611" class="Symbol">...</a>                      <a id="10636" class="Symbol">|</a> <a id="10638" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="10641" href="lagda.2023-11-21-nbe.html#10641" class="Bound">¬pf</a>    <a id="10648" class="Symbol">|</a> <a id="10650" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="10654" class="Symbol">_</a>    <a id="10659" class="Symbol">=</a> <a id="10661" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="10664" class="Symbol">λ{</a><a id="10666" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="10671" class="Symbol">→</a> <a id="10673" href="lagda.2023-11-21-nbe.html#10641" class="Bound">¬pf</a> <a id="10677" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="10681" class="Symbol">}</a>
<a id="10683" class="Symbol">...</a>                      <a id="10708" class="Symbol">|</a> <a id="10710" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="10714" class="Symbol">_</a>     <a id="10720" class="Symbol">|</a> <a id="10722" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="10725" href="lagda.2023-11-21-nbe.html#10725" class="Bound">¬pf</a>   <a id="10731" class="Symbol">=</a> <a id="10733" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="10736" class="Symbol">λ{</a><a id="10738" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="10743" class="Symbol">→</a> <a id="10745" href="lagda.2023-11-21-nbe.html#10725" class="Bound">¬pf</a> <a id="10749" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="10753" class="Symbol">}</a>
<a id="10755" class="Symbol">...</a>                      <a id="10780" class="Symbol">|</a> <a id="10782" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="10786" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>  <a id="10792" class="Symbol">|</a> <a id="10794" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="10798" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="10803" class="Symbol">=</a> <a id="10805" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="10809" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
</pre>--->
<p>With these, the relation can be made decidable in Agda:</p>
<pre class="Agda"><a id="_≤?_"></a><a id="10889" href="lagda.2023-11-21-nbe.html#10889" class="Function Operator">_≤?_</a> <a id="10894" class="Symbol">:</a> <a id="10896" class="Symbol">∀</a> <a id="10898" class="Symbol">(</a><a id="10899" href="lagda.2023-11-21-nbe.html#10899" class="Bound">Γ′</a> <a id="10902" href="lagda.2023-11-21-nbe.html#10902" class="Bound">Γ</a> <a id="10904" class="Symbol">:</a> <a id="10906" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="10909" class="Symbol">)</a> <a id="10911" class="Symbol">→</a> <a id="10913" href="Relation.Nullary.html#1511" class="Record">Dec</a> <a id="10917" class="Symbol">(</a><a id="10918" href="lagda.2023-11-21-nbe.html#10899" class="Bound">Γ′</a> <a id="10921" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="10923" href="lagda.2023-11-21-nbe.html#10902" class="Bound">Γ</a><a id="10924" class="Symbol">)</a>
<a id="10926" href="lagda.2023-11-21-nbe.html#3944" class="InductiveConstructor">∅</a>        <a id="10935" href="lagda.2023-11-21-nbe.html#10889" class="Function Operator">≤?</a> <a id="10938" href="lagda.2023-11-21-nbe.html#3944" class="InductiveConstructor">∅</a>          <a id="10949" class="Symbol">=</a> <a id="10951" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="10955" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a>
<a id="10960" href="lagda.2023-11-21-nbe.html#3944" class="InductiveConstructor">∅</a>        <a id="10969" href="lagda.2023-11-21-nbe.html#10889" class="Function Operator">≤?</a> <a id="10972" class="Symbol">(_</a> <a id="10975" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="10977" class="Symbol">_)</a>    <a id="10983" class="Symbol">=</a> <a id="10985" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="10988" class="Symbol">λ()</a>
<a id="10992" class="Symbol">(_</a> <a id="10995" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="10997" class="Symbol">_)</a>  <a id="11001" href="lagda.2023-11-21-nbe.html#10889" class="Function Operator">≤?</a> <a id="11004" href="lagda.2023-11-21-nbe.html#3944" class="InductiveConstructor">∅</a>          <a id="11015" class="Symbol">=</a> <a id="11017" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="11021" href="lagda.2023-11-21-nbe.html#11033" class="Function">Γ≤∅</a> <a id="11025" class="Keyword">where</a>
  <a id="11033" href="lagda.2023-11-21-nbe.html#11033" class="Function">Γ≤∅</a> <a id="11037" class="Symbol">:</a> <a id="11039" class="Symbol">∀</a> <a id="11041" class="Symbol">{</a><a id="11042" href="lagda.2023-11-21-nbe.html#11042" class="Bound">Γ</a> <a id="11044" class="Symbol">:</a> <a id="11046" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="11049" class="Symbol">}</a> <a id="11051" class="Symbol">→</a> <a id="11053" href="lagda.2023-11-21-nbe.html#11042" class="Bound">Γ</a> <a id="11055" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="11057" href="lagda.2023-11-21-nbe.html#3944" class="InductiveConstructor">∅</a>
  <a id="11061" href="lagda.2023-11-21-nbe.html#11033" class="Function">Γ≤∅</a> <a id="11065" class="Symbol">{</a><a id="11066" href="lagda.2023-11-21-nbe.html#3944" class="InductiveConstructor">∅</a><a id="11067" class="Symbol">}</a>     <a id="11073" class="Symbol">=</a> <a id="11075" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a>
  <a id="11082" href="lagda.2023-11-21-nbe.html#11033" class="Function">Γ≤∅</a> <a id="11086" class="Symbol">{</a><a id="11087" href="lagda.2023-11-21-nbe.html#11087" class="Bound">Γ</a> <a id="11089" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="11091" class="Symbol">_}</a> <a id="11094" class="Symbol">=</a> <a id="11096" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="11102" href="lagda.2023-11-21-nbe.html#11033" class="Function">Γ≤∅</a>
<a id="11106" class="Symbol">(</a><a id="11107" href="lagda.2023-11-21-nbe.html#11107" class="Bound">Γ′</a> <a id="11110" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="11112" href="lagda.2023-11-21-nbe.html#11112" class="Bound">T</a><a id="11113" class="Symbol">)</a> <a id="11115" href="lagda.2023-11-21-nbe.html#10889" class="Function Operator">≤?</a> <a id="11118" href="lagda.2023-11-21-nbe.html#11118" class="Bound">Γ</a><a id="11119" class="Symbol">@(_</a> <a id="11123" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="11125" class="Symbol">_)</a>
  <a id="11130" class="Keyword">with</a> <a id="11135" class="Symbol">(</a><a id="11136" href="lagda.2023-11-21-nbe.html#11107" class="Bound">Γ′</a> <a id="11139" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="11141" href="lagda.2023-11-21-nbe.html#11112" class="Bound">T</a><a id="11142" class="Symbol">)</a> <a id="11144" href="lagda.2023-11-21-nbe.html#10263" class="Function Operator">≟Ctx</a> <a id="11149" href="lagda.2023-11-21-nbe.html#11118" class="Bound">Γ</a>
<a id="11151" class="Symbol">...</a>  <a id="11156" class="Symbol">|</a> <a id="11158" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="11162" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>        <a id="11174" class="Symbol">=</a> <a id="11176" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="11180" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a>
<a id="11185" class="Symbol">...</a>  <a id="11190" class="Symbol">|</a> <a id="11192" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="11195" href="lagda.2023-11-21-nbe.html#11195" class="Bound">Γ′≢Γ</a>
  <a id="11202" class="Keyword">with</a> <a id="11207" class="Bound">Γ′</a> <a id="11210" href="lagda.2023-11-21-nbe.html#10889" class="Function Operator">≤?</a> <a id="11213" class="Bound">Γ</a>
<a id="11215" class="Symbol">...</a>  <a id="11220" class="Symbol">|</a> <a id="11222" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="11226" href="lagda.2023-11-21-nbe.html#11226" class="Bound">pf</a>          <a id="11238" class="Symbol">=</a> <a id="11240" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="11244" class="Symbol">(</a><a id="11245" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="11251" href="lagda.2023-11-21-nbe.html#11226" class="Bound">pf</a><a id="11253" class="Symbol">)</a>
<a id="11255" class="Symbol">...</a>  <a id="11260" class="Symbol">|</a> <a id="11262" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="11265" href="lagda.2023-11-21-nbe.html#11265" class="Bound">¬pf</a>          <a id="11278" class="Symbol">=</a> <a id="11280" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="11283" class="Symbol">λ</a> <a id="11285" class="Keyword">where</a>
                           <a id="11318" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a>       <a id="11329" class="Symbol">→</a> <a id="11331" class="Bound">Γ′≢Γ</a> <a id="11336" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
                           <a id="11368" class="Symbol">(</a><a id="11369" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="11375" href="lagda.2023-11-21-nbe.html#11375" class="Bound">pf</a><a id="11377" class="Symbol">)</a> <a id="11379" class="Symbol">→</a> <a id="11381" href="lagda.2023-11-21-nbe.html#11265" class="Bound">¬pf</a> <a id="11385" href="lagda.2023-11-21-nbe.html#11375" class="Bound">pf</a>
</pre>
<h4 id="substitution">Substitution</h4>
<p>A parallel substitution <code>Γ ⊢ σ : Δ</code> provides a term in <code>Γ</code> to substitute for
each variable in the context <code>Δ</code>. In other words, a substitution <code>σ</code> is a
function from variables in a context to terms in another context.</p>
<pre class="Agda"><a id="Sub"></a><a id="11638" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="11642" class="Symbol">:</a> <a id="11644" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a> <a id="11648" class="Symbol">→</a> <a id="11650" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a> <a id="11654" class="Symbol">→</a> <a id="11656" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="11660" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="11664" href="lagda.2023-11-21-nbe.html#11664" class="Bound">Γ</a> <a id="11666" href="lagda.2023-11-21-nbe.html#11666" class="Bound">Δ</a> <a id="11668" class="Symbol">=</a> <a id="11670" class="Symbol">∀</a> <a id="11672" class="Symbol">{</a><a id="11673" href="lagda.2023-11-21-nbe.html#11673" class="Bound">T</a> <a id="11675" class="Symbol">:</a> <a id="11677" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="11681" class="Symbol">}</a> <a id="11683" class="Symbol">→</a> <a id="11685" href="lagda.2023-11-21-nbe.html#11666" class="Bound">Δ</a> <a id="11687" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="11689" href="lagda.2023-11-21-nbe.html#11673" class="Bound">T</a> <a id="11691" class="Symbol">→</a> <a id="11693" href="lagda.2023-11-21-nbe.html#11664" class="Bound">Γ</a> <a id="11695" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="11697" href="lagda.2023-11-21-nbe.html#11673" class="Bound">T</a>
</pre>
<p>To actually use a substitution, an operation is needed to apply the substitution
to a term in the context being used by the substitution:</p>
<pre><code>Δ ⊢ σ : Γ      Δ ⊢ t : T
------------------------
     Γ ⊢ t[σ] : T</code></pre>
<p>This operation would allow for transforming a term <code>t</code> that is well-typed in the
context <code>Δ</code> using a substitution <code>σ</code> that maps every variable in <code>Δ</code> to a term
that is well-typed in <code>Γ</code>.</p>
<p>Defining this operation is actually a little tricky in Agda, because the
typical definition of the application of a substitution <code>σ</code> is not obviously
terminating. To solve this problem, it is necessary to separately define a
smaller subset of substitution: renaming.</p>
<p>A renaming is a specialized substitution where the only terms that can be
substituted for variables are other variables (i.e. a renaming <code>Γ ⊢ ρ : Δ</code>
provides a variable in <code>Γ</code>, not a term in <code>Γ</code>, to replace for every variable
in <code>Δ</code>).</p>
<pre class="Agda"><a id="Ren"></a><a id="12625" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="12629" class="Symbol">:</a> <a id="12631" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a> <a id="12635" class="Symbol">→</a> <a id="12637" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a> <a id="12641" class="Symbol">→</a> <a id="12643" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="12647" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="12651" href="lagda.2023-11-21-nbe.html#12651" class="Bound">Γ</a> <a id="12653" href="lagda.2023-11-21-nbe.html#12653" class="Bound">Δ</a> <a id="12655" class="Symbol">=</a> <a id="12657" class="Symbol">∀</a> <a id="12659" class="Symbol">{</a><a id="12660" href="lagda.2023-11-21-nbe.html#12660" class="Bound">T</a> <a id="12662" class="Symbol">:</a> <a id="12664" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="12668" class="Symbol">}</a> <a id="12670" class="Symbol">→</a> <a id="12672" href="lagda.2023-11-21-nbe.html#12653" class="Bound">Δ</a> <a id="12674" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="12676" href="lagda.2023-11-21-nbe.html#12660" class="Bound">T</a> <a id="12678" class="Symbol">→</a> <a id="12680" href="lagda.2023-11-21-nbe.html#12651" class="Bound">Γ</a> <a id="12682" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="12684" href="lagda.2023-11-21-nbe.html#12660" class="Bound">T</a>
</pre>
<p>Any renaming can be transformed to the more general definition for
substitutions:</p>
<pre class="Agda"><a id="ren"></a><a id="12782" href="lagda.2023-11-21-nbe.html#12782" class="Function">ren</a> <a id="12786" class="Symbol">:</a> <a id="12788" class="Symbol">∀</a> <a id="12790" class="Symbol">{</a><a id="12791" href="lagda.2023-11-21-nbe.html#12791" class="Bound">Γ</a> <a id="12793" href="lagda.2023-11-21-nbe.html#12793" class="Bound">Δ</a> <a id="12795" class="Symbol">:</a> <a id="12797" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="12800" class="Symbol">}</a> <a id="12802" class="Symbol">→</a> <a id="12804" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="12808" href="lagda.2023-11-21-nbe.html#12791" class="Bound">Γ</a> <a id="12810" href="lagda.2023-11-21-nbe.html#12793" class="Bound">Δ</a> <a id="12812" class="Symbol">→</a> <a id="12814" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="12818" href="lagda.2023-11-21-nbe.html#12791" class="Bound">Γ</a> <a id="12820" href="lagda.2023-11-21-nbe.html#12793" class="Bound">Δ</a>
<a id="12822" href="lagda.2023-11-21-nbe.html#12782" class="Function">ren</a> <a id="12826" href="lagda.2023-11-21-nbe.html#12826" class="Bound">ρ</a> <a id="12828" href="lagda.2023-11-21-nbe.html#12828" class="Bound">x</a> <a id="12830" class="Symbol">=</a> <a id="12832" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="12834" href="lagda.2023-11-21-nbe.html#12826" class="Bound">ρ</a> <a id="12836" href="lagda.2023-11-21-nbe.html#12828" class="Bound">x</a>
</pre>
<p>Two renamings that will be especially relevant are the identity renaming (which
substitutes variables for themselves) and the shifting renaming (which shifts
all variables by 1). To indicate that these are renamings specifically (as they
will also be defined for the more general definition of substitutions), the
superscript <code>ʳ</code> is used.</p>
<pre class="Agda"><a id="idʳ"></a><a id="13191" href="lagda.2023-11-21-nbe.html#13191" class="Function">idʳ</a> <a id="13195" class="Symbol">:</a> <a id="13197" class="Symbol">∀</a> <a id="13199" class="Symbol">{</a><a id="13200" href="lagda.2023-11-21-nbe.html#13200" class="Bound">Γ</a> <a id="13202" class="Symbol">:</a> <a id="13204" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="13207" class="Symbol">}</a> <a id="13209" class="Symbol">→</a> <a id="13211" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="13215" href="lagda.2023-11-21-nbe.html#13200" class="Bound">Γ</a> <a id="13217" href="lagda.2023-11-21-nbe.html#13200" class="Bound">Γ</a>
<a id="13219" href="lagda.2023-11-21-nbe.html#13191" class="Function">idʳ</a> <a id="13223" href="lagda.2023-11-21-nbe.html#13223" class="Bound">x</a> <a id="13225" class="Symbol">=</a> <a id="13227" href="lagda.2023-11-21-nbe.html#13223" class="Bound">x</a>

<a id="↥ʳ"></a><a id="13230" href="lagda.2023-11-21-nbe.html#13230" class="Function">↥ʳ</a> <a id="13233" class="Symbol">:</a> <a id="13235" class="Symbol">∀</a> <a id="13237" class="Symbol">{</a><a id="13238" href="lagda.2023-11-21-nbe.html#13238" class="Bound">Γ</a> <a id="13240" class="Symbol">:</a> <a id="13242" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="13245" class="Symbol">}</a> <a id="13247" class="Symbol">{</a><a id="13248" href="lagda.2023-11-21-nbe.html#13248" class="Bound">T</a> <a id="13250" class="Symbol">:</a> <a id="13252" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="13256" class="Symbol">}</a> <a id="13258" class="Symbol">→</a> <a id="13260" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="13264" class="Symbol">(</a><a id="13265" href="lagda.2023-11-21-nbe.html#13238" class="Bound">Γ</a> <a id="13267" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="13269" href="lagda.2023-11-21-nbe.html#13248" class="Bound">T</a><a id="13270" class="Symbol">)</a> <a id="13272" href="lagda.2023-11-21-nbe.html#13238" class="Bound">Γ</a>
<a id="13274" href="lagda.2023-11-21-nbe.html#13230" class="Function">↥ʳ</a> <a id="13277" href="lagda.2023-11-21-nbe.html#13277" class="Bound">x</a> <a id="13279" class="Symbol">=</a> <a id="13281" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="13283" href="lagda.2023-11-21-nbe.html#13277" class="Bound">x</a>
</pre>
<p>Any two renamings can also be composed. For a renaming substitution, this is
really just function compostition. Agda’s own symbol for function composition,
<code>∘</code>, is used for this reason (though again with the superscript <code>ʳ</code>).</p>
<pre class="Agda"><a id="_∘ʳ_"></a><a id="13525" href="lagda.2023-11-21-nbe.html#13525" class="Function Operator">_∘ʳ_</a> <a id="13530" class="Symbol">:</a> <a id="13532" class="Symbol">∀</a> <a id="13534" class="Symbol">{</a><a id="13535" href="lagda.2023-11-21-nbe.html#13535" class="Bound">Γ</a> <a id="13537" href="lagda.2023-11-21-nbe.html#13537" class="Bound">Δ</a> <a id="13539" href="lagda.2023-11-21-nbe.html#13539" class="Bound">Σ</a> <a id="13541" class="Symbol">:</a> <a id="13543" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="13546" class="Symbol">}</a> <a id="13548" class="Symbol">→</a> <a id="13550" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="13554" href="lagda.2023-11-21-nbe.html#13537" class="Bound">Δ</a> <a id="13556" href="lagda.2023-11-21-nbe.html#13535" class="Bound">Γ</a> <a id="13558" class="Symbol">→</a> <a id="13560" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="13564" href="lagda.2023-11-21-nbe.html#13539" class="Bound">Σ</a> <a id="13566" href="lagda.2023-11-21-nbe.html#13537" class="Bound">Δ</a> <a id="13568" class="Symbol">→</a> <a id="13570" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="13574" href="lagda.2023-11-21-nbe.html#13539" class="Bound">Σ</a> <a id="13576" href="lagda.2023-11-21-nbe.html#13535" class="Bound">Γ</a>
<a id="13578" href="lagda.2023-11-21-nbe.html#13578" class="Bound">ρ</a> <a id="13580" href="lagda.2023-11-21-nbe.html#13525" class="Function Operator">∘ʳ</a> <a id="13583" href="lagda.2023-11-21-nbe.html#13583" class="Bound">ω</a> <a id="13585" class="Symbol">=</a> <a id="13587" class="Symbol">λ</a> <a id="13589" href="lagda.2023-11-21-nbe.html#13589" class="Bound">x</a> <a id="13591" class="Symbol">→</a> <a id="13593" href="lagda.2023-11-21-nbe.html#13583" class="Bound">ω</a> <a id="13595" class="Symbol">(</a><a id="13596" href="lagda.2023-11-21-nbe.html#13578" class="Bound">ρ</a> <a id="13598" href="lagda.2023-11-21-nbe.html#13589" class="Bound">x</a><a id="13599" class="Symbol">)</a>
</pre>
<!---
<pre class="Agda"><a id="13620" class="Keyword">infixr</a> <a id="13627" class="Number">9</a> <a id="13629" href="lagda.2023-11-21-nbe.html#13525" class="Function Operator">_∘ʳ_</a>
</pre>--->
<p>It is possible to define a renaming for a context <code>Γ′</code> using a context <code>Γ</code> that
it extends by composing many shifting renamings, ending finally at the identity
renaming.</p>
<pre class="Agda"><a id="ρ-≤"></a><a id="13819" href="lagda.2023-11-21-nbe.html#13819" class="Function">ρ-≤</a> <a id="13823" class="Symbol">:</a> <a id="13825" class="Symbol">∀</a> <a id="13827" class="Symbol">{</a><a id="13828" href="lagda.2023-11-21-nbe.html#13828" class="Bound">Γ′</a> <a id="13831" href="lagda.2023-11-21-nbe.html#13831" class="Bound">Γ</a> <a id="13833" class="Symbol">:</a> <a id="13835" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="13838" class="Symbol">}</a> <a id="13840" class="Symbol">→</a> <a id="13842" href="lagda.2023-11-21-nbe.html#13828" class="Bound">Γ′</a> <a id="13845" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="13847" href="lagda.2023-11-21-nbe.html#13831" class="Bound">Γ</a> <a id="13849" class="Symbol">→</a> <a id="13851" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="13855" href="lagda.2023-11-21-nbe.html#13828" class="Bound">Γ′</a> <a id="13858" href="lagda.2023-11-21-nbe.html#13831" class="Bound">Γ</a>
<a id="13860" href="lagda.2023-11-21-nbe.html#13819" class="Function">ρ-≤</a> <a id="13864" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a>       <a id="13875" class="Symbol">=</a> <a id="13877" href="lagda.2023-11-21-nbe.html#13191" class="Function">idʳ</a>
<a id="13881" href="lagda.2023-11-21-nbe.html#13819" class="Function">ρ-≤</a> <a id="13885" class="Symbol">(</a><a id="13886" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="13892" href="lagda.2023-11-21-nbe.html#13892" class="Bound">pf</a><a id="13894" class="Symbol">)</a> <a id="13896" class="Symbol">=</a> <a id="13898" href="lagda.2023-11-21-nbe.html#13819" class="Function">ρ-≤</a> <a id="13902" href="lagda.2023-11-21-nbe.html#13892" class="Bound">pf</a> <a id="13905" href="lagda.2023-11-21-nbe.html#13525" class="Function Operator">∘ʳ</a> <a id="13908" href="lagda.2023-11-21-nbe.html#13230" class="Function">↥ʳ</a>
</pre>
<p>The application of a renaming substituion <code>Γ ⊢ ρ : Δ</code> to a term <code>Δ ⊢ t : T</code>
rebases the term to the context <code>Γ</code>. This is done by “distributing” the
renaming substitution across all subterms of the term, renaming all variables
used in the term with their corresponding variable in <code>Γ</code>. When going under a
binder, the renaming substitution has to be “extended” (<code>ext</code>) to now use the
newly bound variable <code>𝑍</code>.</p>
<pre class="Agda"><a id="ext"></a><a id="14333" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="14337" class="Symbol">:</a> <a id="14339" class="Symbol">∀</a> <a id="14341" class="Symbol">{</a><a id="14342" href="lagda.2023-11-21-nbe.html#14342" class="Bound">Γ</a> <a id="14344" href="lagda.2023-11-21-nbe.html#14344" class="Bound">Δ</a> <a id="14346" class="Symbol">:</a> <a id="14348" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="14351" class="Symbol">}</a> <a id="14353" class="Symbol">→</a> <a id="14355" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="14359" href="lagda.2023-11-21-nbe.html#14342" class="Bound">Γ</a> <a id="14361" href="lagda.2023-11-21-nbe.html#14344" class="Bound">Δ</a> <a id="14363" class="Symbol">→</a> <a id="14365" class="Symbol">∀</a> <a id="14367" class="Symbol">{</a><a id="14368" href="lagda.2023-11-21-nbe.html#14368" class="Bound">T</a> <a id="14370" class="Symbol">:</a> <a id="14372" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="14376" class="Symbol">}</a> <a id="14378" class="Symbol">→</a> <a id="14380" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="14384" class="Symbol">(</a><a id="14385" href="lagda.2023-11-21-nbe.html#14342" class="Bound">Γ</a> <a id="14387" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="14389" href="lagda.2023-11-21-nbe.html#14368" class="Bound">T</a><a id="14390" class="Symbol">)</a> <a id="14392" class="Symbol">(</a><a id="14393" href="lagda.2023-11-21-nbe.html#14344" class="Bound">Δ</a> <a id="14395" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="14397" href="lagda.2023-11-21-nbe.html#14368" class="Bound">T</a><a id="14398" class="Symbol">)</a>
<a id="14400" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="14404" href="lagda.2023-11-21-nbe.html#14404" class="Bound">ρ</a> <a id="14406" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>     <a id="14412" class="Symbol">=</a> <a id="14414" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>
<a id="14416" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="14420" href="lagda.2023-11-21-nbe.html#14420" class="Bound">ρ</a> <a id="14422" class="Symbol">(</a><a id="14423" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="14425" href="lagda.2023-11-21-nbe.html#14425" class="Bound">x</a><a id="14426" class="Symbol">)</a> <a id="14428" class="Symbol">=</a> <a id="14430" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="14432" href="lagda.2023-11-21-nbe.html#14420" class="Bound">ρ</a> <a id="14434" href="lagda.2023-11-21-nbe.html#14425" class="Bound">x</a>

<a id="_[_]ʳ"></a><a id="14437" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">_[_]ʳ</a> <a id="14443" class="Symbol">:</a> <a id="14445" class="Symbol">∀</a> <a id="14447" class="Symbol">{</a><a id="14448" href="lagda.2023-11-21-nbe.html#14448" class="Bound">Γ</a> <a id="14450" href="lagda.2023-11-21-nbe.html#14450" class="Bound">Δ</a> <a id="14452" class="Symbol">:</a> <a id="14454" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="14457" class="Symbol">}</a> <a id="14459" class="Symbol">{</a><a id="14460" href="lagda.2023-11-21-nbe.html#14460" class="Bound">T</a> <a id="14462" class="Symbol">:</a> <a id="14464" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="14468" class="Symbol">}</a>
      <a id="14476" class="Symbol">→</a> <a id="14478" href="lagda.2023-11-21-nbe.html#14450" class="Bound">Δ</a> <a id="14480" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="14482" href="lagda.2023-11-21-nbe.html#14460" class="Bound">T</a>
      <a id="14490" class="Symbol">→</a> <a id="14492" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="14496" href="lagda.2023-11-21-nbe.html#14448" class="Bound">Γ</a> <a id="14498" href="lagda.2023-11-21-nbe.html#14450" class="Bound">Δ</a>
        <a id="14508" class="Comment">-------</a>
      <a id="14522" class="Symbol">→</a> <a id="14524" href="lagda.2023-11-21-nbe.html#14448" class="Bound">Γ</a> <a id="14526" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="14528" href="lagda.2023-11-21-nbe.html#14460" class="Bound">T</a>
<a id="14530" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a> <a id="14535" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">[</a> <a id="14537" class="Symbol">_</a> <a id="14539" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">]ʳ</a>    <a id="14545" class="Symbol">=</a> <a id="14547" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a>
<a id="14552" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="14554" href="lagda.2023-11-21-nbe.html#14554" class="Bound">x</a> <a id="14556" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">[</a> <a id="14558" href="lagda.2023-11-21-nbe.html#14558" class="Bound">ρ</a> <a id="14560" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">]ʳ</a>     <a id="14567" class="Symbol">=</a> <a id="14569" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="14571" href="lagda.2023-11-21-nbe.html#14558" class="Bound">ρ</a> <a id="14573" href="lagda.2023-11-21-nbe.html#14554" class="Bound">x</a>
<a id="14575" class="Symbol">(</a><a id="14576" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="14578" href="lagda.2023-11-21-nbe.html#14578" class="Bound">t</a><a id="14579" class="Symbol">)</a> <a id="14581" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">[</a> <a id="14583" href="lagda.2023-11-21-nbe.html#14583" class="Bound">ρ</a> <a id="14585" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">]ʳ</a>   <a id="14590" class="Symbol">=</a> <a id="14592" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="14594" href="lagda.2023-11-21-nbe.html#14578" class="Bound">t</a> <a id="14596" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">[</a> <a id="14598" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="14602" href="lagda.2023-11-21-nbe.html#14583" class="Bound">ρ</a> <a id="14604" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">]ʳ</a>
<a id="14607" class="Symbol">(</a><a id="14608" href="lagda.2023-11-21-nbe.html#14608" class="Bound">r</a> <a id="14610" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="14612" href="lagda.2023-11-21-nbe.html#14612" class="Bound">s</a><a id="14613" class="Symbol">)</a> <a id="14615" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">[</a> <a id="14617" href="lagda.2023-11-21-nbe.html#14617" class="Bound">ρ</a> <a id="14619" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">]ʳ</a> <a id="14622" class="Symbol">=</a> <a id="14624" href="lagda.2023-11-21-nbe.html#14608" class="Bound">r</a> <a id="14626" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">[</a> <a id="14628" href="lagda.2023-11-21-nbe.html#14617" class="Bound">ρ</a> <a id="14630" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">]ʳ</a> <a id="14633" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="14635" href="lagda.2023-11-21-nbe.html#14612" class="Bound">s</a> <a id="14637" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">[</a> <a id="14639" href="lagda.2023-11-21-nbe.html#14617" class="Bound">ρ</a> <a id="14641" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">]ʳ</a>
</pre>
<!---
<pre class="Agda"><a id="14663" class="Keyword">infix</a> <a id="14669" class="Number">8</a> <a id="14671" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">_[_]ʳ</a>
</pre>--->
<p>With the application of a renaming substitution, it is now possible to define
the application of any general substitution such that it is guaranteed to
terminate. Extending the terms in the substitution under a binder requires
applying a shifting substitution to every term in the binder. By defining
the application of renaming substitutions separately, extending a substitution
can be done such that the overall definition of the application <code>Γ ⊢ t [ σ ]: T</code>
of a substitution <code>Γ ⊢ σ : Δ</code> is guaranteed to be terminating. The definition is
very similar to the more specific application of a renaming substitution, except
variables are now being replcaed with entire terms.</p>
<pre class="Agda"><a id="exts"></a><a id="15372" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="15377" class="Symbol">:</a> <a id="15379" class="Symbol">∀</a> <a id="15381" class="Symbol">{</a><a id="15382" href="lagda.2023-11-21-nbe.html#15382" class="Bound">Γ</a> <a id="15384" href="lagda.2023-11-21-nbe.html#15384" class="Bound">Δ</a> <a id="15386" class="Symbol">:</a> <a id="15388" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="15391" class="Symbol">}</a> <a id="15393" class="Symbol">→</a> <a id="15395" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="15399" href="lagda.2023-11-21-nbe.html#15382" class="Bound">Γ</a> <a id="15401" href="lagda.2023-11-21-nbe.html#15384" class="Bound">Δ</a> <a id="15403" class="Symbol">→</a> <a id="15405" class="Symbol">∀</a> <a id="15407" class="Symbol">{</a><a id="15408" href="lagda.2023-11-21-nbe.html#15408" class="Bound">T</a> <a id="15410" class="Symbol">:</a> <a id="15412" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="15416" class="Symbol">}</a> <a id="15418" class="Symbol">→</a> <a id="15420" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="15424" class="Symbol">(</a><a id="15425" href="lagda.2023-11-21-nbe.html#15382" class="Bound">Γ</a> <a id="15427" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="15429" href="lagda.2023-11-21-nbe.html#15408" class="Bound">T</a><a id="15430" class="Symbol">)</a> <a id="15432" class="Symbol">(</a><a id="15433" href="lagda.2023-11-21-nbe.html#15384" class="Bound">Δ</a> <a id="15435" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="15437" href="lagda.2023-11-21-nbe.html#15408" class="Bound">T</a><a id="15438" class="Symbol">)</a>
<a id="15440" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="15445" href="lagda.2023-11-21-nbe.html#15445" class="Bound">σ</a> <a id="15447" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>     <a id="15453" class="Symbol">=</a> <a id="15455" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="15457" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>
<a id="15459" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="15464" href="lagda.2023-11-21-nbe.html#15464" class="Bound">σ</a> <a id="15466" class="Symbol">(</a><a id="15467" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="15469" href="lagda.2023-11-21-nbe.html#15469" class="Bound">x</a><a id="15470" class="Symbol">)</a> <a id="15472" class="Symbol">=</a> <a id="15474" class="Symbol">(</a><a id="15475" href="lagda.2023-11-21-nbe.html#15464" class="Bound">σ</a> <a id="15477" href="lagda.2023-11-21-nbe.html#15469" class="Bound">x</a><a id="15478" class="Symbol">)</a> <a id="15480" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">[</a> <a id="15482" href="lagda.2023-11-21-nbe.html#13230" class="Function">↥ʳ</a> <a id="15485" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">]ʳ</a>

<a id="_[_]"></a><a id="15489" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">_[_]</a> <a id="15494" class="Symbol">:</a> <a id="15496" class="Symbol">∀</a> <a id="15498" class="Symbol">{</a><a id="15499" href="lagda.2023-11-21-nbe.html#15499" class="Bound">Γ</a> <a id="15501" href="lagda.2023-11-21-nbe.html#15501" class="Bound">Δ</a> <a id="15503" class="Symbol">:</a> <a id="15505" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="15508" class="Symbol">}</a> <a id="15510" class="Symbol">{</a><a id="15511" href="lagda.2023-11-21-nbe.html#15511" class="Bound">T</a> <a id="15513" class="Symbol">:</a> <a id="15515" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="15519" class="Symbol">}</a>
     <a id="15526" class="Symbol">→</a> <a id="15528" href="lagda.2023-11-21-nbe.html#15501" class="Bound">Δ</a> <a id="15530" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="15532" href="lagda.2023-11-21-nbe.html#15511" class="Bound">T</a>
     <a id="15539" class="Symbol">→</a> <a id="15541" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="15545" href="lagda.2023-11-21-nbe.html#15499" class="Bound">Γ</a> <a id="15547" href="lagda.2023-11-21-nbe.html#15501" class="Bound">Δ</a>
       <a id="15556" class="Comment">-------</a>
     <a id="15569" class="Symbol">→</a> <a id="15571" href="lagda.2023-11-21-nbe.html#15499" class="Bound">Γ</a> <a id="15573" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="15575" href="lagda.2023-11-21-nbe.html#15511" class="Bound">T</a>
<a id="15577" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a> <a id="15582" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="15584" class="Symbol">_</a> <a id="15586" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a>    <a id="15591" class="Symbol">=</a> <a id="15593" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a>
<a id="15598" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="15600" href="lagda.2023-11-21-nbe.html#15600" class="Bound">x</a> <a id="15602" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="15604" href="lagda.2023-11-21-nbe.html#15604" class="Bound">σ</a> <a id="15606" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a>     <a id="15612" class="Symbol">=</a> <a id="15614" href="lagda.2023-11-21-nbe.html#15604" class="Bound">σ</a> <a id="15616" href="lagda.2023-11-21-nbe.html#15600" class="Bound">x</a>
<a id="15618" class="Symbol">(</a><a id="15619" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="15621" href="lagda.2023-11-21-nbe.html#15621" class="Bound">t</a><a id="15622" class="Symbol">)</a> <a id="15624" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="15626" href="lagda.2023-11-21-nbe.html#15626" class="Bound">σ</a> <a id="15628" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a>   <a id="15632" class="Symbol">=</a> <a id="15634" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="15636" href="lagda.2023-11-21-nbe.html#15621" class="Bound">t</a> <a id="15638" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="15640" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="15645" href="lagda.2023-11-21-nbe.html#15626" class="Bound">σ</a> <a id="15647" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a>
<a id="15649" class="Symbol">(</a><a id="15650" href="lagda.2023-11-21-nbe.html#15650" class="Bound">r</a> <a id="15652" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="15654" href="lagda.2023-11-21-nbe.html#15654" class="Bound">s</a><a id="15655" class="Symbol">)</a> <a id="15657" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="15659" href="lagda.2023-11-21-nbe.html#15659" class="Bound">σ</a> <a id="15661" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a> <a id="15663" class="Symbol">=</a> <a id="15665" href="lagda.2023-11-21-nbe.html#15650" class="Bound">r</a> <a id="15667" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="15669" href="lagda.2023-11-21-nbe.html#15659" class="Bound">σ</a> <a id="15671" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a> <a id="15673" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="15675" href="lagda.2023-11-21-nbe.html#15654" class="Bound">s</a> <a id="15677" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="15679" href="lagda.2023-11-21-nbe.html#15659" class="Bound">σ</a> <a id="15681" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a>
</pre>
<!---
<pre class="Agda"><a id="15698" class="Keyword">infix</a> <a id="15704" class="Number">8</a> <a id="15706" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">_[_]</a>
</pre>--->
<p>The more general identity and shifting substitutions are defined exactly as they
were for renamings, except now the variable term is used. Parallel substitutions
can also be composed, by applying a substitution <code>Γ ⊢ τ : Δ</code> to every term in a
substitution <code>Δ ⊢ σ : Σ</code>.</p>
<pre class="Agda"><a id="id"></a><a id="15998" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="16001" class="Symbol">:</a> <a id="16003" class="Symbol">∀</a> <a id="16005" class="Symbol">{</a><a id="16006" href="lagda.2023-11-21-nbe.html#16006" class="Bound">Γ</a> <a id="16008" class="Symbol">:</a> <a id="16010" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="16013" class="Symbol">}</a> <a id="16015" class="Symbol">→</a> <a id="16017" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="16021" href="lagda.2023-11-21-nbe.html#16006" class="Bound">Γ</a> <a id="16023" href="lagda.2023-11-21-nbe.html#16006" class="Bound">Γ</a>
<a id="16025" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="16028" href="lagda.2023-11-21-nbe.html#16028" class="Bound">x</a> <a id="16030" class="Symbol">=</a> <a id="16032" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="16034" href="lagda.2023-11-21-nbe.html#16028" class="Bound">x</a>

<a id="↥"></a><a id="16037" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a> <a id="16039" class="Symbol">:</a> <a id="16041" class="Symbol">∀</a> <a id="16043" class="Symbol">{</a><a id="16044" href="lagda.2023-11-21-nbe.html#16044" class="Bound">Γ</a> <a id="16046" class="Symbol">:</a> <a id="16048" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="16051" class="Symbol">}</a> <a id="16053" class="Symbol">{</a><a id="16054" href="lagda.2023-11-21-nbe.html#16054" class="Bound">T</a> <a id="16056" class="Symbol">:</a> <a id="16058" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="16062" class="Symbol">}</a> <a id="16064" class="Symbol">→</a> <a id="16066" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="16070" class="Symbol">(</a><a id="16071" href="lagda.2023-11-21-nbe.html#16044" class="Bound">Γ</a> <a id="16073" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="16075" href="lagda.2023-11-21-nbe.html#16054" class="Bound">T</a><a id="16076" class="Symbol">)</a> <a id="16078" href="lagda.2023-11-21-nbe.html#16044" class="Bound">Γ</a>
<a id="16080" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a> <a id="16082" href="lagda.2023-11-21-nbe.html#16082" class="Bound">x</a> <a id="16084" class="Symbol">=</a> <a id="16086" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="16088" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="16090" href="lagda.2023-11-21-nbe.html#16082" class="Bound">x</a>

<a id="_∘_"></a><a id="16093" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">_∘_</a> <a id="16097" class="Symbol">:</a> <a id="16099" class="Symbol">∀</a> <a id="16101" class="Symbol">{</a><a id="16102" href="lagda.2023-11-21-nbe.html#16102" class="Bound">Γ</a> <a id="16104" href="lagda.2023-11-21-nbe.html#16104" class="Bound">Δ</a> <a id="16106" href="lagda.2023-11-21-nbe.html#16106" class="Bound">Σ</a> <a id="16108" class="Symbol">:</a> <a id="16110" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="16113" class="Symbol">}</a> <a id="16115" class="Symbol">→</a> <a id="16117" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="16121" href="lagda.2023-11-21-nbe.html#16104" class="Bound">Δ</a> <a id="16123" href="lagda.2023-11-21-nbe.html#16102" class="Bound">Γ</a> <a id="16125" class="Symbol">→</a> <a id="16127" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="16131" href="lagda.2023-11-21-nbe.html#16106" class="Bound">Σ</a> <a id="16133" href="lagda.2023-11-21-nbe.html#16104" class="Bound">Δ</a> <a id="16135" class="Symbol">→</a> <a id="16137" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="16141" href="lagda.2023-11-21-nbe.html#16106" class="Bound">Σ</a> <a id="16143" href="lagda.2023-11-21-nbe.html#16102" class="Bound">Γ</a>
<a id="16145" class="Symbol">(</a><a id="16146" href="lagda.2023-11-21-nbe.html#16146" class="Bound">σ</a> <a id="16148" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="16150" href="lagda.2023-11-21-nbe.html#16150" class="Bound">τ</a><a id="16151" class="Symbol">)</a> <a id="16153" href="lagda.2023-11-21-nbe.html#16153" class="Bound">x</a> <a id="16155" class="Symbol">=</a> <a id="16157" class="Symbol">(</a><a id="16158" href="lagda.2023-11-21-nbe.html#16146" class="Bound">σ</a> <a id="16160" href="lagda.2023-11-21-nbe.html#16153" class="Bound">x</a><a id="16161" class="Symbol">)</a> <a id="16163" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="16165" href="lagda.2023-11-21-nbe.html#16150" class="Bound">τ</a> <a id="16167" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a>
</pre>
<p>Any substitution <code>Γ ⊢ σ : Δ</code> can be have a well-typed term <code>Γ ⊢ s : S</code> added to
it as well, which will be written as <code>Γ ⊢ σ ∷ s : Δ, x:S</code> (with <code>∷</code> used for
“cons”). This operation is similar to the extension <code>exts</code> of a substitution,
except that terms in the substitution do not need to be shifted (and in fact,
<code>exts σ</code> is equivalent to <code>(σ ∘ ↥) ∷ # 𝑍</code>).</p>
<pre class="Agda"><a id="_∷_"></a><a id="16540" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">_∷_</a> <a id="16544" class="Symbol">:</a> <a id="16546" class="Symbol">∀</a> <a id="16548" class="Symbol">{</a><a id="16549" href="lagda.2023-11-21-nbe.html#16549" class="Bound">Γ</a> <a id="16551" href="lagda.2023-11-21-nbe.html#16551" class="Bound">Δ</a> <a id="16553" class="Symbol">:</a> <a id="16555" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="16558" class="Symbol">}</a> <a id="16560" class="Symbol">{</a><a id="16561" href="lagda.2023-11-21-nbe.html#16561" class="Bound">S</a> <a id="16563" class="Symbol">:</a> <a id="16565" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="16569" class="Symbol">}</a> <a id="16571" class="Symbol">→</a> <a id="16573" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="16577" href="lagda.2023-11-21-nbe.html#16549" class="Bound">Γ</a> <a id="16579" href="lagda.2023-11-21-nbe.html#16551" class="Bound">Δ</a> <a id="16581" class="Symbol">→</a> <a id="16583" href="lagda.2023-11-21-nbe.html#16549" class="Bound">Γ</a> <a id="16585" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="16587" href="lagda.2023-11-21-nbe.html#16561" class="Bound">S</a> <a id="16589" class="Symbol">→</a> <a id="16591" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="16595" href="lagda.2023-11-21-nbe.html#16549" class="Bound">Γ</a> <a id="16597" class="Symbol">(</a><a id="16598" href="lagda.2023-11-21-nbe.html#16551" class="Bound">Δ</a> <a id="16600" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="16602" href="lagda.2023-11-21-nbe.html#16561" class="Bound">S</a><a id="16603" class="Symbol">)</a>
<a id="16605" class="Symbol">(_</a> <a id="16608" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="16610" href="lagda.2023-11-21-nbe.html#16610" class="Bound">s</a><a id="16611" class="Symbol">)</a> <a id="16613" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>     <a id="16619" class="Symbol">=</a> <a id="16621" href="lagda.2023-11-21-nbe.html#16610" class="Bound">s</a>
<a id="16623" class="Symbol">(</a><a id="16624" href="lagda.2023-11-21-nbe.html#16624" class="Bound">σ</a> <a id="16626" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="16628" class="Symbol">_)</a> <a id="16631" class="Symbol">(</a><a id="16632" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="16634" href="lagda.2023-11-21-nbe.html#16634" class="Bound">x</a><a id="16635" class="Symbol">)</a> <a id="16637" class="Symbol">=</a> <a id="16639" href="lagda.2023-11-21-nbe.html#16624" class="Bound">σ</a> <a id="16641" href="lagda.2023-11-21-nbe.html#16634" class="Bound">x</a>
</pre>
<!---
<pre class="Agda"><a id="16662" class="Keyword">infix</a> <a id="16668" class="Number">8</a> <a id="16670" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">_∷_</a>
<a id="16674" class="Keyword">infixr</a> <a id="16681" class="Number">9</a> <a id="16683" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">_∘_</a>
</pre>--->
<p>Using the renaming substitution for context extension, any well-typed term in
<code>Γ</code> can be “weakened” to a well-typed term in a context <code>Γ′</code>. <code>≤⊢</code> will be used
as shorthand for the application of a weakening substitution (and in Agda, this
will look a lot like an extended judgement: <code>Γ′≤Γ ≤⊢ t</code>).</p>
<pre class="Agda"><a id="weaken"></a><a id="17002" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="17009" class="Symbol">:</a> <a id="17011" class="Symbol">∀</a> <a id="17013" class="Symbol">{</a><a id="17014" href="lagda.2023-11-21-nbe.html#17014" class="Bound">Γ′</a> <a id="17017" href="lagda.2023-11-21-nbe.html#17017" class="Bound">Γ</a> <a id="17019" class="Symbol">:</a> <a id="17021" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="17024" class="Symbol">}</a>
       <a id="17033" class="Symbol">→</a> <a id="17035" href="lagda.2023-11-21-nbe.html#17014" class="Bound">Γ′</a> <a id="17038" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="17040" href="lagda.2023-11-21-nbe.html#17017" class="Bound">Γ</a>
         <a id="17051" class="Comment">--------</a>
       <a id="17067" class="Symbol">→</a> <a id="17069" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="17073" href="lagda.2023-11-21-nbe.html#17014" class="Bound">Γ′</a> <a id="17076" href="lagda.2023-11-21-nbe.html#17017" class="Bound">Γ</a>
<a id="17078" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="17085" href="lagda.2023-11-21-nbe.html#17085" class="Bound">pf</a> <a id="17088" href="lagda.2023-11-21-nbe.html#17088" class="Bound">x</a> <a id="17090" class="Symbol">=</a> <a id="17092" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="17094" href="lagda.2023-11-21-nbe.html#13819" class="Function">ρ-≤</a> <a id="17098" href="lagda.2023-11-21-nbe.html#17085" class="Bound">pf</a> <a id="17101" href="lagda.2023-11-21-nbe.html#17088" class="Bound">x</a>

<a id="_≤⊢_"></a><a id="17104" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">_≤⊢_</a> <a id="17109" class="Symbol">:</a> <a id="17111" class="Symbol">∀</a> <a id="17113" class="Symbol">{</a><a id="17114" href="lagda.2023-11-21-nbe.html#17114" class="Bound">Γ′</a> <a id="17117" href="lagda.2023-11-21-nbe.html#17117" class="Bound">Γ</a> <a id="17119" class="Symbol">:</a> <a id="17121" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="17124" class="Symbol">}</a> <a id="17126" class="Symbol">{</a><a id="17127" href="lagda.2023-11-21-nbe.html#17127" class="Bound">T</a> <a id="17129" class="Symbol">:</a> <a id="17131" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="17135" class="Symbol">}</a> <a id="17137" class="Symbol">→</a> <a id="17139" href="lagda.2023-11-21-nbe.html#17114" class="Bound">Γ′</a> <a id="17142" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="17144" href="lagda.2023-11-21-nbe.html#17117" class="Bound">Γ</a> <a id="17146" class="Symbol">→</a> <a id="17148" href="lagda.2023-11-21-nbe.html#17117" class="Bound">Γ</a> <a id="17150" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="17152" href="lagda.2023-11-21-nbe.html#17127" class="Bound">T</a> <a id="17154" class="Symbol">→</a> <a id="17156" href="lagda.2023-11-21-nbe.html#17114" class="Bound">Γ′</a> <a id="17159" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="17161" href="lagda.2023-11-21-nbe.html#17127" class="Bound">T</a>
<a id="17163" href="lagda.2023-11-21-nbe.html#17163" class="Bound">pf</a> <a id="17166" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="17169" href="lagda.2023-11-21-nbe.html#17169" class="Bound">t</a> <a id="17171" class="Symbol">=</a> <a id="17173" href="lagda.2023-11-21-nbe.html#17169" class="Bound">t</a> <a id="17175" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="17177" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="17184" href="lagda.2023-11-21-nbe.html#17163" class="Bound">pf</a> <a id="17187" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a>
</pre>
<p>It will similarly be useful to introduce shorthand for the application of a
shifting substitution:</p>
<pre class="Agda"><a id="_↥⊢_"></a><a id="17302" href="lagda.2023-11-21-nbe.html#17302" class="Function Operator">_↥⊢_</a> <a id="17307" class="Symbol">:</a> <a id="17309" class="Symbol">∀</a> <a id="17311" class="Symbol">{</a><a id="17312" href="lagda.2023-11-21-nbe.html#17312" class="Bound">Γ</a> <a id="17314" class="Symbol">:</a> <a id="17316" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="17319" class="Symbol">}</a> <a id="17321" class="Symbol">{</a><a id="17322" href="lagda.2023-11-21-nbe.html#17322" class="Bound">T</a> <a id="17324" class="Symbol">:</a> <a id="17326" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="17330" class="Symbol">}</a> <a id="17332" class="Symbol">→</a> <a id="17334" class="Symbol">(</a><a id="17335" href="lagda.2023-11-21-nbe.html#17335" class="Bound">S</a> <a id="17337" class="Symbol">:</a> <a id="17339" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="17343" class="Symbol">)</a> <a id="17345" class="Symbol">→</a> <a id="17347" href="lagda.2023-11-21-nbe.html#17312" class="Bound">Γ</a> <a id="17349" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="17351" href="lagda.2023-11-21-nbe.html#17322" class="Bound">T</a> <a id="17353" class="Symbol">→</a> <a id="17355" href="lagda.2023-11-21-nbe.html#17312" class="Bound">Γ</a> <a id="17357" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="17359" href="lagda.2023-11-21-nbe.html#17335" class="Bound">S</a> <a id="17361" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="17363" href="lagda.2023-11-21-nbe.html#17322" class="Bound">T</a>
<a id="17365" class="Symbol">_</a> <a id="17367" href="lagda.2023-11-21-nbe.html#17302" class="Function Operator">↥⊢</a> <a id="17370" href="lagda.2023-11-21-nbe.html#17370" class="Bound">t</a> <a id="17372" class="Symbol">=</a> <a id="17374" href="lagda.2023-11-21-nbe.html#17370" class="Bound">t</a> <a id="17376" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="17378" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a> <a id="17380" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a>
</pre>
<!---
<pre class="Agda"><a id="17397" class="Keyword">infixr</a> <a id="17404" class="Number">5</a> <a id="17406" href="lagda.2023-11-21-nbe.html#17302" class="Function Operator">_↥⊢_</a>
<a id="17411" class="Keyword">infixr</a> <a id="17418" class="Number">5</a> <a id="17420" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">_≤⊢_</a>
</pre>--->
<p>To actually prove results about terms, a number of substitution lemmas will be
necessary. Their proofs are omitted, though they are directly inspired from the
<a href="https://plfa.github.io/20.07/Substitution/">Substitution</a> chapter of PLFA. The
most import ones are <code>sub-sub</code> (substitutions can be composed) and
<code>[id]-identity</code> (the application of the identity substitution is an identity).</p>
<!---
<pre class="Agda"><a id="sub-tail"></a><a id="17835" href="lagda.2023-11-21-nbe.html#17835" class="Function">sub-tail</a> <a id="17844" class="Symbol">:</a> <a id="17846" class="Symbol">∀</a> <a id="17848" class="Symbol">{</a><a id="17849" href="lagda.2023-11-21-nbe.html#17849" class="Bound">Γ</a> <a id="17851" href="lagda.2023-11-21-nbe.html#17851" class="Bound">Δ</a> <a id="17853" class="Symbol">:</a> <a id="17855" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="17858" class="Symbol">}</a> <a id="17860" class="Symbol">{</a><a id="17861" href="lagda.2023-11-21-nbe.html#17861" class="Bound">S</a> <a id="17863" href="lagda.2023-11-21-nbe.html#17863" class="Bound">T</a> <a id="17865" class="Symbol">:</a> <a id="17867" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="17871" class="Symbol">}</a> <a id="17873" class="Symbol">{</a><a id="17874" href="lagda.2023-11-21-nbe.html#17874" class="Bound">s</a> <a id="17876" class="Symbol">:</a> <a id="17878" href="lagda.2023-11-21-nbe.html#17849" class="Bound">Γ</a> <a id="17880" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="17882" href="lagda.2023-11-21-nbe.html#17861" class="Bound">S</a><a id="17883" class="Symbol">}</a> <a id="17885" class="Symbol">{</a><a id="17886" href="lagda.2023-11-21-nbe.html#17886" class="Bound">σ</a> <a id="17888" class="Symbol">:</a> <a id="17890" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="17894" href="lagda.2023-11-21-nbe.html#17849" class="Bound">Γ</a> <a id="17896" href="lagda.2023-11-21-nbe.html#17851" class="Bound">Δ</a><a id="17897" class="Symbol">}</a>
         <a id="17908" class="Symbol">→</a> <a id="17910" class="Symbol">(</a><a id="17911" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a> <a id="17913" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="17915" class="Symbol">(</a><a id="17916" href="lagda.2023-11-21-nbe.html#17886" class="Bound">σ</a> <a id="17918" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="17920" href="lagda.2023-11-21-nbe.html#17874" class="Bound">s</a><a id="17921" class="Symbol">))</a> <a id="17924" class="Symbol">{</a><a id="17925" class="Argument">T</a> <a id="17927" class="Symbol">=</a> <a id="17929" href="lagda.2023-11-21-nbe.html#17863" class="Bound">T</a><a id="17930" class="Symbol">}</a> <a id="17932" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="17934" href="lagda.2023-11-21-nbe.html#17886" class="Bound">σ</a>
<a id="17936" href="lagda.2023-11-21-nbe.html#17835" class="Function">sub-tail</a> <a id="17945" class="Symbol">=</a> <a id="17947" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="sub-dist"></a><a id="17953" href="lagda.2023-11-21-nbe.html#17953" class="Function">sub-dist</a> <a id="17962" class="Symbol">:</a> <a id="17964" class="Symbol">∀</a> <a id="17966" class="Symbol">{</a><a id="17967" href="lagda.2023-11-21-nbe.html#17967" class="Bound">Γ</a> <a id="17969" href="lagda.2023-11-21-nbe.html#17969" class="Bound">Δ</a> <a id="17971" href="lagda.2023-11-21-nbe.html#17971" class="Bound">Σ</a> <a id="17973" class="Symbol">:</a> <a id="17975" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="17978" class="Symbol">}</a> <a id="17980" class="Symbol">{</a><a id="17981" href="lagda.2023-11-21-nbe.html#17981" class="Bound">S</a> <a id="17983" href="lagda.2023-11-21-nbe.html#17983" class="Bound">T</a> <a id="17985" class="Symbol">:</a> <a id="17987" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="17991" class="Symbol">}</a> <a id="17993" class="Symbol">{</a><a id="17994" href="lagda.2023-11-21-nbe.html#17994" class="Bound">τ</a> <a id="17996" class="Symbol">:</a> <a id="17998" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="18002" href="lagda.2023-11-21-nbe.html#17967" class="Bound">Γ</a> <a id="18004" href="lagda.2023-11-21-nbe.html#17969" class="Bound">Δ</a><a id="18005" class="Symbol">}</a> <a id="18007" class="Symbol">{</a><a id="18008" href="lagda.2023-11-21-nbe.html#18008" class="Bound">σ</a> <a id="18010" class="Symbol">:</a> <a id="18012" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="18016" href="lagda.2023-11-21-nbe.html#17969" class="Bound">Δ</a> <a id="18018" href="lagda.2023-11-21-nbe.html#17971" class="Bound">Σ</a><a id="18019" class="Symbol">}</a> <a id="18021" class="Symbol">{</a><a id="18022" href="lagda.2023-11-21-nbe.html#18022" class="Bound">s</a> <a id="18024" class="Symbol">:</a> <a id="18026" href="lagda.2023-11-21-nbe.html#17969" class="Bound">Δ</a> <a id="18028" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="18030" href="lagda.2023-11-21-nbe.html#17981" class="Bound">S</a><a id="18031" class="Symbol">}</a>
         <a id="18042" class="Symbol">→</a> <a id="18044" class="Symbol">(</a><a id="18045" href="lagda.2023-11-21-nbe.html#18008" class="Bound">σ</a> <a id="18047" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="18049" href="lagda.2023-11-21-nbe.html#18022" class="Bound">s</a><a id="18050" class="Symbol">)</a> <a id="18052" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="18054" href="lagda.2023-11-21-nbe.html#17994" class="Bound">τ</a> <a id="18056" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="18058" class="Symbol">(</a><a id="18059" href="lagda.2023-11-21-nbe.html#18008" class="Bound">σ</a> <a id="18061" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="18063" href="lagda.2023-11-21-nbe.html#17994" class="Bound">τ</a> <a id="18065" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="18067" class="Symbol">(</a><a id="18068" href="lagda.2023-11-21-nbe.html#18022" class="Bound">s</a> <a id="18070" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="18072" href="lagda.2023-11-21-nbe.html#17994" class="Bound">τ</a> <a id="18074" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a><a id="18075" class="Symbol">))</a> <a id="18078" class="Symbol">{</a><a id="18079" href="lagda.2023-11-21-nbe.html#17983" class="Bound">T</a><a id="18080" class="Symbol">}</a>
<a id="18082" href="lagda.2023-11-21-nbe.html#17953" class="Function">sub-dist</a> <a id="18091" class="Symbol">{</a><a id="18092" class="Argument">Σ</a> <a id="18094" class="Symbol">=</a> <a id="18096" href="lagda.2023-11-21-nbe.html#18096" class="Bound">Σ</a><a id="18097" class="Symbol">}</a> <a id="18099" class="Symbol">{</a><a id="18100" href="lagda.2023-11-21-nbe.html#18100" class="Bound">S</a><a id="18101" class="Symbol">}</a> <a id="18103" class="Symbol">{</a><a id="18104" href="lagda.2023-11-21-nbe.html#18104" class="Bound">T</a><a id="18105" class="Symbol">}</a> <a id="18107" class="Symbol">{</a><a id="18108" href="lagda.2023-11-21-nbe.html#18108" class="Bound">τ</a><a id="18109" class="Symbol">}</a> <a id="18111" class="Symbol">{</a><a id="18112" href="lagda.2023-11-21-nbe.html#18112" class="Bound">σ</a><a id="18113" class="Symbol">}</a> <a id="18115" class="Symbol">{</a><a id="18116" href="lagda.2023-11-21-nbe.html#18116" class="Bound">s</a><a id="18117" class="Symbol">}</a> <a id="18119" class="Symbol">=</a> <a id="18121" href="lagda.2023-11-21-nbe.html#2744" class="Postulate">extensionality</a> <a id="18136" href="lagda.2023-11-21-nbe.html#18150" class="Function">lemma</a> <a id="18142" class="Keyword">where</a>
  <a id="18150" href="lagda.2023-11-21-nbe.html#18150" class="Function">lemma</a> <a id="18156" class="Symbol">:</a> <a id="18158" class="Symbol">∀</a> <a id="18160" class="Symbol">(</a><a id="18161" href="lagda.2023-11-21-nbe.html#18161" class="Bound">x</a> <a id="18163" class="Symbol">:</a> <a id="18165" href="lagda.2023-11-21-nbe.html#18096" class="Bound">Σ</a> <a id="18167" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="18169" href="lagda.2023-11-21-nbe.html#18100" class="Bound">S</a> <a id="18171" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="18173" href="lagda.2023-11-21-nbe.html#18104" class="Bound">T</a><a id="18174" class="Symbol">)</a> <a id="18176" class="Symbol">→</a> <a id="18178" class="Symbol">((</a><a id="18180" href="lagda.2023-11-21-nbe.html#18112" class="Bound">σ</a> <a id="18182" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="18184" href="lagda.2023-11-21-nbe.html#18116" class="Bound">s</a><a id="18185" class="Symbol">)</a> <a id="18187" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="18189" href="lagda.2023-11-21-nbe.html#18108" class="Bound">τ</a><a id="18190" class="Symbol">)</a> <a id="18192" href="lagda.2023-11-21-nbe.html#18161" class="Bound">x</a> <a id="18194" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="18196" class="Symbol">((</a><a id="18198" href="lagda.2023-11-21-nbe.html#18112" class="Bound">σ</a> <a id="18200" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="18202" href="lagda.2023-11-21-nbe.html#18108" class="Bound">τ</a><a id="18203" class="Symbol">)</a> <a id="18205" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="18207" class="Symbol">(</a><a id="18208" href="lagda.2023-11-21-nbe.html#18116" class="Bound">s</a> <a id="18210" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="18212" href="lagda.2023-11-21-nbe.html#18108" class="Bound">τ</a> <a id="18214" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a><a id="18215" class="Symbol">))</a> <a id="18218" href="lagda.2023-11-21-nbe.html#18161" class="Bound">x</a>
  <a id="18222" href="lagda.2023-11-21-nbe.html#18150" class="Function">lemma</a> <a id="18228" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>     <a id="18234" class="Symbol">=</a> <a id="18236" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="18243" href="lagda.2023-11-21-nbe.html#18150" class="Function">lemma</a> <a id="18249" class="Symbol">(</a><a id="18250" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="18252" href="lagda.2023-11-21-nbe.html#18252" class="Bound">x</a><a id="18253" class="Symbol">)</a> <a id="18255" class="Symbol">=</a> <a id="18257" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="cong-ext"></a><a id="18263" href="lagda.2023-11-21-nbe.html#18263" class="Function">cong-ext</a> <a id="18272" class="Symbol">:</a> <a id="18274" class="Symbol">∀</a> <a id="18276" class="Symbol">{</a><a id="18277" href="lagda.2023-11-21-nbe.html#18277" class="Bound">Γ</a> <a id="18279" href="lagda.2023-11-21-nbe.html#18279" class="Bound">Δ</a> <a id="18281" class="Symbol">:</a> <a id="18283" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="18286" class="Symbol">}</a> <a id="18288" class="Symbol">{</a><a id="18289" href="lagda.2023-11-21-nbe.html#18289" class="Bound">ρ</a> <a id="18291" href="lagda.2023-11-21-nbe.html#18291" class="Bound">ρ′</a> <a id="18294" class="Symbol">:</a> <a id="18296" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="18300" href="lagda.2023-11-21-nbe.html#18277" class="Bound">Γ</a> <a id="18302" href="lagda.2023-11-21-nbe.html#18279" class="Bound">Δ</a><a id="18303" class="Symbol">}</a> <a id="18305" class="Symbol">{</a><a id="18306" href="lagda.2023-11-21-nbe.html#18306" class="Bound">T</a> <a id="18308" class="Symbol">:</a> <a id="18310" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="18314" class="Symbol">}</a>
         <a id="18325" class="Symbol">→</a> <a id="18327" class="Symbol">(∀</a> <a id="18330" class="Symbol">{</a><a id="18331" href="lagda.2023-11-21-nbe.html#18331" class="Bound">S</a> <a id="18333" class="Symbol">:</a> <a id="18335" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="18339" class="Symbol">}</a> <a id="18341" class="Symbol">→</a> <a id="18343" href="lagda.2023-11-21-nbe.html#18289" class="Bound">ρ</a> <a id="18345" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="18347" href="lagda.2023-11-21-nbe.html#18291" class="Bound">ρ′</a> <a id="18350" class="Symbol">{</a><a id="18351" href="lagda.2023-11-21-nbe.html#18331" class="Bound">S</a><a id="18352" class="Symbol">})</a>
         <a id="18364" class="Symbol">→</a> <a id="18366" class="Symbol">∀</a> <a id="18368" class="Symbol">{</a><a id="18369" href="lagda.2023-11-21-nbe.html#18369" class="Bound">S</a> <a id="18371" class="Symbol">:</a> <a id="18373" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="18377" class="Symbol">}</a> <a id="18379" class="Symbol">→</a> <a id="18381" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="18385" href="lagda.2023-11-21-nbe.html#18289" class="Bound">ρ</a> <a id="18387" class="Symbol">{</a><a id="18388" href="lagda.2023-11-21-nbe.html#18306" class="Bound">T</a><a id="18389" class="Symbol">}</a> <a id="18391" class="Symbol">{</a><a id="18392" href="lagda.2023-11-21-nbe.html#18369" class="Bound">S</a><a id="18393" class="Symbol">}</a> <a id="18395" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="18397" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="18401" href="lagda.2023-11-21-nbe.html#18291" class="Bound">ρ′</a>
<a id="18404" href="lagda.2023-11-21-nbe.html#18263" class="Function">cong-ext</a> <a id="18413" class="Symbol">{</a><a id="18414" class="Argument">Δ</a> <a id="18416" class="Symbol">=</a> <a id="18418" href="lagda.2023-11-21-nbe.html#18418" class="Bound">Δ</a><a id="18419" class="Symbol">}</a> <a id="18421" class="Symbol">{</a><a id="18422" href="lagda.2023-11-21-nbe.html#18422" class="Bound">ρ</a><a id="18423" class="Symbol">}</a> <a id="18425" class="Symbol">{</a><a id="18426" href="lagda.2023-11-21-nbe.html#18426" class="Bound">ρ′</a><a id="18428" class="Symbol">}</a> <a id="18430" class="Symbol">{</a><a id="18431" href="lagda.2023-11-21-nbe.html#18431" class="Bound">T</a><a id="18432" class="Symbol">}</a> <a id="18434" href="lagda.2023-11-21-nbe.html#18434" class="Bound">ρ≡ρ′</a> <a id="18439" class="Symbol">{</a><a id="18440" href="lagda.2023-11-21-nbe.html#18440" class="Bound">S</a><a id="18441" class="Symbol">}</a> <a id="18443" class="Symbol">=</a> <a id="18445" href="lagda.2023-11-21-nbe.html#2744" class="Postulate">extensionality</a> <a id="18460" href="lagda.2023-11-21-nbe.html#18474" class="Function">lemma</a> <a id="18466" class="Keyword">where</a>
  <a id="18474" href="lagda.2023-11-21-nbe.html#18474" class="Function">lemma</a> <a id="18480" class="Symbol">:</a> <a id="18482" class="Symbol">∀</a> <a id="18484" class="Symbol">(</a><a id="18485" href="lagda.2023-11-21-nbe.html#18485" class="Bound">x</a> <a id="18487" class="Symbol">:</a> <a id="18489" href="lagda.2023-11-21-nbe.html#18418" class="Bound">Δ</a> <a id="18491" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="18493" href="lagda.2023-11-21-nbe.html#18431" class="Bound">T</a> <a id="18495" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="18497" href="lagda.2023-11-21-nbe.html#18440" class="Bound">S</a><a id="18498" class="Symbol">)</a> <a id="18500" class="Symbol">→</a> <a id="18502" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="18506" href="lagda.2023-11-21-nbe.html#18422" class="Bound">ρ</a> <a id="18508" href="lagda.2023-11-21-nbe.html#18485" class="Bound">x</a> <a id="18510" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="18512" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="18516" href="lagda.2023-11-21-nbe.html#18426" class="Bound">ρ′</a> <a id="18519" href="lagda.2023-11-21-nbe.html#18485" class="Bound">x</a>
  <a id="18523" href="lagda.2023-11-21-nbe.html#18474" class="Function">lemma</a> <a id="18529" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>                      <a id="18552" class="Symbol">=</a> <a id="18554" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="18561" href="lagda.2023-11-21-nbe.html#18474" class="Function">lemma</a> <a id="18567" class="Symbol">(</a><a id="18568" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="18570" href="lagda.2023-11-21-nbe.html#18570" class="Bound">x</a><a id="18571" class="Symbol">)</a> <a id="18573" class="Keyword">rewrite</a> <a id="18581" href="lagda.2023-11-21-nbe.html#18434" class="Bound">ρ≡ρ′</a> <a id="18586" class="Symbol">{</a><a id="18587" href="lagda.2023-11-21-nbe.html#18440" class="Bound">S</a><a id="18588" class="Symbol">}</a> <a id="18590" class="Symbol">=</a> <a id="18592" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="cong-rename"></a><a id="18598" href="lagda.2023-11-21-nbe.html#18598" class="Function">cong-rename</a> <a id="18610" class="Symbol">:</a> <a id="18612" class="Symbol">∀</a> <a id="18614" class="Symbol">{</a><a id="18615" href="lagda.2023-11-21-nbe.html#18615" class="Bound">Γ</a> <a id="18617" href="lagda.2023-11-21-nbe.html#18617" class="Bound">Δ</a> <a id="18619" class="Symbol">:</a> <a id="18621" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="18624" class="Symbol">}</a> <a id="18626" class="Symbol">{</a><a id="18627" href="lagda.2023-11-21-nbe.html#18627" class="Bound">ρ</a> <a id="18629" href="lagda.2023-11-21-nbe.html#18629" class="Bound">ρ′</a> <a id="18632" class="Symbol">:</a> <a id="18634" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="18638" href="lagda.2023-11-21-nbe.html#18615" class="Bound">Γ</a> <a id="18640" href="lagda.2023-11-21-nbe.html#18617" class="Bound">Δ</a><a id="18641" class="Symbol">}</a> <a id="18643" class="Symbol">{</a><a id="18644" href="lagda.2023-11-21-nbe.html#18644" class="Bound">T</a> <a id="18646" class="Symbol">:</a> <a id="18648" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="18652" class="Symbol">}</a> <a id="18654" class="Symbol">{</a><a id="18655" href="lagda.2023-11-21-nbe.html#18655" class="Bound">t</a> <a id="18657" class="Symbol">:</a> <a id="18659" href="lagda.2023-11-21-nbe.html#18617" class="Bound">Δ</a> <a id="18661" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="18663" href="lagda.2023-11-21-nbe.html#18644" class="Bound">T</a><a id="18664" class="Symbol">}</a>
            <a id="18678" class="Symbol">→</a> <a id="18680" class="Symbol">(∀</a> <a id="18683" class="Symbol">{</a><a id="18684" href="lagda.2023-11-21-nbe.html#18684" class="Bound">S</a> <a id="18686" class="Symbol">:</a> <a id="18688" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="18692" class="Symbol">}</a> <a id="18694" class="Symbol">→</a> <a id="18696" href="lagda.2023-11-21-nbe.html#18627" class="Bound">ρ</a> <a id="18698" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="18700" href="lagda.2023-11-21-nbe.html#18629" class="Bound">ρ′</a> <a id="18703" class="Symbol">{</a><a id="18704" href="lagda.2023-11-21-nbe.html#18684" class="Bound">S</a><a id="18705" class="Symbol">})</a>
            <a id="18720" class="Symbol">→</a> <a id="18722" href="lagda.2023-11-21-nbe.html#18655" class="Bound">t</a> <a id="18724" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">[</a> <a id="18726" href="lagda.2023-11-21-nbe.html#18627" class="Bound">ρ</a> <a id="18728" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">]ʳ</a> <a id="18731" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="18733" href="lagda.2023-11-21-nbe.html#18655" class="Bound">t</a> <a id="18735" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">[</a> <a id="18737" href="lagda.2023-11-21-nbe.html#18629" class="Bound">ρ′</a> <a id="18740" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">]ʳ</a>
<a id="18743" href="lagda.2023-11-21-nbe.html#18598" class="Function">cong-rename</a> <a id="18755" class="Symbol">{</a><a id="18756" class="Argument">t</a> <a id="18758" class="Symbol">=</a> <a id="18760" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a><a id="18764" class="Symbol">}</a> <a id="18766" class="Symbol">_</a>                                                <a id="18815" class="Symbol">=</a> <a id="18817" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="18822" href="lagda.2023-11-21-nbe.html#18598" class="Function">cong-rename</a> <a id="18834" class="Symbol">{</a><a id="18835" class="Argument">T</a> <a id="18837" class="Symbol">=</a> <a id="18839" href="lagda.2023-11-21-nbe.html#18839" class="Bound">T</a><a id="18840" class="Symbol">}</a> <a id="18842" class="Symbol">{</a><a id="18843" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="18845" href="lagda.2023-11-21-nbe.html#18845" class="Bound">x</a><a id="18846" class="Symbol">}</a> <a id="18848" href="lagda.2023-11-21-nbe.html#18848" class="Bound">ρ≡ρ′</a> <a id="18853" class="Keyword">rewrite</a> <a id="18861" href="lagda.2023-11-21-nbe.html#18848" class="Bound">ρ≡ρ′</a> <a id="18866" class="Symbol">{</a><a id="18867" href="lagda.2023-11-21-nbe.html#18839" class="Bound">T</a><a id="18868" class="Symbol">}</a>                         <a id="18894" class="Symbol">=</a> <a id="18896" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="18901" href="lagda.2023-11-21-nbe.html#18598" class="Function">cong-rename</a> <a id="18913" class="Symbol">{</a><a id="18914" class="Argument">ρ</a> <a id="18916" class="Symbol">=</a> <a id="18918" href="lagda.2023-11-21-nbe.html#18918" class="Bound">ρ</a><a id="18919" class="Symbol">}</a> <a id="18921" class="Symbol">{</a><a id="18922" href="lagda.2023-11-21-nbe.html#18922" class="Bound">ρ′</a><a id="18924" class="Symbol">}</a> <a id="18926" class="Symbol">{</a><a id="18927" class="Argument">t</a> <a id="18929" class="Symbol">=</a> <a id="18931" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="18933" href="lagda.2023-11-21-nbe.html#18933" class="Bound">t</a><a id="18934" class="Symbol">}</a> <a id="18936" href="lagda.2023-11-21-nbe.html#18936" class="Bound">ρ≡ρ′</a>
  <a id="18943" class="Keyword">rewrite</a> <a id="18951" href="lagda.2023-11-21-nbe.html#18598" class="Function">cong-rename</a> <a id="18963" class="Symbol">{</a><a id="18964" class="Argument">ρ</a> <a id="18966" class="Symbol">=</a> <a id="18968" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="18972" href="lagda.2023-11-21-nbe.html#18918" class="Bound">ρ</a><a id="18973" class="Symbol">}</a> <a id="18975" class="Symbol">{</a><a id="18976" class="Argument">ρ′</a> <a id="18979" class="Symbol">=</a> <a id="18981" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="18985" href="lagda.2023-11-21-nbe.html#18922" class="Bound">ρ′</a><a id="18987" class="Symbol">}</a> <a id="18989" class="Symbol">{</a><a id="18990" class="Argument">t</a> <a id="18992" class="Symbol">=</a> <a id="18994" href="lagda.2023-11-21-nbe.html#18933" class="Bound">t</a><a id="18995" class="Symbol">}</a> <a id="18997" class="Symbol">(</a><a id="18998" href="lagda.2023-11-21-nbe.html#18263" class="Function">cong-ext</a> <a id="19007" href="lagda.2023-11-21-nbe.html#18936" class="Bound">ρ≡ρ′</a><a id="19011" class="Symbol">)</a> <a id="19013" class="Symbol">=</a> <a id="19015" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="19020" href="lagda.2023-11-21-nbe.html#18598" class="Function">cong-rename</a> <a id="19032" class="Symbol">{</a><a id="19033" class="Argument">t</a> <a id="19035" class="Symbol">=</a> <a id="19037" href="lagda.2023-11-21-nbe.html#19037" class="Bound">r</a> <a id="19039" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="19041" href="lagda.2023-11-21-nbe.html#19041" class="Bound">s</a><a id="19042" class="Symbol">}</a> <a id="19044" href="lagda.2023-11-21-nbe.html#19044" class="Bound">ρ≡ρ′</a>
  <a id="19051" class="Keyword">rewrite</a> <a id="19059" href="lagda.2023-11-21-nbe.html#18598" class="Function">cong-rename</a> <a id="19071" class="Symbol">{</a><a id="19072" class="Argument">t</a> <a id="19074" class="Symbol">=</a> <a id="19076" href="lagda.2023-11-21-nbe.html#19037" class="Bound">r</a><a id="19077" class="Symbol">}</a> <a id="19079" href="lagda.2023-11-21-nbe.html#19044" class="Bound">ρ≡ρ′</a> <a id="19084" class="Symbol">|</a> <a id="19086" href="lagda.2023-11-21-nbe.html#18598" class="Function">cong-rename</a> <a id="19098" class="Symbol">{</a><a id="19099" class="Argument">t</a> <a id="19101" class="Symbol">=</a> <a id="19103" href="lagda.2023-11-21-nbe.html#19041" class="Bound">s</a><a id="19104" class="Symbol">}</a> <a id="19106" href="lagda.2023-11-21-nbe.html#19044" class="Bound">ρ≡ρ′</a>           <a id="19121" class="Symbol">=</a> <a id="19123" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="cong-exts"></a><a id="19129" href="lagda.2023-11-21-nbe.html#19129" class="Function">cong-exts</a> <a id="19139" class="Symbol">:</a> <a id="19141" class="Symbol">∀</a> <a id="19143" class="Symbol">{</a><a id="19144" href="lagda.2023-11-21-nbe.html#19144" class="Bound">Γ</a> <a id="19146" href="lagda.2023-11-21-nbe.html#19146" class="Bound">Δ</a> <a id="19148" class="Symbol">:</a> <a id="19150" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="19153" class="Symbol">}</a> <a id="19155" class="Symbol">{</a><a id="19156" href="lagda.2023-11-21-nbe.html#19156" class="Bound">σ</a> <a id="19158" href="lagda.2023-11-21-nbe.html#19158" class="Bound">σ′</a> <a id="19161" class="Symbol">:</a> <a id="19163" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="19167" href="lagda.2023-11-21-nbe.html#19144" class="Bound">Γ</a> <a id="19169" href="lagda.2023-11-21-nbe.html#19146" class="Bound">Δ</a><a id="19170" class="Symbol">}</a> <a id="19172" class="Symbol">{</a><a id="19173" href="lagda.2023-11-21-nbe.html#19173" class="Bound">T</a> <a id="19175" class="Symbol">:</a> <a id="19177" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="19181" class="Symbol">}</a>
          <a id="19193" class="Symbol">→</a> <a id="19195" class="Symbol">(∀</a> <a id="19198" class="Symbol">{</a><a id="19199" href="lagda.2023-11-21-nbe.html#19199" class="Bound">S</a> <a id="19201" class="Symbol">:</a> <a id="19203" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="19207" class="Symbol">}</a> <a id="19209" class="Symbol">→</a> <a id="19211" href="lagda.2023-11-21-nbe.html#19156" class="Bound">σ</a> <a id="19213" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="19215" href="lagda.2023-11-21-nbe.html#19158" class="Bound">σ′</a> <a id="19218" class="Symbol">{</a><a id="19219" href="lagda.2023-11-21-nbe.html#19199" class="Bound">S</a><a id="19220" class="Symbol">})</a>
          <a id="19233" class="Symbol">→</a> <a id="19235" class="Symbol">(∀</a> <a id="19238" class="Symbol">{</a><a id="19239" href="lagda.2023-11-21-nbe.html#19239" class="Bound">S</a> <a id="19241" class="Symbol">:</a> <a id="19243" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="19247" class="Symbol">}</a> <a id="19249" class="Symbol">→</a> <a id="19251" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="19256" href="lagda.2023-11-21-nbe.html#19156" class="Bound">σ</a> <a id="19258" class="Symbol">{</a><a id="19259" href="lagda.2023-11-21-nbe.html#19173" class="Bound">T</a><a id="19260" class="Symbol">}</a> <a id="19262" class="Symbol">{</a><a id="19263" href="lagda.2023-11-21-nbe.html#19239" class="Bound">S</a><a id="19264" class="Symbol">}</a> <a id="19266" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="19268" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="19273" href="lagda.2023-11-21-nbe.html#19158" class="Bound">σ′</a><a id="19275" class="Symbol">)</a>
<a id="19277" href="lagda.2023-11-21-nbe.html#19129" class="Function">cong-exts</a> <a id="19287" class="Symbol">{</a><a id="19288" class="Argument">Δ</a> <a id="19290" class="Symbol">=</a> <a id="19292" href="lagda.2023-11-21-nbe.html#19292" class="Bound">Δ</a><a id="19293" class="Symbol">}</a> <a id="19295" class="Symbol">{</a><a id="19296" href="lagda.2023-11-21-nbe.html#19296" class="Bound">σ</a><a id="19297" class="Symbol">}</a> <a id="19299" class="Symbol">{</a><a id="19300" href="lagda.2023-11-21-nbe.html#19300" class="Bound">σ′</a><a id="19302" class="Symbol">}</a> <a id="19304" class="Symbol">{</a><a id="19305" href="lagda.2023-11-21-nbe.html#19305" class="Bound">T</a><a id="19306" class="Symbol">}</a> <a id="19308" href="lagda.2023-11-21-nbe.html#19308" class="Bound">σ≡σ′</a> <a id="19313" class="Symbol">{</a><a id="19314" href="lagda.2023-11-21-nbe.html#19314" class="Bound">S</a><a id="19315" class="Symbol">}</a> <a id="19317" class="Symbol">=</a> <a id="19319" href="lagda.2023-11-21-nbe.html#2744" class="Postulate">extensionality</a> <a id="19334" href="lagda.2023-11-21-nbe.html#19348" class="Function">lemma</a> <a id="19340" class="Keyword">where</a>
  <a id="19348" href="lagda.2023-11-21-nbe.html#19348" class="Function">lemma</a> <a id="19354" class="Symbol">:</a> <a id="19356" class="Symbol">∀</a> <a id="19358" class="Symbol">(</a><a id="19359" href="lagda.2023-11-21-nbe.html#19359" class="Bound">x</a> <a id="19361" class="Symbol">:</a> <a id="19363" href="lagda.2023-11-21-nbe.html#19292" class="Bound">Δ</a> <a id="19365" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="19367" href="lagda.2023-11-21-nbe.html#19305" class="Bound">T</a> <a id="19369" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="19371" href="lagda.2023-11-21-nbe.html#19314" class="Bound">S</a><a id="19372" class="Symbol">)</a> <a id="19374" class="Symbol">→</a> <a id="19376" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="19381" href="lagda.2023-11-21-nbe.html#19296" class="Bound">σ</a> <a id="19383" href="lagda.2023-11-21-nbe.html#19359" class="Bound">x</a> <a id="19385" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="19387" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="19392" href="lagda.2023-11-21-nbe.html#19300" class="Bound">σ′</a> <a id="19395" href="lagda.2023-11-21-nbe.html#19359" class="Bound">x</a>
  <a id="19399" href="lagda.2023-11-21-nbe.html#19348" class="Function">lemma</a> <a id="19405" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>                      <a id="19428" class="Symbol">=</a> <a id="19430" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="19437" href="lagda.2023-11-21-nbe.html#19348" class="Function">lemma</a> <a id="19443" class="Symbol">(</a><a id="19444" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="19446" href="lagda.2023-11-21-nbe.html#19446" class="Bound">x</a><a id="19447" class="Symbol">)</a> <a id="19449" class="Keyword">rewrite</a> <a id="19457" href="lagda.2023-11-21-nbe.html#19308" class="Bound">σ≡σ′</a> <a id="19462" class="Symbol">{</a><a id="19463" href="lagda.2023-11-21-nbe.html#19314" class="Bound">S</a><a id="19464" class="Symbol">}</a> <a id="19466" class="Symbol">=</a> <a id="19468" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="cong-sub"></a><a id="19474" href="lagda.2023-11-21-nbe.html#19474" class="Function">cong-sub</a> <a id="19483" class="Symbol">:</a> <a id="19485" class="Symbol">∀</a> <a id="19487" class="Symbol">{</a><a id="19488" href="lagda.2023-11-21-nbe.html#19488" class="Bound">Γ</a> <a id="19490" href="lagda.2023-11-21-nbe.html#19490" class="Bound">Δ</a> <a id="19492" class="Symbol">:</a> <a id="19494" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="19497" class="Symbol">}</a> <a id="19499" class="Symbol">{</a><a id="19500" href="lagda.2023-11-21-nbe.html#19500" class="Bound">σ</a> <a id="19502" href="lagda.2023-11-21-nbe.html#19502" class="Bound">σ′</a> <a id="19505" class="Symbol">:</a> <a id="19507" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="19511" href="lagda.2023-11-21-nbe.html#19488" class="Bound">Γ</a> <a id="19513" href="lagda.2023-11-21-nbe.html#19490" class="Bound">Δ</a><a id="19514" class="Symbol">}</a> <a id="19516" class="Symbol">{</a><a id="19517" href="lagda.2023-11-21-nbe.html#19517" class="Bound">T</a> <a id="19519" class="Symbol">:</a> <a id="19521" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="19525" class="Symbol">}</a> <a id="19527" class="Symbol">{</a><a id="19528" href="lagda.2023-11-21-nbe.html#19528" class="Bound">t</a> <a id="19530" href="lagda.2023-11-21-nbe.html#19530" class="Bound">t′</a> <a id="19533" class="Symbol">:</a> <a id="19535" href="lagda.2023-11-21-nbe.html#19490" class="Bound">Δ</a> <a id="19537" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="19539" href="lagda.2023-11-21-nbe.html#19517" class="Bound">T</a><a id="19540" class="Symbol">}</a>
         <a id="19551" class="Symbol">→</a> <a id="19553" class="Symbol">(∀</a> <a id="19556" class="Symbol">{</a><a id="19557" href="lagda.2023-11-21-nbe.html#19557" class="Bound">S</a> <a id="19559" class="Symbol">:</a> <a id="19561" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="19565" class="Symbol">}</a> <a id="19567" class="Symbol">→</a> <a id="19569" href="lagda.2023-11-21-nbe.html#19500" class="Bound">σ</a> <a id="19571" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="19573" href="lagda.2023-11-21-nbe.html#19502" class="Bound">σ′</a> <a id="19576" class="Symbol">{</a><a id="19577" href="lagda.2023-11-21-nbe.html#19557" class="Bound">S</a><a id="19578" class="Symbol">})</a>
         <a id="19590" class="Symbol">→</a> <a id="19592" href="lagda.2023-11-21-nbe.html#19528" class="Bound">t</a> <a id="19594" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="19596" href="lagda.2023-11-21-nbe.html#19530" class="Bound">t′</a>
         <a id="19608" class="Symbol">→</a> <a id="19610" href="lagda.2023-11-21-nbe.html#19528" class="Bound">t</a> <a id="19612" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="19614" href="lagda.2023-11-21-nbe.html#19500" class="Bound">σ</a> <a id="19616" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a> <a id="19618" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="19620" href="lagda.2023-11-21-nbe.html#19530" class="Bound">t′</a> <a id="19623" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="19625" href="lagda.2023-11-21-nbe.html#19502" class="Bound">σ′</a> <a id="19628" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a>
<a id="19630" href="lagda.2023-11-21-nbe.html#19474" class="Function">cong-sub</a> <a id="19639" class="Symbol">{</a><a id="19640" class="Argument">t</a> <a id="19642" class="Symbol">=</a> <a id="19644" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a><a id="19648" class="Symbol">}</a> <a id="19650" class="Symbol">{</a><a id="19651" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a><a id="19655" class="Symbol">}</a> <a id="19657" class="Symbol">_</a> <a id="19659" class="Symbol">_</a>                                          <a id="19702" class="Symbol">=</a> <a id="19704" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="19709" href="lagda.2023-11-21-nbe.html#19474" class="Function">cong-sub</a> <a id="19718" class="Symbol">{</a><a id="19719" class="Argument">T</a> <a id="19721" class="Symbol">=</a> <a id="19723" href="lagda.2023-11-21-nbe.html#19723" class="Bound">T</a><a id="19724" class="Symbol">}</a> <a id="19726" class="Symbol">{</a><a id="19727" class="Argument">t</a> <a id="19729" class="Symbol">=</a> <a id="19731" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="19733" href="lagda.2023-11-21-nbe.html#19733" class="Bound">x</a><a id="19734" class="Symbol">}</a> <a id="19736" href="lagda.2023-11-21-nbe.html#19736" class="Bound">σ≡σ′</a> <a id="19741" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="19746" class="Keyword">rewrite</a> <a id="19754" href="lagda.2023-11-21-nbe.html#19736" class="Bound">σ≡σ′</a> <a id="19759" class="Symbol">{</a><a id="19760" href="lagda.2023-11-21-nbe.html#19723" class="Bound">T</a><a id="19761" class="Symbol">}</a>                   <a id="19781" class="Symbol">=</a> <a id="19783" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="19788" href="lagda.2023-11-21-nbe.html#19474" class="Function">cong-sub</a> <a id="19797" class="Symbol">{</a><a id="19798" class="Argument">σ</a> <a id="19800" class="Symbol">=</a> <a id="19802" href="lagda.2023-11-21-nbe.html#19802" class="Bound">σ</a><a id="19803" class="Symbol">}</a> <a id="19805" class="Symbol">{</a><a id="19806" href="lagda.2023-11-21-nbe.html#19806" class="Bound">σ′</a><a id="19808" class="Symbol">}</a> <a id="19810" class="Symbol">{</a><a id="19811" class="Argument">t</a> <a id="19813" class="Symbol">=</a> <a id="19815" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="19817" href="lagda.2023-11-21-nbe.html#19817" class="Bound">t</a><a id="19818" class="Symbol">}</a> <a id="19820" href="lagda.2023-11-21-nbe.html#19820" class="Bound">σ≡σ′</a> <a id="19825" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="19832" class="Keyword">rewrite</a> <a id="19840" href="lagda.2023-11-21-nbe.html#19474" class="Function">cong-sub</a> <a id="19849" class="Symbol">{</a><a id="19850" class="Argument">σ</a> <a id="19852" class="Symbol">=</a> <a id="19854" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="19859" href="lagda.2023-11-21-nbe.html#19802" class="Bound">σ</a><a id="19860" class="Symbol">}</a> <a id="19862" class="Symbol">{</a><a id="19863" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="19868" href="lagda.2023-11-21-nbe.html#19806" class="Bound">σ′</a><a id="19870" class="Symbol">}</a> <a id="19872" class="Symbol">{</a><a id="19873" class="Argument">t</a> <a id="19875" class="Symbol">=</a> <a id="19877" href="lagda.2023-11-21-nbe.html#19817" class="Bound">t</a><a id="19878" class="Symbol">}</a> <a id="19880" class="Symbol">(</a><a id="19881" href="lagda.2023-11-21-nbe.html#19129" class="Function">cong-exts</a> <a id="19891" href="lagda.2023-11-21-nbe.html#19820" class="Bound">σ≡σ′</a><a id="19895" class="Symbol">)</a> <a id="19897" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="19902" class="Symbol">=</a> <a id="19904" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="19909" href="lagda.2023-11-21-nbe.html#19474" class="Function">cong-sub</a> <a id="19918" class="Symbol">{</a><a id="19919" class="Argument">σ</a> <a id="19921" class="Symbol">=</a> <a id="19923" href="lagda.2023-11-21-nbe.html#19923" class="Bound">σ</a><a id="19924" class="Symbol">}</a> <a id="19926" class="Symbol">{</a><a id="19927" href="lagda.2023-11-21-nbe.html#19927" class="Bound">σ′</a><a id="19929" class="Symbol">}</a> <a id="19931" class="Symbol">{</a><a id="19932" class="Argument">t</a> <a id="19934" class="Symbol">=</a> <a id="19936" href="lagda.2023-11-21-nbe.html#19936" class="Bound">r</a> <a id="19938" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="19940" href="lagda.2023-11-21-nbe.html#19940" class="Bound">s</a><a id="19941" class="Symbol">}</a> <a id="19943" href="lagda.2023-11-21-nbe.html#19943" class="Bound">σ≡σ′</a> <a id="19948" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="19955" class="Keyword">rewrite</a> <a id="19963" href="lagda.2023-11-21-nbe.html#19474" class="Function">cong-sub</a> <a id="19972" class="Symbol">{</a><a id="19973" class="Argument">σ</a> <a id="19975" class="Symbol">=</a> <a id="19977" href="lagda.2023-11-21-nbe.html#19923" class="Bound">σ</a><a id="19978" class="Symbol">}</a> <a id="19980" class="Symbol">{</a><a id="19981" href="lagda.2023-11-21-nbe.html#19927" class="Bound">σ′</a><a id="19983" class="Symbol">}</a> <a id="19985" class="Symbol">{</a><a id="19986" class="Argument">t</a> <a id="19988" class="Symbol">=</a> <a id="19990" href="lagda.2023-11-21-nbe.html#19936" class="Bound">r</a><a id="19991" class="Symbol">}</a> <a id="19993" href="lagda.2023-11-21-nbe.html#19943" class="Bound">σ≡σ′</a> <a id="19998" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
        <a id="20011" class="Symbol">|</a> <a id="20013" href="lagda.2023-11-21-nbe.html#19474" class="Function">cong-sub</a> <a id="20022" class="Symbol">{</a><a id="20023" class="Argument">σ</a> <a id="20025" class="Symbol">=</a> <a id="20027" href="lagda.2023-11-21-nbe.html#19923" class="Bound">σ</a><a id="20028" class="Symbol">}</a> <a id="20030" class="Symbol">{</a><a id="20031" href="lagda.2023-11-21-nbe.html#19927" class="Bound">σ′</a><a id="20033" class="Symbol">}</a> <a id="20035" class="Symbol">{</a><a id="20036" class="Argument">t</a> <a id="20038" class="Symbol">=</a> <a id="20040" href="lagda.2023-11-21-nbe.html#19940" class="Bound">s</a><a id="20041" class="Symbol">}</a> <a id="20043" href="lagda.2023-11-21-nbe.html#19943" class="Bound">σ≡σ′</a> <a id="20048" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>                       <a id="20075" class="Symbol">=</a> <a id="20077" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="cong-cons"></a><a id="20083" href="lagda.2023-11-21-nbe.html#20083" class="Function">cong-cons</a> <a id="20093" class="Symbol">:</a> <a id="20095" class="Symbol">∀</a> <a id="20097" class="Symbol">{</a><a id="20098" href="lagda.2023-11-21-nbe.html#20098" class="Bound">Γ</a> <a id="20100" href="lagda.2023-11-21-nbe.html#20100" class="Bound">Δ</a> <a id="20102" class="Symbol">:</a> <a id="20104" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="20107" class="Symbol">}</a> <a id="20109" class="Symbol">{</a><a id="20110" href="lagda.2023-11-21-nbe.html#20110" class="Bound">S</a> <a id="20112" class="Symbol">:</a> <a id="20114" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="20118" class="Symbol">}</a> <a id="20120" class="Symbol">{</a><a id="20121" href="lagda.2023-11-21-nbe.html#20121" class="Bound">s</a> <a id="20123" href="lagda.2023-11-21-nbe.html#20123" class="Bound">s′</a> <a id="20126" class="Symbol">:</a> <a id="20128" href="lagda.2023-11-21-nbe.html#20098" class="Bound">Γ</a> <a id="20130" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="20132" href="lagda.2023-11-21-nbe.html#20110" class="Bound">S</a><a id="20133" class="Symbol">}</a> <a id="20135" class="Symbol">{</a><a id="20136" href="lagda.2023-11-21-nbe.html#20136" class="Bound">σ</a> <a id="20138" href="lagda.2023-11-21-nbe.html#20138" class="Bound">τ</a> <a id="20140" class="Symbol">:</a> <a id="20142" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="20146" href="lagda.2023-11-21-nbe.html#20098" class="Bound">Γ</a> <a id="20148" href="lagda.2023-11-21-nbe.html#20100" class="Bound">Δ</a><a id="20149" class="Symbol">}</a>
          <a id="20161" class="Symbol">→</a> <a id="20163" href="lagda.2023-11-21-nbe.html#20121" class="Bound">s</a> <a id="20165" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="20167" href="lagda.2023-11-21-nbe.html#20123" class="Bound">s′</a>
          <a id="20180" class="Symbol">→</a> <a id="20182" class="Symbol">(∀</a> <a id="20185" class="Symbol">{</a><a id="20186" href="lagda.2023-11-21-nbe.html#20186" class="Bound">T</a> <a id="20188" class="Symbol">:</a> <a id="20190" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="20194" class="Symbol">}</a> <a id="20196" class="Symbol">→</a> <a id="20198" href="lagda.2023-11-21-nbe.html#20136" class="Bound">σ</a> <a id="20200" class="Symbol">{</a><a id="20201" href="lagda.2023-11-21-nbe.html#20186" class="Bound">T</a><a id="20202" class="Symbol">}</a> <a id="20204" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="20206" href="lagda.2023-11-21-nbe.html#20138" class="Bound">τ</a> <a id="20208" class="Symbol">{</a><a id="20209" href="lagda.2023-11-21-nbe.html#20186" class="Bound">T</a><a id="20210" class="Symbol">})</a>
          <a id="20223" class="Symbol">→</a> <a id="20225" class="Symbol">∀</a> <a id="20227" class="Symbol">{</a><a id="20228" href="lagda.2023-11-21-nbe.html#20228" class="Bound">T</a> <a id="20230" class="Symbol">:</a> <a id="20232" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="20236" class="Symbol">}</a> <a id="20238" class="Symbol">→</a> <a id="20240" href="lagda.2023-11-21-nbe.html#20136" class="Bound">σ</a> <a id="20242" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="20244" href="lagda.2023-11-21-nbe.html#20121" class="Bound">s</a> <a id="20246" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="20248" class="Symbol">(</a><a id="20249" href="lagda.2023-11-21-nbe.html#20138" class="Bound">τ</a> <a id="20251" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="20253" href="lagda.2023-11-21-nbe.html#20123" class="Bound">s′</a><a id="20255" class="Symbol">)</a> <a id="20257" class="Symbol">{</a><a id="20258" href="lagda.2023-11-21-nbe.html#20228" class="Bound">T</a><a id="20259" class="Symbol">}</a>
<a id="20261" href="lagda.2023-11-21-nbe.html#20083" class="Function">cong-cons</a> <a id="20271" class="Symbol">{</a><a id="20272" class="Argument">Δ</a> <a id="20274" class="Symbol">=</a> <a id="20276" href="lagda.2023-11-21-nbe.html#20276" class="Bound">Δ</a><a id="20277" class="Symbol">}</a> <a id="20279" class="Symbol">{</a><a id="20280" href="lagda.2023-11-21-nbe.html#20280" class="Bound">S</a><a id="20281" class="Symbol">}</a> <a id="20283" class="Symbol">{</a><a id="20284" href="lagda.2023-11-21-nbe.html#20284" class="Bound">s</a><a id="20285" class="Symbol">}</a> <a id="20287" class="Symbol">{</a><a id="20288" href="lagda.2023-11-21-nbe.html#20288" class="Bound">s′</a><a id="20290" class="Symbol">}</a> <a id="20292" class="Symbol">{</a><a id="20293" href="lagda.2023-11-21-nbe.html#20293" class="Bound">σ</a><a id="20294" class="Symbol">}</a> <a id="20296" class="Symbol">{</a><a id="20297" href="lagda.2023-11-21-nbe.html#20297" class="Bound">τ</a><a id="20298" class="Symbol">}</a> <a id="20300" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="20305" href="lagda.2023-11-21-nbe.html#20305" class="Bound">σ≡τ</a> <a id="20309" class="Symbol">{</a><a id="20310" href="lagda.2023-11-21-nbe.html#20310" class="Bound">T</a><a id="20311" class="Symbol">}</a> <a id="20313" class="Symbol">=</a> <a id="20315" href="lagda.2023-11-21-nbe.html#2744" class="Postulate">extensionality</a> <a id="20330" href="lagda.2023-11-21-nbe.html#20344" class="Function">lemma</a> <a id="20336" class="Keyword">where</a>
  <a id="20344" href="lagda.2023-11-21-nbe.html#20344" class="Function">lemma</a> <a id="20350" class="Symbol">:</a> <a id="20352" class="Symbol">∀</a> <a id="20354" class="Symbol">(</a><a id="20355" href="lagda.2023-11-21-nbe.html#20355" class="Bound">x</a> <a id="20357" class="Symbol">:</a> <a id="20359" href="lagda.2023-11-21-nbe.html#20276" class="Bound">Δ</a> <a id="20361" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="20363" href="lagda.2023-11-21-nbe.html#20280" class="Bound">S</a> <a id="20365" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="20367" href="lagda.2023-11-21-nbe.html#20310" class="Bound">T</a><a id="20368" class="Symbol">)</a> <a id="20370" class="Symbol">→</a> <a id="20372" class="Symbol">(</a><a id="20373" href="lagda.2023-11-21-nbe.html#20293" class="Bound">σ</a> <a id="20375" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="20377" href="lagda.2023-11-21-nbe.html#20284" class="Bound">s</a><a id="20378" class="Symbol">)</a> <a id="20380" href="lagda.2023-11-21-nbe.html#20355" class="Bound">x</a> <a id="20382" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="20384" class="Symbol">(</a><a id="20385" href="lagda.2023-11-21-nbe.html#20297" class="Bound">τ</a> <a id="20387" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="20389" href="lagda.2023-11-21-nbe.html#20288" class="Bound">s′</a><a id="20391" class="Symbol">)</a> <a id="20393" href="lagda.2023-11-21-nbe.html#20355" class="Bound">x</a>
  <a id="20397" href="lagda.2023-11-21-nbe.html#20344" class="Function">lemma</a> <a id="20403" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>                     <a id="20425" class="Symbol">=</a> <a id="20427" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="20434" href="lagda.2023-11-21-nbe.html#20344" class="Function">lemma</a> <a id="20440" class="Symbol">(</a><a id="20441" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="20443" href="lagda.2023-11-21-nbe.html#20443" class="Bound">x</a><a id="20444" class="Symbol">)</a> <a id="20446" class="Keyword">rewrite</a> <a id="20454" href="lagda.2023-11-21-nbe.html#20305" class="Bound">σ≡τ</a> <a id="20458" class="Symbol">{</a><a id="20459" href="lagda.2023-11-21-nbe.html#20310" class="Bound">T</a><a id="20460" class="Symbol">}</a> <a id="20462" class="Symbol">=</a> <a id="20464" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="cong-seq"></a><a id="20470" href="lagda.2023-11-21-nbe.html#20470" class="Function">cong-seq</a> <a id="20479" class="Symbol">:</a> <a id="20481" class="Symbol">∀</a> <a id="20483" class="Symbol">{</a><a id="20484" href="lagda.2023-11-21-nbe.html#20484" class="Bound">Γ</a> <a id="20486" href="lagda.2023-11-21-nbe.html#20486" class="Bound">Δ</a> <a id="20488" href="lagda.2023-11-21-nbe.html#20488" class="Bound">Σ</a> <a id="20490" class="Symbol">:</a> <a id="20492" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="20495" class="Symbol">}</a> <a id="20497" class="Symbol">{</a><a id="20498" href="lagda.2023-11-21-nbe.html#20498" class="Bound">τ</a> <a id="20500" href="lagda.2023-11-21-nbe.html#20500" class="Bound">τ′</a> <a id="20503" class="Symbol">:</a> <a id="20505" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="20509" href="lagda.2023-11-21-nbe.html#20484" class="Bound">Γ</a> <a id="20511" href="lagda.2023-11-21-nbe.html#20486" class="Bound">Δ</a><a id="20512" class="Symbol">}</a> <a id="20514" class="Symbol">{</a><a id="20515" href="lagda.2023-11-21-nbe.html#20515" class="Bound">σ</a> <a id="20517" href="lagda.2023-11-21-nbe.html#20517" class="Bound">σ′</a> <a id="20520" class="Symbol">:</a> <a id="20522" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="20526" href="lagda.2023-11-21-nbe.html#20486" class="Bound">Δ</a> <a id="20528" href="lagda.2023-11-21-nbe.html#20488" class="Bound">Σ</a><a id="20529" class="Symbol">}</a>
         <a id="20540" class="Symbol">→</a> <a id="20542" class="Symbol">(∀</a> <a id="20545" class="Symbol">{</a><a id="20546" href="lagda.2023-11-21-nbe.html#20546" class="Bound">T</a> <a id="20548" class="Symbol">:</a> <a id="20550" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="20554" class="Symbol">}</a> <a id="20556" class="Symbol">→</a> <a id="20558" href="lagda.2023-11-21-nbe.html#20515" class="Bound">σ</a> <a id="20560" class="Symbol">{</a><a id="20561" href="lagda.2023-11-21-nbe.html#20546" class="Bound">T</a><a id="20562" class="Symbol">}</a> <a id="20564" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="20566" href="lagda.2023-11-21-nbe.html#20517" class="Bound">σ′</a><a id="20568" class="Symbol">)</a>
         <a id="20579" class="Symbol">→</a> <a id="20581" class="Symbol">(∀</a> <a id="20584" class="Symbol">{</a><a id="20585" href="lagda.2023-11-21-nbe.html#20585" class="Bound">T</a> <a id="20587" class="Symbol">:</a> <a id="20589" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="20593" class="Symbol">}</a> <a id="20595" class="Symbol">→</a> <a id="20597" href="lagda.2023-11-21-nbe.html#20498" class="Bound">τ</a> <a id="20599" class="Symbol">{</a><a id="20600" href="lagda.2023-11-21-nbe.html#20585" class="Bound">T</a><a id="20601" class="Symbol">}</a> <a id="20603" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="20605" href="lagda.2023-11-21-nbe.html#20500" class="Bound">τ′</a><a id="20607" class="Symbol">)</a>
         <a id="20618" class="Symbol">→</a> <a id="20620" class="Symbol">(∀</a> <a id="20623" class="Symbol">{</a><a id="20624" href="lagda.2023-11-21-nbe.html#20624" class="Bound">T</a> <a id="20626" class="Symbol">:</a> <a id="20628" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="20632" class="Symbol">}</a> <a id="20634" class="Symbol">→</a> <a id="20636" class="Symbol">(</a><a id="20637" href="lagda.2023-11-21-nbe.html#20515" class="Bound">σ</a> <a id="20639" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="20641" href="lagda.2023-11-21-nbe.html#20498" class="Bound">τ</a><a id="20642" class="Symbol">)</a> <a id="20644" class="Symbol">{</a><a id="20645" href="lagda.2023-11-21-nbe.html#20624" class="Bound">T</a><a id="20646" class="Symbol">}</a> <a id="20648" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="20650" href="lagda.2023-11-21-nbe.html#20517" class="Bound">σ′</a> <a id="20653" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="20655" href="lagda.2023-11-21-nbe.html#20500" class="Bound">τ′</a><a id="20657" class="Symbol">)</a>
<a id="20659" href="lagda.2023-11-21-nbe.html#20470" class="Function">cong-seq</a> <a id="20668" class="Symbol">{</a><a id="20669" class="Argument">Σ</a> <a id="20671" class="Symbol">=</a> <a id="20673" href="lagda.2023-11-21-nbe.html#20673" class="Bound">Σ</a><a id="20674" class="Symbol">}</a> <a id="20676" class="Symbol">{</a><a id="20677" href="lagda.2023-11-21-nbe.html#20677" class="Bound">τ</a><a id="20678" class="Symbol">}</a> <a id="20680" class="Symbol">{</a><a id="20681" href="lagda.2023-11-21-nbe.html#20681" class="Bound">τ′</a><a id="20683" class="Symbol">}</a> <a id="20685" class="Symbol">{</a><a id="20686" href="lagda.2023-11-21-nbe.html#20686" class="Bound">σ</a><a id="20687" class="Symbol">}</a> <a id="20689" class="Symbol">{</a><a id="20690" href="lagda.2023-11-21-nbe.html#20690" class="Bound">σ′</a><a id="20692" class="Symbol">}</a> <a id="20694" href="lagda.2023-11-21-nbe.html#20694" class="Bound">σ≡σ′</a> <a id="20699" href="lagda.2023-11-21-nbe.html#20699" class="Bound">τ≡τ′</a> <a id="20704" class="Symbol">{</a><a id="20705" href="lagda.2023-11-21-nbe.html#20705" class="Bound">T</a><a id="20706" class="Symbol">}</a> <a id="20708" class="Symbol">=</a> <a id="20710" href="lagda.2023-11-21-nbe.html#2744" class="Postulate">extensionality</a> <a id="20725" href="lagda.2023-11-21-nbe.html#20739" class="Function">lemma</a> <a id="20731" class="Keyword">where</a>
  <a id="20739" href="lagda.2023-11-21-nbe.html#20739" class="Function">lemma</a> <a id="20745" class="Symbol">:</a> <a id="20747" class="Symbol">∀</a> <a id="20749" class="Symbol">(</a><a id="20750" href="lagda.2023-11-21-nbe.html#20750" class="Bound">x</a> <a id="20752" class="Symbol">:</a> <a id="20754" href="lagda.2023-11-21-nbe.html#20673" class="Bound">Σ</a> <a id="20756" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="20758" href="lagda.2023-11-21-nbe.html#20705" class="Bound">T</a><a id="20759" class="Symbol">)</a> <a id="20761" class="Symbol">→</a> <a id="20763" class="Symbol">(</a><a id="20764" href="lagda.2023-11-21-nbe.html#20686" class="Bound">σ</a> <a id="20766" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="20768" href="lagda.2023-11-21-nbe.html#20677" class="Bound">τ</a><a id="20769" class="Symbol">)</a> <a id="20771" href="lagda.2023-11-21-nbe.html#20750" class="Bound">x</a> <a id="20773" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="20775" class="Symbol">(</a><a id="20776" href="lagda.2023-11-21-nbe.html#20690" class="Bound">σ′</a> <a id="20779" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="20781" href="lagda.2023-11-21-nbe.html#20681" class="Bound">τ′</a><a id="20783" class="Symbol">)</a> <a id="20785" href="lagda.2023-11-21-nbe.html#20750" class="Bound">x</a>
  <a id="20789" href="lagda.2023-11-21-nbe.html#20739" class="Function">lemma</a> <a id="20795" href="lagda.2023-11-21-nbe.html#20795" class="Bound">x</a> <a id="20797" class="Keyword">rewrite</a> <a id="20805" href="lagda.2023-11-21-nbe.html#20694" class="Bound">σ≡σ′</a> <a id="20810" class="Symbol">{</a><a id="20811" href="lagda.2023-11-21-nbe.html#20705" class="Bound">T</a><a id="20812" class="Symbol">}</a> <a id="20814" class="Symbol">|</a> <a id="20816" href="lagda.2023-11-21-nbe.html#19474" class="Function">cong-sub</a> <a id="20825" class="Symbol">{</a><a id="20826" class="Argument">t</a> <a id="20828" class="Symbol">=</a> <a id="20830" href="lagda.2023-11-21-nbe.html#20690" class="Bound">σ′</a> <a id="20833" href="lagda.2023-11-21-nbe.html#20795" class="Bound">x</a><a id="20834" class="Symbol">}</a> <a id="20836" href="lagda.2023-11-21-nbe.html#20699" class="Bound">τ≡τ′</a> <a id="20841" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="20846" class="Symbol">=</a> <a id="20848" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="ren-ext"></a><a id="20854" href="lagda.2023-11-21-nbe.html#20854" class="Function">ren-ext</a> <a id="20862" class="Symbol">:</a> <a id="20864" class="Symbol">∀</a> <a id="20866" class="Symbol">{</a><a id="20867" href="lagda.2023-11-21-nbe.html#20867" class="Bound">Γ</a> <a id="20869" href="lagda.2023-11-21-nbe.html#20869" class="Bound">Δ</a> <a id="20871" class="Symbol">:</a> <a id="20873" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="20876" class="Symbol">}</a> <a id="20878" class="Symbol">{</a><a id="20879" href="lagda.2023-11-21-nbe.html#20879" class="Bound">S</a> <a id="20881" href="lagda.2023-11-21-nbe.html#20881" class="Bound">T</a> <a id="20883" class="Symbol">:</a> <a id="20885" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="20889" class="Symbol">}</a> <a id="20891" class="Symbol">{</a><a id="20892" href="lagda.2023-11-21-nbe.html#20892" class="Bound">ρ</a> <a id="20894" class="Symbol">:</a> <a id="20896" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="20900" href="lagda.2023-11-21-nbe.html#20867" class="Bound">Γ</a> <a id="20902" href="lagda.2023-11-21-nbe.html#20869" class="Bound">Δ</a><a id="20903" class="Symbol">}</a>
        <a id="20913" class="Symbol">→</a> <a id="20915" href="lagda.2023-11-21-nbe.html#12782" class="Function">ren</a> <a id="20919" class="Symbol">(</a><a id="20920" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="20924" href="lagda.2023-11-21-nbe.html#20892" class="Bound">ρ</a><a id="20925" class="Symbol">)</a> <a id="20927" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="20929" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="20934" class="Symbol">(</a><a id="20935" href="lagda.2023-11-21-nbe.html#12782" class="Function">ren</a> <a id="20939" href="lagda.2023-11-21-nbe.html#20892" class="Bound">ρ</a><a id="20940" class="Symbol">)</a> <a id="20942" class="Symbol">{</a><a id="20943" href="lagda.2023-11-21-nbe.html#20879" class="Bound">S</a><a id="20944" class="Symbol">}</a> <a id="20946" class="Symbol">{</a><a id="20947" href="lagda.2023-11-21-nbe.html#20881" class="Bound">T</a><a id="20948" class="Symbol">}</a>
<a id="20950" href="lagda.2023-11-21-nbe.html#20854" class="Function">ren-ext</a> <a id="20958" class="Symbol">{</a><a id="20959" class="Argument">Δ</a> <a id="20961" class="Symbol">=</a> <a id="20963" href="lagda.2023-11-21-nbe.html#20963" class="Bound">Δ</a><a id="20964" class="Symbol">}</a> <a id="20966" class="Symbol">{</a><a id="20967" href="lagda.2023-11-21-nbe.html#20967" class="Bound">S</a><a id="20968" class="Symbol">}</a> <a id="20970" class="Symbol">{</a><a id="20971" href="lagda.2023-11-21-nbe.html#20971" class="Bound">T</a><a id="20972" class="Symbol">}</a> <a id="20974" class="Symbol">{</a><a id="20975" href="lagda.2023-11-21-nbe.html#20975" class="Bound">ρ</a><a id="20976" class="Symbol">}</a> <a id="20978" class="Symbol">=</a> <a id="20980" href="lagda.2023-11-21-nbe.html#2744" class="Postulate">extensionality</a> <a id="20995" href="lagda.2023-11-21-nbe.html#21009" class="Function">lemma</a> <a id="21001" class="Keyword">where</a>
  <a id="21009" href="lagda.2023-11-21-nbe.html#21009" class="Function">lemma</a> <a id="21015" class="Symbol">:</a> <a id="21017" class="Symbol">∀</a> <a id="21019" class="Symbol">(</a><a id="21020" href="lagda.2023-11-21-nbe.html#21020" class="Bound">x</a> <a id="21022" class="Symbol">:</a> <a id="21024" href="lagda.2023-11-21-nbe.html#20963" class="Bound">Δ</a> <a id="21026" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="21028" href="lagda.2023-11-21-nbe.html#20967" class="Bound">S</a> <a id="21030" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="21032" href="lagda.2023-11-21-nbe.html#20971" class="Bound">T</a><a id="21033" class="Symbol">)</a> <a id="21035" class="Symbol">→</a> <a id="21037" class="Symbol">(</a><a id="21038" href="lagda.2023-11-21-nbe.html#12782" class="Function">ren</a> <a id="21042" class="Symbol">(</a><a id="21043" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="21047" href="lagda.2023-11-21-nbe.html#20975" class="Bound">ρ</a><a id="21048" class="Symbol">))</a> <a id="21051" href="lagda.2023-11-21-nbe.html#21020" class="Bound">x</a> <a id="21053" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="21055" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="21060" class="Symbol">(</a><a id="21061" href="lagda.2023-11-21-nbe.html#12782" class="Function">ren</a> <a id="21065" href="lagda.2023-11-21-nbe.html#20975" class="Bound">ρ</a><a id="21066" class="Symbol">)</a> <a id="21068" href="lagda.2023-11-21-nbe.html#21020" class="Bound">x</a>
  <a id="21072" href="lagda.2023-11-21-nbe.html#21009" class="Function">lemma</a> <a id="21078" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>     <a id="21084" class="Symbol">=</a> <a id="21086" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="21093" href="lagda.2023-11-21-nbe.html#21009" class="Function">lemma</a> <a id="21099" class="Symbol">(</a><a id="21100" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="21102" href="lagda.2023-11-21-nbe.html#21102" class="Bound">x</a><a id="21103" class="Symbol">)</a> <a id="21105" class="Symbol">=</a> <a id="21107" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="rename-subst-ren"></a><a id="21113" href="lagda.2023-11-21-nbe.html#21113" class="Function">rename-subst-ren</a> <a id="21130" class="Symbol">:</a> <a id="21132" class="Symbol">∀</a> <a id="21134" class="Symbol">{</a><a id="21135" href="lagda.2023-11-21-nbe.html#21135" class="Bound">Γ</a> <a id="21137" href="lagda.2023-11-21-nbe.html#21137" class="Bound">Δ</a> <a id="21139" class="Symbol">:</a> <a id="21141" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="21144" class="Symbol">}</a> <a id="21146" class="Symbol">{</a><a id="21147" href="lagda.2023-11-21-nbe.html#21147" class="Bound">T</a> <a id="21149" class="Symbol">:</a> <a id="21151" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="21155" class="Symbol">}</a> <a id="21157" class="Symbol">{</a><a id="21158" href="lagda.2023-11-21-nbe.html#21158" class="Bound">ρ</a> <a id="21160" class="Symbol">:</a> <a id="21162" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="21166" href="lagda.2023-11-21-nbe.html#21135" class="Bound">Γ</a> <a id="21168" href="lagda.2023-11-21-nbe.html#21137" class="Bound">Δ</a><a id="21169" class="Symbol">}</a> <a id="21171" class="Symbol">{</a><a id="21172" href="lagda.2023-11-21-nbe.html#21172" class="Bound">t</a> <a id="21174" class="Symbol">:</a> <a id="21176" href="lagda.2023-11-21-nbe.html#21137" class="Bound">Δ</a> <a id="21178" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="21180" href="lagda.2023-11-21-nbe.html#21147" class="Bound">T</a><a id="21181" class="Symbol">}</a>
                 <a id="21200" class="Symbol">→</a> <a id="21202" href="lagda.2023-11-21-nbe.html#21172" class="Bound">t</a> <a id="21204" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">[</a> <a id="21206" href="lagda.2023-11-21-nbe.html#21158" class="Bound">ρ</a> <a id="21208" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">]ʳ</a> <a id="21211" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="21213" href="lagda.2023-11-21-nbe.html#21172" class="Bound">t</a> <a id="21215" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="21217" href="lagda.2023-11-21-nbe.html#12782" class="Function">ren</a> <a id="21221" href="lagda.2023-11-21-nbe.html#21158" class="Bound">ρ</a> <a id="21223" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a>
<a id="21225" href="lagda.2023-11-21-nbe.html#21113" class="Function">rename-subst-ren</a> <a id="21242" class="Symbol">{</a><a id="21243" class="Argument">t</a> <a id="21245" class="Symbol">=</a> <a id="21247" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a><a id="21251" class="Symbol">}</a>                                           <a id="21295" class="Symbol">=</a> <a id="21297" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="21302" href="lagda.2023-11-21-nbe.html#21113" class="Function">rename-subst-ren</a> <a id="21319" class="Symbol">{</a><a id="21320" class="Argument">t</a> <a id="21322" class="Symbol">=</a> <a id="21324" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="21326" href="lagda.2023-11-21-nbe.html#21326" class="Bound">x</a><a id="21327" class="Symbol">}</a>                                            <a id="21372" class="Symbol">=</a> <a id="21374" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="21379" href="lagda.2023-11-21-nbe.html#21113" class="Function">rename-subst-ren</a> <a id="21396" class="Symbol">{</a><a id="21397" class="Argument">ρ</a> <a id="21399" class="Symbol">=</a> <a id="21401" href="lagda.2023-11-21-nbe.html#21401" class="Bound">ρ</a><a id="21402" class="Symbol">}</a> <a id="21404" class="Symbol">{</a><a id="21405" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="21407" href="lagda.2023-11-21-nbe.html#21407" class="Bound">t</a><a id="21408" class="Symbol">}</a>
  <a id="21412" class="Keyword">rewrite</a> <a id="21420" href="lagda.2023-11-21-nbe.html#21113" class="Function">rename-subst-ren</a> <a id="21437" class="Symbol">{</a><a id="21438" class="Argument">ρ</a> <a id="21440" class="Symbol">=</a> <a id="21442" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="21446" href="lagda.2023-11-21-nbe.html#21401" class="Bound">ρ</a><a id="21447" class="Symbol">}</a> <a id="21449" class="Symbol">{</a><a id="21450" href="lagda.2023-11-21-nbe.html#21407" class="Bound">t</a><a id="21451" class="Symbol">}</a>
        <a id="21461" class="Symbol">|</a> <a id="21463" href="lagda.2023-11-21-nbe.html#19474" class="Function">cong-sub</a> <a id="21472" class="Symbol">{</a><a id="21473" class="Argument">t</a> <a id="21475" class="Symbol">=</a> <a id="21477" href="lagda.2023-11-21-nbe.html#21407" class="Bound">t</a><a id="21478" class="Symbol">}</a> <a id="21480" class="Symbol">(</a><a id="21481" href="lagda.2023-11-21-nbe.html#20854" class="Function">ren-ext</a> <a id="21489" class="Symbol">{</a><a id="21490" class="Argument">ρ</a> <a id="21492" class="Symbol">=</a> <a id="21494" href="lagda.2023-11-21-nbe.html#21401" class="Bound">ρ</a><a id="21495" class="Symbol">})</a> <a id="21498" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>                     <a id="21523" class="Symbol">=</a> <a id="21525" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="21530" href="lagda.2023-11-21-nbe.html#21113" class="Function">rename-subst-ren</a> <a id="21547" class="Symbol">{</a><a id="21548" class="Argument">ρ</a> <a id="21550" class="Symbol">=</a> <a id="21552" href="lagda.2023-11-21-nbe.html#21552" class="Bound">ρ</a><a id="21553" class="Symbol">}</a> <a id="21555" class="Symbol">{</a><a id="21556" href="lagda.2023-11-21-nbe.html#21556" class="Bound">r</a> <a id="21558" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="21560" href="lagda.2023-11-21-nbe.html#21560" class="Bound">s</a><a id="21561" class="Symbol">}</a>
  <a id="21565" class="Keyword">rewrite</a> <a id="21573" href="lagda.2023-11-21-nbe.html#21113" class="Function">rename-subst-ren</a> <a id="21590" class="Symbol">{</a><a id="21591" class="Argument">ρ</a> <a id="21593" class="Symbol">=</a> <a id="21595" href="lagda.2023-11-21-nbe.html#21552" class="Bound">ρ</a><a id="21596" class="Symbol">}</a> <a id="21598" class="Symbol">{</a><a id="21599" href="lagda.2023-11-21-nbe.html#21556" class="Bound">r</a><a id="21600" class="Symbol">}</a> <a id="21602" class="Symbol">|</a> <a id="21604" href="lagda.2023-11-21-nbe.html#21113" class="Function">rename-subst-ren</a> <a id="21621" class="Symbol">{</a><a id="21622" class="Argument">ρ</a> <a id="21624" class="Symbol">=</a> <a id="21626" href="lagda.2023-11-21-nbe.html#21552" class="Bound">ρ</a><a id="21627" class="Symbol">}</a> <a id="21629" class="Symbol">{</a><a id="21630" href="lagda.2023-11-21-nbe.html#21560" class="Bound">s</a><a id="21631" class="Symbol">}</a> <a id="21633" class="Symbol">=</a> <a id="21635" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="ren-shift"></a><a id="21641" href="lagda.2023-11-21-nbe.html#21641" class="Function">ren-shift</a> <a id="21651" class="Symbol">:</a> <a id="21653" class="Symbol">∀</a> <a id="21655" class="Symbol">{</a><a id="21656" href="lagda.2023-11-21-nbe.html#21656" class="Bound">Γ</a> <a id="21658" class="Symbol">:</a> <a id="21660" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="21663" class="Symbol">}</a> <a id="21665" class="Symbol">{</a><a id="21666" href="lagda.2023-11-21-nbe.html#21666" class="Bound">S</a> <a id="21668" href="lagda.2023-11-21-nbe.html#21668" class="Bound">T</a> <a id="21670" class="Symbol">:</a> <a id="21672" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="21676" class="Symbol">}</a>
          <a id="21688" class="Symbol">→</a> <a id="21690" href="lagda.2023-11-21-nbe.html#12782" class="Function">ren</a> <a id="21694" href="lagda.2023-11-21-nbe.html#13230" class="Function">↥ʳ</a> <a id="21697" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="21699" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a> <a id="21701" class="Symbol">{</a><a id="21702" href="lagda.2023-11-21-nbe.html#21656" class="Bound">Γ</a><a id="21703" class="Symbol">}</a> <a id="21705" class="Symbol">{</a><a id="21706" href="lagda.2023-11-21-nbe.html#21666" class="Bound">S</a><a id="21707" class="Symbol">}</a> <a id="21709" class="Symbol">{</a><a id="21710" href="lagda.2023-11-21-nbe.html#21668" class="Bound">T</a><a id="21711" class="Symbol">}</a>
<a id="21713" href="lagda.2023-11-21-nbe.html#21641" class="Function">ren-shift</a> <a id="21723" class="Symbol">{</a><a id="21724" href="lagda.2023-11-21-nbe.html#21724" class="Bound">Γ</a><a id="21725" class="Symbol">}</a> <a id="21727" class="Symbol">{</a><a id="21728" href="lagda.2023-11-21-nbe.html#21728" class="Bound">S</a><a id="21729" class="Symbol">}</a> <a id="21731" class="Symbol">{</a><a id="21732" href="lagda.2023-11-21-nbe.html#21732" class="Bound">T</a><a id="21733" class="Symbol">}</a> <a id="21735" class="Symbol">=</a> <a id="21737" href="lagda.2023-11-21-nbe.html#2744" class="Postulate">extensionality</a> <a id="21752" href="lagda.2023-11-21-nbe.html#21766" class="Function">lemma</a> <a id="21758" class="Keyword">where</a>
  <a id="21766" href="lagda.2023-11-21-nbe.html#21766" class="Function">lemma</a> <a id="21772" class="Symbol">:</a> <a id="21774" class="Symbol">∀</a> <a id="21776" class="Symbol">(</a><a id="21777" href="lagda.2023-11-21-nbe.html#21777" class="Bound">x</a> <a id="21779" class="Symbol">:</a> <a id="21781" href="lagda.2023-11-21-nbe.html#21724" class="Bound">Γ</a> <a id="21783" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="21785" href="lagda.2023-11-21-nbe.html#21732" class="Bound">T</a><a id="21786" class="Symbol">)</a> <a id="21788" class="Symbol">→</a> <a id="21790" href="lagda.2023-11-21-nbe.html#12782" class="Function">ren</a> <a id="21794" href="lagda.2023-11-21-nbe.html#13230" class="Function">↥ʳ</a> <a id="21797" href="lagda.2023-11-21-nbe.html#21777" class="Bound">x</a> <a id="21799" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="21801" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a> <a id="21803" href="lagda.2023-11-21-nbe.html#21777" class="Bound">x</a>
  <a id="21807" href="lagda.2023-11-21-nbe.html#21766" class="Function">lemma</a> <a id="21813" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>     <a id="21819" class="Symbol">=</a> <a id="21821" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="21828" href="lagda.2023-11-21-nbe.html#21766" class="Function">lemma</a> <a id="21834" class="Symbol">(</a><a id="21835" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="21837" href="lagda.2023-11-21-nbe.html#21837" class="Bound">x</a><a id="21838" class="Symbol">)</a> <a id="21840" class="Symbol">=</a> <a id="21842" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="rename-shift"></a><a id="21848" href="lagda.2023-11-21-nbe.html#21848" class="Function">rename-shift</a> <a id="21861" class="Symbol">:</a> <a id="21863" class="Symbol">∀</a> <a id="21865" class="Symbol">{</a><a id="21866" href="lagda.2023-11-21-nbe.html#21866" class="Bound">Γ</a> <a id="21868" class="Symbol">:</a> <a id="21870" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="21873" class="Symbol">}</a> <a id="21875" class="Symbol">{</a><a id="21876" href="lagda.2023-11-21-nbe.html#21876" class="Bound">S</a> <a id="21878" href="lagda.2023-11-21-nbe.html#21878" class="Bound">T</a> <a id="21880" class="Symbol">:</a> <a id="21882" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="21886" class="Symbol">}</a> <a id="21888" class="Symbol">{</a><a id="21889" href="lagda.2023-11-21-nbe.html#21889" class="Bound">s</a> <a id="21891" class="Symbol">:</a> <a id="21893" href="lagda.2023-11-21-nbe.html#21866" class="Bound">Γ</a> <a id="21895" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="21897" href="lagda.2023-11-21-nbe.html#21876" class="Bound">S</a><a id="21898" class="Symbol">}</a>
             <a id="21913" class="Symbol">→</a> <a id="21915" href="lagda.2023-11-21-nbe.html#21889" class="Bound">s</a> <a id="21917" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">[</a> <a id="21919" href="lagda.2023-11-21-nbe.html#13230" class="Function">↥ʳ</a> <a id="21922" class="Symbol">{</a><a id="21923" class="Argument">T</a> <a id="21925" class="Symbol">=</a> <a id="21927" href="lagda.2023-11-21-nbe.html#21878" class="Bound">T</a><a id="21928" class="Symbol">}</a> <a id="21930" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">]ʳ</a> <a id="21933" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="21935" href="lagda.2023-11-21-nbe.html#21889" class="Bound">s</a> <a id="21937" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="21939" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a> <a id="21941" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a>
<a id="21943" href="lagda.2023-11-21-nbe.html#21848" class="Function">rename-shift</a> <a id="21956" class="Symbol">{</a><a id="21957" href="lagda.2023-11-21-nbe.html#21957" class="Bound">Γ</a><a id="21958" class="Symbol">}</a> <a id="21960" class="Symbol">{</a><a id="21961" href="lagda.2023-11-21-nbe.html#21961" class="Bound">S</a><a id="21962" class="Symbol">}</a> <a id="21964" class="Symbol">{</a><a id="21965" href="lagda.2023-11-21-nbe.html#21965" class="Bound">T</a><a id="21966" class="Symbol">}</a> <a id="21968" class="Symbol">{</a><a id="21969" href="lagda.2023-11-21-nbe.html#21969" class="Bound">s</a><a id="21970" class="Symbol">}</a>
  <a id="21974" class="Keyword">rewrite</a> <a id="21982" href="lagda.2023-11-21-nbe.html#21113" class="Function">rename-subst-ren</a> <a id="21999" class="Symbol">{</a><a id="22000" class="Argument">ρ</a> <a id="22002" class="Symbol">=</a> <a id="22004" href="lagda.2023-11-21-nbe.html#13230" class="Function">↥ʳ</a> <a id="22007" class="Symbol">{</a><a id="22008" class="Argument">T</a> <a id="22010" class="Symbol">=</a> <a id="22012" href="lagda.2023-11-21-nbe.html#21965" class="Bound">T</a><a id="22013" class="Symbol">}}</a> <a id="22016" class="Symbol">{</a><a id="22017" href="lagda.2023-11-21-nbe.html#21969" class="Bound">s</a><a id="22018" class="Symbol">}</a>
        <a id="22028" class="Symbol">|</a> <a id="22030" href="lagda.2023-11-21-nbe.html#21641" class="Function">ren-shift</a> <a id="22040" class="Symbol">{</a><a id="22041" href="lagda.2023-11-21-nbe.html#21957" class="Bound">Γ</a><a id="22042" class="Symbol">}</a> <a id="22044" class="Symbol">{</a><a id="22045" href="lagda.2023-11-21-nbe.html#21965" class="Bound">T</a><a id="22046" class="Symbol">}</a> <a id="22048" class="Symbol">{</a><a id="22049" href="lagda.2023-11-21-nbe.html#21961" class="Bound">S</a><a id="22050" class="Symbol">}</a>                <a id="22067" class="Symbol">=</a> <a id="22069" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="exts-cons-shift"></a><a id="22075" href="lagda.2023-11-21-nbe.html#22075" class="Function">exts-cons-shift</a> <a id="22091" class="Symbol">:</a> <a id="22093" class="Symbol">∀</a> <a id="22095" class="Symbol">{</a><a id="22096" href="lagda.2023-11-21-nbe.html#22096" class="Bound">Γ</a> <a id="22098" href="lagda.2023-11-21-nbe.html#22098" class="Bound">Δ</a> <a id="22100" class="Symbol">:</a> <a id="22102" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="22105" class="Symbol">}</a> <a id="22107" class="Symbol">{</a><a id="22108" href="lagda.2023-11-21-nbe.html#22108" class="Bound">S</a> <a id="22110" href="lagda.2023-11-21-nbe.html#22110" class="Bound">T</a> <a id="22112" class="Symbol">:</a> <a id="22114" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="22118" class="Symbol">}</a> <a id="22120" class="Symbol">{</a><a id="22121" href="lagda.2023-11-21-nbe.html#22121" class="Bound">σ</a> <a id="22123" class="Symbol">:</a> <a id="22125" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="22129" href="lagda.2023-11-21-nbe.html#22096" class="Bound">Γ</a> <a id="22131" href="lagda.2023-11-21-nbe.html#22098" class="Bound">Δ</a><a id="22132" class="Symbol">}</a>
                <a id="22150" class="Symbol">→</a> <a id="22152" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="22157" href="lagda.2023-11-21-nbe.html#22121" class="Bound">σ</a> <a id="22159" class="Symbol">{</a><a id="22160" href="lagda.2023-11-21-nbe.html#22108" class="Bound">S</a><a id="22161" class="Symbol">}</a> <a id="22163" class="Symbol">{</a><a id="22164" href="lagda.2023-11-21-nbe.html#22110" class="Bound">T</a><a id="22165" class="Symbol">}</a> <a id="22167" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="22169" class="Symbol">(</a><a id="22170" href="lagda.2023-11-21-nbe.html#22121" class="Bound">σ</a> <a id="22172" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="22174" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a><a id="22175" class="Symbol">)</a> <a id="22177" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="22179" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="22181" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>
<a id="22183" href="lagda.2023-11-21-nbe.html#22075" class="Function">exts-cons-shift</a> <a id="22199" class="Symbol">{</a><a id="22200" class="Argument">Δ</a> <a id="22202" class="Symbol">=</a> <a id="22204" href="lagda.2023-11-21-nbe.html#22204" class="Bound">Δ</a><a id="22205" class="Symbol">}</a> <a id="22207" class="Symbol">{</a><a id="22208" href="lagda.2023-11-21-nbe.html#22208" class="Bound">S</a><a id="22209" class="Symbol">}</a> <a id="22211" class="Symbol">{</a><a id="22212" href="lagda.2023-11-21-nbe.html#22212" class="Bound">T</a><a id="22213" class="Symbol">}</a> <a id="22215" class="Symbol">{</a><a id="22216" href="lagda.2023-11-21-nbe.html#22216" class="Bound">σ</a><a id="22217" class="Symbol">}</a> <a id="22219" class="Symbol">=</a> <a id="22221" href="lagda.2023-11-21-nbe.html#2744" class="Postulate">extensionality</a> <a id="22236" href="lagda.2023-11-21-nbe.html#22250" class="Function">lemma</a> <a id="22242" class="Keyword">where</a>
  <a id="22250" href="lagda.2023-11-21-nbe.html#22250" class="Function">lemma</a> <a id="22256" class="Symbol">:</a> <a id="22258" class="Symbol">∀</a> <a id="22260" class="Symbol">(</a><a id="22261" href="lagda.2023-11-21-nbe.html#22261" class="Bound">x</a> <a id="22263" class="Symbol">:</a> <a id="22265" href="lagda.2023-11-21-nbe.html#22204" class="Bound">Δ</a> <a id="22267" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="22269" href="lagda.2023-11-21-nbe.html#22208" class="Bound">S</a> <a id="22271" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="22273" href="lagda.2023-11-21-nbe.html#22212" class="Bound">T</a><a id="22274" class="Symbol">)</a> <a id="22276" class="Symbol">→</a> <a id="22278" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="22283" href="lagda.2023-11-21-nbe.html#22216" class="Bound">σ</a> <a id="22285" href="lagda.2023-11-21-nbe.html#22261" class="Bound">x</a> <a id="22287" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="22289" class="Symbol">((</a><a id="22291" href="lagda.2023-11-21-nbe.html#22216" class="Bound">σ</a> <a id="22293" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="22295" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a><a id="22296" class="Symbol">)</a> <a id="22298" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="22300" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="22302" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a><a id="22303" class="Symbol">)</a> <a id="22305" href="lagda.2023-11-21-nbe.html#22261" class="Bound">x</a>
  <a id="22309" href="lagda.2023-11-21-nbe.html#22250" class="Function">lemma</a> <a id="22315" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>     <a id="22321" class="Symbol">=</a> <a id="22323" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="22330" href="lagda.2023-11-21-nbe.html#22250" class="Function">lemma</a> <a id="22336" class="Symbol">(</a><a id="22337" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="22339" href="lagda.2023-11-21-nbe.html#22339" class="Bound">x</a><a id="22340" class="Symbol">)</a> <a id="22342" class="Symbol">=</a> <a id="22344" href="lagda.2023-11-21-nbe.html#21113" class="Function">rename-subst-ren</a>

<a id="exts-ids"></a><a id="22362" href="lagda.2023-11-21-nbe.html#22362" class="Function">exts-ids</a> <a id="22371" class="Symbol">:</a> <a id="22373" class="Symbol">∀</a> <a id="22375" class="Symbol">{</a><a id="22376" href="lagda.2023-11-21-nbe.html#22376" class="Bound">Γ</a> <a id="22378" class="Symbol">:</a> <a id="22380" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="22383" class="Symbol">}</a> <a id="22385" class="Symbol">{</a><a id="22386" href="lagda.2023-11-21-nbe.html#22386" class="Bound">S</a> <a id="22388" href="lagda.2023-11-21-nbe.html#22388" class="Bound">T</a> <a id="22390" class="Symbol">:</a> <a id="22392" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="22396" class="Symbol">}</a>
         <a id="22407" class="Symbol">→</a> <a id="22409" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="22414" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="22417" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="22419" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="22422" class="Symbol">{</a><a id="22423" href="lagda.2023-11-21-nbe.html#22376" class="Bound">Γ</a> <a id="22425" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="22427" href="lagda.2023-11-21-nbe.html#22386" class="Bound">S</a><a id="22428" class="Symbol">}</a> <a id="22430" class="Symbol">{</a><a id="22431" href="lagda.2023-11-21-nbe.html#22388" class="Bound">T</a><a id="22432" class="Symbol">}</a>
<a id="22434" href="lagda.2023-11-21-nbe.html#22362" class="Function">exts-ids</a> <a id="22443" class="Symbol">{</a><a id="22444" href="lagda.2023-11-21-nbe.html#22444" class="Bound">Γ</a><a id="22445" class="Symbol">}</a> <a id="22447" class="Symbol">{</a><a id="22448" href="lagda.2023-11-21-nbe.html#22448" class="Bound">S</a><a id="22449" class="Symbol">}</a> <a id="22451" class="Symbol">{</a><a id="22452" href="lagda.2023-11-21-nbe.html#22452" class="Bound">T</a><a id="22453" class="Symbol">}</a> <a id="22455" class="Symbol">=</a> <a id="22457" href="lagda.2023-11-21-nbe.html#2744" class="Postulate">extensionality</a> <a id="22472" href="lagda.2023-11-21-nbe.html#22486" class="Function">lemma</a> <a id="22478" class="Keyword">where</a>
  <a id="22486" href="lagda.2023-11-21-nbe.html#22486" class="Function">lemma</a> <a id="22492" class="Symbol">:</a> <a id="22494" class="Symbol">∀</a> <a id="22496" class="Symbol">(</a><a id="22497" href="lagda.2023-11-21-nbe.html#22497" class="Bound">x</a> <a id="22499" class="Symbol">:</a> <a id="22501" href="lagda.2023-11-21-nbe.html#22444" class="Bound">Γ</a> <a id="22503" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="22505" href="lagda.2023-11-21-nbe.html#22448" class="Bound">S</a> <a id="22507" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="22509" href="lagda.2023-11-21-nbe.html#22452" class="Bound">T</a><a id="22510" class="Symbol">)</a> <a id="22512" class="Symbol">→</a> <a id="22514" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="22519" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="22522" href="lagda.2023-11-21-nbe.html#22497" class="Bound">x</a> <a id="22524" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="22526" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="22529" href="lagda.2023-11-21-nbe.html#22497" class="Bound">x</a>
  <a id="22533" href="lagda.2023-11-21-nbe.html#22486" class="Function">lemma</a> <a id="22539" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>     <a id="22545" class="Symbol">=</a> <a id="22547" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="22554" href="lagda.2023-11-21-nbe.html#22486" class="Function">lemma</a> <a id="22560" class="Symbol">(</a><a id="22561" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="22563" href="lagda.2023-11-21-nbe.html#22563" class="Bound">x</a><a id="22564" class="Symbol">)</a> <a id="22566" class="Symbol">=</a> <a id="22568" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
</pre>--->
<pre class="Agda"><a id="[id]-identity"></a><a id="22591" href="lagda.2023-11-21-nbe.html#22591" class="Function">[id]-identity</a> <a id="22605" class="Symbol">:</a> <a id="22607" class="Symbol">∀</a> <a id="22609" class="Symbol">{</a><a id="22610" href="lagda.2023-11-21-nbe.html#22610" class="Bound">Γ</a> <a id="22612" class="Symbol">:</a> <a id="22614" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="22617" class="Symbol">}</a> <a id="22619" class="Symbol">{</a><a id="22620" href="lagda.2023-11-21-nbe.html#22620" class="Bound">T</a> <a id="22622" class="Symbol">:</a> <a id="22624" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="22628" class="Symbol">}</a> <a id="22630" class="Symbol">{</a><a id="22631" href="lagda.2023-11-21-nbe.html#22631" class="Bound">t</a> <a id="22633" class="Symbol">:</a> <a id="22635" href="lagda.2023-11-21-nbe.html#22610" class="Bound">Γ</a> <a id="22637" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="22639" href="lagda.2023-11-21-nbe.html#22620" class="Bound">T</a><a id="22640" class="Symbol">}</a>
              <a id="22656" class="Symbol">→</a> <a id="22658" href="lagda.2023-11-21-nbe.html#22631" class="Bound">t</a> <a id="22660" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="22662" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="22665" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a> <a id="22667" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="22669" href="lagda.2023-11-21-nbe.html#22631" class="Bound">t</a>
</pre>
<!---
<pre class="Agda"><a id="22690" href="lagda.2023-11-21-nbe.html#22591" class="Function">[id]-identity</a> <a id="22704" class="Symbol">{</a><a id="22705" class="Argument">t</a> <a id="22707" class="Symbol">=</a> <a id="22709" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a><a id="22713" class="Symbol">}</a>                                <a id="22746" class="Symbol">=</a> <a id="22748" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="22753" href="lagda.2023-11-21-nbe.html#22591" class="Function">[id]-identity</a> <a id="22767" class="Symbol">{</a><a id="22768" class="Argument">t</a> <a id="22770" class="Symbol">=</a> <a id="22772" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="22774" href="lagda.2023-11-21-nbe.html#22774" class="Bound">x</a><a id="22775" class="Symbol">}</a>                                 <a id="22809" class="Symbol">=</a> <a id="22811" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="22816" href="lagda.2023-11-21-nbe.html#22591" class="Function">[id]-identity</a> <a id="22830" class="Symbol">{</a><a id="22831" class="Argument">T</a> <a id="22833" class="Symbol">=</a> <a id="22835" href="lagda.2023-11-21-nbe.html#22835" class="Bound">S</a> <a id="22837" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="22839" href="lagda.2023-11-21-nbe.html#22839" class="Bound">T</a><a id="22840" class="Symbol">}</a> <a id="22842" class="Symbol">{</a><a id="22843" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="22845" href="lagda.2023-11-21-nbe.html#22845" class="Bound">t</a><a id="22846" class="Symbol">}</a>
  <a id="22850" class="Keyword">rewrite</a> <a id="22858" href="lagda.2023-11-21-nbe.html#19474" class="Function">cong-sub</a> <a id="22867" class="Symbol">{</a><a id="22868" class="Argument">t</a> <a id="22870" class="Symbol">=</a> <a id="22872" href="lagda.2023-11-21-nbe.html#22845" class="Bound">t</a><a id="22873" class="Symbol">}</a> <a id="22875" href="lagda.2023-11-21-nbe.html#22362" class="Function">exts-ids</a> <a id="22884" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
        <a id="22897" class="Symbol">|</a> <a id="22899" href="lagda.2023-11-21-nbe.html#22591" class="Function">[id]-identity</a> <a id="22913" class="Symbol">{</a><a id="22914" class="Argument">t</a> <a id="22916" class="Symbol">=</a> <a id="22918" href="lagda.2023-11-21-nbe.html#22845" class="Bound">t</a><a id="22919" class="Symbol">}</a>                         <a id="22945" class="Symbol">=</a> <a id="22947" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="22952" href="lagda.2023-11-21-nbe.html#22591" class="Function">[id]-identity</a> <a id="22966" class="Symbol">{</a><a id="22967" class="Argument">t</a> <a id="22969" class="Symbol">=</a> <a id="22971" href="lagda.2023-11-21-nbe.html#22971" class="Bound">r</a> <a id="22973" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="22975" href="lagda.2023-11-21-nbe.html#22975" class="Bound">s</a><a id="22976" class="Symbol">}</a>
  <a id="22980" class="Keyword">rewrite</a> <a id="22988" href="lagda.2023-11-21-nbe.html#22591" class="Function">[id]-identity</a> <a id="23002" class="Symbol">{</a><a id="23003" class="Argument">t</a> <a id="23005" class="Symbol">=</a> <a id="23007" href="lagda.2023-11-21-nbe.html#22971" class="Bound">r</a><a id="23008" class="Symbol">}</a> <a id="23010" class="Symbol">|</a> <a id="23012" href="lagda.2023-11-21-nbe.html#22591" class="Function">[id]-identity</a> <a id="23026" class="Symbol">{</a><a id="23027" class="Argument">t</a> <a id="23029" class="Symbol">=</a> <a id="23031" href="lagda.2023-11-21-nbe.html#22975" class="Bound">s</a><a id="23032" class="Symbol">}</a> <a id="23034" class="Symbol">=</a> <a id="23036" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="sub-idR"></a><a id="23042" href="lagda.2023-11-21-nbe.html#23042" class="Function">sub-idR</a> <a id="23050" class="Symbol">:</a> <a id="23052" class="Symbol">∀</a> <a id="23054" class="Symbol">{</a><a id="23055" href="lagda.2023-11-21-nbe.html#23055" class="Bound">Γ</a> <a id="23057" href="lagda.2023-11-21-nbe.html#23057" class="Bound">Δ</a> <a id="23059" class="Symbol">:</a> <a id="23061" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="23064" class="Symbol">}</a> <a id="23066" class="Symbol">{</a><a id="23067" href="lagda.2023-11-21-nbe.html#23067" class="Bound">σ</a> <a id="23069" class="Symbol">:</a> <a id="23071" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="23075" href="lagda.2023-11-21-nbe.html#23055" class="Bound">Γ</a> <a id="23077" href="lagda.2023-11-21-nbe.html#23057" class="Bound">Δ</a><a id="23078" class="Symbol">}</a> <a id="23080" class="Symbol">{</a><a id="23081" href="lagda.2023-11-21-nbe.html#23081" class="Bound">T</a> <a id="23083" class="Symbol">:</a> <a id="23085" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="23089" class="Symbol">}</a>
        <a id="23099" class="Symbol">→</a> <a id="23101" class="Symbol">(</a><a id="23102" href="lagda.2023-11-21-nbe.html#23067" class="Bound">σ</a> <a id="23104" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="23106" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a><a id="23108" class="Symbol">)</a> <a id="23110" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="23112" href="lagda.2023-11-21-nbe.html#23067" class="Bound">σ</a> <a id="23114" class="Symbol">{</a><a id="23115" href="lagda.2023-11-21-nbe.html#23081" class="Bound">T</a><a id="23116" class="Symbol">}</a>
<a id="23118" href="lagda.2023-11-21-nbe.html#23042" class="Function">sub-idR</a> <a id="23126" class="Symbol">=</a> <a id="23128" href="lagda.2023-11-21-nbe.html#2744" class="Postulate">extensionality</a> <a id="23143" class="Symbol">(λ</a> <a id="23146" href="lagda.2023-11-21-nbe.html#23146" class="Bound">_</a> <a id="23148" class="Symbol">→</a> <a id="23150" href="lagda.2023-11-21-nbe.html#22591" class="Function">[id]-identity</a><a id="23163" class="Symbol">)</a>

<a id="compose-ext"></a><a id="23166" href="lagda.2023-11-21-nbe.html#23166" class="Function">compose-ext</a> <a id="23178" class="Symbol">:</a> <a id="23180" class="Symbol">∀</a> <a id="23182" class="Symbol">{</a><a id="23183" href="lagda.2023-11-21-nbe.html#23183" class="Bound">Γ</a> <a id="23185" href="lagda.2023-11-21-nbe.html#23185" class="Bound">Δ</a> <a id="23187" href="lagda.2023-11-21-nbe.html#23187" class="Bound">Σ</a> <a id="23189" class="Symbol">:</a> <a id="23191" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="23194" class="Symbol">}</a> <a id="23196" class="Symbol">{</a><a id="23197" href="lagda.2023-11-21-nbe.html#23197" class="Bound">ρ</a> <a id="23199" class="Symbol">:</a> <a id="23201" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="23205" href="lagda.2023-11-21-nbe.html#23185" class="Bound">Δ</a> <a id="23207" href="lagda.2023-11-21-nbe.html#23187" class="Bound">Σ</a><a id="23208" class="Symbol">}</a> <a id="23210" class="Symbol">{</a><a id="23211" href="lagda.2023-11-21-nbe.html#23211" class="Bound">ω</a> <a id="23213" class="Symbol">:</a> <a id="23215" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="23219" href="lagda.2023-11-21-nbe.html#23183" class="Bound">Γ</a> <a id="23221" href="lagda.2023-11-21-nbe.html#23185" class="Bound">Δ</a><a id="23222" class="Symbol">}</a> <a id="23224" class="Symbol">{</a><a id="23225" href="lagda.2023-11-21-nbe.html#23225" class="Bound">S</a> <a id="23227" href="lagda.2023-11-21-nbe.html#23227" class="Bound">T</a> <a id="23229" class="Symbol">:</a> <a id="23231" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="23235" class="Symbol">}</a>
            <a id="23249" class="Symbol">→</a> <a id="23251" class="Symbol">(</a><a id="23252" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="23256" href="lagda.2023-11-21-nbe.html#23197" class="Bound">ρ</a><a id="23257" class="Symbol">)</a> <a id="23259" href="lagda.2023-11-21-nbe.html#13525" class="Function Operator">∘ʳ</a> <a id="23262" class="Symbol">(</a><a id="23263" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="23267" href="lagda.2023-11-21-nbe.html#23211" class="Bound">ω</a><a id="23268" class="Symbol">)</a> <a id="23270" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="23272" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="23276" class="Symbol">(</a><a id="23277" href="lagda.2023-11-21-nbe.html#23197" class="Bound">ρ</a> <a id="23279" href="lagda.2023-11-21-nbe.html#13525" class="Function Operator">∘ʳ</a> <a id="23282" href="lagda.2023-11-21-nbe.html#23211" class="Bound">ω</a><a id="23283" class="Symbol">)</a> <a id="23285" class="Symbol">{</a><a id="23286" href="lagda.2023-11-21-nbe.html#23225" class="Bound">S</a><a id="23287" class="Symbol">}</a> <a id="23289" class="Symbol">{</a><a id="23290" href="lagda.2023-11-21-nbe.html#23227" class="Bound">T</a><a id="23291" class="Symbol">}</a>
<a id="23293" href="lagda.2023-11-21-nbe.html#23166" class="Function">compose-ext</a> <a id="23305" class="Symbol">{</a><a id="23306" class="Argument">Σ</a> <a id="23308" class="Symbol">=</a> <a id="23310" href="lagda.2023-11-21-nbe.html#23310" class="Bound">Σ</a><a id="23311" class="Symbol">}</a> <a id="23313" class="Symbol">{</a><a id="23314" href="lagda.2023-11-21-nbe.html#23314" class="Bound">ρ</a><a id="23315" class="Symbol">}</a> <a id="23317" class="Symbol">{</a><a id="23318" href="lagda.2023-11-21-nbe.html#23318" class="Bound">ω</a><a id="23319" class="Symbol">}</a> <a id="23321" class="Symbol">{</a><a id="23322" href="lagda.2023-11-21-nbe.html#23322" class="Bound">S</a><a id="23323" class="Symbol">}</a> <a id="23325" class="Symbol">{</a><a id="23326" href="lagda.2023-11-21-nbe.html#23326" class="Bound">T</a><a id="23327" class="Symbol">}</a> <a id="23329" class="Symbol">=</a> <a id="23331" href="lagda.2023-11-21-nbe.html#2744" class="Postulate">extensionality</a> <a id="23346" href="lagda.2023-11-21-nbe.html#23360" class="Function">lemma</a> <a id="23352" class="Keyword">where</a>
  <a id="23360" href="lagda.2023-11-21-nbe.html#23360" class="Function">lemma</a> <a id="23366" class="Symbol">:</a> <a id="23368" class="Symbol">∀</a> <a id="23370" class="Symbol">(</a><a id="23371" href="lagda.2023-11-21-nbe.html#23371" class="Bound">x</a> <a id="23373" class="Symbol">:</a> <a id="23375" href="lagda.2023-11-21-nbe.html#23310" class="Bound">Σ</a> <a id="23377" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="23379" href="lagda.2023-11-21-nbe.html#23322" class="Bound">S</a> <a id="23381" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="23383" href="lagda.2023-11-21-nbe.html#23326" class="Bound">T</a><a id="23384" class="Symbol">)</a> <a id="23386" class="Symbol">→</a> <a id="23388" class="Symbol">((</a><a id="23390" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="23394" href="lagda.2023-11-21-nbe.html#23314" class="Bound">ρ</a><a id="23395" class="Symbol">)</a> <a id="23397" href="lagda.2023-11-21-nbe.html#13525" class="Function Operator">∘ʳ</a> <a id="23400" class="Symbol">(</a><a id="23401" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="23405" href="lagda.2023-11-21-nbe.html#23318" class="Bound">ω</a><a id="23406" class="Symbol">))</a> <a id="23409" href="lagda.2023-11-21-nbe.html#23371" class="Bound">x</a> <a id="23411" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="23413" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="23417" class="Symbol">(</a><a id="23418" href="lagda.2023-11-21-nbe.html#23314" class="Bound">ρ</a> <a id="23420" href="lagda.2023-11-21-nbe.html#13525" class="Function Operator">∘ʳ</a> <a id="23423" href="lagda.2023-11-21-nbe.html#23318" class="Bound">ω</a><a id="23424" class="Symbol">)</a> <a id="23426" href="lagda.2023-11-21-nbe.html#23371" class="Bound">x</a>
  <a id="23430" href="lagda.2023-11-21-nbe.html#23360" class="Function">lemma</a> <a id="23436" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>     <a id="23442" class="Symbol">=</a> <a id="23444" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="23451" href="lagda.2023-11-21-nbe.html#23360" class="Function">lemma</a> <a id="23457" class="Symbol">(</a><a id="23458" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="23460" href="lagda.2023-11-21-nbe.html#23460" class="Bound">x</a><a id="23461" class="Symbol">)</a> <a id="23463" class="Symbol">=</a> <a id="23465" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="compose-rename"></a><a id="23471" href="lagda.2023-11-21-nbe.html#23471" class="Function">compose-rename</a> <a id="23486" class="Symbol">:</a> <a id="23488" class="Symbol">∀</a> <a id="23490" class="Symbol">{</a><a id="23491" href="lagda.2023-11-21-nbe.html#23491" class="Bound">Γ</a> <a id="23493" href="lagda.2023-11-21-nbe.html#23493" class="Bound">Δ</a> <a id="23495" href="lagda.2023-11-21-nbe.html#23495" class="Bound">Σ</a> <a id="23497" class="Symbol">:</a> <a id="23499" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="23502" class="Symbol">}</a> <a id="23504" class="Symbol">{</a><a id="23505" href="lagda.2023-11-21-nbe.html#23505" class="Bound">T</a> <a id="23507" class="Symbol">:</a> <a id="23509" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="23513" class="Symbol">}</a> <a id="23515" class="Symbol">{</a><a id="23516" href="lagda.2023-11-21-nbe.html#23516" class="Bound">t</a> <a id="23518" class="Symbol">:</a> <a id="23520" href="lagda.2023-11-21-nbe.html#23495" class="Bound">Σ</a> <a id="23522" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="23524" href="lagda.2023-11-21-nbe.html#23505" class="Bound">T</a><a id="23525" class="Symbol">}</a> <a id="23527" class="Symbol">{</a><a id="23528" href="lagda.2023-11-21-nbe.html#23528" class="Bound">ω</a> <a id="23530" class="Symbol">:</a> <a id="23532" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="23536" href="lagda.2023-11-21-nbe.html#23491" class="Bound">Γ</a> <a id="23538" href="lagda.2023-11-21-nbe.html#23493" class="Bound">Δ</a><a id="23539" class="Symbol">}</a>
                   <a id="23560" class="Symbol">{</a><a id="23561" href="lagda.2023-11-21-nbe.html#23561" class="Bound">ρ</a> <a id="23563" class="Symbol">:</a> <a id="23565" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="23569" href="lagda.2023-11-21-nbe.html#23493" class="Bound">Δ</a> <a id="23571" href="lagda.2023-11-21-nbe.html#23495" class="Bound">Σ</a><a id="23572" class="Symbol">}</a>
               <a id="23589" class="Symbol">→</a> <a id="23591" href="lagda.2023-11-21-nbe.html#23516" class="Bound">t</a> <a id="23593" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">[</a> <a id="23595" href="lagda.2023-11-21-nbe.html#23561" class="Bound">ρ</a> <a id="23597" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">]ʳ</a> <a id="23600" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">[</a> <a id="23602" href="lagda.2023-11-21-nbe.html#23528" class="Bound">ω</a> <a id="23604" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">]ʳ</a> <a id="23607" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="23609" href="lagda.2023-11-21-nbe.html#23516" class="Bound">t</a> <a id="23611" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">[</a> <a id="23613" href="lagda.2023-11-21-nbe.html#23561" class="Bound">ρ</a> <a id="23615" href="lagda.2023-11-21-nbe.html#13525" class="Function Operator">∘ʳ</a> <a id="23618" href="lagda.2023-11-21-nbe.html#23528" class="Bound">ω</a> <a id="23620" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">]ʳ</a>
<a id="23623" href="lagda.2023-11-21-nbe.html#23471" class="Function">compose-rename</a> <a id="23638" class="Symbol">{</a><a id="23639" class="Argument">t</a> <a id="23641" class="Symbol">=</a> <a id="23643" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a><a id="23647" class="Symbol">}</a>                               <a id="23679" class="Symbol">=</a> <a id="23681" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="23686" href="lagda.2023-11-21-nbe.html#23471" class="Function">compose-rename</a> <a id="23701" class="Symbol">{</a><a id="23702" class="Argument">t</a> <a id="23704" class="Symbol">=</a> <a id="23706" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="23708" href="lagda.2023-11-21-nbe.html#23708" class="Bound">x</a><a id="23709" class="Symbol">}</a>                                <a id="23742" class="Symbol">=</a> <a id="23744" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="23749" href="lagda.2023-11-21-nbe.html#23471" class="Function">compose-rename</a> <a id="23764" class="Symbol">{</a><a id="23765" class="Argument">T</a> <a id="23767" class="Symbol">=</a> <a id="23769" href="lagda.2023-11-21-nbe.html#23769" class="Bound">S</a> <a id="23771" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="23773" href="lagda.2023-11-21-nbe.html#23773" class="Bound">T</a><a id="23774" class="Symbol">}</a> <a id="23776" class="Symbol">{</a><a id="23777" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="23779" href="lagda.2023-11-21-nbe.html#23779" class="Bound">t</a><a id="23780" class="Symbol">}</a> <a id="23782" class="Symbol">{</a><a id="23783" href="lagda.2023-11-21-nbe.html#23783" class="Bound">ω</a><a id="23784" class="Symbol">}</a> <a id="23786" class="Symbol">{</a><a id="23787" href="lagda.2023-11-21-nbe.html#23787" class="Bound">ρ</a><a id="23788" class="Symbol">}</a>
  <a id="23792" class="Keyword">rewrite</a> <a id="23800" href="lagda.2023-11-21-nbe.html#23471" class="Function">compose-rename</a> <a id="23815" class="Symbol">{</a><a id="23816" class="Argument">t</a> <a id="23818" class="Symbol">=</a> <a id="23820" href="lagda.2023-11-21-nbe.html#23779" class="Bound">t</a><a id="23821" class="Symbol">}</a> <a id="23823" class="Symbol">{</a><a id="23824" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="23828" href="lagda.2023-11-21-nbe.html#23783" class="Bound">ω</a><a id="23829" class="Symbol">}</a> <a id="23831" class="Symbol">{</a><a id="23832" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="23836" href="lagda.2023-11-21-nbe.html#23787" class="Bound">ρ</a><a id="23837" class="Symbol">}</a>
        <a id="23847" class="Symbol">|</a> <a id="23849" href="lagda.2023-11-21-nbe.html#18598" class="Function">cong-rename</a> <a id="23861" class="Symbol">{</a><a id="23862" class="Argument">t</a> <a id="23864" class="Symbol">=</a> <a id="23866" href="lagda.2023-11-21-nbe.html#23779" class="Bound">t</a><a id="23867" class="Symbol">}</a> <a id="23869" class="Symbol">(</a><a id="23870" href="lagda.2023-11-21-nbe.html#23166" class="Function">compose-ext</a> <a id="23882" class="Symbol">{</a><a id="23883" class="Argument">ρ</a> <a id="23885" class="Symbol">=</a> <a id="23887" href="lagda.2023-11-21-nbe.html#23787" class="Bound">ρ</a><a id="23888" class="Symbol">}</a> <a id="23890" class="Symbol">{</a><a id="23891" href="lagda.2023-11-21-nbe.html#23783" class="Bound">ω</a><a id="23892" class="Symbol">})</a> <a id="23895" class="Symbol">=</a> <a id="23897" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="23902" href="lagda.2023-11-21-nbe.html#23471" class="Function">compose-rename</a> <a id="23917" class="Symbol">{</a><a id="23918" class="Argument">t</a> <a id="23920" class="Symbol">=</a> <a id="23922" href="lagda.2023-11-21-nbe.html#23922" class="Bound">r</a> <a id="23924" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="23926" href="lagda.2023-11-21-nbe.html#23926" class="Bound">s</a><a id="23927" class="Symbol">}</a> <a id="23929" class="Symbol">{</a><a id="23930" href="lagda.2023-11-21-nbe.html#23930" class="Bound">ω</a><a id="23931" class="Symbol">}</a> <a id="23933" class="Symbol">{</a><a id="23934" href="lagda.2023-11-21-nbe.html#23934" class="Bound">ρ</a><a id="23935" class="Symbol">}</a>
  <a id="23939" class="Keyword">rewrite</a> <a id="23947" href="lagda.2023-11-21-nbe.html#23471" class="Function">compose-rename</a> <a id="23962" class="Symbol">{</a><a id="23963" class="Argument">t</a> <a id="23965" class="Symbol">=</a> <a id="23967" href="lagda.2023-11-21-nbe.html#23922" class="Bound">r</a><a id="23968" class="Symbol">}</a> <a id="23970" class="Symbol">{</a><a id="23971" href="lagda.2023-11-21-nbe.html#23930" class="Bound">ω</a><a id="23972" class="Symbol">}</a> <a id="23974" class="Symbol">{</a><a id="23975" href="lagda.2023-11-21-nbe.html#23934" class="Bound">ρ</a><a id="23976" class="Symbol">}</a>
        <a id="23986" class="Symbol">|</a> <a id="23988" href="lagda.2023-11-21-nbe.html#23471" class="Function">compose-rename</a> <a id="24003" class="Symbol">{</a><a id="24004" class="Argument">t</a> <a id="24006" class="Symbol">=</a> <a id="24008" href="lagda.2023-11-21-nbe.html#23926" class="Bound">s</a><a id="24009" class="Symbol">}</a> <a id="24011" class="Symbol">{</a><a id="24012" href="lagda.2023-11-21-nbe.html#23930" class="Bound">ω</a><a id="24013" class="Symbol">}</a> <a id="24015" class="Symbol">{</a><a id="24016" href="lagda.2023-11-21-nbe.html#23934" class="Bound">ρ</a><a id="24017" class="Symbol">}</a>                <a id="24034" class="Symbol">=</a> <a id="24036" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="commute-subst-rename"></a><a id="24042" href="lagda.2023-11-21-nbe.html#24042" class="Function">commute-subst-rename</a> <a id="24063" class="Symbol">:</a> <a id="24065" class="Symbol">∀</a> <a id="24067" class="Symbol">{</a><a id="24068" href="lagda.2023-11-21-nbe.html#24068" class="Bound">Γ</a> <a id="24070" href="lagda.2023-11-21-nbe.html#24070" class="Bound">Δ</a> <a id="24072" href="lagda.2023-11-21-nbe.html#24072" class="Bound">Σ</a> <a id="24074" href="lagda.2023-11-21-nbe.html#24074" class="Bound">Φ</a> <a id="24076" class="Symbol">:</a> <a id="24078" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="24081" class="Symbol">}</a> <a id="24083" class="Symbol">{</a><a id="24084" href="lagda.2023-11-21-nbe.html#24084" class="Bound">T</a> <a id="24086" class="Symbol">:</a> <a id="24088" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="24092" class="Symbol">}</a> <a id="24094" class="Symbol">{</a><a id="24095" href="lagda.2023-11-21-nbe.html#24095" class="Bound">t</a> <a id="24097" class="Symbol">:</a> <a id="24099" href="lagda.2023-11-21-nbe.html#24072" class="Bound">Σ</a> <a id="24101" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="24103" href="lagda.2023-11-21-nbe.html#24084" class="Bound">T</a><a id="24104" class="Symbol">}</a>
                         <a id="24131" class="Symbol">{</a><a id="24132" href="lagda.2023-11-21-nbe.html#24132" class="Bound">σ</a> <a id="24134" class="Symbol">:</a> <a id="24136" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="24140" href="lagda.2023-11-21-nbe.html#24068" class="Bound">Γ</a> <a id="24142" href="lagda.2023-11-21-nbe.html#24070" class="Bound">Δ</a><a id="24143" class="Symbol">}</a> <a id="24145" class="Symbol">{</a><a id="24146" href="lagda.2023-11-21-nbe.html#24146" class="Bound">ρ</a> <a id="24148" class="Symbol">:</a> <a id="24150" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="24154" href="lagda.2023-11-21-nbe.html#24070" class="Bound">Δ</a> <a id="24156" href="lagda.2023-11-21-nbe.html#24072" class="Bound">Σ</a><a id="24157" class="Symbol">}</a>
                         <a id="24184" class="Symbol">{</a><a id="24185" href="lagda.2023-11-21-nbe.html#24185" class="Bound">ρ′</a> <a id="24188" class="Symbol">:</a> <a id="24190" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="24194" href="lagda.2023-11-21-nbe.html#24068" class="Bound">Γ</a> <a id="24196" href="lagda.2023-11-21-nbe.html#24074" class="Bound">Φ</a> <a id="24198" class="Symbol">}</a> <a id="24200" class="Symbol">{</a><a id="24201" href="lagda.2023-11-21-nbe.html#24201" class="Bound">σ′</a> <a id="24204" class="Symbol">:</a> <a id="24206" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="24210" href="lagda.2023-11-21-nbe.html#24074" class="Bound">Φ</a> <a id="24212" href="lagda.2023-11-21-nbe.html#24072" class="Bound">Σ</a><a id="24213" class="Symbol">}</a>
                     <a id="24236" class="Symbol">→</a> <a id="24238" class="Symbol">(∀</a> <a id="24241" class="Symbol">{</a><a id="24242" href="lagda.2023-11-21-nbe.html#24242" class="Bound">S</a> <a id="24244" class="Symbol">:</a> <a id="24246" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="24250" class="Symbol">}</a> <a id="24252" class="Symbol">{</a><a id="24253" href="lagda.2023-11-21-nbe.html#24253" class="Bound">x</a> <a id="24255" class="Symbol">:</a> <a id="24257" href="lagda.2023-11-21-nbe.html#24072" class="Bound">Σ</a> <a id="24259" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="24261" href="lagda.2023-11-21-nbe.html#24242" class="Bound">S</a><a id="24262" class="Symbol">}</a> <a id="24264" class="Symbol">→</a> <a id="24266" href="lagda.2023-11-21-nbe.html#24132" class="Bound">σ</a> <a id="24268" class="Symbol">(</a><a id="24269" href="lagda.2023-11-21-nbe.html#24146" class="Bound">ρ</a> <a id="24271" href="lagda.2023-11-21-nbe.html#24253" class="Bound">x</a><a id="24272" class="Symbol">)</a> <a id="24274" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="24276" href="lagda.2023-11-21-nbe.html#24201" class="Bound">σ′</a> <a id="24279" href="lagda.2023-11-21-nbe.html#24253" class="Bound">x</a> <a id="24281" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">[</a> <a id="24283" href="lagda.2023-11-21-nbe.html#24185" class="Bound">ρ′</a> <a id="24286" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">]ʳ</a><a id="24288" class="Symbol">)</a>
                     <a id="24311" class="Symbol">→</a> <a id="24313" href="lagda.2023-11-21-nbe.html#24095" class="Bound">t</a> <a id="24315" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">[</a> <a id="24317" href="lagda.2023-11-21-nbe.html#24146" class="Bound">ρ</a> <a id="24319" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">]ʳ</a> <a id="24322" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="24324" href="lagda.2023-11-21-nbe.html#24132" class="Bound">σ</a> <a id="24326" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a> <a id="24328" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="24330" href="lagda.2023-11-21-nbe.html#24095" class="Bound">t</a> <a id="24332" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="24334" href="lagda.2023-11-21-nbe.html#24201" class="Bound">σ′</a> <a id="24337" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a> <a id="24339" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">[</a> <a id="24341" href="lagda.2023-11-21-nbe.html#24185" class="Bound">ρ′</a> <a id="24344" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">]ʳ</a>
<a id="24347" href="lagda.2023-11-21-nbe.html#24042" class="Function">commute-subst-rename</a> <a id="24368" class="Symbol">{</a><a id="24369" class="Argument">t</a> <a id="24371" class="Symbol">=</a> <a id="24373" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a><a id="24377" class="Symbol">}</a> <a id="24379" href="lagda.2023-11-21-nbe.html#24379" class="Bound">pf</a> <a id="24382" class="Symbol">=</a> <a id="24384" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="24389" href="lagda.2023-11-21-nbe.html#24042" class="Function">commute-subst-rename</a> <a id="24410" class="Symbol">{</a><a id="24411" class="Argument">t</a> <a id="24413" class="Symbol">=</a> <a id="24415" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="24417" href="lagda.2023-11-21-nbe.html#24417" class="Bound">x</a><a id="24418" class="Symbol">}</a> <a id="24420" href="lagda.2023-11-21-nbe.html#24420" class="Bound">pf</a> <a id="24423" class="Symbol">=</a> <a id="24425" href="lagda.2023-11-21-nbe.html#24420" class="Bound">pf</a>
<a id="24428" href="lagda.2023-11-21-nbe.html#24042" class="Function">commute-subst-rename</a> <a id="24449" class="Symbol">{</a><a id="24450" class="Argument">Σ</a> <a id="24452" class="Symbol">=</a> <a id="24454" href="lagda.2023-11-21-nbe.html#24454" class="Bound">Σ</a><a id="24455" class="Symbol">}</a> <a id="24457" class="Symbol">{</a><a id="24458" class="Argument">T</a> <a id="24460" class="Symbol">=</a> <a id="24462" href="lagda.2023-11-21-nbe.html#24462" class="Bound">S</a> <a id="24464" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="24466" href="lagda.2023-11-21-nbe.html#24466" class="Bound">T</a><a id="24467" class="Symbol">}</a> <a id="24469" class="Symbol">{</a><a id="24470" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="24472" href="lagda.2023-11-21-nbe.html#24472" class="Bound">t</a><a id="24473" class="Symbol">}</a> <a id="24475" class="Symbol">{</a><a id="24476" href="lagda.2023-11-21-nbe.html#24476" class="Bound">σ</a><a id="24477" class="Symbol">}</a> <a id="24479" class="Symbol">{</a><a id="24480" href="lagda.2023-11-21-nbe.html#24480" class="Bound">ρ</a><a id="24481" class="Symbol">}</a> <a id="24483" class="Symbol">{</a><a id="24484" href="lagda.2023-11-21-nbe.html#24484" class="Bound">ρ′</a><a id="24486" class="Symbol">}</a> <a id="24488" class="Symbol">{</a><a id="24489" href="lagda.2023-11-21-nbe.html#24489" class="Bound">σ′</a><a id="24491" class="Symbol">}</a> <a id="24493" href="lagda.2023-11-21-nbe.html#24493" class="Bound">pf</a> <a id="24496" class="Symbol">=</a>
  <a id="24500" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="24505" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ_</a> <a id="24508" class="Symbol">(</a><a id="24509" href="lagda.2023-11-21-nbe.html#24042" class="Function">commute-subst-rename</a> <a id="24530" class="Symbol">{</a><a id="24531" class="Argument">t</a> <a id="24533" class="Symbol">=</a> <a id="24535" href="lagda.2023-11-21-nbe.html#24472" class="Bound">t</a><a id="24536" class="Symbol">}</a> <a id="24538" class="Symbol">(λ</a> <a id="24541" class="Symbol">{</a><a id="24542" href="lagda.2023-11-21-nbe.html#24542" class="Bound">_</a><a id="24543" class="Symbol">}</a> <a id="24545" class="Symbol">{</a><a id="24546" href="lagda.2023-11-21-nbe.html#24546" class="Bound">x</a><a id="24547" class="Symbol">}</a> <a id="24549" class="Symbol">→</a> <a id="24551" href="lagda.2023-11-21-nbe.html#24569" class="Function">H</a> <a id="24553" href="lagda.2023-11-21-nbe.html#24546" class="Bound">x</a><a id="24554" class="Symbol">))</a>
  <a id="24559" class="Keyword">where</a>
    <a id="24569" href="lagda.2023-11-21-nbe.html#24569" class="Function">H</a> <a id="24571" class="Symbol">:</a> <a id="24573" class="Symbol">∀</a> <a id="24575" class="Symbol">{</a><a id="24576" href="lagda.2023-11-21-nbe.html#24576" class="Bound">U</a> <a id="24578" class="Symbol">:</a> <a id="24580" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="24584" class="Symbol">}</a> <a id="24586" class="Symbol">(</a><a id="24587" href="lagda.2023-11-21-nbe.html#24587" class="Bound">x</a> <a id="24589" class="Symbol">:</a> <a id="24591" href="lagda.2023-11-21-nbe.html#24454" class="Bound">Σ</a> <a id="24593" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="24595" href="lagda.2023-11-21-nbe.html#24462" class="Bound">S</a> <a id="24597" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="24599" href="lagda.2023-11-21-nbe.html#24576" class="Bound">U</a><a id="24600" class="Symbol">)</a> <a id="24602" class="Symbol">→</a> <a id="24604" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="24609" href="lagda.2023-11-21-nbe.html#24476" class="Bound">σ</a> <a id="24611" class="Symbol">(</a><a id="24612" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="24616" href="lagda.2023-11-21-nbe.html#24480" class="Bound">ρ</a> <a id="24618" href="lagda.2023-11-21-nbe.html#24587" class="Bound">x</a><a id="24619" class="Symbol">)</a> <a id="24621" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="24623" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="24628" href="lagda.2023-11-21-nbe.html#24489" class="Bound">σ′</a> <a id="24631" href="lagda.2023-11-21-nbe.html#24587" class="Bound">x</a> <a id="24633" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">[</a> <a id="24635" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="24639" href="lagda.2023-11-21-nbe.html#24484" class="Bound">ρ′</a> <a id="24642" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">]ʳ</a>
    <a id="24649" href="lagda.2023-11-21-nbe.html#24569" class="Function">H</a> <a id="24651" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a> <a id="24653" class="Symbol">=</a> <a id="24655" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
    <a id="24664" href="lagda.2023-11-21-nbe.html#24569" class="Function">H</a> <a id="24666" class="Symbol">(</a><a id="24667" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="24669" href="lagda.2023-11-21-nbe.html#24669" class="Bound">x</a><a id="24670" class="Symbol">)</a> <a id="24672" class="Keyword">rewrite</a> <a id="24680" href="lagda.2023-11-21-nbe.html#24493" class="Bound">pf</a> <a id="24683" class="Symbol">{</a><a id="24684" class="Argument">x</a> <a id="24686" class="Symbol">=</a> <a id="24688" href="lagda.2023-11-21-nbe.html#24669" class="Bound">x</a><a id="24689" class="Symbol">}</a>
                  <a id="24709" class="Symbol">|</a> <a id="24711" href="lagda.2023-11-21-nbe.html#23471" class="Function">compose-rename</a> <a id="24726" class="Symbol">{</a><a id="24727" class="Argument">t</a> <a id="24729" class="Symbol">=</a> <a id="24731" href="lagda.2023-11-21-nbe.html#24489" class="Bound">σ′</a> <a id="24734" href="lagda.2023-11-21-nbe.html#24669" class="Bound">x</a><a id="24735" class="Symbol">}</a> <a id="24737" class="Symbol">{</a><a id="24738" href="lagda.2023-11-21-nbe.html#13230" class="Function">↥ʳ</a> <a id="24741" class="Symbol">{</a><a id="24742" class="Argument">T</a> <a id="24744" class="Symbol">=</a> <a id="24746" href="lagda.2023-11-21-nbe.html#24462" class="Bound">S</a><a id="24747" class="Symbol">}}</a> <a id="24750" class="Symbol">{</a><a id="24751" href="lagda.2023-11-21-nbe.html#24484" class="Bound">ρ′</a><a id="24753" class="Symbol">}</a>
                  <a id="24773" class="Symbol">|</a> <a id="24775" href="lagda.2023-11-21-nbe.html#23471" class="Function">compose-rename</a> <a id="24790" class="Symbol">{</a><a id="24791" class="Argument">t</a> <a id="24793" class="Symbol">=</a> <a id="24795" href="lagda.2023-11-21-nbe.html#24489" class="Bound">σ′</a> <a id="24798" href="lagda.2023-11-21-nbe.html#24669" class="Bound">x</a><a id="24799" class="Symbol">}</a> <a id="24801" class="Symbol">{</a><a id="24802" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="24806" href="lagda.2023-11-21-nbe.html#24484" class="Bound">ρ′</a> <a id="24809" class="Symbol">{</a><a id="24810" href="lagda.2023-11-21-nbe.html#24462" class="Bound">S</a><a id="24811" class="Symbol">}}</a> <a id="24814" class="Symbol">{</a><a id="24815" href="lagda.2023-11-21-nbe.html#13230" class="Function">↥ʳ</a><a id="24817" class="Symbol">}</a> <a id="24819" class="Symbol">=</a> <a id="24821" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="24826" href="lagda.2023-11-21-nbe.html#24042" class="Function">commute-subst-rename</a> <a id="24847" class="Symbol">{</a><a id="24848" class="Argument">t</a> <a id="24850" class="Symbol">=</a> <a id="24852" href="lagda.2023-11-21-nbe.html#24852" class="Bound">r</a> <a id="24854" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="24856" href="lagda.2023-11-21-nbe.html#24856" class="Bound">s</a><a id="24857" class="Symbol">}</a> <a id="24859" class="Symbol">{</a><a id="24860" href="lagda.2023-11-21-nbe.html#24860" class="Bound">σ</a><a id="24861" class="Symbol">}</a> <a id="24863" class="Symbol">{</a><a id="24864" href="lagda.2023-11-21-nbe.html#24864" class="Bound">ρ</a><a id="24865" class="Symbol">}</a> <a id="24867" class="Symbol">{</a><a id="24868" href="lagda.2023-11-21-nbe.html#24868" class="Bound">ρ′</a><a id="24870" class="Symbol">}</a> <a id="24872" class="Symbol">{</a><a id="24873" href="lagda.2023-11-21-nbe.html#24873" class="Bound">σ′</a><a id="24875" class="Symbol">}</a> <a id="24877" href="lagda.2023-11-21-nbe.html#24877" class="Bound">pf</a>
  <a id="24882" class="Keyword">rewrite</a> <a id="24890" href="lagda.2023-11-21-nbe.html#24042" class="Function">commute-subst-rename</a> <a id="24911" class="Symbol">{</a><a id="24912" class="Argument">t</a> <a id="24914" class="Symbol">=</a> <a id="24916" href="lagda.2023-11-21-nbe.html#24852" class="Bound">r</a><a id="24917" class="Symbol">}</a> <a id="24919" class="Symbol">{</a><a id="24920" href="lagda.2023-11-21-nbe.html#24860" class="Bound">σ</a><a id="24921" class="Symbol">}</a> <a id="24923" class="Symbol">{</a><a id="24924" href="lagda.2023-11-21-nbe.html#24864" class="Bound">ρ</a><a id="24925" class="Symbol">}</a> <a id="24927" class="Symbol">{</a><a id="24928" href="lagda.2023-11-21-nbe.html#24868" class="Bound">ρ′</a><a id="24930" class="Symbol">}</a> <a id="24932" class="Symbol">{</a><a id="24933" href="lagda.2023-11-21-nbe.html#24873" class="Bound">σ′</a><a id="24935" class="Symbol">}</a> <a id="24937" href="lagda.2023-11-21-nbe.html#24877" class="Bound">pf</a>
        <a id="24948" class="Symbol">|</a> <a id="24950" href="lagda.2023-11-21-nbe.html#24042" class="Function">commute-subst-rename</a> <a id="24971" class="Symbol">{</a><a id="24972" class="Argument">t</a> <a id="24974" class="Symbol">=</a> <a id="24976" href="lagda.2023-11-21-nbe.html#24856" class="Bound">s</a><a id="24977" class="Symbol">}</a> <a id="24979" class="Symbol">{</a><a id="24980" href="lagda.2023-11-21-nbe.html#24860" class="Bound">σ</a><a id="24981" class="Symbol">}</a> <a id="24983" class="Symbol">{</a><a id="24984" href="lagda.2023-11-21-nbe.html#24864" class="Bound">ρ</a><a id="24985" class="Symbol">}</a> <a id="24987" class="Symbol">{</a><a id="24988" href="lagda.2023-11-21-nbe.html#24868" class="Bound">ρ′</a><a id="24990" class="Symbol">}</a> <a id="24992" class="Symbol">{</a><a id="24993" href="lagda.2023-11-21-nbe.html#24873" class="Bound">σ′</a><a id="24995" class="Symbol">}</a> <a id="24997" href="lagda.2023-11-21-nbe.html#24877" class="Bound">pf</a> <a id="25000" class="Symbol">=</a> <a id="25002" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="sub-𝑆-shift"></a><a id="25008" href="lagda.2023-11-21-nbe.html#25008" class="Function">sub-𝑆-shift</a> <a id="25020" class="Symbol">:</a> <a id="25022" class="Symbol">∀</a> <a id="25024" class="Symbol">{</a><a id="25025" href="lagda.2023-11-21-nbe.html#25025" class="Bound">Γ</a> <a id="25027" href="lagda.2023-11-21-nbe.html#25027" class="Bound">Δ</a> <a id="25029" class="Symbol">:</a> <a id="25031" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="25034" class="Symbol">}</a> <a id="25036" class="Symbol">{</a><a id="25037" href="lagda.2023-11-21-nbe.html#25037" class="Bound">S</a> <a id="25039" href="lagda.2023-11-21-nbe.html#25039" class="Bound">T</a> <a id="25041" class="Symbol">:</a> <a id="25043" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="25047" class="Symbol">}</a> <a id="25049" class="Symbol">{</a><a id="25050" href="lagda.2023-11-21-nbe.html#25050" class="Bound">σ</a> <a id="25052" class="Symbol">:</a> <a id="25054" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="25058" href="lagda.2023-11-21-nbe.html#25025" class="Bound">Γ</a> <a id="25060" class="Symbol">(</a><a id="25061" href="lagda.2023-11-21-nbe.html#25027" class="Bound">Δ</a> <a id="25063" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="25065" href="lagda.2023-11-21-nbe.html#25037" class="Bound">S</a><a id="25066" class="Symbol">)}</a> <a id="25069" class="Symbol">{</a><a id="25070" href="lagda.2023-11-21-nbe.html#25070" class="Bound">x</a> <a id="25072" class="Symbol">:</a> <a id="25074" href="lagda.2023-11-21-nbe.html#25027" class="Bound">Δ</a> <a id="25076" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="25078" href="lagda.2023-11-21-nbe.html#25039" class="Bound">T</a><a id="25079" class="Symbol">}</a>
            <a id="25093" class="Symbol">→</a> <a id="25095" href="lagda.2023-11-21-nbe.html#25050" class="Bound">σ</a> <a id="25097" class="Symbol">(</a><a id="25098" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆_</a> <a id="25101" class="Symbol">{</a><a id="25102" class="Argument">T</a> <a id="25104" class="Symbol">=</a> <a id="25106" href="lagda.2023-11-21-nbe.html#25039" class="Bound">T</a><a id="25107" class="Symbol">}</a> <a id="25109" href="lagda.2023-11-21-nbe.html#25070" class="Bound">x</a><a id="25110" class="Symbol">)</a> <a id="25112" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="25114" class="Symbol">(</a><a id="25115" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a> <a id="25117" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="25119" href="lagda.2023-11-21-nbe.html#25050" class="Bound">σ</a><a id="25120" class="Symbol">)</a> <a id="25122" href="lagda.2023-11-21-nbe.html#25070" class="Bound">x</a>
<a id="25124" href="lagda.2023-11-21-nbe.html#25008" class="Function">sub-𝑆-shift</a> <a id="25136" class="Symbol">=</a> <a id="25138" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="exts-seq"></a><a id="25144" href="lagda.2023-11-21-nbe.html#25144" class="Function">exts-seq</a> <a id="25153" class="Symbol">:</a> <a id="25155" class="Symbol">∀</a> <a id="25157" class="Symbol">{</a><a id="25158" href="lagda.2023-11-21-nbe.html#25158" class="Bound">Γ</a> <a id="25160" href="lagda.2023-11-21-nbe.html#25160" class="Bound">Δ</a> <a id="25162" href="lagda.2023-11-21-nbe.html#25162" class="Bound">Σ</a> <a id="25164" class="Symbol">:</a> <a id="25166" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="25169" class="Symbol">}</a> <a id="25171" class="Symbol">{</a><a id="25172" href="lagda.2023-11-21-nbe.html#25172" class="Bound">τ</a> <a id="25174" class="Symbol">:</a> <a id="25176" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="25180" href="lagda.2023-11-21-nbe.html#25158" class="Bound">Γ</a> <a id="25182" href="lagda.2023-11-21-nbe.html#25160" class="Bound">Δ</a><a id="25183" class="Symbol">}</a> <a id="25185" class="Symbol">{</a><a id="25186" href="lagda.2023-11-21-nbe.html#25186" class="Bound">σ</a> <a id="25188" class="Symbol">:</a> <a id="25190" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="25194" href="lagda.2023-11-21-nbe.html#25160" class="Bound">Δ</a> <a id="25196" href="lagda.2023-11-21-nbe.html#25162" class="Bound">Σ</a><a id="25197" class="Symbol">}</a> <a id="25199" class="Symbol">{</a><a id="25200" href="lagda.2023-11-21-nbe.html#25200" class="Bound">S</a> <a id="25202" class="Symbol">:</a> <a id="25204" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="25208" class="Symbol">}</a>
         <a id="25219" class="Symbol">→</a> <a id="25221" class="Symbol">∀</a> <a id="25223" class="Symbol">{</a><a id="25224" href="lagda.2023-11-21-nbe.html#25224" class="Bound">T</a> <a id="25226" class="Symbol">:</a> <a id="25228" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="25232" class="Symbol">}</a> <a id="25234" class="Symbol">→</a> <a id="25236" class="Symbol">(</a><a id="25237" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="25242" href="lagda.2023-11-21-nbe.html#25186" class="Bound">σ</a> <a id="25244" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="25246" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="25251" href="lagda.2023-11-21-nbe.html#25172" class="Bound">τ</a><a id="25252" class="Symbol">)</a> <a id="25254" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="25256" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="25261" class="Symbol">(</a><a id="25262" href="lagda.2023-11-21-nbe.html#25186" class="Bound">σ</a> <a id="25264" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="25266" href="lagda.2023-11-21-nbe.html#25172" class="Bound">τ</a><a id="25267" class="Symbol">)</a> <a id="25269" class="Symbol">{</a><a id="25270" href="lagda.2023-11-21-nbe.html#25200" class="Bound">S</a><a id="25271" class="Symbol">}</a> <a id="25273" class="Symbol">{</a><a id="25274" href="lagda.2023-11-21-nbe.html#25224" class="Bound">T</a><a id="25275" class="Symbol">}</a>
<a id="25277" href="lagda.2023-11-21-nbe.html#25144" class="Function">exts-seq</a> <a id="25286" class="Symbol">{</a><a id="25287" class="Argument">Σ</a> <a id="25289" class="Symbol">=</a> <a id="25291" href="lagda.2023-11-21-nbe.html#25291" class="Bound">Σ</a><a id="25292" class="Symbol">}</a> <a id="25294" class="Symbol">{</a><a id="25295" href="lagda.2023-11-21-nbe.html#25295" class="Bound">τ</a><a id="25296" class="Symbol">}</a> <a id="25298" class="Symbol">{</a><a id="25299" href="lagda.2023-11-21-nbe.html#25299" class="Bound">σ</a><a id="25300" class="Symbol">}</a> <a id="25302" class="Symbol">{</a><a id="25303" href="lagda.2023-11-21-nbe.html#25303" class="Bound">S</a><a id="25304" class="Symbol">}</a> <a id="25306" class="Symbol">{</a><a id="25307" href="lagda.2023-11-21-nbe.html#25307" class="Bound">T</a><a id="25308" class="Symbol">}</a> <a id="25310" class="Symbol">=</a> <a id="25312" href="lagda.2023-11-21-nbe.html#2744" class="Postulate">extensionality</a> <a id="25327" href="lagda.2023-11-21-nbe.html#25341" class="Function">lemma</a> <a id="25333" class="Keyword">where</a>
  <a id="25341" href="lagda.2023-11-21-nbe.html#25341" class="Function">lemma</a> <a id="25347" class="Symbol">:</a> <a id="25349" class="Symbol">∀</a> <a id="25351" class="Symbol">(</a><a id="25352" href="lagda.2023-11-21-nbe.html#25352" class="Bound">x</a> <a id="25354" class="Symbol">:</a> <a id="25356" href="lagda.2023-11-21-nbe.html#25291" class="Bound">Σ</a> <a id="25358" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="25360" href="lagda.2023-11-21-nbe.html#25303" class="Bound">S</a> <a id="25362" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="25364" href="lagda.2023-11-21-nbe.html#25307" class="Bound">T</a><a id="25365" class="Symbol">)</a> <a id="25367" class="Symbol">→</a> <a id="25369" class="Symbol">(</a><a id="25370" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="25375" href="lagda.2023-11-21-nbe.html#25299" class="Bound">σ</a> <a id="25377" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="25379" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="25384" href="lagda.2023-11-21-nbe.html#25295" class="Bound">τ</a><a id="25385" class="Symbol">)</a> <a id="25387" href="lagda.2023-11-21-nbe.html#25352" class="Bound">x</a> <a id="25389" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="25391" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="25396" class="Symbol">(</a><a id="25397" href="lagda.2023-11-21-nbe.html#25299" class="Bound">σ</a> <a id="25399" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="25401" href="lagda.2023-11-21-nbe.html#25295" class="Bound">τ</a><a id="25402" class="Symbol">)</a> <a id="25404" href="lagda.2023-11-21-nbe.html#25352" class="Bound">x</a>
  <a id="25408" href="lagda.2023-11-21-nbe.html#25341" class="Function">lemma</a> <a id="25414" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>  <a id="25417" class="Symbol">=</a> <a id="25419" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="25426" href="lagda.2023-11-21-nbe.html#25341" class="Function">lemma</a> <a id="25432" class="Symbol">(</a><a id="25433" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="25435" href="lagda.2023-11-21-nbe.html#25435" class="Bound">x</a><a id="25436" class="Symbol">)</a> <a id="25438" class="Keyword">rewrite</a> <a id="25446" href="lagda.2023-11-21-nbe.html#25008" class="Function">sub-𝑆-shift</a> <a id="25458" class="Symbol">{</a><a id="25459" class="Argument">S</a> <a id="25461" class="Symbol">=</a> <a id="25463" href="lagda.2023-11-21-nbe.html#25303" class="Bound">S</a><a id="25464" class="Symbol">}</a> <a id="25466" class="Symbol">{</a><a id="25467" class="Argument">σ</a> <a id="25469" class="Symbol">=</a> <a id="25471" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="25476" href="lagda.2023-11-21-nbe.html#25299" class="Bound">σ</a> <a id="25478" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="25480" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="25485" href="lagda.2023-11-21-nbe.html#25295" class="Bound">τ</a><a id="25486" class="Symbol">}</a> <a id="25488" class="Symbol">{</a><a id="25489" href="lagda.2023-11-21-nbe.html#25435" class="Bound">x</a><a id="25490" class="Symbol">}</a> <a id="25492" class="Symbol">=</a>
    <a id="25498" href="lagda.2023-11-21-nbe.html#24042" class="Function">commute-subst-rename</a> <a id="25519" class="Symbol">{</a><a id="25520" class="Argument">t</a> <a id="25522" class="Symbol">=</a> <a id="25524" href="lagda.2023-11-21-nbe.html#25299" class="Bound">σ</a> <a id="25526" href="lagda.2023-11-21-nbe.html#25435" class="Bound">x</a><a id="25527" class="Symbol">}</a> <a id="25529" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
</pre>--->
<pre class="Agda"><a id="sub-sub"></a><a id="25552" href="lagda.2023-11-21-nbe.html#25552" class="Function">sub-sub</a> <a id="25560" class="Symbol">:</a> <a id="25562" class="Symbol">∀</a> <a id="25564" class="Symbol">{</a><a id="25565" href="lagda.2023-11-21-nbe.html#25565" class="Bound">Γ</a> <a id="25567" href="lagda.2023-11-21-nbe.html#25567" class="Bound">Δ</a> <a id="25569" href="lagda.2023-11-21-nbe.html#25569" class="Bound">Σ</a> <a id="25571" class="Symbol">:</a> <a id="25573" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="25576" class="Symbol">}</a> <a id="25578" class="Symbol">{</a><a id="25579" href="lagda.2023-11-21-nbe.html#25579" class="Bound">T</a> <a id="25581" class="Symbol">:</a> <a id="25583" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="25587" class="Symbol">}</a> <a id="25589" class="Symbol">{</a><a id="25590" href="lagda.2023-11-21-nbe.html#25590" class="Bound">τ</a> <a id="25592" class="Symbol">:</a> <a id="25594" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="25598" href="lagda.2023-11-21-nbe.html#25565" class="Bound">Γ</a> <a id="25600" href="lagda.2023-11-21-nbe.html#25567" class="Bound">Δ</a><a id="25601" class="Symbol">}</a> <a id="25603" class="Symbol">{</a><a id="25604" href="lagda.2023-11-21-nbe.html#25604" class="Bound">σ</a> <a id="25606" class="Symbol">:</a> <a id="25608" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="25612" href="lagda.2023-11-21-nbe.html#25567" class="Bound">Δ</a> <a id="25614" href="lagda.2023-11-21-nbe.html#25569" class="Bound">Σ</a><a id="25615" class="Symbol">}</a>
            <a id="25629" class="Symbol">{</a><a id="25630" href="lagda.2023-11-21-nbe.html#25630" class="Bound">t</a> <a id="25632" class="Symbol">:</a> <a id="25634" href="lagda.2023-11-21-nbe.html#25569" class="Bound">Σ</a> <a id="25636" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="25638" href="lagda.2023-11-21-nbe.html#25579" class="Bound">T</a><a id="25639" class="Symbol">}</a>
        <a id="25649" class="Symbol">→</a> <a id="25651" href="lagda.2023-11-21-nbe.html#25630" class="Bound">t</a> <a id="25653" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="25655" href="lagda.2023-11-21-nbe.html#25604" class="Bound">σ</a> <a id="25657" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a> <a id="25659" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="25661" href="lagda.2023-11-21-nbe.html#25590" class="Bound">τ</a> <a id="25663" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a> <a id="25665" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="25667" href="lagda.2023-11-21-nbe.html#25630" class="Bound">t</a> <a id="25669" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="25671" href="lagda.2023-11-21-nbe.html#25604" class="Bound">σ</a> <a id="25673" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="25675" href="lagda.2023-11-21-nbe.html#25590" class="Bound">τ</a> <a id="25677" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a>
</pre>
<!---
<pre class="Agda"><a id="25698" href="lagda.2023-11-21-nbe.html#25552" class="Function">sub-sub</a> <a id="25706" class="Symbol">{</a><a id="25707" class="Argument">t</a> <a id="25709" class="Symbol">=</a> <a id="25711" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a><a id="25715" class="Symbol">}</a> <a id="25717" class="Symbol">=</a> <a id="25719" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="25724" href="lagda.2023-11-21-nbe.html#25552" class="Function">sub-sub</a> <a id="25732" class="Symbol">{</a><a id="25733" class="Argument">t</a> <a id="25735" class="Symbol">=</a> <a id="25737" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="25739" href="lagda.2023-11-21-nbe.html#25739" class="Bound">x</a><a id="25740" class="Symbol">}</a> <a id="25742" class="Symbol">=</a> <a id="25744" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="25749" href="lagda.2023-11-21-nbe.html#25552" class="Function">sub-sub</a> <a id="25757" class="Symbol">{</a><a id="25758" class="Argument">τ</a> <a id="25760" class="Symbol">=</a> <a id="25762" href="lagda.2023-11-21-nbe.html#25762" class="Bound">τ</a><a id="25763" class="Symbol">}</a> <a id="25765" class="Symbol">{</a><a id="25766" href="lagda.2023-11-21-nbe.html#25766" class="Bound">σ</a><a id="25767" class="Symbol">}</a> <a id="25769" class="Symbol">{</a><a id="25770" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="25772" href="lagda.2023-11-21-nbe.html#25772" class="Bound">t</a><a id="25773" class="Symbol">}</a> <a id="25775" class="Symbol">=</a>
  <a id="25779" href="Relation.Binary.PropositionalEquality.Core.html#2806" class="Function Operator">begin</a>
    <a id="25789" class="Symbol">(</a><a id="25790" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="25792" href="lagda.2023-11-21-nbe.html#25772" class="Bound">t</a><a id="25793" class="Symbol">)</a> <a id="25795" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="25797" href="lagda.2023-11-21-nbe.html#25766" class="Bound">σ</a> <a id="25799" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a> <a id="25801" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="25803" href="lagda.2023-11-21-nbe.html#25762" class="Bound">τ</a> <a id="25805" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a>
  <a id="25809" href="Relation.Binary.PropositionalEquality.Core.html#2864" class="Function Operator">≡⟨⟩</a>
    <a id="25817" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="25819" href="lagda.2023-11-21-nbe.html#25772" class="Bound">t</a> <a id="25821" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="25823" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="25828" href="lagda.2023-11-21-nbe.html#25766" class="Bound">σ</a> <a id="25830" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a> <a id="25832" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="25834" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="25839" href="lagda.2023-11-21-nbe.html#25762" class="Bound">τ</a> <a id="25841" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a>
  <a id="25845" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="25848" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="25853" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ_</a> <a id="25856" class="Symbol">(</a><a id="25857" href="lagda.2023-11-21-nbe.html#25552" class="Function">sub-sub</a> <a id="25865" class="Symbol">{</a><a id="25866" class="Argument">τ</a> <a id="25868" class="Symbol">=</a> <a id="25870" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="25875" href="lagda.2023-11-21-nbe.html#25762" class="Bound">τ</a><a id="25876" class="Symbol">}</a> <a id="25878" class="Symbol">{</a><a id="25879" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="25884" href="lagda.2023-11-21-nbe.html#25766" class="Bound">σ</a><a id="25885" class="Symbol">}</a> <a id="25887" class="Symbol">{</a><a id="25888" href="lagda.2023-11-21-nbe.html#25772" class="Bound">t</a><a id="25889" class="Symbol">})</a> <a id="25892" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
    <a id="25898" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="25900" href="lagda.2023-11-21-nbe.html#25772" class="Bound">t</a> <a id="25902" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="25904" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="25909" href="lagda.2023-11-21-nbe.html#25766" class="Bound">σ</a> <a id="25911" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="25913" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="25918" href="lagda.2023-11-21-nbe.html#25762" class="Bound">τ</a> <a id="25920" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a>
  <a id="25924" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="25927" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="25932" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ_</a> <a id="25935" class="Symbol">(</a><a id="25936" href="lagda.2023-11-21-nbe.html#19474" class="Function">cong-sub</a> <a id="25945" class="Symbol">{</a><a id="25946" class="Argument">t</a> <a id="25948" class="Symbol">=</a> <a id="25950" href="lagda.2023-11-21-nbe.html#25772" class="Bound">t</a><a id="25951" class="Symbol">}</a> <a id="25953" href="lagda.2023-11-21-nbe.html#25144" class="Function">exts-seq</a> <a id="25962" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="25966" class="Symbol">)</a> <a id="25968" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
    <a id="25974" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="25976" href="lagda.2023-11-21-nbe.html#25772" class="Bound">t</a> <a id="25978" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="25980" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="25985" class="Symbol">(</a><a id="25986" href="lagda.2023-11-21-nbe.html#25766" class="Bound">σ</a> <a id="25988" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="25990" href="lagda.2023-11-21-nbe.html#25762" class="Bound">τ</a><a id="25991" class="Symbol">)</a> <a id="25993" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a>
  <a id="25997" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>
<a id="25999" href="lagda.2023-11-21-nbe.html#25552" class="Function">sub-sub</a> <a id="26007" class="Symbol">{</a><a id="26008" class="Argument">τ</a> <a id="26010" class="Symbol">=</a> <a id="26012" href="lagda.2023-11-21-nbe.html#26012" class="Bound">τ</a><a id="26013" class="Symbol">}</a> <a id="26015" class="Symbol">{</a><a id="26016" href="lagda.2023-11-21-nbe.html#26016" class="Bound">σ</a><a id="26017" class="Symbol">}</a> <a id="26019" class="Symbol">{</a><a id="26020" href="lagda.2023-11-21-nbe.html#26020" class="Bound">r</a> <a id="26022" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="26024" href="lagda.2023-11-21-nbe.html#26024" class="Bound">s</a><a id="26025" class="Symbol">}</a>
  <a id="26029" class="Keyword">rewrite</a> <a id="26037" href="lagda.2023-11-21-nbe.html#25552" class="Function">sub-sub</a> <a id="26045" class="Symbol">{</a><a id="26046" class="Argument">τ</a> <a id="26048" class="Symbol">=</a> <a id="26050" href="lagda.2023-11-21-nbe.html#26012" class="Bound">τ</a><a id="26051" class="Symbol">}</a> <a id="26053" class="Symbol">{</a><a id="26054" href="lagda.2023-11-21-nbe.html#26016" class="Bound">σ</a><a id="26055" class="Symbol">}</a> <a id="26057" class="Symbol">{</a><a id="26058" href="lagda.2023-11-21-nbe.html#26020" class="Bound">r</a><a id="26059" class="Symbol">}</a> <a id="26061" class="Symbol">|</a> <a id="26063" href="lagda.2023-11-21-nbe.html#25552" class="Function">sub-sub</a> <a id="26071" class="Symbol">{</a><a id="26072" class="Argument">τ</a> <a id="26074" class="Symbol">=</a> <a id="26076" href="lagda.2023-11-21-nbe.html#26012" class="Bound">τ</a><a id="26077" class="Symbol">}</a> <a id="26079" class="Symbol">{</a><a id="26080" href="lagda.2023-11-21-nbe.html#26016" class="Bound">σ</a><a id="26081" class="Symbol">}</a> <a id="26083" class="Symbol">{</a><a id="26084" href="lagda.2023-11-21-nbe.html#26024" class="Bound">s</a><a id="26085" class="Symbol">}</a> <a id="26087" class="Symbol">=</a> <a id="26089" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="sub-assoc"></a><a id="26095" href="lagda.2023-11-21-nbe.html#26095" class="Function">sub-assoc</a> <a id="26105" class="Symbol">:</a> <a id="26107" class="Symbol">∀</a> <a id="26109" class="Symbol">{</a><a id="26110" href="lagda.2023-11-21-nbe.html#26110" class="Bound">Γ</a> <a id="26112" href="lagda.2023-11-21-nbe.html#26112" class="Bound">Δ</a> <a id="26114" href="lagda.2023-11-21-nbe.html#26114" class="Bound">Σ</a> <a id="26116" href="lagda.2023-11-21-nbe.html#26116" class="Bound">Φ</a> <a id="26118" class="Symbol">:</a> <a id="26120" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="26123" class="Symbol">}</a> <a id="26125" class="Symbol">{</a><a id="26126" href="lagda.2023-11-21-nbe.html#26126" class="Bound">σ</a> <a id="26128" class="Symbol">:</a> <a id="26130" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="26134" href="lagda.2023-11-21-nbe.html#26112" class="Bound">Δ</a> <a id="26136" href="lagda.2023-11-21-nbe.html#26110" class="Bound">Γ</a><a id="26137" class="Symbol">}</a> <a id="26139" class="Symbol">{</a><a id="26140" href="lagda.2023-11-21-nbe.html#26140" class="Bound">τ</a> <a id="26142" class="Symbol">:</a> <a id="26144" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="26148" href="lagda.2023-11-21-nbe.html#26114" class="Bound">Σ</a> <a id="26150" href="lagda.2023-11-21-nbe.html#26112" class="Bound">Δ</a><a id="26151" class="Symbol">}</a> <a id="26153" class="Symbol">{</a><a id="26154" href="lagda.2023-11-21-nbe.html#26154" class="Bound">θ</a> <a id="26156" class="Symbol">:</a> <a id="26158" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="26162" href="lagda.2023-11-21-nbe.html#26116" class="Bound">Φ</a> <a id="26164" href="lagda.2023-11-21-nbe.html#26114" class="Bound">Σ</a><a id="26165" class="Symbol">}</a>
          <a id="26177" class="Symbol">→</a> <a id="26179" class="Symbol">∀</a> <a id="26181" class="Symbol">{</a><a id="26182" href="lagda.2023-11-21-nbe.html#26182" class="Bound">T</a> <a id="26184" class="Symbol">:</a> <a id="26186" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="26190" class="Symbol">}</a> <a id="26192" class="Symbol">→</a> <a id="26194" class="Symbol">(</a><a id="26195" href="lagda.2023-11-21-nbe.html#26126" class="Bound">σ</a> <a id="26197" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="26199" href="lagda.2023-11-21-nbe.html#26140" class="Bound">τ</a><a id="26200" class="Symbol">)</a> <a id="26202" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="26204" href="lagda.2023-11-21-nbe.html#26154" class="Bound">θ</a> <a id="26206" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="26208" class="Symbol">(</a><a id="26209" href="lagda.2023-11-21-nbe.html#26126" class="Bound">σ</a> <a id="26211" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="26213" href="lagda.2023-11-21-nbe.html#26140" class="Bound">τ</a> <a id="26215" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="26217" href="lagda.2023-11-21-nbe.html#26154" class="Bound">θ</a><a id="26218" class="Symbol">)</a> <a id="26220" class="Symbol">{</a><a id="26221" href="lagda.2023-11-21-nbe.html#26182" class="Bound">T</a><a id="26222" class="Symbol">}</a>
<a id="26224" href="lagda.2023-11-21-nbe.html#26095" class="Function">sub-assoc</a> <a id="26234" class="Symbol">{</a><a id="26235" href="lagda.2023-11-21-nbe.html#26235" class="Bound">Γ</a><a id="26236" class="Symbol">}</a> <a id="26238" class="Symbol">{</a><a id="26239" class="Argument">σ</a> <a id="26241" class="Symbol">=</a> <a id="26243" href="lagda.2023-11-21-nbe.html#26243" class="Bound">σ</a><a id="26244" class="Symbol">}</a> <a id="26246" class="Symbol">{</a><a id="26247" href="lagda.2023-11-21-nbe.html#26247" class="Bound">τ</a><a id="26248" class="Symbol">}</a> <a id="26250" class="Symbol">{</a><a id="26251" href="lagda.2023-11-21-nbe.html#26251" class="Bound">θ</a><a id="26252" class="Symbol">}</a> <a id="26254" class="Symbol">{</a><a id="26255" href="lagda.2023-11-21-nbe.html#26255" class="Bound">T</a><a id="26256" class="Symbol">}</a> <a id="26258" class="Symbol">=</a> <a id="26260" href="lagda.2023-11-21-nbe.html#2744" class="Postulate">extensionality</a> <a id="26275" href="lagda.2023-11-21-nbe.html#26289" class="Function">lemma</a> <a id="26281" class="Keyword">where</a>
  <a id="26289" href="lagda.2023-11-21-nbe.html#26289" class="Function">lemma</a> <a id="26295" class="Symbol">:</a> <a id="26297" class="Symbol">∀</a> <a id="26299" class="Symbol">(</a><a id="26300" href="lagda.2023-11-21-nbe.html#26300" class="Bound">x</a> <a id="26302" class="Symbol">:</a> <a id="26304" href="lagda.2023-11-21-nbe.html#26235" class="Bound">Γ</a> <a id="26306" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="26308" href="lagda.2023-11-21-nbe.html#26255" class="Bound">T</a><a id="26309" class="Symbol">)</a> <a id="26311" class="Symbol">→</a> <a id="26313" class="Symbol">((</a><a id="26315" href="lagda.2023-11-21-nbe.html#26243" class="Bound">σ</a> <a id="26317" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="26319" href="lagda.2023-11-21-nbe.html#26247" class="Bound">τ</a><a id="26320" class="Symbol">)</a> <a id="26322" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="26324" href="lagda.2023-11-21-nbe.html#26251" class="Bound">θ</a><a id="26325" class="Symbol">)</a> <a id="26327" href="lagda.2023-11-21-nbe.html#26300" class="Bound">x</a> <a id="26329" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="26331" class="Symbol">(</a><a id="26332" href="lagda.2023-11-21-nbe.html#26243" class="Bound">σ</a> <a id="26334" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="26336" href="lagda.2023-11-21-nbe.html#26247" class="Bound">τ</a> <a id="26338" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="26340" href="lagda.2023-11-21-nbe.html#26251" class="Bound">θ</a><a id="26341" class="Symbol">)</a> <a id="26343" href="lagda.2023-11-21-nbe.html#26300" class="Bound">x</a>
  <a id="26347" href="lagda.2023-11-21-nbe.html#26289" class="Function">lemma</a> <a id="26353" href="lagda.2023-11-21-nbe.html#26353" class="Bound">x</a> <a id="26355" class="Keyword">rewrite</a> <a id="26363" href="lagda.2023-11-21-nbe.html#25552" class="Function">sub-sub</a> <a id="26371" class="Symbol">{</a><a id="26372" class="Argument">τ</a> <a id="26374" class="Symbol">=</a> <a id="26376" href="lagda.2023-11-21-nbe.html#26251" class="Bound">θ</a><a id="26377" class="Symbol">}</a> <a id="26379" class="Symbol">{</a><a id="26380" href="lagda.2023-11-21-nbe.html#26247" class="Bound">τ</a><a id="26381" class="Symbol">}</a> <a id="26383" class="Symbol">{</a><a id="26384" class="Argument">t</a> <a id="26386" class="Symbol">=</a> <a id="26388" href="lagda.2023-11-21-nbe.html#26243" class="Bound">σ</a> <a id="26390" href="lagda.2023-11-21-nbe.html#26353" class="Bound">x</a><a id="26391" class="Symbol">}</a> <a id="26393" class="Symbol">=</a> <a id="26395" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="subst-zero-exts-cons"></a><a id="26401" href="lagda.2023-11-21-nbe.html#26401" class="Function">subst-zero-exts-cons</a> <a id="26422" class="Symbol">:</a> <a id="26424" class="Symbol">∀</a> <a id="26426" class="Symbol">{</a><a id="26427" href="lagda.2023-11-21-nbe.html#26427" class="Bound">Γ</a> <a id="26429" href="lagda.2023-11-21-nbe.html#26429" class="Bound">Δ</a> <a id="26431" class="Symbol">:</a> <a id="26433" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="26436" class="Symbol">}</a> <a id="26438" class="Symbol">{</a><a id="26439" href="lagda.2023-11-21-nbe.html#26439" class="Bound">S</a> <a id="26441" href="lagda.2023-11-21-nbe.html#26441" class="Bound">T</a> <a id="26443" class="Symbol">:</a> <a id="26445" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="26449" class="Symbol">}</a> <a id="26451" class="Symbol">{</a><a id="26452" href="lagda.2023-11-21-nbe.html#26452" class="Bound">σ</a> <a id="26454" class="Symbol">:</a> <a id="26456" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="26460" href="lagda.2023-11-21-nbe.html#26427" class="Bound">Γ</a> <a id="26462" href="lagda.2023-11-21-nbe.html#26429" class="Bound">Δ</a><a id="26463" class="Symbol">}</a> <a id="26465" class="Symbol">{</a><a id="26466" href="lagda.2023-11-21-nbe.html#26466" class="Bound">s</a> <a id="26468" class="Symbol">:</a> <a id="26470" href="lagda.2023-11-21-nbe.html#26427" class="Bound">Γ</a> <a id="26472" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="26474" href="lagda.2023-11-21-nbe.html#26439" class="Bound">S</a><a id="26475" class="Symbol">}</a>
                     <a id="26498" class="Symbol">→</a> <a id="26500" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="26505" href="lagda.2023-11-21-nbe.html#26452" class="Bound">σ</a> <a id="26507" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="26509" class="Symbol">(</a><a id="26510" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="26513" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="26515" href="lagda.2023-11-21-nbe.html#26466" class="Bound">s</a><a id="26516" class="Symbol">)</a> <a id="26518" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="26520" class="Symbol">(</a><a id="26521" href="lagda.2023-11-21-nbe.html#26452" class="Bound">σ</a> <a id="26523" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="26525" href="lagda.2023-11-21-nbe.html#26466" class="Bound">s</a><a id="26526" class="Symbol">)</a> <a id="26528" class="Symbol">{</a><a id="26529" href="lagda.2023-11-21-nbe.html#26441" class="Bound">T</a><a id="26530" class="Symbol">}</a>
<a id="26532" href="lagda.2023-11-21-nbe.html#26401" class="Function">subst-zero-exts-cons</a> <a id="26553" class="Symbol">{</a><a id="26554" class="Argument">S</a> <a id="26556" class="Symbol">=</a> <a id="26558" href="lagda.2023-11-21-nbe.html#26558" class="Bound">S</a><a id="26559" class="Symbol">}</a> <a id="26561" class="Symbol">{</a><a id="26562" href="lagda.2023-11-21-nbe.html#26562" class="Bound">T</a><a id="26563" class="Symbol">}</a> <a id="26565" class="Symbol">{</a><a id="26566" href="lagda.2023-11-21-nbe.html#26566" class="Bound">σ</a><a id="26567" class="Symbol">}</a> <a id="26569" class="Symbol">{</a><a id="26570" href="lagda.2023-11-21-nbe.html#26570" class="Bound">s</a><a id="26571" class="Symbol">}</a> <a id="26573" class="Symbol">=</a>
  <a id="26577" href="Relation.Binary.PropositionalEquality.Core.html#2806" class="Function Operator">begin</a>
    <a id="26587" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="26592" href="lagda.2023-11-21-nbe.html#26566" class="Bound">σ</a> <a id="26594" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="26596" class="Symbol">(</a><a id="26597" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="26600" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="26602" href="lagda.2023-11-21-nbe.html#26570" class="Bound">s</a><a id="26603" class="Symbol">)</a>
  <a id="26607" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="26610" href="lagda.2023-11-21-nbe.html#20470" class="Function">cong-seq</a> <a id="26619" href="lagda.2023-11-21-nbe.html#22075" class="Function">exts-cons-shift</a> <a id="26635" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="26640" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
    <a id="26646" class="Symbol">((</a><a id="26648" href="lagda.2023-11-21-nbe.html#26566" class="Bound">σ</a> <a id="26650" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="26652" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a><a id="26653" class="Symbol">)</a> <a id="26655" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="26657" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="26659" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a><a id="26660" class="Symbol">)</a> <a id="26662" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="26664" class="Symbol">(</a><a id="26665" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="26668" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="26670" href="lagda.2023-11-21-nbe.html#26570" class="Bound">s</a><a id="26671" class="Symbol">)</a>
  <a id="26675" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="26678" href="lagda.2023-11-21-nbe.html#17953" class="Function">sub-dist</a> <a id="26687" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
    <a id="26693" class="Symbol">((</a><a id="26695" href="lagda.2023-11-21-nbe.html#26566" class="Bound">σ</a> <a id="26697" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="26699" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a><a id="26700" class="Symbol">)</a> <a id="26702" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="26704" class="Symbol">(</a><a id="26705" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="26708" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="26710" href="lagda.2023-11-21-nbe.html#26570" class="Bound">s</a><a id="26711" class="Symbol">))</a> <a id="26714" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="26716" href="lagda.2023-11-21-nbe.html#26570" class="Bound">s</a>
  <a id="26720" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="26723" href="lagda.2023-11-21-nbe.html#20083" class="Function">cong-cons</a> <a id="26733" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="26738" class="Symbol">(</a><a id="26739" href="lagda.2023-11-21-nbe.html#26095" class="Function">sub-assoc</a> <a id="26749" class="Symbol">{</a><a id="26750" class="Argument">σ</a> <a id="26752" class="Symbol">=</a> <a id="26754" href="lagda.2023-11-21-nbe.html#26566" class="Bound">σ</a><a id="26755" class="Symbol">})</a> <a id="26758" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
    <a id="26764" class="Symbol">(</a><a id="26765" href="lagda.2023-11-21-nbe.html#26566" class="Bound">σ</a> <a id="26767" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="26769" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a> <a id="26771" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="26773" class="Symbol">(</a><a id="26774" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="26777" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="26779" href="lagda.2023-11-21-nbe.html#26570" class="Bound">s</a><a id="26780" class="Symbol">))</a> <a id="26783" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="26785" href="lagda.2023-11-21-nbe.html#26570" class="Bound">s</a>
  <a id="26789" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="26792" href="lagda.2023-11-21-nbe.html#20083" class="Function">cong-cons</a> <a id="26802" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="26807" class="Symbol">(</a><a id="26808" href="lagda.2023-11-21-nbe.html#20470" class="Function">cong-seq</a> <a id="26817" class="Symbol">{</a><a id="26818" class="Argument">σ</a> <a id="26820" class="Symbol">=</a> <a id="26822" href="lagda.2023-11-21-nbe.html#26566" class="Bound">σ</a><a id="26823" class="Symbol">}</a> <a id="26825" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="26830" class="Symbol">(</a><a id="26831" href="lagda.2023-11-21-nbe.html#17835" class="Function">sub-tail</a> <a id="26840" class="Symbol">{</a><a id="26841" class="Argument">s</a> <a id="26843" class="Symbol">=</a> <a id="26845" href="lagda.2023-11-21-nbe.html#26570" class="Bound">s</a><a id="26846" class="Symbol">}</a> <a id="26848" class="Symbol">{</a><a id="26849" class="Argument">σ</a> <a id="26851" class="Symbol">=</a> <a id="26853" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a><a id="26855" class="Symbol">}))</a> <a id="26859" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
    <a id="26865" class="Symbol">(</a><a id="26866" href="lagda.2023-11-21-nbe.html#26566" class="Bound">σ</a> <a id="26868" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="26870" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a><a id="26872" class="Symbol">)</a> <a id="26874" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="26876" href="lagda.2023-11-21-nbe.html#26570" class="Bound">s</a>
  <a id="26880" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="26883" href="lagda.2023-11-21-nbe.html#20083" class="Function">cong-cons</a> <a id="26893" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="26898" class="Symbol">(</a><a id="26899" href="lagda.2023-11-21-nbe.html#23042" class="Function">sub-idR</a> <a id="26907" class="Symbol">{</a><a id="26908" class="Argument">σ</a> <a id="26910" class="Symbol">=</a> <a id="26912" href="lagda.2023-11-21-nbe.html#26566" class="Bound">σ</a><a id="26913" class="Symbol">})</a> <a id="26916" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
    <a id="26922" href="lagda.2023-11-21-nbe.html#26566" class="Bound">σ</a> <a id="26924" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="26926" href="lagda.2023-11-21-nbe.html#26570" class="Bound">s</a>
  <a id="26930" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>
</pre>--->
<h4 id="definitional-equality">Definitional Equality</h4>
<p>There is still one language construct left to define ─ equality. To explain why
an embedding of equality in Agda is needed, we can begin discussing
normalization by evaluation in more detail.</p>
<p>Normalization by evaluation is an algorithm for normalization, the process of
transforming a term into its normal form. The normal form of a term is <em>unique</em>,
being the term with all possible reductions (i.e. “computations”) applied to it.
For any normalization algorithm <code>nf</code> such that <code>nf(t)</code> is the normal form of a
term <code>Γ ⊢ t : T</code>, we would expect the following properties to hold.</p>
<ul>
<li><p><code>Γ ⊢ nf(t) : T</code> (well-typedness of normal form)</p>
<p>A normalization algorithm should still produce a term that is well-typed
under the context <code>Γ</code> (and with the same type)</p></li>
<li><p><code>⟦ nf(t) ⟧ = ⟦ t ⟧</code> (preservation of meaning)</p>
<p>The <code>⟦ t ⟧</code> notation here indicates the <em>denotation</em> of <code>t</code>, which is
equivalent to its meaning (in some meta-language).</p>
<p>We want an algorithm for normalization by evaluation to ensure that the
normal form of a term that is obtained is <em>semantically equal</em> to the
original term. Put simply, this means that the two terms must have the
same meaning.</p></li>
<li><p><code>nf(nf(t)) = nf(t)</code> (idempotency)</p>
<p>This property refers to the “normalization” part of the algorithm ─ it
should actually produce a term that has been fully normalized, i.e. it
cannot undergo any more normalization.</p></li>
</ul>
<p>Equality of functions is undecidable, so the last property is especially tricky
to prove for any algorithm in general. Instead, we will want to use
βη-equivalence, or <em>definitional equality</em>. In STLC, we have that two terms are
definitionally equal if and only if they have the same meaning. By proving that
<code>Γ ⊢ nf(t) = t : T</code>, that the normal form of a term is definitionally equal to
the original term, we will be proving that the normal form of a term preserves
the meaning of the original term.</p>
<p>To actually define βη-equivalence, we need to first define operations for
β-reductions and η-expansions.</p>
<p>A β-reduction will be the application of a substitution <code>t[s/x]</code> that
substitutes the term <code>s</code> for the variable <code>x</code> in the term <code>t</code>. In Agda, this
substitution will be the identity substitution with the term <code>s</code> added as the
first term in the substitution. For convenience, we will use <code>t [ s ]₀</code> (as we
are replacing the zeroth term in the identity substitution).</p>
<pre class="Agda"><a id="_[_]₀"></a><a id="29378" href="lagda.2023-11-21-nbe.html#29378" class="Function Operator">_[_]₀</a> <a id="29384" class="Symbol">:</a> <a id="29386" class="Symbol">∀</a> <a id="29388" class="Symbol">{</a><a id="29389" href="lagda.2023-11-21-nbe.html#29389" class="Bound">Γ</a> <a id="29391" class="Symbol">:</a> <a id="29393" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="29396" class="Symbol">}</a> <a id="29398" class="Symbol">{</a><a id="29399" href="lagda.2023-11-21-nbe.html#29399" class="Bound">S</a> <a id="29401" href="lagda.2023-11-21-nbe.html#29401" class="Bound">T</a> <a id="29403" class="Symbol">:</a> <a id="29405" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="29409" class="Symbol">}</a>
  <a id="29413" class="Symbol">→</a> <a id="29415" href="lagda.2023-11-21-nbe.html#29389" class="Bound">Γ</a> <a id="29417" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="29419" href="lagda.2023-11-21-nbe.html#29399" class="Bound">S</a> <a id="29421" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="29423" href="lagda.2023-11-21-nbe.html#29401" class="Bound">T</a>
  <a id="29427" class="Symbol">→</a> <a id="29429" href="lagda.2023-11-21-nbe.html#29389" class="Bound">Γ</a> <a id="29431" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="29433" href="lagda.2023-11-21-nbe.html#29399" class="Bound">S</a>
    <a id="29439" class="Comment">---------</a>
  <a id="29451" class="Symbol">→</a> <a id="29453" href="lagda.2023-11-21-nbe.html#29389" class="Bound">Γ</a> <a id="29455" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="29457" href="lagda.2023-11-21-nbe.html#29401" class="Bound">T</a>
<a id="29459" href="lagda.2023-11-21-nbe.html#29378" class="Function Operator">_[_]₀</a> <a id="29465" class="Symbol">{</a><a id="29466" href="lagda.2023-11-21-nbe.html#29466" class="Bound">Γ</a><a id="29467" class="Symbol">}</a> <a id="29469" class="Symbol">{</a><a id="29470" href="lagda.2023-11-21-nbe.html#29470" class="Bound">S</a><a id="29471" class="Symbol">}</a> <a id="29473" href="lagda.2023-11-21-nbe.html#29473" class="Bound">t</a> <a id="29475" href="lagda.2023-11-21-nbe.html#29475" class="Bound">s</a> <a id="29477" class="Symbol">=</a> <a id="29479" href="lagda.2023-11-21-nbe.html#29473" class="Bound">t</a> <a id="29481" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="29483" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="29486" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="29488" href="lagda.2023-11-21-nbe.html#29475" class="Bound">s</a> <a id="29490" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a>
</pre>
<!---
<pre class="Agda"><a id="29507" class="Keyword">infix</a> <a id="29513" class="Number">8</a> <a id="29515" href="lagda.2023-11-21-nbe.html#29378" class="Function Operator">_[_]₀</a>
</pre>--->
<p>η-expansion for a functional term <code>Γ ⊢ t : S → T</code> will be an abstraction
<code>Γ ⊢ λx . t x : S → T</code> containing the application of a variable <code>Γ, x:S ⊢ x : S</code> to the term <code>t</code>. The term <code>t</code> needs to have a shifting substitution applied
to it as we are using an intrinsically-typed representation (in changing the
context from <code>Γ</code> to <code>Γ, x:S</code>, the expression <code>t</code> itself also changes).</p>
<pre class="Agda"><a id="η-expand"></a><a id="29918" href="lagda.2023-11-21-nbe.html#29918" class="Function">η-expand</a> <a id="29927" class="Symbol">:</a> <a id="29929" class="Symbol">∀</a> <a id="29931" class="Symbol">{</a><a id="29932" href="lagda.2023-11-21-nbe.html#29932" class="Bound">Γ</a> <a id="29934" class="Symbol">:</a> <a id="29936" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="29939" class="Symbol">}</a> <a id="29941" class="Symbol">{</a><a id="29942" href="lagda.2023-11-21-nbe.html#29942" class="Bound">S</a> <a id="29944" href="lagda.2023-11-21-nbe.html#29944" class="Bound">T</a> <a id="29946" class="Symbol">:</a> <a id="29948" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="29952" class="Symbol">}</a>
         <a id="29963" class="Symbol">→</a> <a id="29965" href="lagda.2023-11-21-nbe.html#29932" class="Bound">Γ</a> <a id="29967" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="29969" href="lagda.2023-11-21-nbe.html#29942" class="Bound">S</a> <a id="29971" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="29973" href="lagda.2023-11-21-nbe.html#29944" class="Bound">T</a>
         <a id="29984" class="Symbol">→</a> <a id="29986" href="lagda.2023-11-21-nbe.html#29932" class="Bound">Γ</a> <a id="29988" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="29990" href="lagda.2023-11-21-nbe.html#29942" class="Bound">S</a> <a id="29992" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="29994" href="lagda.2023-11-21-nbe.html#29944" class="Bound">T</a>
<a id="29996" href="lagda.2023-11-21-nbe.html#29918" class="Function">η-expand</a> <a id="30005" class="Symbol">{</a><a id="30006" class="Argument">S</a> <a id="30008" class="Symbol">=</a> <a id="30010" href="lagda.2023-11-21-nbe.html#30010" class="Bound">S</a><a id="30011" class="Symbol">}</a> <a id="30013" href="lagda.2023-11-21-nbe.html#30013" class="Bound">t</a> <a id="30015" class="Symbol">=</a> <a id="30017" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="30019" class="Symbol">(</a><a id="30020" href="lagda.2023-11-21-nbe.html#30010" class="Bound">S</a> <a id="30022" href="lagda.2023-11-21-nbe.html#17302" class="Function Operator">↥⊢</a> <a id="30025" href="lagda.2023-11-21-nbe.html#30013" class="Bound">t</a><a id="30026" class="Symbol">)</a> <a id="30028" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="30030" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="30032" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>
</pre>
<p>With these defined, we can actually introduce definitional equality in Agda.
We use <code>t == t′</code> in Agda instead of <code>Γ ⊢ t = t′ : T</code>, though we will refer to
two terms that are definitionally equal with the latter.</p>
<pre class="Agda"><a id="30260" class="Keyword">data</a> <a id="_==_"></a><a id="30265" href="lagda.2023-11-21-nbe.html#30265" class="Datatype Operator">_==_</a> <a id="30270" class="Symbol">:</a> <a id="30272" class="Symbol">∀</a> <a id="30274" class="Symbol">{</a><a id="30275" href="lagda.2023-11-21-nbe.html#30275" class="Bound">Γ</a> <a id="30277" class="Symbol">:</a> <a id="30279" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="30282" class="Symbol">}</a> <a id="30284" class="Symbol">{</a><a id="30285" href="lagda.2023-11-21-nbe.html#30285" class="Bound">T</a> <a id="30287" class="Symbol">:</a> <a id="30289" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="30293" class="Symbol">}</a> <a id="30295" class="Symbol">→</a> <a id="30297" href="lagda.2023-11-21-nbe.html#30275" class="Bound">Γ</a> <a id="30299" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="30301" href="lagda.2023-11-21-nbe.html#30285" class="Bound">T</a> <a id="30303" class="Symbol">→</a> <a id="30305" href="lagda.2023-11-21-nbe.html#30275" class="Bound">Γ</a> <a id="30307" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="30309" href="lagda.2023-11-21-nbe.html#30285" class="Bound">T</a> <a id="30311" class="Symbol">→</a> <a id="30313" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="30317" class="Keyword">where</a>
  <a id="30325" class="Comment">-- computation rule: beta reduction</a>
  <a id="_==_.β"></a><a id="30363" href="lagda.2023-11-21-nbe.html#30363" class="InductiveConstructor">β</a> <a id="30365" class="Symbol">:</a> <a id="30367" class="Symbol">∀</a> <a id="30369" class="Symbol">{</a><a id="30370" href="lagda.2023-11-21-nbe.html#30370" class="Bound">Γ</a> <a id="30372" class="Symbol">:</a> <a id="30374" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="30377" class="Symbol">}</a> <a id="30379" class="Symbol">{</a><a id="30380" href="lagda.2023-11-21-nbe.html#30380" class="Bound">S</a> <a id="30382" href="lagda.2023-11-21-nbe.html#30382" class="Bound">T</a> <a id="30384" class="Symbol">:</a> <a id="30386" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="30390" class="Symbol">}</a>
          <a id="30402" class="Symbol">{</a><a id="30403" href="lagda.2023-11-21-nbe.html#30403" class="Bound">t</a> <a id="30405" class="Symbol">:</a> <a id="30407" href="lagda.2023-11-21-nbe.html#30370" class="Bound">Γ</a> <a id="30409" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="30411" href="lagda.2023-11-21-nbe.html#30380" class="Bound">S</a> <a id="30413" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="30415" href="lagda.2023-11-21-nbe.html#30382" class="Bound">T</a><a id="30416" class="Symbol">}</a>
          <a id="30428" class="Symbol">{</a><a id="30429" href="lagda.2023-11-21-nbe.html#30429" class="Bound">s</a> <a id="30431" class="Symbol">:</a> <a id="30433" href="lagda.2023-11-21-nbe.html#30370" class="Bound">Γ</a> <a id="30435" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="30437" href="lagda.2023-11-21-nbe.html#30380" class="Bound">S</a><a id="30438" class="Symbol">}</a>
          <a id="30450" class="Comment">----------------------</a>
        <a id="30481" class="Symbol">→</a> <a id="30483" class="Symbol">(</a><a id="30484" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="30486" href="lagda.2023-11-21-nbe.html#30403" class="Bound">t</a><a id="30487" class="Symbol">)</a> <a id="30489" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="30491" href="lagda.2023-11-21-nbe.html#30429" class="Bound">s</a> <a id="30493" href="lagda.2023-11-21-nbe.html#30265" class="Datatype Operator">==</a> <a id="30496" href="lagda.2023-11-21-nbe.html#30403" class="Bound">t</a> <a id="30498" href="lagda.2023-11-21-nbe.html#29378" class="Function Operator">[</a> <a id="30500" href="lagda.2023-11-21-nbe.html#30429" class="Bound">s</a> <a id="30502" href="lagda.2023-11-21-nbe.html#29378" class="Function Operator">]₀</a>

  <a id="30508" class="Comment">-- η-expansion / function extensionality</a>
  <a id="30551" class="Comment">-- i.e. Γ ⊢ t = Γ ⊢ λx. t x : S ⇒ T</a>
  <a id="_==_.η"></a><a id="30589" href="lagda.2023-11-21-nbe.html#30589" class="InductiveConstructor">η</a> <a id="30591" class="Symbol">:</a> <a id="30593" class="Symbol">∀</a> <a id="30595" class="Symbol">{</a><a id="30596" href="lagda.2023-11-21-nbe.html#30596" class="Bound">Γ</a> <a id="30598" class="Symbol">:</a> <a id="30600" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="30603" class="Symbol">}</a> <a id="30605" class="Symbol">{</a><a id="30606" href="lagda.2023-11-21-nbe.html#30606" class="Bound">S</a> <a id="30608" href="lagda.2023-11-21-nbe.html#30608" class="Bound">T</a> <a id="30610" class="Symbol">:</a> <a id="30612" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="30616" class="Symbol">}</a>
        <a id="30626" class="Symbol">{</a><a id="30627" href="lagda.2023-11-21-nbe.html#30627" class="Bound">t</a> <a id="30629" class="Symbol">:</a> <a id="30631" href="lagda.2023-11-21-nbe.html#30596" class="Bound">Γ</a> <a id="30633" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="30635" href="lagda.2023-11-21-nbe.html#30606" class="Bound">S</a> <a id="30637" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="30639" href="lagda.2023-11-21-nbe.html#30608" class="Bound">T</a><a id="30640" class="Symbol">}</a>
        <a id="30650" class="Comment">----------------------</a>
      <a id="30679" class="Symbol">→</a> <a id="30681" href="lagda.2023-11-21-nbe.html#30627" class="Bound">t</a> <a id="30683" href="lagda.2023-11-21-nbe.html#30265" class="Datatype Operator">==</a> <a id="30686" href="lagda.2023-11-21-nbe.html#29918" class="Function">η-expand</a> <a id="30695" href="lagda.2023-11-21-nbe.html#30627" class="Bound">t</a>

  <a id="30700" class="Comment">-- compatibility rules</a>
  <a id="_==_.abs-compatible"></a><a id="30725" href="lagda.2023-11-21-nbe.html#30725" class="InductiveConstructor">abs-compatible</a> <a id="30740" class="Symbol">:</a> <a id="30742" class="Symbol">∀</a> <a id="30744" class="Symbol">{</a><a id="30745" href="lagda.2023-11-21-nbe.html#30745" class="Bound">Γ</a> <a id="30747" class="Symbol">:</a> <a id="30749" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="30752" class="Symbol">}</a> <a id="30754" class="Symbol">{</a><a id="30755" href="lagda.2023-11-21-nbe.html#30755" class="Bound">S</a> <a id="30757" href="lagda.2023-11-21-nbe.html#30757" class="Bound">T</a> <a id="30759" class="Symbol">:</a> <a id="30761" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="30765" class="Symbol">}</a> <a id="30767" class="Symbol">{</a><a id="30768" href="lagda.2023-11-21-nbe.html#30768" class="Bound">t</a> <a id="30770" href="lagda.2023-11-21-nbe.html#30770" class="Bound">t′</a> <a id="30773" class="Symbol">:</a> <a id="30775" href="lagda.2023-11-21-nbe.html#30745" class="Bound">Γ</a> <a id="30777" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="30779" href="lagda.2023-11-21-nbe.html#30755" class="Bound">S</a> <a id="30781" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="30783" href="lagda.2023-11-21-nbe.html#30757" class="Bound">T</a><a id="30784" class="Symbol">}</a>
                   <a id="30805" class="Symbol">→</a> <a id="30807" href="lagda.2023-11-21-nbe.html#30768" class="Bound">t</a> <a id="30809" href="lagda.2023-11-21-nbe.html#30265" class="Datatype Operator">==</a> <a id="30812" href="lagda.2023-11-21-nbe.html#30770" class="Bound">t′</a>
                     <a id="30836" class="Comment">-----------</a>
                   <a id="30867" class="Symbol">→</a> <a id="30869" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="30871" href="lagda.2023-11-21-nbe.html#30768" class="Bound">t</a> <a id="30873" href="lagda.2023-11-21-nbe.html#30265" class="Datatype Operator">==</a> <a id="30876" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="30878" href="lagda.2023-11-21-nbe.html#30770" class="Bound">t′</a>

  <a id="_==_.app-compatible"></a><a id="30884" href="lagda.2023-11-21-nbe.html#30884" class="InductiveConstructor">app-compatible</a> <a id="30899" class="Symbol">:</a> <a id="30901" class="Symbol">∀</a> <a id="30903" class="Symbol">{</a><a id="30904" href="lagda.2023-11-21-nbe.html#30904" class="Bound">Γ</a> <a id="30906" class="Symbol">:</a> <a id="30908" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="30911" class="Symbol">}</a> <a id="30913" class="Symbol">{</a><a id="30914" href="lagda.2023-11-21-nbe.html#30914" class="Bound">S</a> <a id="30916" href="lagda.2023-11-21-nbe.html#30916" class="Bound">T</a> <a id="30918" class="Symbol">:</a> <a id="30920" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="30924" class="Symbol">}</a>
                     <a id="30947" class="Symbol">{</a><a id="30948" href="lagda.2023-11-21-nbe.html#30948" class="Bound">r</a> <a id="30950" href="lagda.2023-11-21-nbe.html#30950" class="Bound">r′</a> <a id="30953" class="Symbol">:</a> <a id="30955" href="lagda.2023-11-21-nbe.html#30904" class="Bound">Γ</a> <a id="30957" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="30959" href="lagda.2023-11-21-nbe.html#30914" class="Bound">S</a> <a id="30961" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="30963" href="lagda.2023-11-21-nbe.html#30916" class="Bound">T</a><a id="30964" class="Symbol">}</a> <a id="30966" class="Symbol">{</a><a id="30967" href="lagda.2023-11-21-nbe.html#30967" class="Bound">s</a> <a id="30969" href="lagda.2023-11-21-nbe.html#30969" class="Bound">s′</a> <a id="30972" class="Symbol">:</a> <a id="30974" href="lagda.2023-11-21-nbe.html#30904" class="Bound">Γ</a> <a id="30976" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="30978" href="lagda.2023-11-21-nbe.html#30914" class="Bound">S</a><a id="30979" class="Symbol">}</a>
                   <a id="31000" class="Symbol">→</a> <a id="31002" href="lagda.2023-11-21-nbe.html#30948" class="Bound">r</a> <a id="31004" href="lagda.2023-11-21-nbe.html#30265" class="Datatype Operator">==</a> <a id="31007" href="lagda.2023-11-21-nbe.html#30950" class="Bound">r′</a>
                   <a id="31029" class="Symbol">→</a> <a id="31031" href="lagda.2023-11-21-nbe.html#30967" class="Bound">s</a> <a id="31033" href="lagda.2023-11-21-nbe.html#30265" class="Datatype Operator">==</a> <a id="31036" href="lagda.2023-11-21-nbe.html#30969" class="Bound">s′</a>
                     <a id="31060" class="Comment">----------------</a>
                   <a id="31096" class="Symbol">→</a> <a id="31098" href="lagda.2023-11-21-nbe.html#30948" class="Bound">r</a> <a id="31100" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="31102" href="lagda.2023-11-21-nbe.html#30967" class="Bound">s</a> <a id="31104" href="lagda.2023-11-21-nbe.html#30265" class="Datatype Operator">==</a> <a id="31107" href="lagda.2023-11-21-nbe.html#30950" class="Bound">r′</a> <a id="31110" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="31112" href="lagda.2023-11-21-nbe.html#30969" class="Bound">s′</a>

  <a id="31118" class="Comment">-- equivalence rules</a>
  <a id="_==_.refl⁼⁼"></a><a id="31141" href="lagda.2023-11-21-nbe.html#31141" class="InductiveConstructor">refl⁼⁼</a> <a id="31148" class="Symbol">:</a> <a id="31150" class="Symbol">∀</a> <a id="31152" class="Symbol">{</a><a id="31153" href="lagda.2023-11-21-nbe.html#31153" class="Bound">Γ</a> <a id="31155" class="Symbol">:</a> <a id="31157" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="31160" class="Symbol">}</a> <a id="31162" class="Symbol">{</a><a id="31163" href="lagda.2023-11-21-nbe.html#31163" class="Bound">T</a> <a id="31165" class="Symbol">:</a> <a id="31167" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="31171" class="Symbol">}</a> <a id="31173" class="Symbol">{</a><a id="31174" href="lagda.2023-11-21-nbe.html#31174" class="Bound">t</a> <a id="31176" class="Symbol">:</a> <a id="31178" href="lagda.2023-11-21-nbe.html#31153" class="Bound">Γ</a> <a id="31180" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="31182" href="lagda.2023-11-21-nbe.html#31163" class="Bound">T</a><a id="31183" class="Symbol">}</a>
           <a id="31196" class="Comment">------</a>
         <a id="31212" class="Symbol">→</a> <a id="31214" href="lagda.2023-11-21-nbe.html#31174" class="Bound">t</a> <a id="31216" href="lagda.2023-11-21-nbe.html#30265" class="Datatype Operator">==</a> <a id="31219" href="lagda.2023-11-21-nbe.html#31174" class="Bound">t</a>

  <a id="_==_.sym⁼⁼"></a><a id="31224" href="lagda.2023-11-21-nbe.html#31224" class="InductiveConstructor">sym⁼⁼</a> <a id="31230" class="Symbol">:</a> <a id="31232" class="Symbol">∀</a> <a id="31234" class="Symbol">{</a><a id="31235" href="lagda.2023-11-21-nbe.html#31235" class="Bound">Γ</a> <a id="31237" class="Symbol">:</a> <a id="31239" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="31242" class="Symbol">}</a> <a id="31244" class="Symbol">{</a><a id="31245" href="lagda.2023-11-21-nbe.html#31245" class="Bound">T</a> <a id="31247" class="Symbol">:</a> <a id="31249" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="31253" class="Symbol">}</a> <a id="31255" class="Symbol">{</a><a id="31256" href="lagda.2023-11-21-nbe.html#31256" class="Bound">t</a> <a id="31258" href="lagda.2023-11-21-nbe.html#31258" class="Bound">t′</a> <a id="31261" class="Symbol">:</a> <a id="31263" href="lagda.2023-11-21-nbe.html#31235" class="Bound">Γ</a> <a id="31265" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="31267" href="lagda.2023-11-21-nbe.html#31245" class="Bound">T</a><a id="31268" class="Symbol">}</a>
        <a id="31278" class="Symbol">→</a> <a id="31280" href="lagda.2023-11-21-nbe.html#31256" class="Bound">t</a> <a id="31282" href="lagda.2023-11-21-nbe.html#30265" class="Datatype Operator">==</a> <a id="31285" href="lagda.2023-11-21-nbe.html#31258" class="Bound">t′</a>
          <a id="31298" class="Comment">-------</a>
        <a id="31314" class="Symbol">→</a> <a id="31316" href="lagda.2023-11-21-nbe.html#31258" class="Bound">t′</a> <a id="31319" href="lagda.2023-11-21-nbe.html#30265" class="Datatype Operator">==</a> <a id="31322" href="lagda.2023-11-21-nbe.html#31256" class="Bound">t</a>

  <a id="_==_.trans⁼⁼"></a><a id="31327" href="lagda.2023-11-21-nbe.html#31327" class="InductiveConstructor">trans⁼⁼</a> <a id="31335" class="Symbol">:</a> <a id="31337" class="Symbol">∀</a> <a id="31339" class="Symbol">{</a><a id="31340" href="lagda.2023-11-21-nbe.html#31340" class="Bound">Γ</a> <a id="31342" class="Symbol">:</a> <a id="31344" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="31347" class="Symbol">}</a> <a id="31349" class="Symbol">{</a><a id="31350" href="lagda.2023-11-21-nbe.html#31350" class="Bound">T</a> <a id="31352" class="Symbol">:</a> <a id="31354" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="31358" class="Symbol">}</a> <a id="31360" class="Symbol">{</a><a id="31361" href="lagda.2023-11-21-nbe.html#31361" class="Bound">t₁</a> <a id="31364" href="lagda.2023-11-21-nbe.html#31364" class="Bound">t₂</a> <a id="31367" href="lagda.2023-11-21-nbe.html#31367" class="Bound">t₃</a> <a id="31370" class="Symbol">:</a> <a id="31372" href="lagda.2023-11-21-nbe.html#31340" class="Bound">Γ</a> <a id="31374" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="31376" href="lagda.2023-11-21-nbe.html#31350" class="Bound">T</a><a id="31377" class="Symbol">}</a>
          <a id="31389" class="Symbol">→</a> <a id="31391" href="lagda.2023-11-21-nbe.html#31361" class="Bound">t₁</a> <a id="31394" href="lagda.2023-11-21-nbe.html#30265" class="Datatype Operator">==</a> <a id="31397" href="lagda.2023-11-21-nbe.html#31364" class="Bound">t₂</a>
          <a id="31410" class="Symbol">→</a> <a id="31412" href="lagda.2023-11-21-nbe.html#31364" class="Bound">t₂</a> <a id="31415" href="lagda.2023-11-21-nbe.html#30265" class="Datatype Operator">==</a> <a id="31418" href="lagda.2023-11-21-nbe.html#31367" class="Bound">t₃</a>
            <a id="31433" class="Comment">--------</a>
          <a id="31452" class="Symbol">→</a> <a id="31454" href="lagda.2023-11-21-nbe.html#31361" class="Bound">t₁</a> <a id="31457" href="lagda.2023-11-21-nbe.html#30265" class="Datatype Operator">==</a> <a id="31460" href="lagda.2023-11-21-nbe.html#31367" class="Bound">t₃</a>
</pre>
<!---
<pre class="Agda"><a id="31478" class="Keyword">infix</a> <a id="31484" class="Number">3</a> <a id="31486" href="lagda.2023-11-21-nbe.html#30265" class="Datatype Operator">_==_</a>
</pre>--->
<p>For the readability of some of the proofs that will follow, it will be helpful
to have equational reasoning defined with respect to definitional equality. Its
definition is almost identical to Agda’s own equational reasoning for
propositional equality, so it is left out in the rendering.</p>
<!---
<pre class="Agda"><a id="31805" class="Keyword">module</a> <a id="==-Reasoning"></a><a id="31812" href="lagda.2023-11-21-nbe.html#31812" class="Module">==-Reasoning</a> <a id="31825" class="Keyword">where</a>

  <a id="31834" class="Keyword">infix</a>  <a id="31841" class="Number">1</a> <a id="31843" href="lagda.2023-11-21-nbe.html#31890" class="Function Operator">begin==_</a>
  <a id="31854" class="Keyword">infixr</a> <a id="31861" class="Number">2</a> <a id="31863" href="lagda.2023-11-21-nbe.html#32023" class="Function Operator">_==⟨_⟩_</a>
  <a id="31873" class="Keyword">infix</a>  <a id="31880" class="Number">3</a> <a id="31882" href="lagda.2023-11-21-nbe.html#32231" class="Function Operator">_==∎</a>

  <a id="==-Reasoning.begin==_"></a><a id="31890" href="lagda.2023-11-21-nbe.html#31890" class="Function Operator">begin==_</a> <a id="31899" class="Symbol">:</a> <a id="31901" class="Symbol">∀</a> <a id="31903" class="Symbol">{</a><a id="31904" href="lagda.2023-11-21-nbe.html#31904" class="Bound">Γ</a> <a id="31906" class="Symbol">:</a> <a id="31908" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="31911" class="Symbol">}</a> <a id="31913" class="Symbol">{</a><a id="31914" href="lagda.2023-11-21-nbe.html#31914" class="Bound">T</a> <a id="31916" class="Symbol">:</a> <a id="31918" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="31922" class="Symbol">}</a> <a id="31924" class="Symbol">{</a><a id="31925" href="lagda.2023-11-21-nbe.html#31925" class="Bound">t</a> <a id="31927" href="lagda.2023-11-21-nbe.html#31927" class="Bound">t′</a> <a id="31930" class="Symbol">:</a> <a id="31932" href="lagda.2023-11-21-nbe.html#31904" class="Bound">Γ</a> <a id="31934" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="31936" href="lagda.2023-11-21-nbe.html#31914" class="Bound">T</a><a id="31937" class="Symbol">}</a>
           <a id="31950" class="Symbol">→</a> <a id="31952" href="lagda.2023-11-21-nbe.html#31925" class="Bound">t</a> <a id="31954" href="lagda.2023-11-21-nbe.html#30265" class="Datatype Operator">==</a> <a id="31957" href="lagda.2023-11-21-nbe.html#31927" class="Bound">t′</a>
             <a id="31973" class="Comment">-------</a>
           <a id="31992" class="Symbol">→</a> <a id="31994" href="lagda.2023-11-21-nbe.html#31925" class="Bound">t</a> <a id="31996" href="lagda.2023-11-21-nbe.html#30265" class="Datatype Operator">==</a> <a id="31999" href="lagda.2023-11-21-nbe.html#31927" class="Bound">t′</a>
  <a id="32004" href="lagda.2023-11-21-nbe.html#31890" class="Function Operator">begin==</a> <a id="32012" href="lagda.2023-11-21-nbe.html#32012" class="Bound">pf</a> <a id="32015" class="Symbol">=</a> <a id="32017" href="lagda.2023-11-21-nbe.html#32012" class="Bound">pf</a>

  <a id="==-Reasoning._==⟨_⟩_"></a><a id="32023" href="lagda.2023-11-21-nbe.html#32023" class="Function Operator">_==⟨_⟩_</a> <a id="32031" class="Symbol">:</a> <a id="32033" class="Symbol">∀</a> <a id="32035" class="Symbol">{</a><a id="32036" href="lagda.2023-11-21-nbe.html#32036" class="Bound">Γ</a> <a id="32038" class="Symbol">:</a> <a id="32040" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="32043" class="Symbol">}</a> <a id="32045" class="Symbol">{</a><a id="32046" href="lagda.2023-11-21-nbe.html#32046" class="Bound">T</a> <a id="32048" class="Symbol">:</a> <a id="32050" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="32054" class="Symbol">}</a> <a id="32056" class="Symbol">{</a><a id="32057" href="lagda.2023-11-21-nbe.html#32057" class="Bound">t₂</a> <a id="32060" href="lagda.2023-11-21-nbe.html#32060" class="Bound">t₃</a> <a id="32063" class="Symbol">:</a> <a id="32065" href="lagda.2023-11-21-nbe.html#32036" class="Bound">Γ</a> <a id="32067" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="32069" href="lagda.2023-11-21-nbe.html#32046" class="Bound">T</a><a id="32070" class="Symbol">}</a>
          <a id="32082" class="Symbol">→</a> <a id="32084" class="Symbol">(</a><a id="32085" href="lagda.2023-11-21-nbe.html#32085" class="Bound">t₁</a> <a id="32088" class="Symbol">:</a> <a id="32090" href="lagda.2023-11-21-nbe.html#32036" class="Bound">Γ</a> <a id="32092" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="32094" href="lagda.2023-11-21-nbe.html#32046" class="Bound">T</a><a id="32095" class="Symbol">)</a>
          <a id="32107" class="Symbol">→</a> <a id="32109" href="lagda.2023-11-21-nbe.html#32085" class="Bound">t₁</a> <a id="32112" href="lagda.2023-11-21-nbe.html#30265" class="Datatype Operator">==</a> <a id="32115" href="lagda.2023-11-21-nbe.html#32057" class="Bound">t₂</a>
          <a id="32128" class="Symbol">→</a> <a id="32130" href="lagda.2023-11-21-nbe.html#32057" class="Bound">t₂</a> <a id="32133" href="lagda.2023-11-21-nbe.html#30265" class="Datatype Operator">==</a> <a id="32136" href="lagda.2023-11-21-nbe.html#32060" class="Bound">t₃</a>
            <a id="32151" class="Comment">--------</a>
          <a id="32170" class="Symbol">→</a> <a id="32172" href="lagda.2023-11-21-nbe.html#32085" class="Bound">t₁</a> <a id="32175" href="lagda.2023-11-21-nbe.html#30265" class="Datatype Operator">==</a> <a id="32178" href="lagda.2023-11-21-nbe.html#32060" class="Bound">t₃</a>
  <a id="32183" href="lagda.2023-11-21-nbe.html#32183" class="Bound">t₁</a> <a id="32186" href="lagda.2023-11-21-nbe.html#32023" class="Function Operator">==⟨</a> <a id="32190" href="lagda.2023-11-21-nbe.html#32190" class="Bound">t₁≡t₂</a> <a id="32196" href="lagda.2023-11-21-nbe.html#32023" class="Function Operator">⟩</a> <a id="32198" href="lagda.2023-11-21-nbe.html#32198" class="Bound">t₂≡t₃</a>  <a id="32205" class="Symbol">=</a>  <a id="32208" href="lagda.2023-11-21-nbe.html#31327" class="InductiveConstructor">trans⁼⁼</a> <a id="32216" href="lagda.2023-11-21-nbe.html#32190" class="Bound">t₁≡t₂</a> <a id="32222" href="lagda.2023-11-21-nbe.html#32198" class="Bound">t₂≡t₃</a>

  <a id="==-Reasoning._==∎"></a><a id="32231" href="lagda.2023-11-21-nbe.html#32231" class="Function Operator">_==∎</a> <a id="32236" class="Symbol">:</a> <a id="32238" class="Symbol">∀</a> <a id="32240" class="Symbol">{</a><a id="32241" href="lagda.2023-11-21-nbe.html#32241" class="Bound">Γ</a> <a id="32243" class="Symbol">:</a> <a id="32245" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="32248" class="Symbol">}</a> <a id="32250" class="Symbol">{</a><a id="32251" href="lagda.2023-11-21-nbe.html#32251" class="Bound">T</a> <a id="32253" class="Symbol">:</a> <a id="32255" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="32259" class="Symbol">}</a> <a id="32261" class="Symbol">→</a> <a id="32263" class="Symbol">(</a><a id="32264" href="lagda.2023-11-21-nbe.html#32264" class="Bound">t</a> <a id="32266" class="Symbol">:</a> <a id="32268" href="lagda.2023-11-21-nbe.html#32241" class="Bound">Γ</a> <a id="32270" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="32272" href="lagda.2023-11-21-nbe.html#32251" class="Bound">T</a><a id="32273" class="Symbol">)</a>
         <a id="32284" class="Comment">------</a>
       <a id="32298" class="Symbol">→</a> <a id="32300" href="lagda.2023-11-21-nbe.html#32264" class="Bound">t</a> <a id="32302" href="lagda.2023-11-21-nbe.html#30265" class="Datatype Operator">==</a> <a id="32305" href="lagda.2023-11-21-nbe.html#32264" class="Bound">t</a>
  <a id="32309" href="lagda.2023-11-21-nbe.html#32309" class="Bound">t</a> <a id="32311" href="lagda.2023-11-21-nbe.html#32231" class="Function Operator">==∎</a>  <a id="32316" class="Symbol">=</a>  <a id="32319" href="lagda.2023-11-21-nbe.html#31141" class="InductiveConstructor">refl⁼⁼</a>
</pre>--->
<pre class="Agda"><a id="32344" class="Keyword">open</a> <a id="32349" href="lagda.2023-11-21-nbe.html#31812" class="Module">==-Reasoning</a> <a id="32362" class="Keyword">public</a>
</pre>
<p>Propositional equality implies definitional equality, a fact that will be
helpful to include here for later use.</p>
<pre class="Agda"><a id="≡→=="></a><a id="32496" href="lagda.2023-11-21-nbe.html#32496" class="Function">≡→==</a> <a id="32501" class="Symbol">:</a> <a id="32503" class="Symbol">∀</a> <a id="32505" class="Symbol">{</a><a id="32506" href="lagda.2023-11-21-nbe.html#32506" class="Bound">Γ</a> <a id="32508" class="Symbol">:</a> <a id="32510" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="32513" class="Symbol">}</a> <a id="32515" class="Symbol">{</a><a id="32516" href="lagda.2023-11-21-nbe.html#32516" class="Bound">T</a> <a id="32518" class="Symbol">:</a> <a id="32520" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="32524" class="Symbol">}</a> <a id="32526" class="Symbol">{</a><a id="32527" href="lagda.2023-11-21-nbe.html#32527" class="Bound">t</a> <a id="32529" href="lagda.2023-11-21-nbe.html#32529" class="Bound">t′</a> <a id="32532" class="Symbol">:</a> <a id="32534" href="lagda.2023-11-21-nbe.html#32506" class="Bound">Γ</a> <a id="32536" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="32538" href="lagda.2023-11-21-nbe.html#32516" class="Bound">T</a><a id="32539" class="Symbol">}</a>
     <a id="32546" class="Symbol">→</a> <a id="32548" href="lagda.2023-11-21-nbe.html#32527" class="Bound">t</a> <a id="32550" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="32552" href="lagda.2023-11-21-nbe.html#32529" class="Bound">t′</a>
       <a id="32562" class="Comment">-------</a>
     <a id="32575" class="Symbol">→</a> <a id="32577" href="lagda.2023-11-21-nbe.html#32527" class="Bound">t</a> <a id="32579" href="lagda.2023-11-21-nbe.html#30265" class="Datatype Operator">==</a> <a id="32582" href="lagda.2023-11-21-nbe.html#32529" class="Bound">t′</a>
<a id="32585" href="lagda.2023-11-21-nbe.html#32496" class="Function">≡→==</a> <a id="32590" href="lagda.2023-11-21-nbe.html#32590" class="Bound">pf</a> <a id="32593" class="Keyword">rewrite</a> <a id="32601" href="lagda.2023-11-21-nbe.html#32590" class="Bound">pf</a> <a id="32604" class="Symbol">=</a> <a id="32606" href="lagda.2023-11-21-nbe.html#31141" class="InductiveConstructor">refl⁼⁼</a>
</pre>
<h3 id="evaluation">Evaluation</h3>
<p>The evaluation, or interpretation, <code>⟦ t ⟧</code> of a well-typed term <code>Γ ⊢ t : T</code>
assigns a meaning to <code>t</code> by equating it to a semantic object in our meta
language, using an interpretation of the context <code>Γ</code> (an <em>environment</em>) under
which the term <code>t</code> is well-typed.</p>
<p>For types, we can interpret <code>𝟙</code> as Agda’s own unit type, <code>⊤</code>, and functions as
Agda functions, with their meaning defined inductively.</p>
<pre><code>⟦ 𝟙 ⟧ = ⊤
⟦ S ⇒ T ⟧ = ⟦ S ⟧ → ⟦ T ⟧</code></pre>
<p>An empty context is interpreted as the unit type (an “empty” environment), and
an extension to a context is defined inductively, with the extension itself
being the interpretation of the type the context is extended with.</p>
<pre><code>⟦ ∅ ⟧ = ⊤
⟦ Γ , S ⟧ = ⟦ Γ ⟧ × ⟦ S ⟧</code></pre>
<p>We will use the lowercase Greek letter of a context to refer to its environment
(e.g. <code>γ</code> is an environment for <code>Γ</code>).</p>
<p>The interpretation of a variable expects an environment, and is essentially a
lookup into the environment for the variable’s value:</p>
<pre><code>⟦ Γ ∋ x:T ⟧ (γ ∈ ⟦ Γ ⟧) ∈ ⟦ T ⟧
⟦ Γ , T ∋ x:T ⟧ (γ , a) = a
⟦ Γ , y:S ∋ x:T ⟧ (γ , _) = ⟦ Γ ∋ x:T ⟧ γ</code></pre>
<p>The interpretation of a typed term expects an environment as well, evaluating
the term by using the environment for the variables that the term is using.</p>
<pre><code>⟦ Γ ⊢ t : T ⟧ (γ ∈ ⟦Γ⟧) ∈ ⟦ T ⟧
⟦ Γ ⊢ unit : 𝟙 ⟧ γ       = tt
⟦ Γ ⊢ x : T ⟧ γ          = ⟦ Γ ∋ x:T ⟧ γ
⟦ Γ ⊢ λx . t : S ⇒ T ⟧ γ = λ a → ⟦ Γ , x:S ⊢ t : T ⟧ (γ , a)
⟦ Γ ⊢ r s : T ⟧ γ        = (⟦ Γ ⊢ r : S ⇒ T ⟧ γ) (⟦ Γ ⊢ s : S ⟧ γ)</code></pre>
<p>Before moving forward, we introduce the record we will use to represent
interpretations of types and contexts. For now, we will only include the
interpretation of a context as an environment, as our interpretation of types
will change subtly to better fit our algorithm for normalization by evaluation ─
this is also why we have only discussed evaluation at a high level.</p>
<pre class="Agda"><a id="34500" class="Keyword">record</a> <a id="Interpretation"></a><a id="34507" href="lagda.2023-11-21-nbe.html#34507" class="Record">Interpretation</a> <a id="34522" class="Symbol">(</a><a id="34523" href="lagda.2023-11-21-nbe.html#34523" class="Bound">D</a> <a id="34525" class="Symbol">:</a> <a id="34527" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="34530" class="Symbol">)</a> <a id="34532" class="Symbol">:</a> <a id="34534" href="Agda.Primitive.html#326" class="Primitive">Set₁</a> <a id="34539" class="Keyword">where</a>
  <a id="34547" class="Keyword">field</a>
    <a id="Interpretation.⟦_⟧"></a><a id="34557" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦_⟧</a> <a id="34561" class="Symbol">:</a> <a id="34563" href="lagda.2023-11-21-nbe.html#34523" class="Bound">D</a> <a id="34565" class="Symbol">→</a> <a id="34567" href="Agda.Primitive.html#326" class="Primitive">Set</a>

<a id="34572" class="Keyword">open</a> <a id="34577" href="lagda.2023-11-21-nbe.html#34507" class="Module">Interpretation</a> <a id="34592" class="Symbol">⦃...⦄</a> <a id="34598" class="Keyword">public</a>

<a id="34606" class="Keyword">instance</a>
    <a id="⟦Γ⟧"></a><a id="34619" href="lagda.2023-11-21-nbe.html#34619" class="Function">⟦Γ⟧</a> <a id="34623" class="Symbol">:</a> <a id="34625" class="Symbol">⦃</a> <a id="34627" href="lagda.2023-11-21-nbe.html#34627" class="Bound">_</a> <a id="34629" class="Symbol">:</a> <a id="34631" href="lagda.2023-11-21-nbe.html#34507" class="Record">Interpretation</a> <a id="34646" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a> <a id="34651" class="Symbol">⦄</a> <a id="34653" class="Symbol">→</a> <a id="34655" href="lagda.2023-11-21-nbe.html#34507" class="Record">Interpretation</a> <a id="34670" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a>
    <a id="34678" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">Interpretation.⟦</a> <a id="34695" href="lagda.2023-11-21-nbe.html#34619" class="Function">⟦Γ⟧</a> <a id="34699" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a> <a id="34701" href="lagda.2023-11-21-nbe.html#3944" class="InductiveConstructor">∅</a> <a id="34703" class="Symbol">=</a> <a id="34705" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
    <a id="34711" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">Interpretation.⟦</a> <a id="34728" href="lagda.2023-11-21-nbe.html#34619" class="Function">⟦Γ⟧</a> <a id="34732" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a> <a id="34734" class="Symbol">(</a><a id="34735" href="lagda.2023-11-21-nbe.html#34735" class="Bound">Γ</a> <a id="34737" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="34739" href="lagda.2023-11-21-nbe.html#34739" class="Bound">T</a><a id="34740" class="Symbol">)</a> <a id="34742" class="Symbol">=</a> <a id="34744" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="34746" href="lagda.2023-11-21-nbe.html#34735" class="Bound">Γ</a> <a id="34748" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a> <a id="34750" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="34752" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="34754" href="lagda.2023-11-21-nbe.html#34739" class="Bound">T</a> <a id="34756" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a>
</pre>
<h3 id="normalization-by-evaluation">Normalization by Evaluation</h3>
<p>The key idea behind normalization by evaluation is that we have inherently
performed some normalization of the term <code>t</code> in its evaluation – if <code>t</code> was an
application <code>r s</code>, we are actually performing that application and reducing the
term. Normalization by evaluation as an algorithm takes advantage of this fact.</p>
<p>An issue with this view is that evaluation is not actually giving us the normal
form of a term, but rather its meaning as a semantic object in our meta
language. An algorithm for normalization by evaluation would need a way to to
convert a semantic object in our meta language back into a term in the object
language.</p>
<p>One way to achieve this is to evaluate (i.e. normalize) the parts of the
expression that actually <em>can</em> be evaluated (such as function application),
while leaving the parts that cannot intact. Under this view, normalization by
evaluation becomes the evaluation of an expression with unknowns
(i.e. variables) to another, possibly simplified, expression with unknowns.</p>
<p>To get this behavior, we make a subtle change to the “meaning” of a term in the meta language – instead of terms of type <code>𝟙</code> mapping to Agda’s unit type, they
will now evaluate to terms in their normal form.</p>
<p>This is a subtle distinction with a significant impact on the algorithm we will
define. We can now easily convert back to the object language, because
<em>technically</em> we never left it to begin with: functions in Agda can be
translated simply abstractions in the STLC, and for terms of type <code>𝟙</code>, we
already have the term!</p>
<p>In Agda, we do not yet have a concept of normal form. We can define terms in
their normal form (normal terms) mutually with terms that are blocked on
evaluation because they are unknown (neutral terms).</p>
<pre class="Agda"><a id="36542" class="Keyword">data</a> <a id="Nf"></a><a id="36547" href="lagda.2023-11-21-nbe.html#36547" class="Datatype">Nf</a> <a id="36550" class="Symbol">:</a> <a id="36552" class="Symbol">(</a><a id="36553" href="lagda.2023-11-21-nbe.html#36553" class="Bound">T</a> <a id="36555" class="Symbol">:</a> <a id="36557" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="36561" class="Symbol">)</a> <a id="36563" class="Symbol">→</a> <a id="36565" class="Symbol">(</a><a id="36566" href="lagda.2023-11-21-nbe.html#36566" class="Bound">Γ</a> <a id="36568" class="Symbol">:</a> <a id="36570" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="36573" class="Symbol">)</a> <a id="36575" class="Symbol">→</a> <a id="36577" href="lagda.2023-11-21-nbe.html#36566" class="Bound">Γ</a> <a id="36579" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="36581" href="lagda.2023-11-21-nbe.html#36553" class="Bound">T</a> <a id="36583" class="Symbol">→</a> <a id="36585" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="36589" class="Comment">-- Normal terms</a>
<a id="36605" class="Keyword">data</a> <a id="Ne"></a><a id="36610" href="lagda.2023-11-21-nbe.html#36610" class="Datatype">Ne</a> <a id="36613" class="Symbol">(</a><a id="36614" href="lagda.2023-11-21-nbe.html#36614" class="Bound">T</a> <a id="36616" class="Symbol">:</a> <a id="36618" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="36622" class="Symbol">)</a> <a id="36624" class="Symbol">(</a><a id="36625" href="lagda.2023-11-21-nbe.html#36625" class="Bound">Γ</a> <a id="36627" class="Symbol">:</a> <a id="36629" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="36632" class="Symbol">)</a> <a id="36634" class="Symbol">:</a> <a id="36636" href="lagda.2023-11-21-nbe.html#36625" class="Bound">Γ</a> <a id="36638" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="36640" href="lagda.2023-11-21-nbe.html#36614" class="Bound">T</a> <a id="36642" class="Symbol">→</a> <a id="36644" href="Agda.Primitive.html#326" class="Primitive">Set</a>     <a id="36652" class="Comment">-- Neutral terms</a>
</pre>
<p>The rules for these will follow shortly ─ but with this definition we can change
the interpretation of a term of type <code>𝟙</code> to what we would want it to be to
define a suitable algorithm for normalization by evaluation:</p>
<pre><code>⟦ 𝟙 ⟧ = Nf 𝟙</code></pre>
<p>Note that our data type for normal terms is indexed both by a type and a
context, yet here the interpretation of a type is only indexed by the type
itself. We will get to this later, but it is for this reason that we have again
not written an implementation out in Agda yet. For now, we can give an initial
sketch of the algorithm, using a <em>reflection</em> function <code>↑ᵀ</code> that maps neutral
terms of type <code>T</code> to semantic objects in <code>⟦ T ⟧</code>, and a <em>reification</em> function
<code>↓ᵀ</code> for mapping a semantic object in <code>⟦ T ⟧</code> to normal forms of type <code>T</code>:</p>
<p>Putting all of these pieces together, we can present (in pseudocode) what an
algorithm for normalization by evaluation would do.</p>
<pre><code>⟦ 𝟙 ⟧ = Nf 𝟙
⟦ S → T ⟧ = ⟦ S ⟧ → ⟦ T ⟧

↑ᵀ ∈ Ne T → ⟦ T ⟧
↑ᵘⁿⁱᵗ 𝓊 = 𝓊
↑ˢ  ⃕ ᵗ 𝓊 (a ∈ ⟦ S ⟧) = ↑ᵀ (𝓊 𝓋) , 𝓋 = ↓ˢ a

↓ᵀ ∈ ⟦ T ⟧ → Nf T
↓ᵘⁿⁱᵗ 𝓋 = 𝓋
↓ˢ  ⃕ ᵗ f = λx. ↓ᵀ (f(a)) , where a = ↑ᵀ x and x is &quot;fresh&quot;

↑ᶜᵗˣ ∈ ⟦ Γ ⟧
↑∅ = tt
↑Γ,x:S = ↑Γ , ↑ᵀ x

nf(t) = ↓ᵀ (⟦ t ⟧ ↑Γ)</code></pre>
<p>In summary, the algorithm proceeds as follows:</p>
<ol type="1">
<li><p>reflect the variables of the context <code>Γ</code> (<code>↑Γ</code>)</p></li>
<li><p>interpret the value of the term using the environment
of reflected variables (<code>⟦ t ⟧ ↑Γ</code>)</p></li>
<li><p>“reify” the interpreted value of the term (<code>↓ᵀ (⟦ t ⟧ ↑Γ)</code>),
returning it to a term in normal form</p></li>
</ol>
<p>The “freshness” condition in this sketch is a key part of why we have not
started defining a more concrete version of the algorithm, but with this sketch
we can see how our new interpretation of the type <code>𝟙</code> has benefitted us: we are
able to evaluate a term while leaving its unknowns “untouched”: reflection of an
unknown term of type <code>𝟙</code> yields the unknown itself, while we always η-expand at
reification to continue evaluation. Once we have finished evaluating the term,
we are easily able to convert it back into our object language.</p>
<p>As an initial step in formally defining this algorithm, we can now introduce the
rules for normal and neutral terms in Agda. Going forward, we will be using <code>𝓊</code>
(for “unknown”) to refer to neutral terms and <code>𝓋</code> (for “value”) to refer to
normal terms.</p>
<p>Neutral terms are normal terms in their blocked form. Variables are the “base
case” for blocked terms, with application of an unknown function to a normal
term also being blocked.</p>
<pre class="Agda"><a id="39203" class="Keyword">data</a> <a id="39208" href="lagda.2023-11-21-nbe.html#36610" class="Datatype">Ne</a> <a id="39211" href="lagda.2023-11-21-nbe.html#39211" class="Bound">T</a> <a id="39213" href="lagda.2023-11-21-nbe.html#39213" class="Bound">Γ</a> <a id="39215" class="Keyword">where</a>
  <a id="Ne.ne-var"></a><a id="39223" href="lagda.2023-11-21-nbe.html#39223" class="InductiveConstructor">ne-var</a> <a id="39230" class="Symbol">:</a> <a id="39232" class="Symbol">(</a><a id="39233" href="lagda.2023-11-21-nbe.html#39233" class="Bound">x</a> <a id="39235" class="Symbol">:</a> <a id="39237" href="lagda.2023-11-21-nbe.html#39213" class="Bound">Γ</a> <a id="39239" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="39241" href="lagda.2023-11-21-nbe.html#39211" class="Bound">T</a><a id="39242" class="Symbol">)</a>
           <a id="39255" class="Comment">------------</a>
         <a id="39277" class="Symbol">→</a> <a id="39279" href="lagda.2023-11-21-nbe.html#36610" class="Datatype">Ne</a> <a id="39282" href="lagda.2023-11-21-nbe.html#39211" class="Bound">T</a> <a id="39284" href="lagda.2023-11-21-nbe.html#39213" class="Bound">Γ</a> <a id="39286" class="Symbol">(</a><a id="39287" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="39289" href="lagda.2023-11-21-nbe.html#39233" class="Bound">x</a><a id="39290" class="Symbol">)</a>

  <a id="Ne.ne-app"></a><a id="39295" href="lagda.2023-11-21-nbe.html#39295" class="InductiveConstructor">ne-app</a> <a id="39302" class="Symbol">:</a> <a id="39304" class="Symbol">∀</a> <a id="39306" class="Symbol">{</a><a id="39307" href="lagda.2023-11-21-nbe.html#39307" class="Bound">S</a> <a id="39309" class="Symbol">:</a> <a id="39311" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="39315" class="Symbol">}</a> <a id="39317" class="Symbol">{</a><a id="39318" href="lagda.2023-11-21-nbe.html#39318" class="Bound">𝓊</a> <a id="39320" class="Symbol">:</a> <a id="39322" href="lagda.2023-11-21-nbe.html#39213" class="Bound">Γ</a> <a id="39324" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="39326" href="lagda.2023-11-21-nbe.html#39307" class="Bound">S</a> <a id="39328" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="39330" href="lagda.2023-11-21-nbe.html#39211" class="Bound">T</a><a id="39331" class="Symbol">}</a> <a id="39333" class="Symbol">{</a><a id="39334" href="lagda.2023-11-21-nbe.html#39334" class="Bound">𝓋</a> <a id="39336" class="Symbol">:</a> <a id="39338" href="lagda.2023-11-21-nbe.html#39213" class="Bound">Γ</a> <a id="39340" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="39342" href="lagda.2023-11-21-nbe.html#39307" class="Bound">S</a><a id="39343" class="Symbol">}</a>
         <a id="39354" class="Symbol">→</a> <a id="39356" href="lagda.2023-11-21-nbe.html#36610" class="Datatype">Ne</a> <a id="39359" class="Symbol">(</a><a id="39360" href="lagda.2023-11-21-nbe.html#39307" class="Bound">S</a> <a id="39362" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="39364" href="lagda.2023-11-21-nbe.html#39211" class="Bound">T</a><a id="39365" class="Symbol">)</a> <a id="39367" href="lagda.2023-11-21-nbe.html#39213" class="Bound">Γ</a> <a id="39369" href="lagda.2023-11-21-nbe.html#39318" class="Bound">𝓊</a>
         <a id="39380" class="Symbol">→</a> <a id="39382" href="lagda.2023-11-21-nbe.html#36547" class="Datatype">Nf</a> <a id="39385" href="lagda.2023-11-21-nbe.html#39307" class="Bound">S</a> <a id="39387" href="lagda.2023-11-21-nbe.html#39213" class="Bound">Γ</a> <a id="39389" href="lagda.2023-11-21-nbe.html#39334" class="Bound">𝓋</a>
           <a id="39402" class="Comment">--------------</a>
         <a id="39426" class="Symbol">→</a> <a id="39428" href="lagda.2023-11-21-nbe.html#36610" class="Datatype">Ne</a> <a id="39431" href="lagda.2023-11-21-nbe.html#39211" class="Bound">T</a> <a id="39433" href="lagda.2023-11-21-nbe.html#39213" class="Bound">Γ</a> <a id="39435" class="Symbol">(</a><a id="39436" href="lagda.2023-11-21-nbe.html#39318" class="Bound">𝓊</a> <a id="39438" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="39440" href="lagda.2023-11-21-nbe.html#39334" class="Bound">𝓋</a><a id="39441" class="Symbol">)</a>
</pre>
<p>Normal terms are terms in their normal form. <code>unit</code> is a normal term, as is an
abstraction whose body is itself normalized. Any neutral term is also a normal
term.</p>
<pre class="Agda"><a id="39621" class="Keyword">data</a> <a id="39626" href="lagda.2023-11-21-nbe.html#36547" class="Datatype">Nf</a> <a id="39629" class="Keyword">where</a>
  <a id="Nf.nf-unit"></a><a id="39637" href="lagda.2023-11-21-nbe.html#39637" class="InductiveConstructor">nf-unit</a> <a id="39645" class="Symbol">:</a> <a id="39647" class="Symbol">∀</a> <a id="39649" class="Symbol">{</a><a id="39650" href="lagda.2023-11-21-nbe.html#39650" class="Bound">Γ</a> <a id="39652" class="Symbol">:</a> <a id="39654" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="39657" class="Symbol">}</a> <a id="39659" class="Symbol">→</a> <a id="39661" href="lagda.2023-11-21-nbe.html#36547" class="Datatype">Nf</a> <a id="39664" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a> <a id="39666" href="lagda.2023-11-21-nbe.html#39650" class="Bound">Γ</a> <a id="39668" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a>

  <a id="Nf.nf-abs"></a><a id="39676" href="lagda.2023-11-21-nbe.html#39676" class="InductiveConstructor">nf-abs</a> <a id="39683" class="Symbol">:</a> <a id="39685" class="Symbol">∀</a> <a id="39687" class="Symbol">{</a><a id="39688" href="lagda.2023-11-21-nbe.html#39688" class="Bound">S</a> <a id="39690" href="lagda.2023-11-21-nbe.html#39690" class="Bound">T</a> <a id="39692" class="Symbol">:</a> <a id="39694" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="39698" class="Symbol">}</a> <a id="39700" class="Symbol">{</a><a id="39701" href="lagda.2023-11-21-nbe.html#39701" class="Bound">Γ</a> <a id="39703" class="Symbol">:</a> <a id="39705" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="39708" class="Symbol">}</a> <a id="39710" class="Symbol">{</a><a id="39711" href="lagda.2023-11-21-nbe.html#39711" class="Bound">𝓋</a> <a id="39713" class="Symbol">:</a> <a id="39715" href="lagda.2023-11-21-nbe.html#39701" class="Bound">Γ</a> <a id="39717" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="39719" href="lagda.2023-11-21-nbe.html#39688" class="Bound">S</a> <a id="39721" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="39723" href="lagda.2023-11-21-nbe.html#39690" class="Bound">T</a><a id="39724" class="Symbol">}</a>
         <a id="39735" class="Symbol">→</a> <a id="39737" href="lagda.2023-11-21-nbe.html#36547" class="Datatype">Nf</a> <a id="39740" href="lagda.2023-11-21-nbe.html#39690" class="Bound">T</a> <a id="39742" class="Symbol">(</a><a id="39743" href="lagda.2023-11-21-nbe.html#39701" class="Bound">Γ</a> <a id="39745" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="39747" href="lagda.2023-11-21-nbe.html#39688" class="Bound">S</a><a id="39748" class="Symbol">)</a> <a id="39750" href="lagda.2023-11-21-nbe.html#39711" class="Bound">𝓋</a>
           <a id="39763" class="Comment">------------------</a>
         <a id="39791" class="Symbol">→</a> <a id="39793" href="lagda.2023-11-21-nbe.html#36547" class="Datatype">Nf</a> <a id="39796" class="Symbol">(</a><a id="39797" href="lagda.2023-11-21-nbe.html#39688" class="Bound">S</a> <a id="39799" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="39801" href="lagda.2023-11-21-nbe.html#39690" class="Bound">T</a><a id="39802" class="Symbol">)</a> <a id="39804" href="lagda.2023-11-21-nbe.html#39701" class="Bound">Γ</a> <a id="39806" class="Symbol">(</a><a id="39807" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="39809" href="lagda.2023-11-21-nbe.html#39711" class="Bound">𝓋</a><a id="39810" class="Symbol">)</a>

  <a id="Nf.nf-neutral"></a><a id="39815" href="lagda.2023-11-21-nbe.html#39815" class="InductiveConstructor">nf-neutral</a> <a id="39826" class="Symbol">:</a> <a id="39828" class="Symbol">∀</a> <a id="39830" class="Symbol">{</a><a id="39831" href="lagda.2023-11-21-nbe.html#39831" class="Bound">T</a> <a id="39833" class="Symbol">:</a> <a id="39835" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="39839" class="Symbol">}</a> <a id="39841" class="Symbol">{</a><a id="39842" href="lagda.2023-11-21-nbe.html#39842" class="Bound">Γ</a> <a id="39844" class="Symbol">:</a> <a id="39846" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="39849" class="Symbol">}</a> <a id="39851" class="Symbol">{</a><a id="39852" href="lagda.2023-11-21-nbe.html#39852" class="Bound">𝓊</a> <a id="39854" class="Symbol">:</a> <a id="39856" href="lagda.2023-11-21-nbe.html#39842" class="Bound">Γ</a> <a id="39858" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="39860" href="lagda.2023-11-21-nbe.html#39831" class="Bound">T</a><a id="39861" class="Symbol">}</a>
             <a id="39876" class="Symbol">→</a> <a id="39878" href="lagda.2023-11-21-nbe.html#36610" class="Datatype">Ne</a> <a id="39881" href="lagda.2023-11-21-nbe.html#39831" class="Bound">T</a> <a id="39883" href="lagda.2023-11-21-nbe.html#39842" class="Bound">Γ</a> <a id="39885" href="lagda.2023-11-21-nbe.html#39852" class="Bound">𝓊</a>
               <a id="39902" class="Comment">--------</a>
             <a id="39924" class="Symbol">→</a> <a id="39926" href="lagda.2023-11-21-nbe.html#36547" class="Datatype">Nf</a> <a id="39929" href="lagda.2023-11-21-nbe.html#39831" class="Bound">T</a> <a id="39931" href="lagda.2023-11-21-nbe.html#39842" class="Bound">Γ</a> <a id="39933" href="lagda.2023-11-21-nbe.html#39852" class="Bound">𝓊</a>
</pre>
<p>Now, we can discuss the issue of the freshness condition used when reifying at
function type. We are using a de Brujin index representation, so “freshness” is
given to us freely by extending the context. However, there is no context
anywhere in our definition of reification, so what context do we extend with the
fresh variable? This is actually an intentional decision for reification,
because of a problem that is more subtle: after we reflect the variable, it may
later be reified in a different context than it was created. Consider the
reification of a semantic object <code>f</code> with type <code>(S → T) → U</code>:</p>
<pre><code>↓⁽ˢ  ⃕ ᵗ⁾  ⃕ ᵘ f = λx. ↓ˢ  ⃕ ᵗ (f(a)) , where a = ↑ᵘ x</code></pre>
<p>The inner reification evaluates further:</p>
<pre><code>↓ˢ  ⃕ ᵗ (f(a)) = λy. ↓ᵗ (f(a)(b)) , where b = ↑ˢ y</code></pre>
<p>This example showcases the problem: when we reflected <code>x</code> into our meta
language, we had to (presumably) use some context <code>Γ</code> to produce the Agda
expression <code>a</code> with the type <code>Nf T Γ</code>. But later, when we reify <code>f(a)(b)</code>, we
will produce a term that is possibly using the variable <code>x</code>, but the term is
now in a different context: <code>Γ, y:S</code>.</p>
<p>This suggests that we need to generalize our reflection of terms in the object
language over all contexts, so that at reification we can use a different
context than the one that was used at reflection.</p>
<p>We introduce <em>liftable</em> normal and neutral terms to address this. These are
normal/neutral terms that are generalized over contexts.</p>
<p>While they will be generalized over contexts, this means that a liftable neutral
or normal term may not be well-typed when lifted to some contexts. It will be
the case that the liftable terms we will use in our algirhtm will only be able
to be lifted at reification to a context that is an extension of the context
used when the liftable term was reflected (and with the example above, the
reason is clear: our algorithm would otherwise never produce a term that is
well-typed).</p>
<p>Because we cannot apply <em>any</em> context to a liftable normal/neutral term, we will
need a placeholder value for some contexts.</p>
<pre class="Agda"><a id="41995" class="Comment">-- Liftable neutral term</a>
<a id="Ne^"></a><a id="42020" href="lagda.2023-11-21-nbe.html#42020" class="Function">Ne^</a> <a id="42024" class="Symbol">:</a> <a id="42026" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a> <a id="42031" class="Symbol">→</a> <a id="42033" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="42037" href="lagda.2023-11-21-nbe.html#42020" class="Function">Ne^</a> <a id="42041" href="lagda.2023-11-21-nbe.html#42041" class="Bound">T</a> <a id="42043" class="Symbol">=</a> <a id="42045" class="Symbol">∀</a> <a id="42047" class="Symbol">(</a><a id="42048" href="lagda.2023-11-21-nbe.html#42048" class="Bound">Γ</a> <a id="42050" class="Symbol">:</a> <a id="42052" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="42055" class="Symbol">)</a> <a id="42057" class="Symbol">→</a> <a id="42059" href="Data.Product.html#1806" class="Function">∃[</a> <a id="42062" href="lagda.2023-11-21-nbe.html#42062" class="Bound">t</a> <a id="42064" href="Data.Product.html#1806" class="Function">]</a> <a id="42066" href="lagda.2023-11-21-nbe.html#36610" class="Datatype">Ne</a> <a id="42069" href="lagda.2023-11-21-nbe.html#42041" class="Bound">T</a> <a id="42071" href="lagda.2023-11-21-nbe.html#42048" class="Bound">Γ</a> <a id="42073" href="lagda.2023-11-21-nbe.html#42062" class="Bound">t</a> <a id="42075" href="Data.Sum.Base.html#734" class="Datatype Operator">⊎</a> <a id="42077" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>

<a id="42080" class="Comment">-- Liftable normal term</a>
<a id="Nf^"></a><a id="42104" href="lagda.2023-11-21-nbe.html#42104" class="Function">Nf^</a> <a id="42108" class="Symbol">:</a> <a id="42110" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a> <a id="42115" class="Symbol">→</a> <a id="42117" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="42121" href="lagda.2023-11-21-nbe.html#42104" class="Function">Nf^</a> <a id="42125" href="lagda.2023-11-21-nbe.html#42125" class="Bound">T</a> <a id="42127" class="Symbol">=</a> <a id="42129" class="Symbol">∀</a> <a id="42131" class="Symbol">(</a><a id="42132" href="lagda.2023-11-21-nbe.html#42132" class="Bound">Γ</a> <a id="42134" class="Symbol">:</a> <a id="42136" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="42139" class="Symbol">)</a> <a id="42141" class="Symbol">→</a> <a id="42143" href="Data.Product.html#1806" class="Function">∃[</a> <a id="42146" href="lagda.2023-11-21-nbe.html#42146" class="Bound">t</a> <a id="42148" href="Data.Product.html#1806" class="Function">]</a> <a id="42150" href="lagda.2023-11-21-nbe.html#36547" class="Datatype">Nf</a> <a id="42153" href="lagda.2023-11-21-nbe.html#42125" class="Bound">T</a> <a id="42155" href="lagda.2023-11-21-nbe.html#42132" class="Bound">Γ</a> <a id="42157" href="lagda.2023-11-21-nbe.html#42146" class="Bound">t</a>
</pre>
<p>For convenience, we only use this placeholder for liftable neutral terms.
This is possible because of how the algorithm for normalization by evaluation
is designed ─ reification always η-expands at function type, so there will only
ever be a need to use a placeholder value at our base type <code>𝟙</code>. In the case of
liftable normals, we can fallback to using <code>unit</code> (which is a valid normal term)
instead of using our placeholder value.</p>
<p>We allow ourselves this convenience because in proving the soundness of
normalization by evaluation, we will be proving that neither the placeholder
value nor the fallback of <code>unit</code> will actually be used.</p>
<p>Going forward, we will use <code>𝓋̂</code> and <code>𝓊̂</code> as the metavariables for liftable normal
terms and neutral terms respectively, and will append the symbol <code>^</code> for the
“liftable” counterpart of a language construct. For example, we define the
overloaded application <code>(𝓊̂ 𝓋̂)(Γ) = 𝓊̂(Γ) 𝓋̂(Γ)</code> of liftable terms as <code>·^</code>.</p>
<pre class="Agda"><a id="_·^_"></a><a id="43123" href="lagda.2023-11-21-nbe.html#43123" class="Function Operator">_·^_</a> <a id="43128" class="Symbol">:</a> <a id="43130" class="Symbol">∀</a> <a id="43132" class="Symbol">{</a><a id="43133" href="lagda.2023-11-21-nbe.html#43133" class="Bound">S</a> <a id="43135" href="lagda.2023-11-21-nbe.html#43135" class="Bound">T</a> <a id="43137" class="Symbol">:</a> <a id="43139" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="43143" class="Symbol">}</a> <a id="43145" class="Symbol">→</a> <a id="43147" href="lagda.2023-11-21-nbe.html#42020" class="Function">Ne^</a> <a id="43151" class="Symbol">(</a><a id="43152" href="lagda.2023-11-21-nbe.html#43133" class="Bound">S</a> <a id="43154" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="43156" href="lagda.2023-11-21-nbe.html#43135" class="Bound">T</a><a id="43157" class="Symbol">)</a> <a id="43159" class="Symbol">→</a> <a id="43161" href="lagda.2023-11-21-nbe.html#42104" class="Function">Nf^</a> <a id="43165" href="lagda.2023-11-21-nbe.html#43133" class="Bound">S</a> <a id="43167" class="Symbol">→</a> <a id="43169" href="lagda.2023-11-21-nbe.html#42020" class="Function">Ne^</a> <a id="43173" href="lagda.2023-11-21-nbe.html#43135" class="Bound">T</a>
<a id="43175" class="Symbol">(</a><a id="43176" href="lagda.2023-11-21-nbe.html#43176" class="Bound">𝓊̂</a> <a id="43179" href="lagda.2023-11-21-nbe.html#43123" class="Function Operator">·^</a> <a id="43182" href="lagda.2023-11-21-nbe.html#43182" class="Bound">𝓋̂</a><a id="43184" class="Symbol">)</a> <a id="43186" href="lagda.2023-11-21-nbe.html#43186" class="Bound">Γ</a> <a id="43188" class="Keyword">with</a> <a id="43193" href="lagda.2023-11-21-nbe.html#43176" class="Bound">𝓊̂</a> <a id="43196" href="lagda.2023-11-21-nbe.html#43186" class="Bound">Γ</a>
<a id="43198" class="Symbol">...</a>           <a id="43212" class="Symbol">|</a> <a id="43214" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="43219" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="43221" href="lagda.2023-11-21-nbe.html#43221" class="Bound">𝓊</a> <a id="43223" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="43225" href="lagda.2023-11-21-nbe.html#43225" class="Bound">pf-𝓊</a> <a id="43230" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a> <a id="43232" class="Symbol">=</a>
  <a id="43236" class="Keyword">let</a> <a id="43240" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="43242" href="lagda.2023-11-21-nbe.html#43242" class="Bound">𝓋</a> <a id="43244" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="43246" href="lagda.2023-11-21-nbe.html#43246" class="Bound">pf-𝓋</a> <a id="43251" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a> <a id="43253" class="Symbol">=</a> <a id="43255" class="Bound">𝓋̂</a> <a id="43258" class="Bound">Γ</a> <a id="43260" class="Keyword">in</a>
  <a id="43265" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="43270" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="43272" href="lagda.2023-11-21-nbe.html#43221" class="Bound">𝓊</a> <a id="43274" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="43276" href="lagda.2023-11-21-nbe.html#43242" class="Bound">𝓋</a> <a id="43278" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="43280" href="lagda.2023-11-21-nbe.html#39295" class="InductiveConstructor">ne-app</a> <a id="43287" href="lagda.2023-11-21-nbe.html#43225" class="Bound">pf-𝓊</a> <a id="43292" href="lagda.2023-11-21-nbe.html#43246" class="Bound">pf-𝓋</a> <a id="43297" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a>
<a id="43299" class="Symbol">...</a>           <a id="43313" class="Symbol">|</a> <a id="43315" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="43320" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>           <a id="43333" class="Symbol">=</a> <a id="43335" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="43340" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>
</pre>
<p>The actual interpretation of the base type <code>𝟙</code> will be an extension to Agda’s
unit type that embeds liftable neutrals: <code>⊤̂</code> (pronounced “top hat”). With it
defined, we can also define the interpretation of types, along with the
evaluation of terms. These are exactly as was shown earlier in pseudocode.</p>
<pre class="Agda"><a id="43660" class="Keyword">data</a> <a id="⊤̂"></a><a id="43665" href="lagda.2023-11-21-nbe.html#43665" class="Datatype">⊤̂</a> <a id="43668" class="Symbol">:</a> <a id="43670" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="43674" class="Keyword">where</a>
  <a id="⊤̂.unit"></a><a id="43682" href="lagda.2023-11-21-nbe.html#43682" class="InductiveConstructor">unit</a> <a id="43687" class="Symbol">:</a> <a id="43689" href="lagda.2023-11-21-nbe.html#43665" class="Datatype">⊤̂</a>
  <a id="⊤̂.ne"></a><a id="43694" href="lagda.2023-11-21-nbe.html#43694" class="InductiveConstructor">ne</a>   <a id="43699" class="Symbol">:</a> <a id="43701" href="lagda.2023-11-21-nbe.html#42020" class="Function">Ne^</a> <a id="43705" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a> <a id="43707" class="Symbol">→</a> <a id="43709" href="lagda.2023-11-21-nbe.html#43665" class="Datatype">⊤̂</a>

<a id="43713" class="Keyword">instance</a>
  <a id="⟦Type⟧"></a><a id="43724" href="lagda.2023-11-21-nbe.html#43724" class="Function">⟦Type⟧</a> <a id="43731" class="Symbol">:</a> <a id="43733" href="lagda.2023-11-21-nbe.html#34507" class="Record">Interpretation</a> <a id="43748" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a>
  <a id="43755" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">Interpretation.⟦</a> <a id="43772" href="lagda.2023-11-21-nbe.html#43724" class="Function">⟦Type⟧</a> <a id="43779" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a> <a id="43781" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a> <a id="43783" class="Symbol">=</a> <a id="43785" href="lagda.2023-11-21-nbe.html#43665" class="Datatype">⊤̂</a>
  <a id="43790" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">Interpretation.⟦</a> <a id="43807" href="lagda.2023-11-21-nbe.html#43724" class="Function">⟦Type⟧</a> <a id="43814" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a> <a id="43816" class="Symbol">(</a><a id="43817" href="lagda.2023-11-21-nbe.html#43817" class="Bound">S</a> <a id="43819" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="43821" href="lagda.2023-11-21-nbe.html#43821" class="Bound">T</a><a id="43822" class="Symbol">)</a> <a id="43824" class="Symbol">=</a> <a id="43826" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="43828" href="lagda.2023-11-21-nbe.html#43817" class="Bound">S</a> <a id="43830" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a> <a id="43832" class="Symbol">→</a> <a id="43834" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="43836" href="lagda.2023-11-21-nbe.html#43821" class="Bound">T</a> <a id="43838" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a>

<a id="env-lookup"></a><a id="43841" href="lagda.2023-11-21-nbe.html#43841" class="Function">env-lookup</a> <a id="43852" class="Symbol">:</a> <a id="43854" class="Symbol">∀</a> <a id="43856" class="Symbol">{</a><a id="43857" href="lagda.2023-11-21-nbe.html#43857" class="Bound">Γ</a> <a id="43859" class="Symbol">:</a> <a id="43861" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="43864" class="Symbol">}</a> <a id="43866" class="Symbol">{</a><a id="43867" href="lagda.2023-11-21-nbe.html#43867" class="Bound">T</a> <a id="43869" class="Symbol">:</a> <a id="43871" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="43875" class="Symbol">}</a> <a id="43877" class="Symbol">→</a> <a id="43879" href="lagda.2023-11-21-nbe.html#43857" class="Bound">Γ</a> <a id="43881" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="43883" href="lagda.2023-11-21-nbe.html#43867" class="Bound">T</a> <a id="43885" class="Symbol">→</a> <a id="43887" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="43889" href="lagda.2023-11-21-nbe.html#43857" class="Bound">Γ</a> <a id="43891" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a> <a id="43893" class="Symbol">→</a> <a id="43895" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="43897" href="lagda.2023-11-21-nbe.html#43867" class="Bound">T</a> <a id="43899" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a>
<a id="43901" href="lagda.2023-11-21-nbe.html#43841" class="Function">env-lookup</a> <a id="43912" class="Symbol">{</a><a id="43913" href="lagda.2023-11-21-nbe.html#43913" class="Bound">Γ</a> <a id="43915" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="43917" href="lagda.2023-11-21-nbe.html#43917" class="Bound">T</a><a id="43918" class="Symbol">}</a> <a id="43920" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>     <a id="43926" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="43928" class="Symbol">_</a> <a id="43930" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="43932" href="lagda.2023-11-21-nbe.html#43932" class="Bound">a</a> <a id="43934" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a> <a id="43936" class="Symbol">=</a> <a id="43938" href="lagda.2023-11-21-nbe.html#43932" class="Bound">a</a>
<a id="43940" href="lagda.2023-11-21-nbe.html#43841" class="Function">env-lookup</a> <a id="43951" class="Symbol">{</a><a id="43952" href="lagda.2023-11-21-nbe.html#43952" class="Bound">Γ</a> <a id="43954" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="43956" href="lagda.2023-11-21-nbe.html#43956" class="Bound">T</a><a id="43957" class="Symbol">}</a> <a id="43959" class="Symbol">(</a><a id="43960" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="43962" href="lagda.2023-11-21-nbe.html#43962" class="Bound">x</a><a id="43963" class="Symbol">)</a> <a id="43965" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="43967" href="lagda.2023-11-21-nbe.html#43967" class="Bound">γ</a> <a id="43969" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="43971" class="Symbol">_</a> <a id="43973" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a> <a id="43975" class="Symbol">=</a> <a id="43977" href="lagda.2023-11-21-nbe.html#43841" class="Function">env-lookup</a> <a id="43988" href="lagda.2023-11-21-nbe.html#43962" class="Bound">x</a> <a id="43990" href="lagda.2023-11-21-nbe.html#43967" class="Bound">γ</a>

<a id="⟦⊢_⟧"></a><a id="43993" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟦⊢_⟧</a> <a id="43998" class="Symbol">:</a> <a id="44000" class="Symbol">∀</a> <a id="44002" class="Symbol">{</a><a id="44003" href="lagda.2023-11-21-nbe.html#44003" class="Bound">Γ</a> <a id="44005" class="Symbol">:</a> <a id="44007" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="44010" class="Symbol">}</a> <a id="44012" class="Symbol">{</a><a id="44013" href="lagda.2023-11-21-nbe.html#44013" class="Bound">T</a> <a id="44015" class="Symbol">:</a> <a id="44017" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="44021" class="Symbol">}</a> <a id="44023" class="Symbol">→</a> <a id="44025" href="lagda.2023-11-21-nbe.html#44003" class="Bound">Γ</a> <a id="44027" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="44029" href="lagda.2023-11-21-nbe.html#44013" class="Bound">T</a> <a id="44031" class="Symbol">→</a> <a id="44033" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="44035" href="lagda.2023-11-21-nbe.html#44003" class="Bound">Γ</a> <a id="44037" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a> <a id="44039" class="Symbol">→</a> <a id="44041" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="44043" href="lagda.2023-11-21-nbe.html#44013" class="Bound">T</a> <a id="44045" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a>
<a id="44047" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟦⊢</a> <a id="44050" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a> <a id="44055" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟧</a> <a id="44057" class="Symbol">_</a>  <a id="44060" class="Symbol">=</a> <a id="44062" href="lagda.2023-11-21-nbe.html#43682" class="InductiveConstructor">unit</a>
<a id="44067" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟦⊢</a> <a id="44070" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="44072" href="lagda.2023-11-21-nbe.html#44072" class="Bound">x</a> <a id="44074" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟧</a> <a id="44076" href="lagda.2023-11-21-nbe.html#44076" class="Bound">γ</a>   <a id="44080" class="Symbol">=</a> <a id="44082" href="lagda.2023-11-21-nbe.html#43841" class="Function">env-lookup</a> <a id="44093" href="lagda.2023-11-21-nbe.html#44072" class="Bound">x</a> <a id="44095" href="lagda.2023-11-21-nbe.html#44076" class="Bound">γ</a>
<a id="44097" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟦⊢</a> <a id="44100" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="44102" href="lagda.2023-11-21-nbe.html#44102" class="Bound">t</a> <a id="44104" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟧</a> <a id="44106" href="lagda.2023-11-21-nbe.html#44106" class="Bound">γ</a> <a id="44108" href="lagda.2023-11-21-nbe.html#44108" class="Bound">a</a> <a id="44110" class="Symbol">=</a> <a id="44112" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟦⊢</a> <a id="44115" href="lagda.2023-11-21-nbe.html#44102" class="Bound">t</a> <a id="44117" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟧</a> <a id="44119" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="44121" href="lagda.2023-11-21-nbe.html#44106" class="Bound">γ</a> <a id="44123" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="44125" href="lagda.2023-11-21-nbe.html#44108" class="Bound">a</a> <a id="44127" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a>
<a id="44129" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟦⊢</a> <a id="44132" href="lagda.2023-11-21-nbe.html#44132" class="Bound">r</a> <a id="44134" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="44136" href="lagda.2023-11-21-nbe.html#44136" class="Bound">s</a> <a id="44138" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟧</a> <a id="44140" href="lagda.2023-11-21-nbe.html#44140" class="Bound">γ</a> <a id="44142" class="Symbol">=</a> <a id="44144" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟦⊢</a> <a id="44147" href="lagda.2023-11-21-nbe.html#44132" class="Bound">r</a> <a id="44149" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟧</a> <a id="44151" href="lagda.2023-11-21-nbe.html#44140" class="Bound">γ</a> <a id="44153" class="Symbol">(</a><a id="44154" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟦⊢</a> <a id="44157" href="lagda.2023-11-21-nbe.html#44136" class="Bound">s</a> <a id="44159" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟧</a>  <a id="44162" href="lagda.2023-11-21-nbe.html#44140" class="Bound">γ</a><a id="44163" class="Symbol">)</a>
</pre>
<p>To reify an Agda expressions of type <code>⊤̂</code>, we will define a function <code>↓⊤̂</code>. It is
here that the fallback to <code>unit</code> happens, when the context that the embedded
liftable neutral is being lifted to results in it being undefined. This case
will be irrelevant and we will prove that it will never actually be used in the
algorithm for normalization by evaluation by proving that the algorithm
preserves the meaning of the original term (such a fallback actually being used
would make this impossible to prove).</p>
<pre class="Agda"><a id="↓⊤̂"></a><a id="44685" href="lagda.2023-11-21-nbe.html#44685" class="Function">↓⊤̂</a> <a id="44689" class="Symbol">:</a> <a id="44691" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="44693" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a> <a id="44695" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a> <a id="44697" class="Symbol">→</a> <a id="44699" href="lagda.2023-11-21-nbe.html#42104" class="Function">Nf^</a> <a id="44703" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a>
<a id="44705" href="lagda.2023-11-21-nbe.html#44685" class="Function">↓⊤̂</a> <a id="44709" href="lagda.2023-11-21-nbe.html#43682" class="InductiveConstructor">unit</a> <a id="44714" class="Symbol">=</a> <a id="44716" href="lagda.2023-11-21-nbe.html#44730" class="Function">unit^</a> <a id="44722" class="Keyword">where</a>
  <a id="44730" href="lagda.2023-11-21-nbe.html#44730" class="Function">unit^</a> <a id="44736" class="Symbol">=</a> <a id="44738" class="Symbol">(λ</a> <a id="44741" href="lagda.2023-11-21-nbe.html#44741" class="Bound">_</a> <a id="44743" class="Symbol">→</a> <a id="44745" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="44747" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a> <a id="44752" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="44754" href="lagda.2023-11-21-nbe.html#39637" class="InductiveConstructor">nf-unit</a> <a id="44762" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a><a id="44763" class="Symbol">)</a>
<a id="44765" href="lagda.2023-11-21-nbe.html#44685" class="Function">↓⊤̂</a> <a id="44769" class="Symbol">(</a><a id="44770" href="lagda.2023-11-21-nbe.html#43694" class="InductiveConstructor">ne</a> <a id="44773" href="lagda.2023-11-21-nbe.html#44773" class="Bound">𝓊̂</a><a id="44775" class="Symbol">)</a> <a id="44777" href="lagda.2023-11-21-nbe.html#44777" class="Bound">Γ</a> <a id="44779" class="Keyword">with</a> <a id="44784" href="lagda.2023-11-21-nbe.html#44773" class="Bound">𝓊̂</a> <a id="44787" href="lagda.2023-11-21-nbe.html#44777" class="Bound">Γ</a>
<a id="44789" class="Symbol">...</a>            <a id="44804" class="Symbol">|</a> <a id="44806" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="44811" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="44813" href="lagda.2023-11-21-nbe.html#44813" class="Bound">𝓊</a> <a id="44815" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="44817" href="lagda.2023-11-21-nbe.html#44817" class="Bound">pf</a> <a id="44820" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a> <a id="44822" class="Symbol">=</a> <a id="44824" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="44826" href="lagda.2023-11-21-nbe.html#44813" class="Bound">𝓊</a> <a id="44828" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="44830" href="lagda.2023-11-21-nbe.html#39815" class="InductiveConstructor">nf-neutral</a> <a id="44841" href="lagda.2023-11-21-nbe.html#44817" class="Bound">pf</a> <a id="44844" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a>
<a id="44846" class="Symbol">...</a>            <a id="44861" class="Symbol">|</a> <a id="44863" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="44868" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>         <a id="44879" class="Symbol">=</a> <a id="44881" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="44883" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a> <a id="44888" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="44890" href="lagda.2023-11-21-nbe.html#39637" class="InductiveConstructor">nf-unit</a> <a id="44898" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a>
</pre>
<p>We are now ready to actually define reflection and reification in Agda. These
are mutually recursive, and will each be defined by induction on the type <code>T</code>.
Their definition is almost the same as the sketch shown in pseudocode, except
that the implicit changing of contexts is now being handled by using liftable
terms instead.</p>
<pre class="Agda">
<a id="45243" class="Keyword">mutual</a>
  <a id="↑ᵀ"></a><a id="45252" href="lagda.2023-11-21-nbe.html#45252" class="Function">↑ᵀ</a> <a id="45255" class="Symbol">:</a> <a id="45257" class="Symbol">{</a><a id="45258" href="lagda.2023-11-21-nbe.html#45258" class="Bound">T</a> <a id="45260" class="Symbol">:</a> <a id="45262" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="45266" class="Symbol">}</a> <a id="45268" class="Symbol">→</a> <a id="45270" href="lagda.2023-11-21-nbe.html#42020" class="Function">Ne^</a> <a id="45274" href="lagda.2023-11-21-nbe.html#45258" class="Bound">T</a> <a id="45276" class="Symbol">→</a> <a id="45278" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="45280" href="lagda.2023-11-21-nbe.html#45258" class="Bound">T</a> <a id="45282" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a>
  <a id="45286" href="lagda.2023-11-21-nbe.html#45252" class="Function">↑ᵀ</a> <a id="45289" class="Symbol">{</a><a id="45290" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a><a id="45291" class="Symbol">}</a> <a id="45293" href="lagda.2023-11-21-nbe.html#45293" class="Bound">𝓊̂</a> <a id="45296" class="Symbol">=</a> <a id="45298" href="lagda.2023-11-21-nbe.html#43694" class="InductiveConstructor">ne</a> <a id="45301" href="lagda.2023-11-21-nbe.html#45293" class="Bound">𝓊̂</a>
  <a id="45306" href="lagda.2023-11-21-nbe.html#45252" class="Function">↑ᵀ</a> <a id="45309" class="Symbol">{</a><a id="45310" href="lagda.2023-11-21-nbe.html#45310" class="Bound">S</a> <a id="45312" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="45314" href="lagda.2023-11-21-nbe.html#45314" class="Bound">T</a><a id="45315" class="Symbol">}</a> <a id="45317" href="lagda.2023-11-21-nbe.html#45317" class="Bound">𝓊̂</a> <a id="45320" href="lagda.2023-11-21-nbe.html#45320" class="Bound">a</a> <a id="45322" class="Symbol">=</a> <a id="45324" href="lagda.2023-11-21-nbe.html#45252" class="Function">↑ᵀ</a> <a id="45327" class="Symbol">(</a><a id="45328" href="lagda.2023-11-21-nbe.html#45317" class="Bound">𝓊̂</a> <a id="45331" href="lagda.2023-11-21-nbe.html#43123" class="Function Operator">·^</a> <a id="45334" href="lagda.2023-11-21-nbe.html#45344" class="Function">𝓋̂</a><a id="45336" class="Symbol">)</a> <a id="45338" class="Keyword">where</a> <a id="45344" href="lagda.2023-11-21-nbe.html#45344" class="Function">𝓋̂</a> <a id="45347" class="Symbol">=</a> <a id="45349" href="lagda.2023-11-21-nbe.html#45357" class="Function">↓ᵀ</a> <a id="45352" href="lagda.2023-11-21-nbe.html#45320" class="Bound">a</a>

  <a id="↓ᵀ"></a><a id="45357" href="lagda.2023-11-21-nbe.html#45357" class="Function">↓ᵀ</a> <a id="45360" class="Symbol">:</a> <a id="45362" class="Symbol">{</a><a id="45363" href="lagda.2023-11-21-nbe.html#45363" class="Bound">T</a> <a id="45365" class="Symbol">:</a> <a id="45367" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="45371" class="Symbol">}</a> <a id="45373" class="Symbol">→</a> <a id="45375" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="45377" href="lagda.2023-11-21-nbe.html#45363" class="Bound">T</a> <a id="45379" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a> <a id="45381" class="Symbol">→</a> <a id="45383" href="lagda.2023-11-21-nbe.html#42104" class="Function">Nf^</a> <a id="45387" href="lagda.2023-11-21-nbe.html#45363" class="Bound">T</a>
  <a id="45391" href="lagda.2023-11-21-nbe.html#45357" class="Function">↓ᵀ</a> <a id="45394" class="Symbol">{</a><a id="45395" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a><a id="45396" class="Symbol">}</a> <a id="45398" class="Symbol">=</a> <a id="45400" href="lagda.2023-11-21-nbe.html#44685" class="Function">↓⊤̂</a>
  <a id="45406" href="lagda.2023-11-21-nbe.html#45357" class="Function">↓ᵀ</a> <a id="45409" class="Symbol">{</a><a id="45410" href="lagda.2023-11-21-nbe.html#45410" class="Bound">S</a> <a id="45412" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="45414" href="lagda.2023-11-21-nbe.html#45414" class="Bound">T</a><a id="45415" class="Symbol">}</a> <a id="45417" href="lagda.2023-11-21-nbe.html#45417" class="Bound">f</a> <a id="45419" href="lagda.2023-11-21-nbe.html#45419" class="Bound">Γ</a> <a id="45421" class="Symbol">=</a>
    <a id="45427" class="Keyword">let</a> <a id="45431" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="45433" href="lagda.2023-11-21-nbe.html#45433" class="Bound">𝓋</a> <a id="45435" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="45437" href="lagda.2023-11-21-nbe.html#45437" class="Bound">pf</a> <a id="45440" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a> <a id="45442" class="Symbol">=</a> <a id="45444" href="lagda.2023-11-21-nbe.html#45357" class="Function">↓ᵀ</a> <a id="45447" class="Symbol">(</a><a id="45448" href="lagda.2023-11-21-nbe.html#45417" class="Bound">f</a> <a id="45450" href="lagda.2023-11-21-nbe.html#45498" class="Function">a</a><a id="45451" class="Symbol">)</a> <a id="45453" class="Symbol">(</a><a id="45454" href="lagda.2023-11-21-nbe.html#45419" class="Bound">Γ</a> <a id="45456" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="45458" href="lagda.2023-11-21-nbe.html#45410" class="Bound">S</a><a id="45459" class="Symbol">)</a> <a id="45461" class="Keyword">in</a>
    <a id="45468" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="45470" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="45472" href="lagda.2023-11-21-nbe.html#45433" class="Bound">𝓋</a> <a id="45474" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="45476" href="lagda.2023-11-21-nbe.html#39676" class="InductiveConstructor">nf-abs</a> <a id="45483" href="lagda.2023-11-21-nbe.html#45437" class="Bound">pf</a> <a id="45486" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a>
    <a id="45492" class="Keyword">where</a> <a id="45498" href="lagda.2023-11-21-nbe.html#45498" class="Function">a</a> <a id="45500" class="Symbol">=</a> <a id="45502" href="lagda.2023-11-21-nbe.html#45252" class="Function">↑ᵀ</a> <a id="45505" class="Symbol">(</a><a id="45506" href="lagda.2023-11-21-nbe.html#46082" class="Function">𝓍̂</a> <a id="45509" href="lagda.2023-11-21-nbe.html#45410" class="Bound">S</a> <a id="45511" href="lagda.2023-11-21-nbe.html#45419" class="Bound">Γ</a><a id="45512" class="Symbol">)</a>
</pre>
<p>Freshness is given to us almost for free as we are using a de Brujin
representation, so a fresh variable would just be the de Brujin index <code>𝑍</code>. This
variable will be used in a different context from the one in which it was
created, so it will need to be renamed.</p>
<p>For this purpose we use <code>𝓍̂ S Γ</code>, a liftable variable of type <code>S</code> that can only
be lifted to extensions of the context <code>Γ, x:S</code>. When lifted to an extension
<code>Γ′</code> of <code>Γ, x:S</code> we apply the extension renaming to the de Brujin index <code>𝑍</code> to
obtain its corresponding index in the extended context.</p>
<pre class="Agda">  <a id="𝓍̂"></a><a id="46082" href="lagda.2023-11-21-nbe.html#46082" class="Function">𝓍̂</a> <a id="46085" class="Symbol">:</a> <a id="46087" class="Symbol">(</a><a id="46088" href="lagda.2023-11-21-nbe.html#46088" class="Bound">S</a> <a id="46090" class="Symbol">:</a> <a id="46092" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="46096" class="Symbol">)</a> <a id="46098" class="Symbol">→</a> <a id="46100" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a> <a id="46104" class="Symbol">→</a> <a id="46106" href="lagda.2023-11-21-nbe.html#42020" class="Function">Ne^</a> <a id="46110" href="lagda.2023-11-21-nbe.html#46088" class="Bound">S</a>
  <a id="46114" href="lagda.2023-11-21-nbe.html#46082" class="Function">𝓍̂</a> <a id="46117" href="lagda.2023-11-21-nbe.html#46117" class="Bound">S</a> <a id="46119" href="lagda.2023-11-21-nbe.html#46119" class="Bound">Γ</a> <a id="46121" href="lagda.2023-11-21-nbe.html#46121" class="Bound">Γ′</a>
    <a id="46128" class="Keyword">with</a> <a id="46133" href="lagda.2023-11-21-nbe.html#46121" class="Bound">Γ′</a> <a id="46136" href="lagda.2023-11-21-nbe.html#10889" class="Function Operator">≤?</a> <a id="46139" class="Symbol">(</a><a id="46140" href="lagda.2023-11-21-nbe.html#46119" class="Bound">Γ</a> <a id="46142" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="46144" href="lagda.2023-11-21-nbe.html#46117" class="Bound">S</a><a id="46145" class="Symbol">)</a>
  <a id="46149" class="Symbol">...</a>  <a id="46154" class="Symbol">|</a> <a id="46156" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="46159" class="Symbol">_</a>          <a id="46170" class="Symbol">=</a> <a id="46172" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="46177" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>
  <a id="46182" class="Symbol">...</a>  <a id="46187" class="Symbol">|</a> <a id="46189" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="46193" href="lagda.2023-11-21-nbe.html#46193" class="Bound">pf</a>        <a id="46203" class="Symbol">=</a> <a id="46205" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="46210" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="46212" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="46214" href="lagda.2023-11-21-nbe.html#46235" class="Function">x</a> <a id="46216" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="46218" href="lagda.2023-11-21-nbe.html#39223" class="InductiveConstructor">ne-var</a> <a id="46225" href="lagda.2023-11-21-nbe.html#46235" class="Function">x</a> <a id="46227" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a> <a id="46229" class="Keyword">where</a> <a id="46235" href="lagda.2023-11-21-nbe.html#46235" class="Function">x</a> <a id="46237" class="Symbol">=</a> <a id="46239" href="lagda.2023-11-21-nbe.html#13819" class="Function">ρ-≤</a> <a id="46243" href="lagda.2023-11-21-nbe.html#46193" class="Bound">pf</a> <a id="46246" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>
</pre>
<p>We can also define the reflection of a context <code>Γ</code> into an environment, which
will be the reflected environment over which a typed term in the context <code>Γ</code>
will be evaluated.</p>
<pre class="Agda"><a id="↑ᶜᵗˣ"></a><a id="46436" href="lagda.2023-11-21-nbe.html#46436" class="Function">↑ᶜᵗˣ</a> <a id="46441" class="Symbol">:</a> <a id="46443" class="Symbol">∀</a> <a id="46445" class="Symbol">(</a><a id="46446" href="lagda.2023-11-21-nbe.html#46446" class="Bound">Γ</a> <a id="46448" class="Symbol">:</a> <a id="46450" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="46453" class="Symbol">)</a> <a id="46455" class="Symbol">→</a> <a id="46457" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="46459" href="lagda.2023-11-21-nbe.html#46446" class="Bound">Γ</a> <a id="46461" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a>
<a id="46463" href="lagda.2023-11-21-nbe.html#46436" class="Function">↑ᶜᵗˣ</a> <a id="46468" href="lagda.2023-11-21-nbe.html#3944" class="InductiveConstructor">∅</a>       <a id="46476" class="Symbol">=</a> <a id="46478" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>
<a id="46481" href="lagda.2023-11-21-nbe.html#46436" class="Function">↑ᶜᵗˣ</a> <a id="46486" class="Symbol">(</a><a id="46487" href="lagda.2023-11-21-nbe.html#46487" class="Bound">Γ</a> <a id="46489" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="46491" href="lagda.2023-11-21-nbe.html#46491" class="Bound">T</a><a id="46492" class="Symbol">)</a> <a id="46494" class="Symbol">=</a> <a id="46496" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="46498" href="lagda.2023-11-21-nbe.html#46436" class="Function">↑ᶜᵗˣ</a> <a id="46503" href="lagda.2023-11-21-nbe.html#46487" class="Bound">Γ</a>  <a id="46506" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="46508" href="lagda.2023-11-21-nbe.html#45252" class="Function">↑ᵀ</a> <a id="46511" class="Symbol">(</a><a id="46512" href="lagda.2023-11-21-nbe.html#46082" class="Function">𝓍̂</a> <a id="46515" href="lagda.2023-11-21-nbe.html#46491" class="Bound">T</a> <a id="46517" href="lagda.2023-11-21-nbe.html#46487" class="Bound">Γ</a><a id="46518" class="Symbol">)</a> <a id="46520" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a>
</pre>
<p>Finally, the algorithm for normalization by evaluation can be written in Agda.
Its definition is again almost exactly the same as the sketch in pseudocode,
except that we now lift the reified normal term to the original context <code>Γ</code>.</p>
<pre class="Agda"><a id="nbe"></a><a id="46769" href="lagda.2023-11-21-nbe.html#46769" class="Function">nbe</a> <a id="46773" class="Symbol">:</a> <a id="46775" class="Symbol">∀</a> <a id="46777" class="Symbol">{</a><a id="46778" href="lagda.2023-11-21-nbe.html#46778" class="Bound">Γ</a> <a id="46780" class="Symbol">:</a> <a id="46782" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="46785" class="Symbol">}</a> <a id="46787" class="Symbol">{</a><a id="46788" href="lagda.2023-11-21-nbe.html#46788" class="Bound">T</a> <a id="46790" class="Symbol">:</a> <a id="46792" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="46796" class="Symbol">}</a> <a id="46798" class="Symbol">→</a> <a id="46800" href="lagda.2023-11-21-nbe.html#46778" class="Bound">Γ</a> <a id="46802" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="46804" href="lagda.2023-11-21-nbe.html#46788" class="Bound">T</a> <a id="46806" class="Symbol">→</a> <a id="46808" href="Data.Product.html#1806" class="Function">∃[</a> <a id="46811" href="lagda.2023-11-21-nbe.html#46811" class="Bound">t</a> <a id="46813" href="Data.Product.html#1806" class="Function">]</a> <a id="46815" href="lagda.2023-11-21-nbe.html#36547" class="Datatype">Nf</a> <a id="46818" href="lagda.2023-11-21-nbe.html#46788" class="Bound">T</a> <a id="46820" href="lagda.2023-11-21-nbe.html#46778" class="Bound">Γ</a> <a id="46822" href="lagda.2023-11-21-nbe.html#46811" class="Bound">t</a>
<a id="46824" href="lagda.2023-11-21-nbe.html#46769" class="Function">nbe</a> <a id="46828" class="Symbol">{</a><a id="46829" href="lagda.2023-11-21-nbe.html#46829" class="Bound">Γ</a><a id="46830" class="Symbol">}</a> <a id="46832" href="lagda.2023-11-21-nbe.html#46832" class="Bound">t</a> <a id="46834" class="Symbol">=</a> <a id="46836" href="lagda.2023-11-21-nbe.html#45357" class="Function">↓ᵀ</a> <a id="46839" class="Symbol">(</a><a id="46840" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟦⊢</a> <a id="46843" href="lagda.2023-11-21-nbe.html#46832" class="Bound">t</a> <a id="46845" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟧</a> <a id="46847" class="Symbol">(</a><a id="46848" href="lagda.2023-11-21-nbe.html#46436" class="Function">↑ᶜᵗˣ</a> <a id="46853" href="lagda.2023-11-21-nbe.html#46829" class="Bound">Γ</a><a id="46854" class="Symbol">))</a> <a id="46857" href="lagda.2023-11-21-nbe.html#46829" class="Bound">Γ</a>

<a id="nf"></a><a id="46860" href="lagda.2023-11-21-nbe.html#46860" class="Function">nf</a> <a id="46863" class="Symbol">:</a> <a id="46865" class="Symbol">∀</a> <a id="46867" class="Symbol">{</a><a id="46868" href="lagda.2023-11-21-nbe.html#46868" class="Bound">Γ</a> <a id="46870" class="Symbol">:</a> <a id="46872" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="46875" class="Symbol">}</a> <a id="46877" class="Symbol">{</a><a id="46878" href="lagda.2023-11-21-nbe.html#46878" class="Bound">T</a> <a id="46880" class="Symbol">:</a> <a id="46882" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="46886" class="Symbol">}</a> <a id="46888" class="Symbol">→</a> <a id="46890" href="lagda.2023-11-21-nbe.html#46868" class="Bound">Γ</a> <a id="46892" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="46894" href="lagda.2023-11-21-nbe.html#46878" class="Bound">T</a> <a id="46896" class="Symbol">→</a> <a id="46898" href="lagda.2023-11-21-nbe.html#46868" class="Bound">Γ</a> <a id="46900" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="46902" href="lagda.2023-11-21-nbe.html#46878" class="Bound">T</a>
<a id="46904" href="lagda.2023-11-21-nbe.html#46860" class="Function">nf</a> <a id="46907" href="lagda.2023-11-21-nbe.html#46907" class="Bound">t</a> <a id="46909" class="Symbol">=</a> <a id="46911" class="Keyword">let</a> <a id="46915" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="46917" href="lagda.2023-11-21-nbe.html#46917" class="Bound">t′</a> <a id="46920" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="46922" class="Symbol">_</a> <a id="46924" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a> <a id="46926" class="Symbol">=</a> <a id="46928" href="lagda.2023-11-21-nbe.html#46769" class="Function">nbe</a> <a id="46932" href="lagda.2023-11-21-nbe.html#46907" class="Bound">t</a> <a id="46934" class="Keyword">in</a> <a id="46937" href="lagda.2023-11-21-nbe.html#46917" class="Bound">t′</a>
</pre>
<p>And here is an example of the algorithm in action:</p>
<pre class="Agda"><a id="47005" class="Keyword">module</a> <a id="AlgorithmExample"></a><a id="47012" href="lagda.2023-11-21-nbe.html#47012" class="Module">AlgorithmExample</a> <a id="47029" class="Keyword">where</a>
  <a id="47037" class="Comment">-- (λx. (λy. y) x) unit</a>
  <a id="AlgorithmExample.ex"></a><a id="47063" href="lagda.2023-11-21-nbe.html#47063" class="Function">ex</a> <a id="47066" class="Symbol">:</a> <a id="47068" href="lagda.2023-11-21-nbe.html#3944" class="InductiveConstructor">∅</a> <a id="47070" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="47072" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a>
  <a id="47076" href="lagda.2023-11-21-nbe.html#47063" class="Function">ex</a> <a id="47079" class="Symbol">=</a> <a id="47081" class="Symbol">(</a><a id="47082" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="47084" class="Symbol">(</a><a id="47085" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="47087" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="47089" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a><a id="47090" class="Symbol">)</a> <a id="47092" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="47094" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="47096" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a><a id="47097" class="Symbol">)</a> <a id="47099" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="47101" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a>

  <a id="47109" class="Comment">-- normal form is unit</a>
  <a id="AlgorithmExample.nf-ex"></a><a id="47134" href="lagda.2023-11-21-nbe.html#47134" class="Function">nf-ex</a> <a id="47140" class="Symbol">:</a> <a id="47142" href="lagda.2023-11-21-nbe.html#46860" class="Function">nf</a> <a id="47145" href="lagda.2023-11-21-nbe.html#47063" class="Function">ex</a> <a id="47148" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="47150" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a>
  <a id="47157" href="lagda.2023-11-21-nbe.html#47134" class="Function">nf-ex</a> <a id="47163" class="Keyword">with</a> <a id="47168" href="lagda.2023-11-21-nbe.html#47063" class="Function">ex</a>
  <a id="47173" href="lagda.2023-11-21-nbe.html#47134" class="Function">...</a>      <a id="47182" class="Symbol">|</a> <a id="47184" class="Symbol">_</a>  <a id="47187" class="Symbol">=</a> <a id="47189" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
</pre>
<h3 id="correctness">Correctness</h3>
<p>We wish for our algorithm for normalization by evaluation to be both complete
and sound. First, we need to prove the property that if two terms are
definitionally equal, then they must have the same interpretation. This proof
is omitted in the rendering as well ─ it is an adaptation of the proof of
soundness of reduction with respect to denotational semantics in PLFA seen
in <a href="https://plfa.github.io/Soundness/">this</a> chapter.</p>
<!---

A renaming `Γ ⊢ ρ : Δ` relates an environment `γ ∈ ⟦ Γ ⟧` to an environment
`δ ∈ ⟦ Δ ⟧` iff the semantic object in `γ` for `ρ x` is equivalent to the
semantic object in `δ` for `x` for any variable `x` in the context `Δ`:

    γ ⊩ ρ ~ δ ⇔ ∀ x. ⟦ Γ ∋ (ρ x):T ⟧ γ ≡ ⟦ Δ ∋ x:T ⟧ δ

<pre class="Agda"><a id="_⊩ʳ_~_"></a><a id="47940" href="lagda.2023-11-21-nbe.html#47940" class="Function Operator">_⊩ʳ_~_</a> <a id="47947" class="Symbol">:</a> <a id="47949" class="Symbol">∀</a> <a id="47951" class="Symbol">{</a><a id="47952" href="lagda.2023-11-21-nbe.html#47952" class="Bound">Γ</a> <a id="47954" href="lagda.2023-11-21-nbe.html#47954" class="Bound">Δ</a> <a id="47956" class="Symbol">:</a> <a id="47958" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="47961" class="Symbol">}</a> <a id="47963" class="Symbol">→</a> <a id="47965" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="47967" href="lagda.2023-11-21-nbe.html#47952" class="Bound">Γ</a> <a id="47969" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a> <a id="47971" class="Symbol">→</a> <a id="47973" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="47977" href="lagda.2023-11-21-nbe.html#47952" class="Bound">Γ</a> <a id="47979" href="lagda.2023-11-21-nbe.html#47954" class="Bound">Δ</a> <a id="47981" class="Symbol">→</a> <a id="47983" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="47985" href="lagda.2023-11-21-nbe.html#47954" class="Bound">Δ</a> <a id="47987" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a> <a id="47989" class="Symbol">→</a> <a id="47991" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="47995" href="lagda.2023-11-21-nbe.html#47940" class="Function Operator">_⊩ʳ_~_</a> <a id="48002" class="Symbol">{</a><a id="48003" class="Argument">Δ</a> <a id="48005" class="Symbol">=</a> <a id="48007" href="lagda.2023-11-21-nbe.html#48007" class="Bound">Δ</a><a id="48008" class="Symbol">}</a> <a id="48010" href="lagda.2023-11-21-nbe.html#48010" class="Bound">γ</a> <a id="48012" href="lagda.2023-11-21-nbe.html#48012" class="Bound">ρ</a> <a id="48014" href="lagda.2023-11-21-nbe.html#48014" class="Bound">δ</a> <a id="48016" class="Symbol">=</a>
  <a id="48020" class="Symbol">∀</a> <a id="48022" class="Symbol">{</a><a id="48023" href="lagda.2023-11-21-nbe.html#48023" class="Bound">T</a> <a id="48025" class="Symbol">:</a> <a id="48027" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="48031" class="Symbol">}</a> <a id="48033" class="Symbol">(</a><a id="48034" href="lagda.2023-11-21-nbe.html#48034" class="Bound">x</a> <a id="48036" class="Symbol">:</a> <a id="48038" href="lagda.2023-11-21-nbe.html#48007" class="Bound">Δ</a> <a id="48040" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="48042" href="lagda.2023-11-21-nbe.html#48023" class="Bound">T</a><a id="48043" class="Symbol">)</a> <a id="48045" class="Symbol">→</a> <a id="48047" href="lagda.2023-11-21-nbe.html#43841" class="Function">env-lookup</a> <a id="48058" class="Symbol">(</a><a id="48059" href="lagda.2023-11-21-nbe.html#48012" class="Bound">ρ</a> <a id="48061" href="lagda.2023-11-21-nbe.html#48034" class="Bound">x</a><a id="48062" class="Symbol">)</a> <a id="48064" href="lagda.2023-11-21-nbe.html#48010" class="Bound">γ</a> <a id="48066" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="48068" href="lagda.2023-11-21-nbe.html#43841" class="Function">env-lookup</a> <a id="48079" href="lagda.2023-11-21-nbe.html#48034" class="Bound">x</a> <a id="48081" href="lagda.2023-11-21-nbe.html#48014" class="Bound">δ</a>
</pre>
Any renaming that satisfies this relation preserves meaning between
environments.

<pre class="Agda"><a id="rename-preserves-meaning"></a><a id="48179" href="lagda.2023-11-21-nbe.html#48179" class="Function">rename-preserves-meaning</a> <a id="48204" class="Symbol">:</a> <a id="48206" class="Symbol">∀</a> <a id="48208" class="Symbol">{</a><a id="48209" href="lagda.2023-11-21-nbe.html#48209" class="Bound">Γ</a> <a id="48211" href="lagda.2023-11-21-nbe.html#48211" class="Bound">Δ</a> <a id="48213" class="Symbol">:</a> <a id="48215" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="48218" class="Symbol">}</a> <a id="48220" class="Symbol">{</a><a id="48221" href="lagda.2023-11-21-nbe.html#48221" class="Bound">T</a> <a id="48223" class="Symbol">:</a> <a id="48225" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="48229" class="Symbol">}</a> <a id="48231" class="Symbol">{</a><a id="48232" href="lagda.2023-11-21-nbe.html#48232" class="Bound">γ</a> <a id="48234" class="Symbol">:</a> <a id="48236" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="48238" href="lagda.2023-11-21-nbe.html#48209" class="Bound">Γ</a> <a id="48240" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a><a id="48241" class="Symbol">}</a> <a id="48243" class="Symbol">{</a><a id="48244" href="lagda.2023-11-21-nbe.html#48244" class="Bound">δ</a> <a id="48246" class="Symbol">:</a> <a id="48248" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="48250" href="lagda.2023-11-21-nbe.html#48211" class="Bound">Δ</a> <a id="48252" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a><a id="48253" class="Symbol">}</a>
                             <a id="48284" class="Symbol">{</a><a id="48285" href="lagda.2023-11-21-nbe.html#48285" class="Bound">t</a> <a id="48287" class="Symbol">:</a> <a id="48289" href="lagda.2023-11-21-nbe.html#48211" class="Bound">Δ</a> <a id="48291" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="48293" href="lagda.2023-11-21-nbe.html#48221" class="Bound">T</a><a id="48294" class="Symbol">}</a> <a id="48296" class="Symbol">{</a><a id="48297" href="lagda.2023-11-21-nbe.html#48297" class="Bound">ρ</a> <a id="48299" class="Symbol">:</a> <a id="48301" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="48305" href="lagda.2023-11-21-nbe.html#48209" class="Bound">Γ</a> <a id="48307" href="lagda.2023-11-21-nbe.html#48211" class="Bound">Δ</a><a id="48308" class="Symbol">}</a>
                         <a id="48335" class="Symbol">→</a> <a id="48337" href="lagda.2023-11-21-nbe.html#48232" class="Bound">γ</a> <a id="48339" href="lagda.2023-11-21-nbe.html#47940" class="Function Operator">⊩ʳ</a> <a id="48342" href="lagda.2023-11-21-nbe.html#48297" class="Bound">ρ</a> <a id="48344" href="lagda.2023-11-21-nbe.html#47940" class="Function Operator">~</a> <a id="48346" href="lagda.2023-11-21-nbe.html#48244" class="Bound">δ</a>
                         <a id="48373" class="Symbol">→</a> <a id="48375" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟦⊢</a> <a id="48378" href="lagda.2023-11-21-nbe.html#48285" class="Bound">t</a> <a id="48380" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">[</a> <a id="48382" href="lagda.2023-11-21-nbe.html#48297" class="Bound">ρ</a> <a id="48384" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">]ʳ</a> <a id="48387" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟧</a> <a id="48389" href="lagda.2023-11-21-nbe.html#48232" class="Bound">γ</a> <a id="48391" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="48393" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟦⊢</a> <a id="48396" href="lagda.2023-11-21-nbe.html#48285" class="Bound">t</a> <a id="48398" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟧</a> <a id="48400" href="lagda.2023-11-21-nbe.html#48244" class="Bound">δ</a>
<a id="48402" href="lagda.2023-11-21-nbe.html#48179" class="Function">rename-preserves-meaning</a> <a id="48427" class="Symbol">{</a><a id="48428" class="Argument">t</a> <a id="48430" class="Symbol">=</a> <a id="48432" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a><a id="48436" class="Symbol">}</a> <a id="48438" href="lagda.2023-11-21-nbe.html#48438" class="Bound">pf</a> <a id="48441" class="Symbol">=</a> <a id="48443" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="48448" href="lagda.2023-11-21-nbe.html#48179" class="Function">rename-preserves-meaning</a> <a id="48473" class="Symbol">{</a><a id="48474" class="Argument">t</a> <a id="48476" class="Symbol">=</a> <a id="48478" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="48480" href="lagda.2023-11-21-nbe.html#48480" class="Bound">x</a><a id="48481" class="Symbol">}</a> <a id="48483" href="lagda.2023-11-21-nbe.html#48483" class="Bound">pf</a> <a id="48486" class="Symbol">=</a> <a id="48488" href="lagda.2023-11-21-nbe.html#48483" class="Bound">pf</a> <a id="48491" href="lagda.2023-11-21-nbe.html#48480" class="Bound">x</a>
<a id="48493" href="lagda.2023-11-21-nbe.html#48179" class="Function">rename-preserves-meaning</a> <a id="48518" class="Symbol">{</a><a id="48519" class="Argument">Δ</a> <a id="48521" class="Symbol">=</a> <a id="48523" href="lagda.2023-11-21-nbe.html#48523" class="Bound">Δ</a><a id="48524" class="Symbol">}</a> <a id="48526" class="Symbol">{</a><a id="48527" href="lagda.2023-11-21-nbe.html#48527" class="Bound">S</a> <a id="48529" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="48531" class="Symbol">_}</a> <a id="48534" class="Symbol">{</a><a id="48535" href="lagda.2023-11-21-nbe.html#48535" class="Bound">γ</a><a id="48536" class="Symbol">}</a> <a id="48538" class="Symbol">{</a><a id="48539" href="lagda.2023-11-21-nbe.html#48539" class="Bound">δ</a><a id="48540" class="Symbol">}</a> <a id="48542" class="Symbol">{</a><a id="48543" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="48545" href="lagda.2023-11-21-nbe.html#48545" class="Bound">t</a><a id="48546" class="Symbol">}</a> <a id="48548" class="Symbol">{</a><a id="48549" href="lagda.2023-11-21-nbe.html#48549" class="Bound">ρ</a><a id="48550" class="Symbol">}</a> <a id="48552" href="lagda.2023-11-21-nbe.html#48552" class="Bound">pf</a> <a id="48555" class="Symbol">=</a>
  <a id="48559" href="lagda.2023-11-21-nbe.html#2744" class="Postulate">extensionality</a> <a id="48574" class="Symbol">λ{</a><a id="48576" href="lagda.2023-11-21-nbe.html#48576" class="Bound">a</a> <a id="48578" class="Symbol">→</a> <a id="48580" href="lagda.2023-11-21-nbe.html#48179" class="Function">rename-preserves-meaning</a> <a id="48605" class="Symbol">{</a><a id="48606" class="Argument">t</a> <a id="48608" class="Symbol">=</a> <a id="48610" href="lagda.2023-11-21-nbe.html#48545" class="Bound">t</a><a id="48611" class="Symbol">}</a> <a id="48613" class="Symbol">{</a><a id="48614" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="48618" href="lagda.2023-11-21-nbe.html#48549" class="Bound">ρ</a><a id="48619" class="Symbol">}</a> <a id="48621" class="Symbol">(</a><a id="48622" href="lagda.2023-11-21-nbe.html#48646" class="Function">lemma</a> <a id="48628" class="Symbol">{</a><a id="48629" href="lagda.2023-11-21-nbe.html#48576" class="Bound">a</a><a id="48630" class="Symbol">})}</a>
  <a id="48636" class="Keyword">where</a>
    <a id="48646" href="lagda.2023-11-21-nbe.html#48646" class="Function">lemma</a> <a id="48652" class="Symbol">:</a> <a id="48654" class="Symbol">∀</a> <a id="48656" class="Symbol">{</a><a id="48657" href="lagda.2023-11-21-nbe.html#48657" class="Bound">a</a> <a id="48659" class="Symbol">:</a> <a id="48661" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="48663" href="lagda.2023-11-21-nbe.html#48527" class="Bound">S</a> <a id="48665" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a><a id="48666" class="Symbol">}</a> <a id="48668" class="Symbol">{</a><a id="48669" href="lagda.2023-11-21-nbe.html#48669" class="Bound">T</a> <a id="48671" class="Symbol">:</a> <a id="48673" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="48677" class="Symbol">}</a> <a id="48679" class="Symbol">(</a><a id="48680" href="lagda.2023-11-21-nbe.html#48680" class="Bound">x</a> <a id="48682" class="Symbol">:</a> <a id="48684" href="lagda.2023-11-21-nbe.html#48523" class="Bound">Δ</a> <a id="48686" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="48688" href="lagda.2023-11-21-nbe.html#48527" class="Bound">S</a> <a id="48690" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="48692" href="lagda.2023-11-21-nbe.html#48669" class="Bound">T</a><a id="48693" class="Symbol">)</a>
          <a id="48705" class="Symbol">→</a> <a id="48707" href="lagda.2023-11-21-nbe.html#43841" class="Function">env-lookup</a> <a id="48718" class="Symbol">(</a><a id="48719" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="48723" href="lagda.2023-11-21-nbe.html#48549" class="Bound">ρ</a> <a id="48725" href="lagda.2023-11-21-nbe.html#48680" class="Bound">x</a><a id="48726" class="Symbol">)</a> <a id="48728" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="48730" href="lagda.2023-11-21-nbe.html#48535" class="Bound">γ</a> <a id="48732" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="48734" href="lagda.2023-11-21-nbe.html#48657" class="Bound">a</a> <a id="48736" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a> <a id="48738" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="48740" href="lagda.2023-11-21-nbe.html#43841" class="Function">env-lookup</a> <a id="48751" href="lagda.2023-11-21-nbe.html#48680" class="Bound">x</a> <a id="48753" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="48755" href="lagda.2023-11-21-nbe.html#48539" class="Bound">δ</a> <a id="48757" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="48759" href="lagda.2023-11-21-nbe.html#48657" class="Bound">a</a> <a id="48761" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a>
    <a id="48767" href="lagda.2023-11-21-nbe.html#48646" class="Function">lemma</a> <a id="48773" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>     <a id="48779" class="Symbol">=</a> <a id="48781" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
    <a id="48790" href="lagda.2023-11-21-nbe.html#48646" class="Function">lemma</a> <a id="48796" class="Symbol">(</a><a id="48797" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="48799" href="lagda.2023-11-21-nbe.html#48799" class="Bound">x</a><a id="48800" class="Symbol">)</a> <a id="48802" class="Symbol">=</a> <a id="48804" href="lagda.2023-11-21-nbe.html#48552" class="Bound">pf</a> <a id="48807" href="lagda.2023-11-21-nbe.html#48799" class="Bound">x</a>
<a id="48809" href="lagda.2023-11-21-nbe.html#48179" class="Function">rename-preserves-meaning</a> <a id="48834" class="Symbol">{</a><a id="48835" class="Argument">t</a> <a id="48837" class="Symbol">=</a> <a id="48839" href="lagda.2023-11-21-nbe.html#48839" class="Bound">r</a> <a id="48841" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="48843" href="lagda.2023-11-21-nbe.html#48843" class="Bound">s</a><a id="48844" class="Symbol">}</a> <a id="48846" class="Symbol">{</a><a id="48847" href="lagda.2023-11-21-nbe.html#48847" class="Bound">ρ</a><a id="48848" class="Symbol">}</a> <a id="48850" href="lagda.2023-11-21-nbe.html#48850" class="Bound">pf</a>
  <a id="48855" class="Keyword">rewrite</a> <a id="48863" href="lagda.2023-11-21-nbe.html#48179" class="Function">rename-preserves-meaning</a> <a id="48888" class="Symbol">{</a><a id="48889" class="Argument">t</a> <a id="48891" class="Symbol">=</a> <a id="48893" href="lagda.2023-11-21-nbe.html#48839" class="Bound">r</a><a id="48894" class="Symbol">}</a> <a id="48896" class="Symbol">{</a><a id="48897" href="lagda.2023-11-21-nbe.html#48847" class="Bound">ρ</a><a id="48898" class="Symbol">}</a> <a id="48900" href="lagda.2023-11-21-nbe.html#48850" class="Bound">pf</a>
        <a id="48911" class="Symbol">|</a> <a id="48913" href="lagda.2023-11-21-nbe.html#48179" class="Function">rename-preserves-meaning</a> <a id="48938" class="Symbol">{</a><a id="48939" class="Argument">t</a> <a id="48941" class="Symbol">=</a> <a id="48943" href="lagda.2023-11-21-nbe.html#48843" class="Bound">s</a><a id="48944" class="Symbol">}</a> <a id="48946" class="Symbol">{</a><a id="48947" href="lagda.2023-11-21-nbe.html#48847" class="Bound">ρ</a><a id="48948" class="Symbol">}</a> <a id="48950" href="lagda.2023-11-21-nbe.html#48850" class="Bound">pf</a> <a id="48953" class="Symbol">=</a> <a id="48955" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
</pre>
A substitution `Γ ⊢ σ : Δ` relates an environment `γ ∈ ⟦ Γ ⟧` to an environment
`δ ∈ ⟦ Δ ⟧` iff for every variable `x` in the context `Δ`, the evaluation of
`σ x` under the environment `γ` is equivalent to the semantic object in `δ`
corresponding to the variable `x`:

    γ ⊩ σ ~ δ ⇔ ∀ x. ⟦⊢ σ x ⟧ γ ≡ ⟦⊢ Δ ∋ x:T ⟧ δ

<pre class="Agda"><a id="_⊩_~_"></a><a id="49292" href="lagda.2023-11-21-nbe.html#49292" class="Function Operator">_⊩_~_</a> <a id="49298" class="Symbol">:</a> <a id="49300" class="Symbol">∀</a> <a id="49302" class="Symbol">{</a><a id="49303" href="lagda.2023-11-21-nbe.html#49303" class="Bound">Γ</a> <a id="49305" href="lagda.2023-11-21-nbe.html#49305" class="Bound">Δ</a> <a id="49307" class="Symbol">:</a> <a id="49309" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="49312" class="Symbol">}</a> <a id="49314" class="Symbol">→</a> <a id="49316" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="49318" href="lagda.2023-11-21-nbe.html#49303" class="Bound">Γ</a> <a id="49320" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a> <a id="49322" class="Symbol">→</a> <a id="49324" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="49328" href="lagda.2023-11-21-nbe.html#49303" class="Bound">Γ</a> <a id="49330" href="lagda.2023-11-21-nbe.html#49305" class="Bound">Δ</a> <a id="49332" class="Symbol">→</a> <a id="49334" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="49336" href="lagda.2023-11-21-nbe.html#49305" class="Bound">Δ</a> <a id="49338" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a> <a id="49340" class="Symbol">→</a> <a id="49342" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="49346" href="lagda.2023-11-21-nbe.html#49292" class="Function Operator">_⊩_~_</a> <a id="49352" class="Symbol">{</a><a id="49353" class="Argument">Δ</a> <a id="49355" class="Symbol">=</a> <a id="49357" href="lagda.2023-11-21-nbe.html#49357" class="Bound">Δ</a><a id="49358" class="Symbol">}</a> <a id="49360" href="lagda.2023-11-21-nbe.html#49360" class="Bound">γ</a> <a id="49362" href="lagda.2023-11-21-nbe.html#49362" class="Bound">σ</a> <a id="49364" href="lagda.2023-11-21-nbe.html#49364" class="Bound">δ</a> <a id="49366" class="Symbol">=</a> <a id="49368" class="Symbol">∀</a> <a id="49370" class="Symbol">{</a><a id="49371" href="lagda.2023-11-21-nbe.html#49371" class="Bound">T</a> <a id="49373" class="Symbol">:</a> <a id="49375" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="49379" class="Symbol">}</a> <a id="49381" class="Symbol">(</a><a id="49382" href="lagda.2023-11-21-nbe.html#49382" class="Bound">x</a> <a id="49384" class="Symbol">:</a> <a id="49386" href="lagda.2023-11-21-nbe.html#49357" class="Bound">Δ</a> <a id="49388" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="49390" href="lagda.2023-11-21-nbe.html#49371" class="Bound">T</a><a id="49391" class="Symbol">)</a> <a id="49393" class="Symbol">→</a> <a id="49395" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟦⊢</a> <a id="49398" href="lagda.2023-11-21-nbe.html#49362" class="Bound">σ</a> <a id="49400" href="lagda.2023-11-21-nbe.html#49382" class="Bound">x</a> <a id="49402" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟧</a> <a id="49404" href="lagda.2023-11-21-nbe.html#49360" class="Bound">γ</a> <a id="49406" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="49408" href="lagda.2023-11-21-nbe.html#43841" class="Function">env-lookup</a> <a id="49419" href="lagda.2023-11-21-nbe.html#49382" class="Bound">x</a> <a id="49421" href="lagda.2023-11-21-nbe.html#49364" class="Bound">δ</a>
</pre>
This relation allows for proving that substitutions preserve meaning, using a
lemma that the relation is closed under substitution extension.

<pre class="Agda"><a id="subst-exts"></a><a id="49579" href="lagda.2023-11-21-nbe.html#49579" class="Function">subst-exts</a> <a id="49590" class="Symbol">:</a> <a id="49592" class="Symbol">∀</a> <a id="49594" class="Symbol">{</a><a id="49595" href="lagda.2023-11-21-nbe.html#49595" class="Bound">Γ</a> <a id="49597" href="lagda.2023-11-21-nbe.html#49597" class="Bound">Δ</a> <a id="49599" class="Symbol">:</a> <a id="49601" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="49604" class="Symbol">}</a> <a id="49606" class="Symbol">{</a><a id="49607" href="lagda.2023-11-21-nbe.html#49607" class="Bound">S</a> <a id="49609" class="Symbol">:</a> <a id="49611" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="49615" class="Symbol">}</a> <a id="49617" class="Symbol">{</a><a id="49618" href="lagda.2023-11-21-nbe.html#49618" class="Bound">γ</a> <a id="49620" class="Symbol">:</a> <a id="49622" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="49624" href="lagda.2023-11-21-nbe.html#49595" class="Bound">Γ</a> <a id="49626" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a><a id="49627" class="Symbol">}</a> <a id="49629" class="Symbol">{</a><a id="49630" href="lagda.2023-11-21-nbe.html#49630" class="Bound">a</a> <a id="49632" class="Symbol">:</a> <a id="49634" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="49636" href="lagda.2023-11-21-nbe.html#49607" class="Bound">S</a> <a id="49638" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a><a id="49639" class="Symbol">}</a> <a id="49641" class="Symbol">{</a><a id="49642" href="lagda.2023-11-21-nbe.html#49642" class="Bound">σ</a> <a id="49644" class="Symbol">:</a> <a id="49646" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="49650" href="lagda.2023-11-21-nbe.html#49595" class="Bound">Γ</a> <a id="49652" href="lagda.2023-11-21-nbe.html#49597" class="Bound">Δ</a><a id="49653" class="Symbol">}</a>
               <a id="49670" class="Symbol">{</a><a id="49671" href="lagda.2023-11-21-nbe.html#49671" class="Bound">δ</a> <a id="49673" class="Symbol">:</a> <a id="49675" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="49677" href="lagda.2023-11-21-nbe.html#49597" class="Bound">Δ</a> <a id="49679" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a><a id="49680" class="Symbol">}</a>
           <a id="49693" class="Symbol">→</a> <a id="49695" href="lagda.2023-11-21-nbe.html#49618" class="Bound">γ</a> <a id="49697" href="lagda.2023-11-21-nbe.html#49292" class="Function Operator">⊩</a> <a id="49699" href="lagda.2023-11-21-nbe.html#49642" class="Bound">σ</a> <a id="49701" href="lagda.2023-11-21-nbe.html#49292" class="Function Operator">~</a> <a id="49703" href="lagda.2023-11-21-nbe.html#49671" class="Bound">δ</a>
           <a id="49716" class="Symbol">→</a> <a id="49718" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="49720" href="lagda.2023-11-21-nbe.html#49618" class="Bound">γ</a> <a id="49722" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="49724" href="lagda.2023-11-21-nbe.html#49630" class="Bound">a</a> <a id="49726" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a> <a id="49728" href="lagda.2023-11-21-nbe.html#49292" class="Function Operator">⊩</a> <a id="49730" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="49735" href="lagda.2023-11-21-nbe.html#49642" class="Bound">σ</a> <a id="49737" href="lagda.2023-11-21-nbe.html#49292" class="Function Operator">~</a> <a id="49739" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="49741" href="lagda.2023-11-21-nbe.html#49671" class="Bound">δ</a> <a id="49743" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="49745" href="lagda.2023-11-21-nbe.html#49630" class="Bound">a</a> <a id="49747" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a>
<a id="49749" href="lagda.2023-11-21-nbe.html#49579" class="Function">subst-exts</a> <a id="49760" class="Symbol">_</a> <a id="49762" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a> <a id="49764" class="Symbol">=</a> <a id="49766" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="49771" href="lagda.2023-11-21-nbe.html#49579" class="Function">subst-exts</a> <a id="49782" class="Symbol">{</a><a id="49783" class="Argument">σ</a> <a id="49785" class="Symbol">=</a> <a id="49787" href="lagda.2023-11-21-nbe.html#49787" class="Bound">σ</a><a id="49788" class="Symbol">}</a> <a id="49790" href="lagda.2023-11-21-nbe.html#49790" class="Bound">pf</a> <a id="49793" class="Symbol">(</a><a id="49794" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="49796" href="lagda.2023-11-21-nbe.html#49796" class="Bound">x</a><a id="49797" class="Symbol">)</a> <a id="49799" class="Keyword">rewrite</a> <a id="49807" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="49811" class="Symbol">(</a><a id="49812" href="lagda.2023-11-21-nbe.html#49790" class="Bound">pf</a> <a id="49815" href="lagda.2023-11-21-nbe.html#49796" class="Bound">x</a><a id="49816" class="Symbol">)</a> <a id="49818" class="Symbol">=</a>
  <a id="49822" href="lagda.2023-11-21-nbe.html#48179" class="Function">rename-preserves-meaning</a> <a id="49847" class="Symbol">{</a><a id="49848" class="Argument">t</a> <a id="49850" class="Symbol">=</a> <a id="49852" href="lagda.2023-11-21-nbe.html#49787" class="Bound">σ</a> <a id="49854" href="lagda.2023-11-21-nbe.html#49796" class="Bound">x</a><a id="49855" class="Symbol">}</a> <a id="49857" class="Symbol">{</a><a id="49858" href="lagda.2023-11-21-nbe.html#13230" class="Function">↥ʳ</a><a id="49860" class="Symbol">}</a> <a id="49862" class="Symbol">λ</a> <a id="49864" href="lagda.2023-11-21-nbe.html#49864" class="Bound">_</a> <a id="49866" class="Symbol">→</a> <a id="49868" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="subst-preserves-meaning"></a><a id="49874" href="lagda.2023-11-21-nbe.html#49874" class="Function">subst-preserves-meaning</a> <a id="49898" class="Symbol">:</a> <a id="49900" class="Symbol">∀</a> <a id="49902" class="Symbol">{</a><a id="49903" href="lagda.2023-11-21-nbe.html#49903" class="Bound">Γ</a> <a id="49905" href="lagda.2023-11-21-nbe.html#49905" class="Bound">Δ</a> <a id="49907" class="Symbol">:</a> <a id="49909" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="49912" class="Symbol">}</a> <a id="49914" class="Symbol">{</a><a id="49915" href="lagda.2023-11-21-nbe.html#49915" class="Bound">T</a> <a id="49917" class="Symbol">:</a> <a id="49919" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="49923" class="Symbol">}</a> <a id="49925" class="Symbol">{</a><a id="49926" href="lagda.2023-11-21-nbe.html#49926" class="Bound">γ</a> <a id="49928" class="Symbol">:</a> <a id="49930" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="49932" href="lagda.2023-11-21-nbe.html#49903" class="Bound">Γ</a> <a id="49934" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a><a id="49935" class="Symbol">}</a> <a id="49937" class="Symbol">{</a><a id="49938" href="lagda.2023-11-21-nbe.html#49938" class="Bound">δ</a> <a id="49940" class="Symbol">:</a> <a id="49942" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="49944" href="lagda.2023-11-21-nbe.html#49905" class="Bound">Δ</a> <a id="49946" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a><a id="49947" class="Symbol">}</a>
                            <a id="49977" class="Symbol">{</a><a id="49978" href="lagda.2023-11-21-nbe.html#49978" class="Bound">σ</a> <a id="49980" class="Symbol">:</a> <a id="49982" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="49986" href="lagda.2023-11-21-nbe.html#49903" class="Bound">Γ</a> <a id="49988" href="lagda.2023-11-21-nbe.html#49905" class="Bound">Δ</a><a id="49989" class="Symbol">}</a> <a id="49991" class="Symbol">{</a><a id="49992" href="lagda.2023-11-21-nbe.html#49992" class="Bound">t</a> <a id="49994" class="Symbol">:</a> <a id="49996" href="lagda.2023-11-21-nbe.html#49905" class="Bound">Δ</a> <a id="49998" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="50000" href="lagda.2023-11-21-nbe.html#49915" class="Bound">T</a><a id="50001" class="Symbol">}</a>
                        <a id="50027" class="Symbol">→</a> <a id="50029" href="lagda.2023-11-21-nbe.html#49926" class="Bound">γ</a> <a id="50031" href="lagda.2023-11-21-nbe.html#49292" class="Function Operator">⊩</a> <a id="50033" href="lagda.2023-11-21-nbe.html#49978" class="Bound">σ</a> <a id="50035" href="lagda.2023-11-21-nbe.html#49292" class="Function Operator">~</a> <a id="50037" href="lagda.2023-11-21-nbe.html#49938" class="Bound">δ</a>
                        <a id="50063" class="Symbol">→</a> <a id="50065" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟦⊢</a> <a id="50068" href="lagda.2023-11-21-nbe.html#49992" class="Bound">t</a> <a id="50070" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="50072" href="lagda.2023-11-21-nbe.html#49978" class="Bound">σ</a> <a id="50074" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a> <a id="50076" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟧</a> <a id="50078" href="lagda.2023-11-21-nbe.html#49926" class="Bound">γ</a> <a id="50080" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="50082" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟦⊢</a> <a id="50085" href="lagda.2023-11-21-nbe.html#49992" class="Bound">t</a> <a id="50087" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟧</a> <a id="50089" href="lagda.2023-11-21-nbe.html#49938" class="Bound">δ</a>
<a id="50091" href="lagda.2023-11-21-nbe.html#49874" class="Function">subst-preserves-meaning</a> <a id="50115" class="Symbol">{</a><a id="50116" class="Argument">t</a> <a id="50118" class="Symbol">=</a> <a id="50120" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a><a id="50124" class="Symbol">}</a> <a id="50126" href="lagda.2023-11-21-nbe.html#50126" class="Bound">x</a> <a id="50128" class="Symbol">=</a> <a id="50130" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="50135" href="lagda.2023-11-21-nbe.html#49874" class="Function">subst-preserves-meaning</a> <a id="50159" class="Symbol">{</a><a id="50160" class="Argument">t</a> <a id="50162" class="Symbol">=</a> <a id="50164" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="50166" href="lagda.2023-11-21-nbe.html#50166" class="Bound">x</a><a id="50167" class="Symbol">}</a> <a id="50169" href="lagda.2023-11-21-nbe.html#50169" class="Bound">pf</a> <a id="50172" class="Symbol">=</a> <a id="50174" href="lagda.2023-11-21-nbe.html#50169" class="Bound">pf</a> <a id="50177" href="lagda.2023-11-21-nbe.html#50166" class="Bound">x</a>
<a id="50179" href="lagda.2023-11-21-nbe.html#49874" class="Function">subst-preserves-meaning</a> <a id="50203" class="Symbol">{</a><a id="50204" class="Argument">T</a> <a id="50206" class="Symbol">=</a> <a id="50208" href="lagda.2023-11-21-nbe.html#50208" class="Bound">S</a> <a id="50210" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="50212" href="lagda.2023-11-21-nbe.html#50212" class="Bound">T</a><a id="50213" class="Symbol">}</a> <a id="50215" class="Symbol">{</a><a id="50216" href="lagda.2023-11-21-nbe.html#50216" class="Bound">γ</a><a id="50217" class="Symbol">}</a> <a id="50219" class="Symbol">{</a><a id="50220" href="lagda.2023-11-21-nbe.html#50220" class="Bound">δ</a><a id="50221" class="Symbol">}</a> <a id="50223" class="Symbol">{</a><a id="50224" href="lagda.2023-11-21-nbe.html#50224" class="Bound">σ</a><a id="50225" class="Symbol">}</a> <a id="50227" class="Symbol">{</a><a id="50228" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="50230" href="lagda.2023-11-21-nbe.html#50230" class="Bound">t</a><a id="50231" class="Symbol">}</a> <a id="50233" href="lagda.2023-11-21-nbe.html#50233" class="Bound">pf</a> <a id="50236" class="Symbol">=</a> <a id="50238" href="lagda.2023-11-21-nbe.html#2744" class="Postulate">extensionality</a> <a id="50253" href="lagda.2023-11-21-nbe.html#50269" class="Function">lemma</a>
  <a id="50261" class="Keyword">where</a>
  <a id="50269" href="lagda.2023-11-21-nbe.html#50269" class="Function">lemma</a> <a id="50275" class="Symbol">:</a> <a id="50277" class="Symbol">∀</a> <a id="50279" class="Symbol">(</a><a id="50280" href="lagda.2023-11-21-nbe.html#50280" class="Bound">a</a> <a id="50282" class="Symbol">:</a> <a id="50284" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="50286" href="lagda.2023-11-21-nbe.html#50208" class="Bound">S</a> <a id="50288" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a><a id="50289" class="Symbol">)</a> <a id="50291" class="Symbol">→</a> <a id="50293" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟦⊢</a> <a id="50296" href="lagda.2023-11-21-nbe.html#50230" class="Bound">t</a> <a id="50298" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="50300" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="50305" href="lagda.2023-11-21-nbe.html#50224" class="Bound">σ</a> <a id="50307" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a> <a id="50309" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟧</a> <a id="50311" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="50313" href="lagda.2023-11-21-nbe.html#50216" class="Bound">γ</a> <a id="50315" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="50317" href="lagda.2023-11-21-nbe.html#50280" class="Bound">a</a> <a id="50319" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a> <a id="50321" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="50323" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟦⊢</a> <a id="50326" href="lagda.2023-11-21-nbe.html#50230" class="Bound">t</a> <a id="50328" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟧</a> <a id="50330" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="50332" href="lagda.2023-11-21-nbe.html#50220" class="Bound">δ</a> <a id="50334" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="50336" href="lagda.2023-11-21-nbe.html#50280" class="Bound">a</a> <a id="50338" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a>
  <a id="50342" href="lagda.2023-11-21-nbe.html#50269" class="Function">lemma</a> <a id="50348" href="lagda.2023-11-21-nbe.html#50348" class="Bound">a</a> <a id="50350" class="Symbol">=</a> <a id="50352" href="lagda.2023-11-21-nbe.html#49874" class="Function">subst-preserves-meaning</a> <a id="50376" class="Symbol">{</a><a id="50377" class="Argument">σ</a> <a id="50379" class="Symbol">=</a> <a id="50381" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="50386" href="lagda.2023-11-21-nbe.html#50224" class="Bound">σ</a><a id="50387" class="Symbol">}</a> <a id="50389" class="Symbol">{</a><a id="50390" class="Argument">t</a> <a id="50392" class="Symbol">=</a> <a id="50394" href="lagda.2023-11-21-nbe.html#50230" class="Bound">t</a><a id="50395" class="Symbol">}</a> <a id="50397" class="Symbol">(</a><a id="50398" href="lagda.2023-11-21-nbe.html#49579" class="Function">subst-exts</a> <a id="50409" href="lagda.2023-11-21-nbe.html#50233" class="Bound">pf</a><a id="50411" class="Symbol">)</a>
<a id="50413" href="lagda.2023-11-21-nbe.html#49874" class="Function">subst-preserves-meaning</a> <a id="50437" class="Symbol">{</a><a id="50438" class="Argument">σ</a> <a id="50440" class="Symbol">=</a> <a id="50442" href="lagda.2023-11-21-nbe.html#50442" class="Bound">σ</a><a id="50443" class="Symbol">}</a> <a id="50445" class="Symbol">{</a><a id="50446" href="lagda.2023-11-21-nbe.html#50446" class="Bound">r</a> <a id="50448" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="50450" href="lagda.2023-11-21-nbe.html#50450" class="Bound">s</a><a id="50451" class="Symbol">}</a> <a id="50453" href="lagda.2023-11-21-nbe.html#50453" class="Bound">pf</a>
  <a id="50458" class="Keyword">rewrite</a> <a id="50466" href="lagda.2023-11-21-nbe.html#49874" class="Function">subst-preserves-meaning</a> <a id="50490" class="Symbol">{</a><a id="50491" class="Argument">σ</a> <a id="50493" class="Symbol">=</a> <a id="50495" href="lagda.2023-11-21-nbe.html#50442" class="Bound">σ</a><a id="50496" class="Symbol">}</a> <a id="50498" class="Symbol">{</a><a id="50499" href="lagda.2023-11-21-nbe.html#50446" class="Bound">r</a><a id="50500" class="Symbol">}</a> <a id="50502" href="lagda.2023-11-21-nbe.html#50453" class="Bound">pf</a>
        <a id="50513" class="Symbol">|</a> <a id="50515" href="lagda.2023-11-21-nbe.html#49874" class="Function">subst-preserves-meaning</a> <a id="50539" class="Symbol">{</a><a id="50540" class="Argument">σ</a> <a id="50542" class="Symbol">=</a> <a id="50544" href="lagda.2023-11-21-nbe.html#50442" class="Bound">σ</a><a id="50545" class="Symbol">}</a> <a id="50547" class="Symbol">{</a><a id="50548" href="lagda.2023-11-21-nbe.html#50450" class="Bound">s</a><a id="50549" class="Symbol">}</a> <a id="50551" href="lagda.2023-11-21-nbe.html#50453" class="Bound">pf</a> <a id="50554" class="Symbol">=</a> <a id="50556" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
</pre>
A corollary of this is that β-reductions preserve meaning:

<pre class="Agda"><a id="β-preserves-meaning"></a><a id="50634" href="lagda.2023-11-21-nbe.html#50634" class="Function">β-preserves-meaning</a> <a id="50654" class="Symbol">:</a> <a id="50656" class="Symbol">∀</a> <a id="50658" class="Symbol">{</a><a id="50659" href="lagda.2023-11-21-nbe.html#50659" class="Bound">Γ</a> <a id="50661" class="Symbol">:</a> <a id="50663" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="50666" class="Symbol">}</a> <a id="50668" class="Symbol">{</a><a id="50669" href="lagda.2023-11-21-nbe.html#50669" class="Bound">S</a> <a id="50671" href="lagda.2023-11-21-nbe.html#50671" class="Bound">T</a> <a id="50673" class="Symbol">:</a> <a id="50675" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="50679" class="Symbol">}</a> <a id="50681" class="Symbol">{</a><a id="50682" href="lagda.2023-11-21-nbe.html#50682" class="Bound">γ</a> <a id="50684" class="Symbol">:</a> <a id="50686" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="50688" href="lagda.2023-11-21-nbe.html#50659" class="Bound">Γ</a> <a id="50690" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a><a id="50691" class="Symbol">}</a> <a id="50693" class="Symbol">{</a><a id="50694" href="lagda.2023-11-21-nbe.html#50694" class="Bound">s</a> <a id="50696" class="Symbol">:</a> <a id="50698" href="lagda.2023-11-21-nbe.html#50659" class="Bound">Γ</a> <a id="50700" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="50702" href="lagda.2023-11-21-nbe.html#50669" class="Bound">S</a><a id="50703" class="Symbol">}</a>
                        <a id="50729" class="Symbol">{</a><a id="50730" href="lagda.2023-11-21-nbe.html#50730" class="Bound">t</a> <a id="50732" class="Symbol">:</a> <a id="50734" href="lagda.2023-11-21-nbe.html#50659" class="Bound">Γ</a> <a id="50736" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="50738" href="lagda.2023-11-21-nbe.html#50669" class="Bound">S</a> <a id="50740" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="50742" href="lagda.2023-11-21-nbe.html#50671" class="Bound">T</a><a id="50743" class="Symbol">}</a>
                    <a id="50765" class="Symbol">→</a> <a id="50767" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟦⊢</a> <a id="50770" href="lagda.2023-11-21-nbe.html#50730" class="Bound">t</a> <a id="50772" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟧</a> <a id="50774" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="50776" href="lagda.2023-11-21-nbe.html#50682" class="Bound">γ</a> <a id="50778" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="50780" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟦⊢</a> <a id="50783" href="lagda.2023-11-21-nbe.html#50694" class="Bound">s</a> <a id="50785" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟧</a> <a id="50787" href="lagda.2023-11-21-nbe.html#50682" class="Bound">γ</a> <a id="50789" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a> <a id="50791" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="50793" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟦⊢</a> <a id="50796" href="lagda.2023-11-21-nbe.html#50730" class="Bound">t</a> <a id="50798" href="lagda.2023-11-21-nbe.html#29378" class="Function Operator">[</a> <a id="50800" href="lagda.2023-11-21-nbe.html#50694" class="Bound">s</a> <a id="50802" href="lagda.2023-11-21-nbe.html#29378" class="Function Operator">]₀</a> <a id="50805" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟧</a> <a id="50807" href="lagda.2023-11-21-nbe.html#50682" class="Bound">γ</a>
<a id="50809" href="lagda.2023-11-21-nbe.html#50634" class="Function">β-preserves-meaning</a> <a id="50829" class="Symbol">{</a><a id="50830" href="lagda.2023-11-21-nbe.html#50830" class="Bound">Γ</a><a id="50831" class="Symbol">}</a> <a id="50833" class="Symbol">{</a><a id="50834" href="lagda.2023-11-21-nbe.html#50834" class="Bound">S</a><a id="50835" class="Symbol">}</a> <a id="50837" class="Symbol">{</a><a id="50838" class="Argument">γ</a> <a id="50840" class="Symbol">=</a> <a id="50842" href="lagda.2023-11-21-nbe.html#50842" class="Bound">γ</a><a id="50843" class="Symbol">}</a> <a id="50845" class="Symbol">{</a><a id="50846" href="lagda.2023-11-21-nbe.html#50846" class="Bound">s</a><a id="50847" class="Symbol">}</a> <a id="50849" class="Symbol">{</a><a id="50850" href="lagda.2023-11-21-nbe.html#50850" class="Bound">t</a><a id="50851" class="Symbol">}</a> <a id="50853" class="Symbol">=</a>
  <a id="50857" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="50861" class="Symbol">(</a><a id="50862" href="lagda.2023-11-21-nbe.html#49874" class="Function">subst-preserves-meaning</a> <a id="50886" class="Symbol">{</a><a id="50887" class="Argument">γ</a> <a id="50889" class="Symbol">=</a> <a id="50891" href="lagda.2023-11-21-nbe.html#50842" class="Bound">γ</a><a id="50892" class="Symbol">}</a> <a id="50894" class="Symbol">{</a><a id="50895" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="50897" href="lagda.2023-11-21-nbe.html#50842" class="Bound">γ</a> <a id="50899" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="50901" href="lagda.2023-11-21-nbe.html#50936" class="Function">a</a> <a id="50903" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a><a id="50904" class="Symbol">}</a> <a id="50906" class="Symbol">{</a><a id="50907" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="50910" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="50912" href="lagda.2023-11-21-nbe.html#50846" class="Bound">s</a><a id="50913" class="Symbol">}</a> <a id="50915" class="Symbol">{</a><a id="50916" href="lagda.2023-11-21-nbe.html#50850" class="Bound">t</a><a id="50917" class="Symbol">}</a> <a id="50919" href="lagda.2023-11-21-nbe.html#50951" class="Function">lemma</a><a id="50924" class="Symbol">)</a>
  <a id="50928" class="Keyword">where</a>
  <a id="50936" href="lagda.2023-11-21-nbe.html#50936" class="Function">a</a> <a id="50938" class="Symbol">=</a> <a id="50940" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟦⊢</a> <a id="50943" href="lagda.2023-11-21-nbe.html#50846" class="Bound">s</a> <a id="50945" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟧</a> <a id="50947" href="lagda.2023-11-21-nbe.html#50842" class="Bound">γ</a>
  <a id="50951" href="lagda.2023-11-21-nbe.html#50951" class="Function">lemma</a> <a id="50957" class="Symbol">:</a> <a id="50959" class="Symbol">∀</a> <a id="50961" class="Symbol">{</a><a id="50962" href="lagda.2023-11-21-nbe.html#50962" class="Bound">T</a> <a id="50964" class="Symbol">:</a> <a id="50966" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="50970" class="Symbol">}</a>
        <a id="50980" class="Symbol">→</a> <a id="50982" class="Symbol">(</a><a id="50983" href="lagda.2023-11-21-nbe.html#50983" class="Bound">x</a> <a id="50985" class="Symbol">:</a> <a id="50987" href="lagda.2023-11-21-nbe.html#50830" class="Bound">Γ</a> <a id="50989" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="50991" href="lagda.2023-11-21-nbe.html#50834" class="Bound">S</a> <a id="50993" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="50995" href="lagda.2023-11-21-nbe.html#50962" class="Bound">T</a><a id="50996" class="Symbol">)</a>
        <a id="51006" class="Symbol">→</a> <a id="51008" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟦⊢</a> <a id="51011" class="Symbol">(</a><a id="51012" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="51015" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="51017" href="lagda.2023-11-21-nbe.html#50846" class="Bound">s</a><a id="51018" class="Symbol">)</a> <a id="51020" href="lagda.2023-11-21-nbe.html#50983" class="Bound">x</a> <a id="51022" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟧</a> <a id="51024" href="lagda.2023-11-21-nbe.html#50842" class="Bound">γ</a> <a id="51026" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="51028" href="lagda.2023-11-21-nbe.html#43841" class="Function">env-lookup</a> <a id="51039" href="lagda.2023-11-21-nbe.html#50983" class="Bound">x</a> <a id="51041" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="51043" href="lagda.2023-11-21-nbe.html#50842" class="Bound">γ</a> <a id="51045" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="51047" href="lagda.2023-11-21-nbe.html#50936" class="Function">a</a> <a id="51049" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a>
  <a id="51053" href="lagda.2023-11-21-nbe.html#50951" class="Function">lemma</a> <a id="51059" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>     <a id="51065" class="Symbol">=</a> <a id="51067" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="51074" href="lagda.2023-11-21-nbe.html#50951" class="Function">lemma</a> <a id="51080" class="Symbol">(</a><a id="51081" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="51083" href="lagda.2023-11-21-nbe.html#51083" class="Bound">x</a><a id="51084" class="Symbol">)</a> <a id="51086" class="Symbol">=</a> <a id="51088" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
</pre>
Another corollary is that the shifting substitution preserves meaning on an
extended environment.

<pre class="Agda"><a id="↥-preserves-meaning"></a><a id="51205" href="lagda.2023-11-21-nbe.html#51205" class="Function">↥-preserves-meaning</a> <a id="51225" class="Symbol">:</a> <a id="51227" class="Symbol">∀</a> <a id="51229" class="Symbol">{</a><a id="51230" href="lagda.2023-11-21-nbe.html#51230" class="Bound">Γ</a> <a id="51232" class="Symbol">:</a> <a id="51234" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="51237" class="Symbol">}</a> <a id="51239" class="Symbol">{</a><a id="51240" href="lagda.2023-11-21-nbe.html#51240" class="Bound">S</a> <a id="51242" href="lagda.2023-11-21-nbe.html#51242" class="Bound">T</a> <a id="51244" class="Symbol">:</a> <a id="51246" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="51250" class="Symbol">}</a> <a id="51252" class="Symbol">{</a><a id="51253" href="lagda.2023-11-21-nbe.html#51253" class="Bound">t</a> <a id="51255" class="Symbol">:</a> <a id="51257" href="lagda.2023-11-21-nbe.html#51230" class="Bound">Γ</a> <a id="51259" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="51261" href="lagda.2023-11-21-nbe.html#51242" class="Bound">T</a><a id="51262" class="Symbol">}</a> <a id="51264" class="Symbol">{</a><a id="51265" href="lagda.2023-11-21-nbe.html#51265" class="Bound">γ</a> <a id="51267" class="Symbol">:</a> <a id="51269" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="51271" href="lagda.2023-11-21-nbe.html#51230" class="Bound">Γ</a> <a id="51273" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a><a id="51274" class="Symbol">}</a>
                        <a id="51300" class="Symbol">{</a><a id="51301" href="lagda.2023-11-21-nbe.html#51301" class="Bound">a</a> <a id="51303" class="Symbol">:</a> <a id="51305" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="51307" href="lagda.2023-11-21-nbe.html#51240" class="Bound">S</a> <a id="51309" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a><a id="51310" class="Symbol">}</a>
                    <a id="51332" class="Symbol">→</a> <a id="51334" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟦⊢</a> <a id="51337" href="lagda.2023-11-21-nbe.html#51253" class="Bound">t</a> <a id="51339" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟧</a> <a id="51341" href="lagda.2023-11-21-nbe.html#51265" class="Bound">γ</a> <a id="51343" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="51345" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟦⊢</a> <a id="51348" href="lagda.2023-11-21-nbe.html#51253" class="Bound">t</a> <a id="51350" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="51352" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a> <a id="51354" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a> <a id="51356" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟧</a> <a id="51358" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="51360" href="lagda.2023-11-21-nbe.html#51265" class="Bound">γ</a> <a id="51362" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="51364" href="lagda.2023-11-21-nbe.html#51301" class="Bound">a</a> <a id="51366" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a>
<a id="51368" href="lagda.2023-11-21-nbe.html#51205" class="Function">↥-preserves-meaning</a> <a id="51388" class="Symbol">{</a><a id="51389" class="Argument">t</a> <a id="51391" class="Symbol">=</a> <a id="51393" href="lagda.2023-11-21-nbe.html#51393" class="Bound">t</a><a id="51394" class="Symbol">}</a> <a id="51396" class="Symbol">{</a><a id="51397" href="lagda.2023-11-21-nbe.html#51397" class="Bound">γ</a><a id="51398" class="Symbol">}</a> <a id="51400" class="Symbol">{</a><a id="51401" href="lagda.2023-11-21-nbe.html#51401" class="Bound">a</a><a id="51402" class="Symbol">}</a> <a id="51404" class="Symbol">=</a>
  <a id="51408" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="51412" class="Symbol">(</a><a id="51413" href="lagda.2023-11-21-nbe.html#49874" class="Function">subst-preserves-meaning</a> <a id="51437" class="Symbol">{</a><a id="51438" class="Argument">γ</a> <a id="51440" class="Symbol">=</a> <a id="51442" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="51444" href="lagda.2023-11-21-nbe.html#51397" class="Bound">γ</a> <a id="51446" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="51448" href="lagda.2023-11-21-nbe.html#51401" class="Bound">a</a> <a id="51450" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a><a id="51451" class="Symbol">}</a> <a id="51453" class="Symbol">{</a><a id="51454" href="lagda.2023-11-21-nbe.html#51397" class="Bound">γ</a><a id="51455" class="Symbol">}</a> <a id="51457" class="Symbol">{</a><a id="51458" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a><a id="51459" class="Symbol">}</a> <a id="51461" class="Symbol">{</a><a id="51462" href="lagda.2023-11-21-nbe.html#51393" class="Bound">t</a><a id="51463" class="Symbol">}</a> <a id="51465" class="Symbol">λ{_</a> <a id="51469" class="Symbol">→</a> <a id="51471" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="51475" class="Symbol">})</a>
</pre>
With these lemmas, it is possible to prove that definitional equality implies
semantic equality.
--->
<pre class="Agda"><a id="==→⟦≡⟧"></a><a id="51593" href="lagda.2023-11-21-nbe.html#51593" class="Function">==→⟦≡⟧</a> <a id="51600" class="Symbol">:</a> <a id="51602" class="Symbol">∀</a> <a id="51604" class="Symbol">{</a><a id="51605" href="lagda.2023-11-21-nbe.html#51605" class="Bound">Γ</a> <a id="51607" class="Symbol">:</a> <a id="51609" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="51612" class="Symbol">}</a> <a id="51614" class="Symbol">{</a><a id="51615" href="lagda.2023-11-21-nbe.html#51615" class="Bound">T</a> <a id="51617" class="Symbol">:</a> <a id="51619" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="51623" class="Symbol">}</a> <a id="51625" class="Symbol">{</a><a id="51626" href="lagda.2023-11-21-nbe.html#51626" class="Bound">t</a> <a id="51628" href="lagda.2023-11-21-nbe.html#51628" class="Bound">t′</a> <a id="51631" class="Symbol">:</a> <a id="51633" href="lagda.2023-11-21-nbe.html#51605" class="Bound">Γ</a> <a id="51635" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="51637" href="lagda.2023-11-21-nbe.html#51615" class="Bound">T</a><a id="51638" class="Symbol">}</a> <a id="51640" class="Symbol">{</a><a id="51641" href="lagda.2023-11-21-nbe.html#51641" class="Bound">γ</a> <a id="51643" class="Symbol">:</a> <a id="51645" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="51647" href="lagda.2023-11-21-nbe.html#51605" class="Bound">Γ</a> <a id="51649" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a><a id="51650" class="Symbol">}</a>
       <a id="51659" class="Symbol">→</a> <a id="51661" href="lagda.2023-11-21-nbe.html#51626" class="Bound">t</a> <a id="51663" href="lagda.2023-11-21-nbe.html#30265" class="Datatype Operator">==</a> <a id="51666" href="lagda.2023-11-21-nbe.html#51628" class="Bound">t′</a>
       <a id="51676" class="Symbol">→</a> <a id="51678" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟦⊢</a> <a id="51681" href="lagda.2023-11-21-nbe.html#51626" class="Bound">t</a> <a id="51683" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟧</a> <a id="51685" href="lagda.2023-11-21-nbe.html#51641" class="Bound">γ</a> <a id="51687" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="51689" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟦⊢</a> <a id="51692" href="lagda.2023-11-21-nbe.html#51628" class="Bound">t′</a> <a id="51695" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟧</a> <a id="51697" href="lagda.2023-11-21-nbe.html#51641" class="Bound">γ</a>
</pre>
<!---
<pre class="Agda"><a id="51713" href="lagda.2023-11-21-nbe.html#51593" class="Function">==→⟦≡⟧</a> <a id="51720" class="Symbol">{</a><a id="51721" class="Argument">γ</a> <a id="51723" class="Symbol">=</a> <a id="51725" href="lagda.2023-11-21-nbe.html#51725" class="Bound">γ</a><a id="51726" class="Symbol">}</a> <a id="51728" class="Symbol">(</a><a id="51729" href="lagda.2023-11-21-nbe.html#30363" class="InductiveConstructor">β</a> <a id="51731" class="Symbol">{</a><a id="51732" class="Argument">t</a> <a id="51734" class="Symbol">=</a> <a id="51736" href="lagda.2023-11-21-nbe.html#51736" class="Bound">t</a><a id="51737" class="Symbol">}</a> <a id="51739" class="Symbol">{</a><a id="51740" class="Argument">s</a> <a id="51742" class="Symbol">=</a> <a id="51744" href="lagda.2023-11-21-nbe.html#51744" class="Bound">s</a><a id="51745" class="Symbol">})</a> <a id="51748" class="Symbol">=</a> <a id="51750" href="lagda.2023-11-21-nbe.html#50634" class="Function">β-preserves-meaning</a> <a id="51770" class="Symbol">{</a><a id="51771" class="Argument">γ</a> <a id="51773" class="Symbol">=</a> <a id="51775" href="lagda.2023-11-21-nbe.html#51725" class="Bound">γ</a><a id="51776" class="Symbol">}</a> <a id="51778" class="Symbol">{</a><a id="51779" href="lagda.2023-11-21-nbe.html#51744" class="Bound">s</a><a id="51780" class="Symbol">}</a> <a id="51782" class="Symbol">{</a><a id="51783" href="lagda.2023-11-21-nbe.html#51736" class="Bound">t</a><a id="51784" class="Symbol">}</a>
<a id="51786" href="lagda.2023-11-21-nbe.html#51593" class="Function">==→⟦≡⟧</a> <a id="51793" class="Symbol">{</a><a id="51794" class="Argument">T</a> <a id="51796" class="Symbol">=</a> <a id="51798" href="lagda.2023-11-21-nbe.html#51798" class="Bound">S</a> <a id="51800" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="51802" class="Symbol">_}</a> <a id="51805" class="Symbol">{</a><a id="51806" class="Argument">t</a> <a id="51808" class="Symbol">=</a> <a id="51810" href="lagda.2023-11-21-nbe.html#51810" class="Bound">t</a><a id="51811" class="Symbol">}</a> <a id="51813" class="Symbol">{</a><a id="51814" class="Argument">γ</a> <a id="51816" class="Symbol">=</a> <a id="51818" href="lagda.2023-11-21-nbe.html#51818" class="Bound">γ</a><a id="51819" class="Symbol">}</a> <a id="51821" href="lagda.2023-11-21-nbe.html#30589" class="InductiveConstructor">η</a> <a id="51823" class="Symbol">=</a> <a id="51825" href="lagda.2023-11-21-nbe.html#2744" class="Postulate">extensionality</a> <a id="51840" href="lagda.2023-11-21-nbe.html#51854" class="Function">lemma</a> <a id="51846" class="Keyword">where</a>
  <a id="51854" href="lagda.2023-11-21-nbe.html#51854" class="Function">lemma</a> <a id="51860" class="Symbol">:</a> <a id="51862" class="Symbol">∀</a> <a id="51864" class="Symbol">(</a><a id="51865" href="lagda.2023-11-21-nbe.html#51865" class="Bound">a</a> <a id="51867" class="Symbol">:</a> <a id="51869" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="51871" href="lagda.2023-11-21-nbe.html#51798" class="Bound">S</a> <a id="51873" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a><a id="51874" class="Symbol">)</a> <a id="51876" class="Symbol">→</a> <a id="51878" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟦⊢</a> <a id="51881" href="lagda.2023-11-21-nbe.html#51810" class="Bound">t</a> <a id="51883" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟧</a> <a id="51885" href="lagda.2023-11-21-nbe.html#51818" class="Bound">γ</a> <a id="51887" href="lagda.2023-11-21-nbe.html#51865" class="Bound">a</a> <a id="51889" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="51891" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟦⊢</a> <a id="51894" href="lagda.2023-11-21-nbe.html#51810" class="Bound">t</a> <a id="51896" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="51898" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a> <a id="51900" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a> <a id="51902" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟧</a> <a id="51904" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="51906" href="lagda.2023-11-21-nbe.html#51818" class="Bound">γ</a> <a id="51908" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="51910" href="lagda.2023-11-21-nbe.html#51865" class="Bound">a</a> <a id="51912" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a> <a id="51914" href="lagda.2023-11-21-nbe.html#51865" class="Bound">a</a>
  <a id="51918" href="lagda.2023-11-21-nbe.html#51854" class="Function">lemma</a> <a id="51924" href="lagda.2023-11-21-nbe.html#51924" class="Bound">a</a> <a id="51926" class="Keyword">rewrite</a> <a id="51934" href="lagda.2023-11-21-nbe.html#51205" class="Function">↥-preserves-meaning</a> <a id="51954" class="Symbol">{</a><a id="51955" class="Argument">t</a> <a id="51957" class="Symbol">=</a> <a id="51959" href="lagda.2023-11-21-nbe.html#51810" class="Bound">t</a><a id="51960" class="Symbol">}</a> <a id="51962" class="Symbol">{</a><a id="51963" href="lagda.2023-11-21-nbe.html#51818" class="Bound">γ</a><a id="51964" class="Symbol">}</a> <a id="51966" class="Symbol">{</a><a id="51967" href="lagda.2023-11-21-nbe.html#51924" class="Bound">a</a><a id="51968" class="Symbol">}</a> <a id="51970" class="Symbol">=</a> <a id="51972" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="51977" href="lagda.2023-11-21-nbe.html#51593" class="Function">==→⟦≡⟧</a> <a id="51984" class="Symbol">{</a><a id="51985" class="Argument">γ</a> <a id="51987" class="Symbol">=</a> <a id="51989" href="lagda.2023-11-21-nbe.html#51989" class="Bound">γ</a><a id="51990" class="Symbol">}</a> <a id="51992" class="Symbol">(</a><a id="51993" href="lagda.2023-11-21-nbe.html#30725" class="InductiveConstructor">abs-compatible</a> <a id="52008" href="lagda.2023-11-21-nbe.html#52008" class="Bound">t==t′</a><a id="52013" class="Symbol">)</a> <a id="52015" class="Symbol">=</a>
  <a id="52019" href="lagda.2023-11-21-nbe.html#2744" class="Postulate">extensionality</a> <a id="52034" class="Symbol">(λ</a> <a id="52037" href="lagda.2023-11-21-nbe.html#52037" class="Bound">a</a> <a id="52039" class="Symbol">→</a> <a id="52041" href="lagda.2023-11-21-nbe.html#51593" class="Function">==→⟦≡⟧</a> <a id="52048" class="Symbol">{</a><a id="52049" class="Argument">γ</a> <a id="52051" class="Symbol">=</a> <a id="52053" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="52055" href="lagda.2023-11-21-nbe.html#51989" class="Bound">γ</a> <a id="52057" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="52059" href="lagda.2023-11-21-nbe.html#52037" class="Bound">a</a> <a id="52061" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a><a id="52062" class="Symbol">}</a> <a id="52064" href="lagda.2023-11-21-nbe.html#52008" class="Bound">t==t′</a><a id="52069" class="Symbol">)</a>
<a id="52071" href="lagda.2023-11-21-nbe.html#51593" class="Function">==→⟦≡⟧</a> <a id="52078" class="Symbol">{</a><a id="52079" class="Argument">γ</a> <a id="52081" class="Symbol">=</a> <a id="52083" href="lagda.2023-11-21-nbe.html#52083" class="Bound">γ</a><a id="52084" class="Symbol">}</a> <a id="52086" class="Symbol">(</a><a id="52087" href="lagda.2023-11-21-nbe.html#30884" class="InductiveConstructor">app-compatible</a> <a id="52102" href="lagda.2023-11-21-nbe.html#52102" class="Bound">r==r′</a> <a id="52108" href="lagda.2023-11-21-nbe.html#52108" class="Bound">s==s′</a><a id="52113" class="Symbol">)</a>
  <a id="52117" class="Keyword">rewrite</a> <a id="52125" href="lagda.2023-11-21-nbe.html#51593" class="Function">==→⟦≡⟧</a> <a id="52132" class="Symbol">{</a><a id="52133" class="Argument">γ</a> <a id="52135" class="Symbol">=</a> <a id="52137" href="lagda.2023-11-21-nbe.html#52083" class="Bound">γ</a><a id="52138" class="Symbol">}</a> <a id="52140" href="lagda.2023-11-21-nbe.html#52102" class="Bound">r==r′</a> <a id="52146" class="Symbol">|</a> <a id="52148" href="lagda.2023-11-21-nbe.html#51593" class="Function">==→⟦≡⟧</a> <a id="52155" class="Symbol">{</a><a id="52156" class="Argument">γ</a> <a id="52158" class="Symbol">=</a> <a id="52160" href="lagda.2023-11-21-nbe.html#52083" class="Bound">γ</a><a id="52161" class="Symbol">}</a> <a id="52163" href="lagda.2023-11-21-nbe.html#52108" class="Bound">s==s′</a> <a id="52169" class="Symbol">=</a> <a id="52171" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="52176" href="lagda.2023-11-21-nbe.html#51593" class="Function">==→⟦≡⟧</a> <a id="52183" href="lagda.2023-11-21-nbe.html#31141" class="InductiveConstructor">refl⁼⁼</a> <a id="52190" class="Symbol">=</a> <a id="52192" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="52197" href="lagda.2023-11-21-nbe.html#51593" class="Function">==→⟦≡⟧</a> <a id="52204" class="Symbol">(</a><a id="52205" href="lagda.2023-11-21-nbe.html#31224" class="InductiveConstructor">sym⁼⁼</a> <a id="52211" href="lagda.2023-11-21-nbe.html#52211" class="Bound">t′==t</a><a id="52216" class="Symbol">)</a> <a id="52218" class="Symbol">=</a> <a id="52220" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="52224" class="Symbol">(</a><a id="52225" href="lagda.2023-11-21-nbe.html#51593" class="Function">==→⟦≡⟧</a> <a id="52232" href="lagda.2023-11-21-nbe.html#52211" class="Bound">t′==t</a><a id="52237" class="Symbol">)</a>
<a id="52239" href="lagda.2023-11-21-nbe.html#51593" class="Function">==→⟦≡⟧</a> <a id="52246" class="Symbol">(</a><a id="52247" href="lagda.2023-11-21-nbe.html#31327" class="InductiveConstructor">trans⁼⁼</a> <a id="52255" href="lagda.2023-11-21-nbe.html#52255" class="Bound">t₁==t₂</a> <a id="52262" href="lagda.2023-11-21-nbe.html#52262" class="Bound">t₂==t₃</a><a id="52268" class="Symbol">)</a> <a id="52270" class="Symbol">=</a> <a id="52272" href="Relation.Binary.PropositionalEquality.Core.html#1729" class="Function">trans</a> <a id="52278" class="Symbol">(</a><a id="52279" href="lagda.2023-11-21-nbe.html#51593" class="Function">==→⟦≡⟧</a> <a id="52286" href="lagda.2023-11-21-nbe.html#52255" class="Bound">t₁==t₂</a><a id="52292" class="Symbol">)</a> <a id="52294" class="Symbol">(</a><a id="52295" href="lagda.2023-11-21-nbe.html#51593" class="Function">==→⟦≡⟧</a> <a id="52302" href="lagda.2023-11-21-nbe.html#52262" class="Bound">t₂==t₃</a><a id="52308" class="Symbol">)</a>
</pre>--->
<p>We consider our algorithm for normalization by evaluation complete if two terms
that are definitionally equal (and thus have the same meaning) have the same
normal form:</p>
<pre><code>Γ ⊢ t = t′ : T implies nf(t) = nf(t′)</code></pre>
<p>Expanding out <code>nf</code> here gives us the following theorem:</p>
<pre><code>Γ ⊢ t = t′ : T ⇒ ↓ᵀ (⟦ t ⟧ ↑Γ) Γ = ↓ᵀ (⟦ t′ ⟧ ↑Γ) Γ</code></pre>
<p>This follows directly from <code>Γ ⊢ t = t′ : T</code> implying that <code>⟦ t ⟧ = ⟦ t′ ⟧</code>.</p>
<pre class="Agda"><a id="completeness"></a><a id="52733" href="lagda.2023-11-21-nbe.html#52733" class="Function">completeness</a> <a id="52746" class="Symbol">:</a> <a id="52748" class="Symbol">∀</a> <a id="52750" class="Symbol">{</a><a id="52751" href="lagda.2023-11-21-nbe.html#52751" class="Bound">Γ</a> <a id="52753" class="Symbol">:</a> <a id="52755" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="52758" class="Symbol">}</a> <a id="52760" class="Symbol">{</a><a id="52761" href="lagda.2023-11-21-nbe.html#52761" class="Bound">T</a> <a id="52763" class="Symbol">:</a> <a id="52765" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="52769" class="Symbol">}</a> <a id="52771" class="Symbol">{</a><a id="52772" href="lagda.2023-11-21-nbe.html#52772" class="Bound">t</a> <a id="52774" href="lagda.2023-11-21-nbe.html#52774" class="Bound">t′</a> <a id="52777" class="Symbol">:</a> <a id="52779" href="lagda.2023-11-21-nbe.html#52751" class="Bound">Γ</a> <a id="52781" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="52783" href="lagda.2023-11-21-nbe.html#52761" class="Bound">T</a><a id="52784" class="Symbol">}</a>
             <a id="52799" class="Symbol">→</a> <a id="52801" href="lagda.2023-11-21-nbe.html#52772" class="Bound">t</a> <a id="52803" href="lagda.2023-11-21-nbe.html#30265" class="Datatype Operator">==</a> <a id="52806" href="lagda.2023-11-21-nbe.html#52774" class="Bound">t′</a>
             <a id="52822" class="Symbol">→</a> <a id="52824" href="lagda.2023-11-21-nbe.html#46860" class="Function">nf</a> <a id="52827" href="lagda.2023-11-21-nbe.html#52772" class="Bound">t</a> <a id="52829" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="52831" href="lagda.2023-11-21-nbe.html#46860" class="Function">nf</a> <a id="52834" href="lagda.2023-11-21-nbe.html#52774" class="Bound">t′</a>
<a id="52837" href="lagda.2023-11-21-nbe.html#52733" class="Function">completeness</a> <a id="52850" class="Symbol">{</a><a id="52851" href="lagda.2023-11-21-nbe.html#52851" class="Bound">Γ</a><a id="52852" class="Symbol">}</a> <a id="52854" href="lagda.2023-11-21-nbe.html#52854" class="Bound">t==t′</a> <a id="52860" class="Keyword">rewrite</a> <a id="52868" href="lagda.2023-11-21-nbe.html#51593" class="Function">==→⟦≡⟧</a> <a id="52875" class="Symbol">{</a><a id="52876" class="Argument">γ</a> <a id="52878" class="Symbol">=</a> <a id="52880" href="lagda.2023-11-21-nbe.html#46436" class="Function">↑ᶜᵗˣ</a> <a id="52885" href="lagda.2023-11-21-nbe.html#52851" class="Bound">Γ</a><a id="52886" class="Symbol">}</a> <a id="52888" href="lagda.2023-11-21-nbe.html#52854" class="Bound">t==t′</a> <a id="52894" class="Symbol">=</a> <a id="52896" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
</pre>
<p>As for the soundness properties that we wanted from the algorithm:</p>
<ul>
<li><p><code>Γ ⊢ nf(t) : T</code> (well-typedness of normal form)</p>
<p>We are using an intrinsically typed representation of terms, so this
property is given to us automatically</p></li>
<li><p><code>⟦ nf(t) ⟧ = ⟦ t ⟧</code> (preservation of meaning)</p>
<p>As discussed, equality of functional terms in Agda is undecidable, for
which we have introduced definitional equality. Even proving that
<code>Γ ⊢ nf(t) = t : T</code> is difficult, and we will have to use a
logical relation to prove it in the following section</p></li>
<li><p><code>nf(nf(t)) = nf(t)</code> (idempotency)</p>
<p>This follows directly from the preservation of
meaning and completeness properties of the algorithm:</p>
<p>By the soundness property of preservation of meaning,
we will have <code>Γ ⊢ nf t = t : T</code>, which will in turn imply
<code>nf (nf t) = nf(t)</code> by the algorithm’s completeness</p></li>
</ul>
<h4 id="soundness">Soundness</h4>
<p>To prove that the algorithm for normalization by evaluation implemented
preserves the meaning of a program, we will prove that a term is definitionally
equal to its normal form:</p>
<p>Γ ⊢ t = nf(t) : T</p>
<p>In proving that a term is definitionally equal to its normal form, we will have
that <code>⟦ nf (t) ⟧ = ⟦ t ⟧</code>, as definitional equality implies semantic equality.
This new property we wish to prove expands to:</p>
<pre><code>Γ ⊢ t = ↓ᵀ a Γ, where a = ⟦ t ⟧ ↑Γ</code></pre>
<p>To prove this, we will establish a logical relation <code>Γ ⊢ t : T Ⓡ a</code> between a
well-typed term <code>Γ ⊢ t : T</code> and a semantic object in our meta language
<code>a ∈ ⟦ T ⟧</code> such that it implies <code>Γ ⊢ t = ↓ᵀ a Γ : T</code>. Later, we will prove that
<code>Γ ⊢ t : T Ⓡ ⟦ t ⟧ ↑Γ</code> (which will then finish our proof), but we will focus on
the logical relation itself for now.</p>
<p>For defining the relation in Agda, we will need to first define another relation
that “lifts” definitional equality to include liftable neutrals. If the liftable
neutral can be lifted to the context <code>Γ</code>, this is just definitional equality.
Otherwise, the relation can never hold, as there is no lifted term in the
context to compare to.</p>
<pre class="Agda"><a id="_==^_"></a><a id="54968" href="lagda.2023-11-21-nbe.html#54968" class="Function Operator">_==^_</a> <a id="54974" class="Symbol">:</a> <a id="54976" class="Symbol">{</a><a id="54977" href="lagda.2023-11-21-nbe.html#54977" class="Bound">Γ</a> <a id="54979" class="Symbol">:</a> <a id="54981" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="54984" class="Symbol">}</a> <a id="54986" class="Symbol">{</a><a id="54987" href="lagda.2023-11-21-nbe.html#54987" class="Bound">T</a> <a id="54989" class="Symbol">:</a> <a id="54991" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="54995" class="Symbol">}</a> <a id="54997" class="Symbol">→</a> <a id="54999" href="lagda.2023-11-21-nbe.html#54977" class="Bound">Γ</a> <a id="55001" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="55003" href="lagda.2023-11-21-nbe.html#54987" class="Bound">T</a> <a id="55005" class="Symbol">→</a> <a id="55007" href="lagda.2023-11-21-nbe.html#42020" class="Function">Ne^</a> <a id="55011" href="lagda.2023-11-21-nbe.html#54987" class="Bound">T</a> <a id="55013" class="Symbol">→</a> <a id="55015" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="55019" href="lagda.2023-11-21-nbe.html#54968" class="Function Operator">_==^_</a> <a id="55025" class="Symbol">{</a><a id="55026" href="lagda.2023-11-21-nbe.html#55026" class="Bound">Γ</a><a id="55027" class="Symbol">}</a> <a id="55029" href="lagda.2023-11-21-nbe.html#55029" class="Bound">t</a> <a id="55031" href="lagda.2023-11-21-nbe.html#55031" class="Bound">𝓊̂</a> <a id="55034" class="Keyword">with</a> <a id="55039" href="lagda.2023-11-21-nbe.html#55031" class="Bound">𝓊̂</a> <a id="55042" href="lagda.2023-11-21-nbe.html#55026" class="Bound">Γ</a>
<a id="55044" class="Symbol">...</a> <a id="55048" class="Symbol">|</a> <a id="55050" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="55055" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="55057" href="lagda.2023-11-21-nbe.html#55057" class="Bound">𝓊</a> <a id="55059" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="55061" class="Symbol">_</a> <a id="55063" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a>   <a id="55067" class="Symbol">=</a> <a id="55069" class="Bound">t</a> <a id="55071" href="lagda.2023-11-21-nbe.html#30265" class="Datatype Operator">==</a> <a id="55074" href="lagda.2023-11-21-nbe.html#55057" class="Bound">𝓊</a>
<a id="55076" class="Symbol">...</a> <a id="55080" class="Symbol">|</a> <a id="55082" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="55087" class="Symbol">_</a>           <a id="55099" class="Symbol">=</a> <a id="55101" href="Data.Empty.html#526" class="Datatype">⊥</a>
</pre>
<!---
<pre class="Agda"><a id="55118" class="Keyword">infix</a> <a id="55124" class="Number">3</a> <a id="55126" href="lagda.2023-11-21-nbe.html#54968" class="Function Operator">_==^_</a>
</pre>--->
<p>Formally, this relation represents the condition <code>Γ ⊢ 𝓊 = 𝓊̂(Γ) : T</code>, meaning
that a term <code>𝓊</code> is definitionally equal to the liftable neutral <code>𝓊̂</code> lifted to
the context <code>Γ</code>.</p>
<p>We also need to define a relation lifting definitional equality to the unit type
with embedded liftable neutrals. If the expression is unit, then this is just
regular definitional equality, and otherwise we reuse definitional equality for
liftable neutrals.</p>
<pre class="Agda"><a id="_==⊤̂_"></a><a id="55584" href="lagda.2023-11-21-nbe.html#55584" class="Function Operator">_==⊤̂_</a> <a id="55591" class="Symbol">:</a> <a id="55593" class="Symbol">∀</a> <a id="55595" class="Symbol">{</a><a id="55596" href="lagda.2023-11-21-nbe.html#55596" class="Bound">Γ</a> <a id="55598" class="Symbol">:</a> <a id="55600" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="55603" class="Symbol">}</a> <a id="55605" class="Symbol">→</a> <a id="55607" href="lagda.2023-11-21-nbe.html#55596" class="Bound">Γ</a> <a id="55609" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="55611" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a> <a id="55613" class="Symbol">→</a> <a id="55615" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="55617" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a> <a id="55619" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a> <a id="55621" class="Symbol">→</a> <a id="55623" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="55627" href="lagda.2023-11-21-nbe.html#55584" class="Function Operator">_==⊤̂_</a> <a id="55634" class="Symbol">{</a><a id="55635" href="lagda.2023-11-21-nbe.html#55635" class="Bound">Γ</a><a id="55636" class="Symbol">}</a> <a id="55638" href="lagda.2023-11-21-nbe.html#55638" class="Bound">t</a> <a id="55640" href="lagda.2023-11-21-nbe.html#43682" class="InductiveConstructor">unit</a>   <a id="55647" class="Symbol">=</a> <a id="55649" href="lagda.2023-11-21-nbe.html#55638" class="Bound">t</a> <a id="55651" href="lagda.2023-11-21-nbe.html#30265" class="Datatype Operator">==</a> <a id="55654" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a>
<a id="55659" href="lagda.2023-11-21-nbe.html#55584" class="Function Operator">_==⊤̂_</a> <a id="55666" class="Symbol">{</a><a id="55667" href="lagda.2023-11-21-nbe.html#55667" class="Bound">Γ</a><a id="55668" class="Symbol">}</a> <a id="55670" href="lagda.2023-11-21-nbe.html#55670" class="Bound">t</a> <a id="55672" class="Symbol">(</a><a id="55673" href="lagda.2023-11-21-nbe.html#43694" class="InductiveConstructor">ne</a> <a id="55676" href="lagda.2023-11-21-nbe.html#55676" class="Bound">𝓊̂</a><a id="55678" class="Symbol">)</a> <a id="55680" class="Symbol">=</a> <a id="55682" href="lagda.2023-11-21-nbe.html#55670" class="Bound">t</a> <a id="55684" href="lagda.2023-11-21-nbe.html#54968" class="Function Operator">==^</a> <a id="55688" href="lagda.2023-11-21-nbe.html#55676" class="Bound">𝓊̂</a>
</pre>
<!---
<pre class="Agda"><a id="55706" class="Keyword">infix</a> <a id="55712" class="Number">3</a> <a id="55714" href="lagda.2023-11-21-nbe.html#55584" class="Function Operator">_==⊤̂_</a>
</pre>--->
<p>This will represent the condition <code>Γ ⊢ t = 𝓋̂(Γ) : 𝟙</code> that we will now see, as we
are ready to begin defining the logical relation <code>Γ ⊢ t : T Ⓡ a</code> inductively on
types. At type <code>𝟙</code>, the relation is defined as:</p>
<pre><code>  Γ ⊢ t : 𝟙 Ⓡ 𝓋̂ ⇔ ∀ Γ′ ≤ Γ. Γ′ ⊢ t = 𝓋̂(Γ′) : 𝟙</code></pre>
<p>In other words, <code>t</code> is logically related to a semantic object <code>𝓋̂ ∈ ⊤̂</code> if and
only if the term is definitionally equal to <code>𝓋̂</code> when lifted to any context <code>Γ′</code>
that is an extension of <code>Γ</code>.</p>
<p>For function types, the relation is defined as:</p>
<pre><code>Γ ⊢ r : S → T Ⓡ f ⇔ ∀ Γ′ ≤ Γ. Γ′ ⊢ s : S Ⓡ a ⇒ Γ′ ⊢ r s : T Ⓡ f(a)</code></pre>
<p>The relation is written so that it sort of expands functions, reducing our proof
that a functional term in STLC is logically related to a function in Agda to
only having to prove that given related arguments, the functional term and the
function in Agda both produce related results. Again, this is generalized over
all extensions of the context <code>Γ</code>. While our final results will only be
concerned with the context <code>Γ</code>, to prove these results we will need the relation
to be strengthened in this way.</p>
<pre class="Agda"><a id="_Ⓡ_"></a><a id="56818" href="lagda.2023-11-21-nbe.html#56818" class="Function Operator">_Ⓡ_</a> <a id="56822" class="Symbol">:</a> <a id="56824" class="Symbol">∀</a> <a id="56826" class="Symbol">{</a><a id="56827" href="lagda.2023-11-21-nbe.html#56827" class="Bound">Γ</a> <a id="56829" class="Symbol">:</a> <a id="56831" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="56834" class="Symbol">}</a> <a id="56836" class="Symbol">{</a><a id="56837" href="lagda.2023-11-21-nbe.html#56837" class="Bound">T</a> <a id="56839" class="Symbol">:</a> <a id="56841" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="56845" class="Symbol">}</a> <a id="56847" class="Symbol">→</a> <a id="56849" href="lagda.2023-11-21-nbe.html#56827" class="Bound">Γ</a> <a id="56851" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="56853" href="lagda.2023-11-21-nbe.html#56837" class="Bound">T</a> <a id="56855" class="Symbol">→</a> <a id="56857" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="56859" href="lagda.2023-11-21-nbe.html#56837" class="Bound">T</a> <a id="56861" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a> <a id="56863" class="Symbol">→</a> <a id="56865" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="56869" href="lagda.2023-11-21-nbe.html#56818" class="Function Operator">_Ⓡ_</a> <a id="56873" class="Symbol">{</a><a id="56874" href="lagda.2023-11-21-nbe.html#56874" class="Bound">Γ</a><a id="56875" class="Symbol">}</a> <a id="56877" class="Symbol">{</a><a id="56878" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a><a id="56879" class="Symbol">}</a> <a id="56881" href="lagda.2023-11-21-nbe.html#56881" class="Bound">t</a> <a id="56883" href="lagda.2023-11-21-nbe.html#56883" class="Bound">𝓋̂</a> <a id="56886" class="Symbol">=</a> <a id="56888" class="Symbol">∀</a> <a id="56890" class="Symbol">{</a><a id="56891" href="lagda.2023-11-21-nbe.html#56891" class="Bound">Γ′</a> <a id="56894" class="Symbol">:</a> <a id="56896" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="56899" class="Symbol">}</a> <a id="56901" class="Symbol">→</a> <a id="56903" class="Symbol">(</a><a id="56904" href="lagda.2023-11-21-nbe.html#56904" class="Bound">Γ′≤Γ</a> <a id="56909" class="Symbol">:</a> <a id="56911" href="lagda.2023-11-21-nbe.html#56891" class="Bound">Γ′</a> <a id="56914" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="56916" href="lagda.2023-11-21-nbe.html#56874" class="Bound">Γ</a><a id="56917" class="Symbol">)</a> <a id="56919" class="Symbol">→</a> <a id="56921" href="lagda.2023-11-21-nbe.html#56904" class="Bound">Γ′≤Γ</a> <a id="56926" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="56929" href="lagda.2023-11-21-nbe.html#56881" class="Bound">t</a> <a id="56931" href="lagda.2023-11-21-nbe.html#55584" class="Function Operator">==⊤̂</a> <a id="56936" href="lagda.2023-11-21-nbe.html#56883" class="Bound">𝓋̂</a>
<a id="56939" href="lagda.2023-11-21-nbe.html#56818" class="Function Operator">_Ⓡ_</a> <a id="56943" class="Symbol">{</a><a id="56944" href="lagda.2023-11-21-nbe.html#56944" class="Bound">Γ</a><a id="56945" class="Symbol">}</a> <a id="56947" class="Symbol">{</a><a id="56948" href="lagda.2023-11-21-nbe.html#56948" class="Bound">S</a> <a id="56950" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="56952" href="lagda.2023-11-21-nbe.html#56952" class="Bound">T</a><a id="56953" class="Symbol">}</a> <a id="56955" href="lagda.2023-11-21-nbe.html#56955" class="Bound">r</a> <a id="56957" href="lagda.2023-11-21-nbe.html#56957" class="Bound">f</a> <a id="56959" class="Symbol">=</a>
    <a id="56965" class="Symbol">∀</a> <a id="56967" class="Symbol">{</a><a id="56968" href="lagda.2023-11-21-nbe.html#56968" class="Bound">Γ′</a> <a id="56971" class="Symbol">:</a> <a id="56973" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="56976" class="Symbol">}</a>
    <a id="56982" class="Symbol">→</a> <a id="56984" class="Symbol">(</a><a id="56985" href="lagda.2023-11-21-nbe.html#56985" class="Bound">Γ′≤Γ</a> <a id="56990" class="Symbol">:</a> <a id="56992" href="lagda.2023-11-21-nbe.html#56968" class="Bound">Γ′</a> <a id="56995" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="56997" href="lagda.2023-11-21-nbe.html#56944" class="Bound">Γ</a><a id="56998" class="Symbol">)</a>
    <a id="57004" class="Symbol">→</a> <a id="57006" class="Symbol">∀</a> <a id="57008" class="Symbol">{</a><a id="57009" href="lagda.2023-11-21-nbe.html#57009" class="Bound">s</a> <a id="57011" class="Symbol">:</a> <a id="57013" href="lagda.2023-11-21-nbe.html#56968" class="Bound">Γ′</a> <a id="57016" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="57018" href="lagda.2023-11-21-nbe.html#56948" class="Bound">S</a><a id="57019" class="Symbol">}</a> <a id="57021" class="Symbol">{</a><a id="57022" href="lagda.2023-11-21-nbe.html#57022" class="Bound">a</a> <a id="57024" class="Symbol">:</a> <a id="57026" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="57028" href="lagda.2023-11-21-nbe.html#56948" class="Bound">S</a> <a id="57030" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a><a id="57031" class="Symbol">}</a>
    <a id="57037" class="Symbol">→</a> <a id="57039" href="lagda.2023-11-21-nbe.html#57009" class="Bound">s</a> <a id="57041" href="lagda.2023-11-21-nbe.html#56818" class="Function Operator">Ⓡ</a> <a id="57043" href="lagda.2023-11-21-nbe.html#57022" class="Bound">a</a>
      <a id="57051" class="Comment">-------------------------</a>
    <a id="57081" class="Symbol">→</a> <a id="57083" class="Symbol">(</a><a id="57084" href="lagda.2023-11-21-nbe.html#56985" class="Bound">Γ′≤Γ</a> <a id="57089" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="57092" href="lagda.2023-11-21-nbe.html#56955" class="Bound">r</a><a id="57093" class="Symbol">)</a> <a id="57095" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="57097" href="lagda.2023-11-21-nbe.html#57009" class="Bound">s</a> <a id="57099" href="lagda.2023-11-21-nbe.html#56818" class="Function Operator">Ⓡ</a> <a id="57101" href="lagda.2023-11-21-nbe.html#56957" class="Bound">f</a> <a id="57103" href="lagda.2023-11-21-nbe.html#57022" class="Bound">a</a>
</pre>
<!---
<pre class="Agda"><a id="57120" class="Keyword">infix</a> <a id="57126" class="Number">4</a> <a id="57128" href="lagda.2023-11-21-nbe.html#56818" class="Function Operator">_Ⓡ_</a>
</pre>--->
<p>As the logical relation between terms and semantic objects is defined using
definitional equality, it is transitive with respect to definitional equality.
This is the first lemma we will prove using equational reasoning for
definitional equality. As for most proofs related to the logical relation <code>Ⓡ</code>
between terms and semantic objects, we prove it by induction on types, and do a
case analysis at type <code>𝟙</code> on the semantic object <code>a ∈ ⊤̂</code>. The proof makes use of
a lemma whose proof has been omitted, <code>cong⁼⁼-sub</code>: if two terms are
definitionally equal , the terms with the same substitution applied are still
definitionally equal.</p>
<pre class="Agda"><a id="cong⁼⁼-sub"></a><a id="57784" href="lagda.2023-11-21-nbe.html#57784" class="Function">cong⁼⁼-sub</a> <a id="57795" class="Symbol">:</a> <a id="57797" class="Symbol">∀</a> <a id="57799" class="Symbol">{</a><a id="57800" href="lagda.2023-11-21-nbe.html#57800" class="Bound">Γ</a> <a id="57802" href="lagda.2023-11-21-nbe.html#57802" class="Bound">Δ</a> <a id="57804" class="Symbol">:</a> <a id="57806" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="57809" class="Symbol">}</a> <a id="57811" class="Symbol">{</a><a id="57812" href="lagda.2023-11-21-nbe.html#57812" class="Bound">T</a> <a id="57814" class="Symbol">:</a> <a id="57816" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="57820" class="Symbol">}</a> <a id="57822" class="Symbol">{</a><a id="57823" href="lagda.2023-11-21-nbe.html#57823" class="Bound">t</a> <a id="57825" href="lagda.2023-11-21-nbe.html#57825" class="Bound">t′</a> <a id="57828" class="Symbol">:</a> <a id="57830" href="lagda.2023-11-21-nbe.html#57800" class="Bound">Γ</a> <a id="57832" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="57834" href="lagda.2023-11-21-nbe.html#57812" class="Bound">T</a><a id="57835" class="Symbol">}</a> <a id="57837" class="Symbol">{</a><a id="57838" href="lagda.2023-11-21-nbe.html#57838" class="Bound">σ</a> <a id="57840" class="Symbol">:</a> <a id="57842" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="57846" href="lagda.2023-11-21-nbe.html#57802" class="Bound">Δ</a> <a id="57848" href="lagda.2023-11-21-nbe.html#57800" class="Bound">Γ</a><a id="57849" class="Symbol">}</a>
          <a id="57861" class="Symbol">→</a> <a id="57863" href="lagda.2023-11-21-nbe.html#57823" class="Bound">t</a> <a id="57865" href="lagda.2023-11-21-nbe.html#30265" class="Datatype Operator">==</a> <a id="57868" href="lagda.2023-11-21-nbe.html#57825" class="Bound">t′</a>
          <a id="57881" class="Symbol">→</a> <a id="57883" href="lagda.2023-11-21-nbe.html#57823" class="Bound">t</a> <a id="57885" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="57887" href="lagda.2023-11-21-nbe.html#57838" class="Bound">σ</a> <a id="57889" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a> <a id="57891" href="lagda.2023-11-21-nbe.html#30265" class="Datatype Operator">==</a> <a id="57894" href="lagda.2023-11-21-nbe.html#57825" class="Bound">t′</a> <a id="57897" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="57899" href="lagda.2023-11-21-nbe.html#57838" class="Bound">σ</a> <a id="57901" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a>
</pre>
<!---
<pre class="Agda">
<a id="57923" href="lagda.2023-11-21-nbe.html#57784" class="Function">cong⁼⁼-sub</a> <a id="57934" class="Symbol">{</a><a id="57935" class="Argument">σ</a> <a id="57937" class="Symbol">=</a> <a id="57939" href="lagda.2023-11-21-nbe.html#57939" class="Bound">σ</a><a id="57940" class="Symbol">}</a> <a id="57942" class="Symbol">(</a><a id="57943" href="lagda.2023-11-21-nbe.html#30363" class="InductiveConstructor">β</a> <a id="57945" class="Symbol">{</a><a id="57946" class="Argument">t</a> <a id="57948" class="Symbol">=</a> <a id="57950" href="lagda.2023-11-21-nbe.html#57950" class="Bound">t</a><a id="57951" class="Symbol">}</a> <a id="57953" class="Symbol">{</a><a id="57954" href="lagda.2023-11-21-nbe.html#57954" class="Bound">s</a><a id="57955" class="Symbol">})</a>
  <a id="57960" class="Keyword">rewrite</a> <a id="57968" href="lagda.2023-11-21-nbe.html#25552" class="Function">sub-sub</a> <a id="57976" class="Symbol">{</a><a id="57977" class="Argument">τ</a> <a id="57979" class="Symbol">=</a> <a id="57981" href="lagda.2023-11-21-nbe.html#57939" class="Bound">σ</a><a id="57982" class="Symbol">}</a> <a id="57984" class="Symbol">{</a><a id="57985" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="57988" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="57990" href="lagda.2023-11-21-nbe.html#57954" class="Bound">s</a><a id="57991" class="Symbol">}</a> <a id="57993" class="Symbol">{</a><a id="57994" href="lagda.2023-11-21-nbe.html#57950" class="Bound">t</a><a id="57995" class="Symbol">}</a> <a id="57997" class="Symbol">=</a>
  <a id="58001" href="lagda.2023-11-21-nbe.html#31327" class="InductiveConstructor">trans⁼⁼</a>
    <a id="58013" href="lagda.2023-11-21-nbe.html#30363" class="InductiveConstructor">β</a>
    <a id="58019" class="Symbol">(</a><a id="58020" href="lagda.2023-11-21-nbe.html#32496" class="Function">≡→==</a>
      <a id="58031" class="Symbol">(</a><a id="58032" href="Relation.Binary.PropositionalEquality.Core.html#1729" class="Function">trans</a>
        <a id="58046" class="Symbol">(</a><a id="58047" href="lagda.2023-11-21-nbe.html#25552" class="Function">sub-sub</a> <a id="58055" class="Symbol">{</a><a id="58056" class="Argument">t</a> <a id="58058" class="Symbol">=</a> <a id="58060" href="lagda.2023-11-21-nbe.html#57950" class="Bound">t</a><a id="58061" class="Symbol">})</a>
        <a id="58072" class="Symbol">(</a><a id="58073" href="lagda.2023-11-21-nbe.html#19474" class="Function">cong-sub</a> <a id="58082" class="Symbol">{</a><a id="58083" class="Argument">t</a> <a id="58085" class="Symbol">=</a> <a id="58087" href="lagda.2023-11-21-nbe.html#57950" class="Bound">t</a><a id="58088" class="Symbol">}</a>
          <a id="58100" class="Symbol">(</a><a id="58101" href="Relation.Binary.PropositionalEquality.Core.html#1729" class="Function">trans</a>
            <a id="58119" href="lagda.2023-11-21-nbe.html#26401" class="Function">subst-zero-exts-cons</a>
            <a id="58152" class="Symbol">(</a><a id="58153" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="58157" href="lagda.2023-11-21-nbe.html#17953" class="Function">sub-dist</a><a id="58165" class="Symbol">))</a>
          <a id="58178" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="58182" class="Symbol">)))</a>
<a id="58186" href="lagda.2023-11-21-nbe.html#57784" class="Function">cong⁼⁼-sub</a> <a id="58197" class="Symbol">{</a><a id="58198" href="lagda.2023-11-21-nbe.html#58198" class="Bound">Γ</a><a id="58199" class="Symbol">}</a> <a id="58201" class="Symbol">{</a><a id="58202" class="Argument">T</a> <a id="58204" class="Symbol">=</a> <a id="58206" href="lagda.2023-11-21-nbe.html#58206" class="Bound">S</a> <a id="58208" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="58210" href="lagda.2023-11-21-nbe.html#58210" class="Bound">T</a><a id="58211" class="Symbol">}</a> <a id="58213" class="Symbol">{</a><a id="58214" href="lagda.2023-11-21-nbe.html#58214" class="Bound">t</a><a id="58215" class="Symbol">}</a> <a id="58217" class="Symbol">{</a><a id="58218" class="Argument">σ</a> <a id="58220" class="Symbol">=</a> <a id="58222" href="lagda.2023-11-21-nbe.html#58222" class="Bound">σ</a><a id="58223" class="Symbol">}</a> <a id="58225" href="lagda.2023-11-21-nbe.html#30589" class="InductiveConstructor">η</a>
  <a id="58229" class="Keyword">rewrite</a> <a id="58237" href="lagda.2023-11-21-nbe.html#25552" class="Function">sub-sub</a> <a id="58245" class="Symbol">{</a><a id="58246" class="Argument">τ</a> <a id="58248" class="Symbol">=</a> <a id="58250" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="58255" href="lagda.2023-11-21-nbe.html#58222" class="Bound">σ</a><a id="58256" class="Symbol">}</a> <a id="58258" class="Symbol">{</a><a id="58259" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a> <a id="58261" class="Symbol">{</a><a id="58262" class="Argument">T</a> <a id="58264" class="Symbol">=</a> <a id="58266" href="lagda.2023-11-21-nbe.html#58206" class="Bound">S</a><a id="58267" class="Symbol">}}</a> <a id="58270" class="Symbol">{</a><a id="58271" href="lagda.2023-11-21-nbe.html#58214" class="Bound">t</a><a id="58272" class="Symbol">}</a> <a id="58274" class="Symbol">=</a>
  <a id="58278" href="lagda.2023-11-21-nbe.html#31327" class="InductiveConstructor">trans⁼⁼</a>
    <a id="58290" href="lagda.2023-11-21-nbe.html#30589" class="InductiveConstructor">η</a>
    <a id="58296" class="Symbol">(</a><a id="58297" href="lagda.2023-11-21-nbe.html#30725" class="InductiveConstructor">abs-compatible</a>
      <a id="58318" class="Symbol">(</a><a id="58319" href="lagda.2023-11-21-nbe.html#30884" class="InductiveConstructor">app-compatible</a>
        <a id="58342" class="Symbol">(</a><a id="58343" href="lagda.2023-11-21-nbe.html#32496" class="Function">≡→==</a>
          <a id="58358" class="Symbol">(</a><a id="58359" href="Relation.Binary.PropositionalEquality.Core.html#1729" class="Function">trans</a>
            <a id="58377" class="Symbol">(</a><a id="58378" href="lagda.2023-11-21-nbe.html#25552" class="Function">sub-sub</a> <a id="58386" class="Symbol">{</a><a id="58387" class="Argument">τ</a> <a id="58389" class="Symbol">=</a> <a id="58391" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a><a id="58392" class="Symbol">}</a> <a id="58394" class="Symbol">{</a><a id="58395" href="lagda.2023-11-21-nbe.html#58222" class="Bound">σ</a><a id="58396" class="Symbol">}</a> <a id="58398" class="Symbol">{</a><a id="58399" href="lagda.2023-11-21-nbe.html#58214" class="Bound">t</a><a id="58400" class="Symbol">})</a>
            <a id="58415" class="Symbol">(</a><a id="58416" href="lagda.2023-11-21-nbe.html#19474" class="Function">cong-sub</a> <a id="58425" class="Symbol">{</a><a id="58426" class="Argument">t</a> <a id="58428" class="Symbol">=</a> <a id="58430" href="lagda.2023-11-21-nbe.html#58214" class="Bound">t</a><a id="58431" class="Symbol">}</a> <a id="58433" class="Symbol">(</a><a id="58434" href="lagda.2023-11-21-nbe.html#2744" class="Postulate">extensionality</a> <a id="58449" class="Symbol">λ{_</a> <a id="58453" class="Symbol">→</a> <a id="58455" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="58459" href="lagda.2023-11-21-nbe.html#21848" class="Function">rename-shift</a><a id="58471" class="Symbol">})</a> <a id="58474" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="58478" class="Symbol">)))</a>
        <a id="58490" href="lagda.2023-11-21-nbe.html#31141" class="InductiveConstructor">refl⁼⁼</a><a id="58496" class="Symbol">))</a>
<a id="58499" href="lagda.2023-11-21-nbe.html#57784" class="Function">cong⁼⁼-sub</a> <a id="58510" class="Symbol">(</a><a id="58511" href="lagda.2023-11-21-nbe.html#30725" class="InductiveConstructor">abs-compatible</a> <a id="58526" href="lagda.2023-11-21-nbe.html#58526" class="Bound">t==t′</a><a id="58531" class="Symbol">)</a> <a id="58533" class="Symbol">=</a> <a id="58535" href="lagda.2023-11-21-nbe.html#30725" class="InductiveConstructor">abs-compatible</a> <a id="58550" class="Symbol">(</a><a id="58551" href="lagda.2023-11-21-nbe.html#57784" class="Function">cong⁼⁼-sub</a> <a id="58562" href="lagda.2023-11-21-nbe.html#58526" class="Bound">t==t′</a><a id="58567" class="Symbol">)</a>
<a id="58569" href="lagda.2023-11-21-nbe.html#57784" class="Function">cong⁼⁼-sub</a> <a id="58580" class="Symbol">(</a><a id="58581" href="lagda.2023-11-21-nbe.html#30884" class="InductiveConstructor">app-compatible</a> <a id="58596" href="lagda.2023-11-21-nbe.html#58596" class="Bound">r==r′</a> <a id="58602" href="lagda.2023-11-21-nbe.html#58602" class="Bound">s==s′</a><a id="58607" class="Symbol">)</a> <a id="58609" class="Symbol">=</a>
  <a id="58613" href="lagda.2023-11-21-nbe.html#30884" class="InductiveConstructor">app-compatible</a> <a id="58628" class="Symbol">(</a><a id="58629" href="lagda.2023-11-21-nbe.html#57784" class="Function">cong⁼⁼-sub</a> <a id="58640" href="lagda.2023-11-21-nbe.html#58596" class="Bound">r==r′</a><a id="58645" class="Symbol">)</a> <a id="58647" class="Symbol">(</a><a id="58648" href="lagda.2023-11-21-nbe.html#57784" class="Function">cong⁼⁼-sub</a> <a id="58659" href="lagda.2023-11-21-nbe.html#58602" class="Bound">s==s′</a><a id="58664" class="Symbol">)</a>
<a id="58666" href="lagda.2023-11-21-nbe.html#57784" class="Function">cong⁼⁼-sub</a> <a id="58677" href="lagda.2023-11-21-nbe.html#31141" class="InductiveConstructor">refl⁼⁼</a> <a id="58684" class="Symbol">=</a> <a id="58686" href="lagda.2023-11-21-nbe.html#31141" class="InductiveConstructor">refl⁼⁼</a>
<a id="58693" href="lagda.2023-11-21-nbe.html#57784" class="Function">cong⁼⁼-sub</a> <a id="58704" class="Symbol">(</a><a id="58705" href="lagda.2023-11-21-nbe.html#31224" class="InductiveConstructor">sym⁼⁼</a> <a id="58711" href="lagda.2023-11-21-nbe.html#58711" class="Bound">t==t′</a><a id="58716" class="Symbol">)</a> <a id="58718" class="Symbol">=</a> <a id="58720" href="lagda.2023-11-21-nbe.html#31224" class="InductiveConstructor">sym⁼⁼</a> <a id="58726" class="Symbol">(</a><a id="58727" href="lagda.2023-11-21-nbe.html#57784" class="Function">cong⁼⁼-sub</a> <a id="58738" href="lagda.2023-11-21-nbe.html#58711" class="Bound">t==t′</a><a id="58743" class="Symbol">)</a>
<a id="58745" href="lagda.2023-11-21-nbe.html#57784" class="Function">cong⁼⁼-sub</a> <a id="58756" class="Symbol">(</a><a id="58757" href="lagda.2023-11-21-nbe.html#31327" class="InductiveConstructor">trans⁼⁼</a> <a id="58765" href="lagda.2023-11-21-nbe.html#58765" class="Bound">t₁==t₂</a> <a id="58772" href="lagda.2023-11-21-nbe.html#58772" class="Bound">t₂==t₃</a><a id="58778" class="Symbol">)</a> <a id="58780" class="Symbol">=</a> <a id="58782" href="lagda.2023-11-21-nbe.html#31327" class="InductiveConstructor">trans⁼⁼</a> <a id="58790" class="Symbol">(</a><a id="58791" href="lagda.2023-11-21-nbe.html#57784" class="Function">cong⁼⁼-sub</a> <a id="58802" href="lagda.2023-11-21-nbe.html#58765" class="Bound">t₁==t₂</a><a id="58808" class="Symbol">)</a> <a id="58810" class="Symbol">(</a><a id="58811" href="lagda.2023-11-21-nbe.html#57784" class="Function">cong⁼⁼-sub</a> <a id="58822" href="lagda.2023-11-21-nbe.html#58772" class="Bound">t₂==t₃</a><a id="58828" class="Symbol">)</a>
</pre>--->
<pre class="Agda"><a id="==-Ⓡ-trans"></a><a id="58848" href="lagda.2023-11-21-nbe.html#58848" class="Function">==-Ⓡ-trans</a> <a id="58859" class="Symbol">:</a> <a id="58861" class="Symbol">∀</a> <a id="58863" class="Symbol">{</a><a id="58864" href="lagda.2023-11-21-nbe.html#58864" class="Bound">Γ</a> <a id="58866" class="Symbol">:</a> <a id="58868" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="58871" class="Symbol">}</a> <a id="58873" class="Symbol">{</a><a id="58874" href="lagda.2023-11-21-nbe.html#58874" class="Bound">T</a> <a id="58876" class="Symbol">:</a> <a id="58878" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="58882" class="Symbol">}</a> <a id="58884" class="Symbol">{</a><a id="58885" href="lagda.2023-11-21-nbe.html#58885" class="Bound">t</a> <a id="58887" href="lagda.2023-11-21-nbe.html#58887" class="Bound">t′</a> <a id="58890" class="Symbol">:</a> <a id="58892" href="lagda.2023-11-21-nbe.html#58864" class="Bound">Γ</a> <a id="58894" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="58896" href="lagda.2023-11-21-nbe.html#58874" class="Bound">T</a><a id="58897" class="Symbol">}</a> <a id="58899" class="Symbol">{</a><a id="58900" href="lagda.2023-11-21-nbe.html#58900" class="Bound">a</a> <a id="58902" class="Symbol">:</a> <a id="58904" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="58906" href="lagda.2023-11-21-nbe.html#58874" class="Bound">T</a> <a id="58908" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a><a id="58909" class="Symbol">}</a>
           <a id="58922" class="Symbol">→</a> <a id="58924" href="lagda.2023-11-21-nbe.html#58885" class="Bound">t</a> <a id="58926" href="lagda.2023-11-21-nbe.html#30265" class="Datatype Operator">==</a> <a id="58929" href="lagda.2023-11-21-nbe.html#58887" class="Bound">t′</a>
           <a id="58943" class="Symbol">→</a> <a id="58945" href="lagda.2023-11-21-nbe.html#58885" class="Bound">t</a> <a id="58947" href="lagda.2023-11-21-nbe.html#56818" class="Function Operator">Ⓡ</a> <a id="58949" href="lagda.2023-11-21-nbe.html#58900" class="Bound">a</a>
             <a id="58964" class="Comment">-------</a>
           <a id="58983" class="Symbol">→</a> <a id="58985" href="lagda.2023-11-21-nbe.html#58887" class="Bound">t′</a> <a id="58988" href="lagda.2023-11-21-nbe.html#56818" class="Function Operator">Ⓡ</a> <a id="58990" href="lagda.2023-11-21-nbe.html#58900" class="Bound">a</a>
<a id="58992" href="lagda.2023-11-21-nbe.html#58848" class="Function">==-Ⓡ-trans</a> <a id="59003" class="Symbol">{</a><a id="59004" class="Argument">T</a> <a id="59006" class="Symbol">=</a> <a id="59008" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a><a id="59009" class="Symbol">}</a> <a id="59011" class="Symbol">{</a><a id="59012" href="lagda.2023-11-21-nbe.html#59012" class="Bound">t</a><a id="59013" class="Symbol">}</a> <a id="59015" class="Symbol">{</a><a id="59016" href="lagda.2023-11-21-nbe.html#59016" class="Bound">t′</a><a id="59018" class="Symbol">}</a> <a id="59020" class="Symbol">{</a><a id="59021" href="lagda.2023-11-21-nbe.html#43682" class="InductiveConstructor">unit</a><a id="59025" class="Symbol">}</a> <a id="59027" href="lagda.2023-11-21-nbe.html#59027" class="Bound">t==t′</a> <a id="59033" href="lagda.2023-11-21-nbe.html#59033" class="Bound">pf</a> <a id="59036" href="lagda.2023-11-21-nbe.html#59036" class="Bound">Γ′≤Γ</a> <a id="59041" class="Symbol">=</a>
  <a id="59045" href="lagda.2023-11-21-nbe.html#31890" class="Function Operator">begin==</a>
    <a id="59057" href="lagda.2023-11-21-nbe.html#59036" class="Bound">Γ′≤Γ</a> <a id="59062" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="59065" href="lagda.2023-11-21-nbe.html#59016" class="Bound">t′</a>
  <a id="59070" href="lagda.2023-11-21-nbe.html#32023" class="Function Operator">==⟨</a> <a id="59074" href="lagda.2023-11-21-nbe.html#31224" class="InductiveConstructor">sym⁼⁼</a> <a id="59080" class="Symbol">(</a><a id="59081" href="lagda.2023-11-21-nbe.html#57784" class="Function">cong⁼⁼-sub</a> <a id="59092" href="lagda.2023-11-21-nbe.html#59027" class="Bound">t==t′</a><a id="59097" class="Symbol">)</a> <a id="59099" href="lagda.2023-11-21-nbe.html#32023" class="Function Operator">⟩</a>
    <a id="59105" href="lagda.2023-11-21-nbe.html#59036" class="Bound">Γ′≤Γ</a> <a id="59110" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="59113" href="lagda.2023-11-21-nbe.html#59012" class="Bound">t</a>
  <a id="59117" href="lagda.2023-11-21-nbe.html#32023" class="Function Operator">==⟨</a> <a id="59121" href="lagda.2023-11-21-nbe.html#59033" class="Bound">pf</a> <a id="59124" href="lagda.2023-11-21-nbe.html#59036" class="Bound">Γ′≤Γ</a> <a id="59129" href="lagda.2023-11-21-nbe.html#32023" class="Function Operator">⟩</a>
    <a id="59135" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a>
  <a id="59142" href="lagda.2023-11-21-nbe.html#32231" class="Function Operator">==∎</a>
<a id="59146" href="lagda.2023-11-21-nbe.html#58848" class="Function">==-Ⓡ-trans</a> <a id="59157" class="Symbol">{</a><a id="59158" class="Argument">T</a> <a id="59160" class="Symbol">=</a> <a id="59162" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a><a id="59163" class="Symbol">}</a> <a id="59165" class="Symbol">{</a><a id="59166" href="lagda.2023-11-21-nbe.html#59166" class="Bound">t</a><a id="59167" class="Symbol">}</a> <a id="59169" class="Symbol">{</a><a id="59170" href="lagda.2023-11-21-nbe.html#59170" class="Bound">t′</a><a id="59172" class="Symbol">}</a> <a id="59174" class="Symbol">{</a><a id="59175" href="lagda.2023-11-21-nbe.html#43694" class="InductiveConstructor">ne</a> <a id="59178" href="lagda.2023-11-21-nbe.html#59178" class="Bound">𝓊̂</a><a id="59180" class="Symbol">}</a> <a id="59182" href="lagda.2023-11-21-nbe.html#59182" class="Bound">t==t′</a> <a id="59188" href="lagda.2023-11-21-nbe.html#59188" class="Bound">pf</a> <a id="59191" class="Symbol">{</a><a id="59192" href="lagda.2023-11-21-nbe.html#59192" class="Bound">Γ′</a><a id="59194" class="Symbol">}</a> <a id="59196" href="lagda.2023-11-21-nbe.html#59196" class="Bound">Γ′≤Γ</a>
  <a id="59203" class="Keyword">with</a> <a id="59208" href="lagda.2023-11-21-nbe.html#59178" class="Bound">𝓊̂</a> <a id="59211" href="lagda.2023-11-21-nbe.html#59192" class="Bound">Γ′</a>          <a id="59223" class="Symbol">|</a> <a id="59225" href="lagda.2023-11-21-nbe.html#59188" class="Bound">pf</a> <a id="59228" href="lagda.2023-11-21-nbe.html#59196" class="Bound">Γ′≤Γ</a>
<a id="59233" class="Symbol">...</a> <a id="59237" class="Symbol">|</a> <a id="59239" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="59244" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="59246" href="lagda.2023-11-21-nbe.html#59246" class="Bound">𝓊</a> <a id="59248" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="59250" class="Symbol">_</a> <a id="59252" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a> <a id="59254" class="Symbol">|</a> <a id="59256" href="lagda.2023-11-21-nbe.html#59256" class="Bound">t==𝓊</a>    <a id="59264" class="Symbol">=</a>
  <a id="59268" href="lagda.2023-11-21-nbe.html#31890" class="Function Operator">begin==</a>
    <a id="59280" class="Bound">Γ′≤Γ</a> <a id="59285" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="59288" class="Bound">t′</a>
  <a id="59293" href="lagda.2023-11-21-nbe.html#32023" class="Function Operator">==⟨</a> <a id="59297" href="lagda.2023-11-21-nbe.html#31224" class="InductiveConstructor">sym⁼⁼</a> <a id="59303" class="Symbol">(</a><a id="59304" href="lagda.2023-11-21-nbe.html#57784" class="Function">cong⁼⁼-sub</a> <a id="59315" class="Bound">t==t′</a><a id="59320" class="Symbol">)</a> <a id="59322" href="lagda.2023-11-21-nbe.html#32023" class="Function Operator">⟩</a>
    <a id="59328" class="Bound">Γ′≤Γ</a> <a id="59333" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="59336" class="Bound">t</a>
  <a id="59340" href="lagda.2023-11-21-nbe.html#32023" class="Function Operator">==⟨</a> <a id="59344" href="lagda.2023-11-21-nbe.html#59256" class="Bound">t==𝓊</a> <a id="59349" href="lagda.2023-11-21-nbe.html#32023" class="Function Operator">⟩</a>
    <a id="59355" href="lagda.2023-11-21-nbe.html#59246" class="Bound">𝓊</a>
  <a id="59359" href="lagda.2023-11-21-nbe.html#32231" class="Function Operator">==∎</a>
<a id="59363" href="lagda.2023-11-21-nbe.html#58848" class="Function">==-Ⓡ-trans</a> <a id="59374" class="Symbol">{</a><a id="59375" class="Argument">T</a> <a id="59377" class="Symbol">=</a> <a id="59379" href="lagda.2023-11-21-nbe.html#59379" class="Bound">S</a> <a id="59381" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="59383" href="lagda.2023-11-21-nbe.html#59383" class="Bound">T</a><a id="59384" class="Symbol">}</a> <a id="59386" class="Symbol">{</a><a id="59387" href="lagda.2023-11-21-nbe.html#59387" class="Bound">r</a><a id="59388" class="Symbol">}</a> <a id="59390" class="Symbol">{</a><a id="59391" href="lagda.2023-11-21-nbe.html#59391" class="Bound">r′</a><a id="59393" class="Symbol">}</a> <a id="59395" href="lagda.2023-11-21-nbe.html#59395" class="Bound">r==r′</a> <a id="59401" href="lagda.2023-11-21-nbe.html#59401" class="Bound">pf</a> <a id="59404" href="lagda.2023-11-21-nbe.html#59404" class="Bound">Γ′≤Γ</a> <a id="59409" href="lagda.2023-11-21-nbe.html#59409" class="Bound">sⓇa</a> <a id="59413" class="Symbol">=</a>
  <a id="59417" href="lagda.2023-11-21-nbe.html#58848" class="Function">==-Ⓡ-trans</a> <a id="59428" href="lagda.2023-11-21-nbe.html#59457" class="Function">r·s==r′·s</a> <a id="59438" href="lagda.2023-11-21-nbe.html#59514" class="Function">r·sⓇfa</a>
  <a id="59447" class="Keyword">where</a>
    <a id="59457" href="lagda.2023-11-21-nbe.html#59457" class="Function">r·s==r′·s</a> <a id="59467" class="Symbol">=</a> <a id="59469" href="lagda.2023-11-21-nbe.html#30884" class="InductiveConstructor">app-compatible</a> <a id="59484" class="Symbol">(</a><a id="59485" href="lagda.2023-11-21-nbe.html#57784" class="Function">cong⁼⁼-sub</a> <a id="59496" href="lagda.2023-11-21-nbe.html#59395" class="Bound">r==r′</a><a id="59501" class="Symbol">)</a> <a id="59503" href="lagda.2023-11-21-nbe.html#31141" class="InductiveConstructor">refl⁼⁼</a>
    <a id="59514" href="lagda.2023-11-21-nbe.html#59514" class="Function">r·sⓇfa</a> <a id="59521" class="Symbol">=</a> <a id="59523" href="lagda.2023-11-21-nbe.html#59401" class="Bound">pf</a> <a id="59526" href="lagda.2023-11-21-nbe.html#59404" class="Bound">Γ′≤Γ</a> <a id="59531" href="lagda.2023-11-21-nbe.html#59409" class="Bound">sⓇa</a>
</pre>
<p>Additionally, because we have defined the relation so that its implication holds
for all extensions of a context, we can “weaken” the logical relation
<code>Γ ⊢ t : T Ⓡ a</code> for all <code>Γ′ ≤ Γ</code>, having that <code>Γ′ ⊢ t : T Ⓡ a</code> holds as well.
For this proof, we use another lemma whose proof has also been omitted,
<code>compose-weaken</code>: weakening a term <code>t</code> twice is equivalent to weakening it once
with a composed weakening substitution.</p>
<!---
<pre class="Agda"><a id="compose-ρ-≤"></a><a id="59976" href="lagda.2023-11-21-nbe.html#59976" class="Function">compose-ρ-≤</a> <a id="59988" class="Symbol">:</a> <a id="59990" class="Symbol">∀</a> <a id="59992" class="Symbol">{</a><a id="59993" href="lagda.2023-11-21-nbe.html#59993" class="Bound">Γ″</a> <a id="59996" href="lagda.2023-11-21-nbe.html#59996" class="Bound">Γ′</a> <a id="59999" href="lagda.2023-11-21-nbe.html#59999" class="Bound">Γ</a> <a id="60001" class="Symbol">:</a> <a id="60003" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="60006" class="Symbol">}</a> <a id="60008" class="Symbol">{</a><a id="60009" href="lagda.2023-11-21-nbe.html#60009" class="Bound">T</a> <a id="60011" class="Symbol">:</a> <a id="60013" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="60017" class="Symbol">}</a>
            <a id="60031" class="Symbol">→</a> <a id="60033" class="Symbol">(</a><a id="60034" href="lagda.2023-11-21-nbe.html#60034" class="Bound">Γ″≤Γ′</a> <a id="60040" class="Symbol">:</a> <a id="60042" href="lagda.2023-11-21-nbe.html#59993" class="Bound">Γ″</a> <a id="60045" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="60047" href="lagda.2023-11-21-nbe.html#59996" class="Bound">Γ′</a><a id="60049" class="Symbol">)</a>
            <a id="60063" class="Symbol">→</a> <a id="60065" class="Symbol">(</a><a id="60066" href="lagda.2023-11-21-nbe.html#60066" class="Bound">Γ′≤Γ</a> <a id="60071" class="Symbol">:</a> <a id="60073" href="lagda.2023-11-21-nbe.html#59996" class="Bound">Γ′</a> <a id="60076" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="60078" href="lagda.2023-11-21-nbe.html#59999" class="Bound">Γ</a><a id="60079" class="Symbol">)</a>
            <a id="60093" class="Symbol">→</a> <a id="60095" class="Symbol">(</a><a id="60096" href="lagda.2023-11-21-nbe.html#60096" class="Bound">x</a> <a id="60098" class="Symbol">:</a> <a id="60100" href="lagda.2023-11-21-nbe.html#59999" class="Bound">Γ</a> <a id="60102" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="60104" href="lagda.2023-11-21-nbe.html#60009" class="Bound">T</a><a id="60105" class="Symbol">)</a>
            <a id="60119" class="Symbol">→</a> <a id="60121" href="lagda.2023-11-21-nbe.html#13819" class="Function">ρ-≤</a> <a id="60125" href="lagda.2023-11-21-nbe.html#60034" class="Bound">Γ″≤Γ′</a> <a id="60131" class="Symbol">(</a><a id="60132" href="lagda.2023-11-21-nbe.html#13819" class="Function">ρ-≤</a> <a id="60136" href="lagda.2023-11-21-nbe.html#60066" class="Bound">Γ′≤Γ</a> <a id="60141" href="lagda.2023-11-21-nbe.html#60096" class="Bound">x</a><a id="60142" class="Symbol">)</a> <a id="60144" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="60146" href="lagda.2023-11-21-nbe.html#13819" class="Function">ρ-≤</a> <a id="60150" class="Symbol">(</a><a id="60151" href="lagda.2023-11-21-nbe.html#9166" class="Function">≤-trans</a> <a id="60159" href="lagda.2023-11-21-nbe.html#60034" class="Bound">Γ″≤Γ′</a> <a id="60165" href="lagda.2023-11-21-nbe.html#60066" class="Bound">Γ′≤Γ</a><a id="60169" class="Symbol">)</a> <a id="60171" href="lagda.2023-11-21-nbe.html#60096" class="Bound">x</a>
<a id="60173" href="lagda.2023-11-21-nbe.html#59976" class="Function">compose-ρ-≤</a> <a id="60185" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a> <a id="60190" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a> <a id="60195" class="Symbol">_</a>                    <a id="60216" class="Symbol">=</a> <a id="60218" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="60223" href="lagda.2023-11-21-nbe.html#59976" class="Function">compose-ρ-≤</a> <a id="60235" class="Symbol">(</a><a id="60236" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="60242" class="Symbol">_)</a> <a id="60245" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a> <a id="60250" class="Symbol">_</a>               <a id="60266" class="Symbol">=</a> <a id="60268" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="60273" href="lagda.2023-11-21-nbe.html#59976" class="Function">compose-ρ-≤</a> <a id="60285" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a> <a id="60290" class="Symbol">(</a><a id="60291" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="60297" class="Symbol">_)</a> <a id="60300" class="Symbol">_</a>               <a id="60316" class="Symbol">=</a> <a id="60318" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="60323" href="lagda.2023-11-21-nbe.html#59976" class="Function">compose-ρ-≤</a> <a id="60335" class="Symbol">(</a><a id="60336" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="60342" href="lagda.2023-11-21-nbe.html#60342" class="Bound">Γ″≤Γ′</a><a id="60347" class="Symbol">)</a> <a id="60349" class="Symbol">(</a><a id="60350" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="60356" href="lagda.2023-11-21-nbe.html#60356" class="Bound">Γ′≤Γ</a><a id="60360" class="Symbol">)</a> <a id="60362" href="lagda.2023-11-21-nbe.html#60362" class="Bound">x</a>
  <a id="60366" class="Keyword">rewrite</a> <a id="60374" href="lagda.2023-11-21-nbe.html#59976" class="Function">compose-ρ-≤</a> <a id="60386" href="lagda.2023-11-21-nbe.html#60342" class="Bound">Γ″≤Γ′</a><a id="60391" class="Symbol">(</a><a id="60392" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="60398" href="lagda.2023-11-21-nbe.html#60356" class="Bound">Γ′≤Γ</a><a id="60402" class="Symbol">)</a> <a id="60404" href="lagda.2023-11-21-nbe.html#60362" class="Bound">x</a>  <a id="60407" class="Symbol">=</a> <a id="60409" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

</pre>--->
<pre class="Agda"><a id="compose-weaken"></a><a id="60433" href="lagda.2023-11-21-nbe.html#60433" class="Function">compose-weaken</a> <a id="60448" class="Symbol">:</a> <a id="60450" class="Symbol">∀</a> <a id="60452" class="Symbol">{</a><a id="60453" href="lagda.2023-11-21-nbe.html#60453" class="Bound">Γ″</a> <a id="60456" href="lagda.2023-11-21-nbe.html#60456" class="Bound">Γ′</a> <a id="60459" href="lagda.2023-11-21-nbe.html#60459" class="Bound">Γ</a> <a id="60461" class="Symbol">:</a> <a id="60463" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="60466" class="Symbol">}</a> <a id="60468" class="Symbol">{</a><a id="60469" href="lagda.2023-11-21-nbe.html#60469" class="Bound">T</a> <a id="60471" class="Symbol">:</a> <a id="60473" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="60477" class="Symbol">}</a>
               <a id="60494" class="Symbol">→</a> <a id="60496" class="Symbol">(</a><a id="60497" href="lagda.2023-11-21-nbe.html#60497" class="Bound">Γ″≤Γ′</a> <a id="60503" class="Symbol">:</a> <a id="60505" href="lagda.2023-11-21-nbe.html#60453" class="Bound">Γ″</a> <a id="60508" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="60510" href="lagda.2023-11-21-nbe.html#60456" class="Bound">Γ′</a><a id="60512" class="Symbol">)</a>
               <a id="60529" class="Symbol">→</a> <a id="60531" class="Symbol">(</a><a id="60532" href="lagda.2023-11-21-nbe.html#60532" class="Bound">Γ′≤Γ</a> <a id="60537" class="Symbol">:</a> <a id="60539" href="lagda.2023-11-21-nbe.html#60456" class="Bound">Γ′</a> <a id="60542" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="60544" href="lagda.2023-11-21-nbe.html#60459" class="Bound">Γ</a><a id="60545" class="Symbol">)</a>
               <a id="60562" class="Symbol">→</a> <a id="60564" class="Symbol">(</a><a id="60565" href="lagda.2023-11-21-nbe.html#60565" class="Bound">t</a> <a id="60567" class="Symbol">:</a> <a id="60569" href="lagda.2023-11-21-nbe.html#60459" class="Bound">Γ</a> <a id="60571" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="60573" href="lagda.2023-11-21-nbe.html#60469" class="Bound">T</a><a id="60574" class="Symbol">)</a>
               <a id="60591" class="Symbol">→</a> <a id="60593" href="lagda.2023-11-21-nbe.html#60497" class="Bound">Γ″≤Γ′</a> <a id="60599" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="60602" href="lagda.2023-11-21-nbe.html#60532" class="Bound">Γ′≤Γ</a> <a id="60607" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="60610" href="lagda.2023-11-21-nbe.html#60565" class="Bound">t</a> <a id="60612" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="60614" class="Symbol">(</a><a id="60615" href="lagda.2023-11-21-nbe.html#9166" class="Function">≤-trans</a> <a id="60623" href="lagda.2023-11-21-nbe.html#60497" class="Bound">Γ″≤Γ′</a> <a id="60629" href="lagda.2023-11-21-nbe.html#60532" class="Bound">Γ′≤Γ</a><a id="60633" class="Symbol">)</a> <a id="60635" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="60638" href="lagda.2023-11-21-nbe.html#60565" class="Bound">t</a>
</pre>
<!---
<pre class="Agda"><a id="60659" href="lagda.2023-11-21-nbe.html#60433" class="Function">compose-weaken</a> <a id="60674" href="lagda.2023-11-21-nbe.html#60674" class="Bound">Γ″≤Γ′</a> <a id="60680" href="lagda.2023-11-21-nbe.html#60680" class="Bound">Γ′≤Γ</a> <a id="60685" href="lagda.2023-11-21-nbe.html#60685" class="Bound">t</a>
  <a id="60689" class="Keyword">rewrite</a> <a id="60697" href="lagda.2023-11-21-nbe.html#25552" class="Function">sub-sub</a> <a id="60705" class="Symbol">{</a><a id="60706" class="Argument">τ</a> <a id="60708" class="Symbol">=</a> <a id="60710" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="60717" href="lagda.2023-11-21-nbe.html#60674" class="Bound">Γ″≤Γ′</a><a id="60722" class="Symbol">}</a> <a id="60724" class="Symbol">{</a><a id="60725" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="60732" href="lagda.2023-11-21-nbe.html#60680" class="Bound">Γ′≤Γ</a><a id="60736" class="Symbol">}</a> <a id="60738" class="Symbol">{</a><a id="60739" href="lagda.2023-11-21-nbe.html#60685" class="Bound">t</a><a id="60740" class="Symbol">}</a> <a id="60742" class="Symbol">=</a>
    <a id="60748" href="lagda.2023-11-21-nbe.html#19474" class="Function">cong-sub</a> <a id="60757" class="Symbol">{</a><a id="60758" class="Argument">t</a> <a id="60760" class="Symbol">=</a> <a id="60762" href="lagda.2023-11-21-nbe.html#60685" class="Bound">t</a><a id="60763" class="Symbol">}</a>
      <a id="60771" class="Symbol">(</a><a id="60772" href="lagda.2023-11-21-nbe.html#2744" class="Postulate">extensionality</a> <a id="60787" class="Symbol">λ{</a><a id="60789" href="lagda.2023-11-21-nbe.html#60789" class="Bound">x</a> <a id="60791" class="Symbol">→</a> <a id="60793" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="60798" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#_</a> <a id="60801" class="Symbol">(</a><a id="60802" href="lagda.2023-11-21-nbe.html#59976" class="Function">compose-ρ-≤</a> <a id="60814" href="lagda.2023-11-21-nbe.html#60674" class="Bound">Γ″≤Γ′</a> <a id="60820" href="lagda.2023-11-21-nbe.html#60680" class="Bound">Γ′≤Γ</a> <a id="60825" href="lagda.2023-11-21-nbe.html#60789" class="Bound">x</a><a id="60826" class="Symbol">)})</a>
      <a id="60836" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
</pre>--->
<pre class="Agda"><a id="Ⓡ-weaken"></a><a id="60859" href="lagda.2023-11-21-nbe.html#60859" class="Function">Ⓡ-weaken</a> <a id="60868" class="Symbol">:</a> <a id="60870" class="Symbol">∀</a> <a id="60872" class="Symbol">{</a><a id="60873" href="lagda.2023-11-21-nbe.html#60873" class="Bound">Γ′</a> <a id="60876" href="lagda.2023-11-21-nbe.html#60876" class="Bound">Γ</a> <a id="60878" class="Symbol">:</a> <a id="60880" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="60883" class="Symbol">}</a> <a id="60885" class="Symbol">{</a><a id="60886" href="lagda.2023-11-21-nbe.html#60886" class="Bound">T</a> <a id="60888" class="Symbol">:</a> <a id="60890" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="60894" class="Symbol">}</a> <a id="60896" class="Symbol">{</a><a id="60897" href="lagda.2023-11-21-nbe.html#60897" class="Bound">Γ′≤Γ</a> <a id="60902" class="Symbol">:</a> <a id="60904" href="lagda.2023-11-21-nbe.html#60873" class="Bound">Γ′</a> <a id="60907" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="60909" href="lagda.2023-11-21-nbe.html#60876" class="Bound">Γ</a><a id="60910" class="Symbol">}</a> <a id="60912" class="Symbol">{</a><a id="60913" href="lagda.2023-11-21-nbe.html#60913" class="Bound">t</a> <a id="60915" class="Symbol">:</a> <a id="60917" href="lagda.2023-11-21-nbe.html#60876" class="Bound">Γ</a> <a id="60919" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="60921" href="lagda.2023-11-21-nbe.html#60886" class="Bound">T</a><a id="60922" class="Symbol">}</a>
             <a id="60937" class="Symbol">{</a><a id="60938" href="lagda.2023-11-21-nbe.html#60938" class="Bound">a</a> <a id="60940" class="Symbol">:</a> <a id="60942" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="60944" href="lagda.2023-11-21-nbe.html#60886" class="Bound">T</a> <a id="60946" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a><a id="60947" class="Symbol">}</a>
      <a id="60955" class="Symbol">→</a> <a id="60957" href="lagda.2023-11-21-nbe.html#60913" class="Bound">t</a> <a id="60959" href="lagda.2023-11-21-nbe.html#56818" class="Function Operator">Ⓡ</a> <a id="60961" href="lagda.2023-11-21-nbe.html#60938" class="Bound">a</a>
      <a id="60969" class="Symbol">→</a> <a id="60971" href="lagda.2023-11-21-nbe.html#60897" class="Bound">Γ′≤Γ</a> <a id="60976" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="60979" href="lagda.2023-11-21-nbe.html#60913" class="Bound">t</a> <a id="60981" href="lagda.2023-11-21-nbe.html#56818" class="Function Operator">Ⓡ</a> <a id="60983" href="lagda.2023-11-21-nbe.html#60938" class="Bound">a</a>
<a id="60985" href="lagda.2023-11-21-nbe.html#60859" class="Function">Ⓡ-weaken</a> <a id="60994" class="Symbol">{</a><a id="60995" class="Argument">T</a> <a id="60997" class="Symbol">=</a> <a id="60999" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a><a id="61000" class="Symbol">}</a> <a id="61002" class="Symbol">{</a><a id="61003" href="lagda.2023-11-21-nbe.html#61003" class="Bound">Γ′≤Γ</a><a id="61007" class="Symbol">}</a> <a id="61009" class="Symbol">{</a><a id="61010" href="lagda.2023-11-21-nbe.html#61010" class="Bound">t</a><a id="61011" class="Symbol">}</a> <a id="61013" href="lagda.2023-11-21-nbe.html#61013" class="Bound">pf</a> <a id="61016" href="lagda.2023-11-21-nbe.html#61016" class="Bound">Γ″≤Γ′</a>
  <a id="61024" class="Keyword">rewrite</a> <a id="61032" href="lagda.2023-11-21-nbe.html#60433" class="Function">compose-weaken</a> <a id="61047" href="lagda.2023-11-21-nbe.html#61016" class="Bound">Γ″≤Γ′</a> <a id="61053" href="lagda.2023-11-21-nbe.html#61003" class="Bound">Γ′≤Γ</a> <a id="61058" href="lagda.2023-11-21-nbe.html#61010" class="Bound">t</a> <a id="61060" class="Symbol">=</a> <a id="61062" href="lagda.2023-11-21-nbe.html#61013" class="Bound">pf</a> <a id="61065" class="Symbol">(</a><a id="61066" href="lagda.2023-11-21-nbe.html#9166" class="Function">≤-trans</a> <a id="61074" href="lagda.2023-11-21-nbe.html#61016" class="Bound">Γ″≤Γ′</a> <a id="61080" href="lagda.2023-11-21-nbe.html#61003" class="Bound">Γ′≤Γ</a><a id="61084" class="Symbol">)</a>
<a id="61086" href="lagda.2023-11-21-nbe.html#60859" class="Function">Ⓡ-weaken</a> <a id="61095" class="Symbol">{</a><a id="61096" class="Argument">T</a> <a id="61098" class="Symbol">=</a> <a id="61100" href="lagda.2023-11-21-nbe.html#61100" class="Bound">S</a> <a id="61102" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="61104" href="lagda.2023-11-21-nbe.html#61104" class="Bound">T</a><a id="61105" class="Symbol">}</a> <a id="61107" class="Symbol">{</a><a id="61108" href="lagda.2023-11-21-nbe.html#61108" class="Bound">Γ′≤Γ</a><a id="61112" class="Symbol">}</a> <a id="61114" class="Symbol">{</a><a id="61115" href="lagda.2023-11-21-nbe.html#61115" class="Bound">t</a><a id="61116" class="Symbol">}</a> <a id="61118" href="lagda.2023-11-21-nbe.html#61118" class="Bound">pf</a> <a id="61121" href="lagda.2023-11-21-nbe.html#61121" class="Bound">Γ″≤Γ′</a> <a id="61127" href="lagda.2023-11-21-nbe.html#61127" class="Bound">sⓇa</a>
  <a id="61133" class="Keyword">rewrite</a> <a id="61141" href="lagda.2023-11-21-nbe.html#60433" class="Function">compose-weaken</a> <a id="61156" href="lagda.2023-11-21-nbe.html#61121" class="Bound">Γ″≤Γ′</a> <a id="61162" href="lagda.2023-11-21-nbe.html#61108" class="Bound">Γ′≤Γ</a> <a id="61167" href="lagda.2023-11-21-nbe.html#61115" class="Bound">t</a> <a id="61169" class="Symbol">=</a> <a id="61171" href="lagda.2023-11-21-nbe.html#61118" class="Bound">pf</a> <a id="61174" class="Symbol">(</a><a id="61175" href="lagda.2023-11-21-nbe.html#9166" class="Function">≤-trans</a> <a id="61183" href="lagda.2023-11-21-nbe.html#61121" class="Bound">Γ″≤Γ′</a> <a id="61189" href="lagda.2023-11-21-nbe.html#61108" class="Bound">Γ′≤Γ</a><a id="61193" class="Symbol">)</a> <a id="61195" href="lagda.2023-11-21-nbe.html#61127" class="Bound">sⓇa</a>
</pre>
<p>The logical relation between terms and semantic objects is “sandwiched” between
reflection and reification – to arrive at a logical relation between a term and
a semantic object, the semantic object must be a reflection of a liftable
neutral that is definitionally equal to the term. Likewise, if a logical
relation holds between a term and a semantic object, then the term must be
definitionally equal to the reification of that semantic object.</p>
<p>This is intentional, as these results will be exactly what we will need to prove
the soundness of normalization by evaluation. We formalize them with the
following lemmas, which we will prove mutually (as reflection and reification
are themselves defined mutually) by induction on types.</p>
<p>The first lemma is that if the liftable variable <code>𝓊̂</code> is definitionally equal
to a term <code>𝓊</code> for all contexts <code>Γ′ ≤ Γ</code>, then <code>𝓊</code> is logically related to the
reflection of <code>𝓊̂</code>:</p>
<pre><code>(∀ Γ′ ≤ Γ. Γ′ ⊢ 𝓊 = 𝓊̂(Γ′) : T) ⇒ Γ ⊢ 𝓊 : T Ⓡ ↑ᵀ 𝓊̂</code></pre>
<pre class="Agda"><a id="==^→Ⓡ↑"></a><a id="62184" href="lagda.2023-11-21-nbe.html#62184" class="Function">==^→Ⓡ↑</a> <a id="62191" class="Symbol">:</a> <a id="62193" class="Symbol">∀</a> <a id="62195" class="Symbol">{</a><a id="62196" href="lagda.2023-11-21-nbe.html#62196" class="Bound">Γ</a> <a id="62198" class="Symbol">:</a> <a id="62200" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="62203" class="Symbol">}</a> <a id="62205" class="Symbol">{</a><a id="62206" href="lagda.2023-11-21-nbe.html#62206" class="Bound">T</a> <a id="62208" class="Symbol">:</a> <a id="62210" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="62214" class="Symbol">}</a> <a id="62216" class="Symbol">{</a><a id="62217" href="lagda.2023-11-21-nbe.html#62217" class="Bound">𝓊</a> <a id="62219" class="Symbol">:</a> <a id="62221" href="lagda.2023-11-21-nbe.html#62196" class="Bound">Γ</a> <a id="62223" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="62225" href="lagda.2023-11-21-nbe.html#62206" class="Bound">T</a><a id="62226" class="Symbol">}</a> <a id="62228" class="Symbol">{</a><a id="62229" href="lagda.2023-11-21-nbe.html#62229" class="Bound">𝓊̂</a> <a id="62232" class="Symbol">:</a> <a id="62234" href="lagda.2023-11-21-nbe.html#42020" class="Function">Ne^</a> <a id="62238" href="lagda.2023-11-21-nbe.html#62206" class="Bound">T</a><a id="62239" class="Symbol">}</a>
        <a id="62249" class="Symbol">→</a> <a id="62251" class="Symbol">(∀</a> <a id="62254" class="Symbol">{</a><a id="62255" href="lagda.2023-11-21-nbe.html#62255" class="Bound">Γ′</a> <a id="62258" class="Symbol">:</a> <a id="62260" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="62263" class="Symbol">}</a>
           <a id="62276" class="Symbol">→</a> <a id="62278" class="Symbol">(</a><a id="62279" href="lagda.2023-11-21-nbe.html#62279" class="Bound">Γ′≤Γ</a> <a id="62284" class="Symbol">:</a> <a id="62286" href="lagda.2023-11-21-nbe.html#62255" class="Bound">Γ′</a> <a id="62289" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="62291" href="lagda.2023-11-21-nbe.html#62196" class="Bound">Γ</a><a id="62292" class="Symbol">)</a>
           <a id="62305" class="Symbol">→</a> <a id="62307" href="lagda.2023-11-21-nbe.html#62279" class="Bound">Γ′≤Γ</a> <a id="62312" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="62315" href="lagda.2023-11-21-nbe.html#62217" class="Bound">𝓊</a> <a id="62317" href="lagda.2023-11-21-nbe.html#54968" class="Function Operator">==^</a> <a id="62321" href="lagda.2023-11-21-nbe.html#62229" class="Bound">𝓊̂</a><a id="62323" class="Symbol">)</a>
          <a id="62335" class="Comment">-------------------</a>
        <a id="62363" class="Symbol">→</a> <a id="62365" href="lagda.2023-11-21-nbe.html#62217" class="Bound">𝓊</a> <a id="62367" href="lagda.2023-11-21-nbe.html#56818" class="Function Operator">Ⓡ</a> <a id="62369" class="Symbol">(</a><a id="62370" href="lagda.2023-11-21-nbe.html#45252" class="Function">↑ᵀ</a> <a id="62373" href="lagda.2023-11-21-nbe.html#62229" class="Bound">𝓊̂</a><a id="62375" class="Symbol">)</a>
</pre>
<p>An immediate consequence of this lemma is that <code>Γ , x:T ⊢ x Ⓡ ↑ᵀ 𝓍̂ Γ</code>, which we
can define in Agda now as it will be necessary for proving the next lemma we
will introduce.</p>
<pre class="Agda"><a id="xⓇ↑ᵀ𝓍̂"></a><a id="62565" href="lagda.2023-11-21-nbe.html#62565" class="Function">xⓇ↑ᵀ𝓍̂</a> <a id="62572" class="Symbol">:</a> <a id="62574" class="Symbol">∀</a> <a id="62576" class="Symbol">{</a><a id="62577" href="lagda.2023-11-21-nbe.html#62577" class="Bound">Γ</a> <a id="62579" class="Symbol">:</a> <a id="62581" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="62584" class="Symbol">}</a> <a id="62586" class="Symbol">{</a><a id="62587" href="lagda.2023-11-21-nbe.html#62587" class="Bound">T</a> <a id="62589" class="Symbol">:</a> <a id="62591" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="62595" class="Symbol">}</a>
        <a id="62605" class="Comment">-------------------------</a>
      <a id="62637" class="Symbol">→</a> <a id="62639" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="62641" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a> <a id="62643" class="Symbol">{</a><a id="62644" href="lagda.2023-11-21-nbe.html#62577" class="Bound">Γ</a><a id="62645" class="Symbol">}</a> <a id="62647" class="Symbol">{</a><a id="62648" href="lagda.2023-11-21-nbe.html#62587" class="Bound">T</a><a id="62649" class="Symbol">}</a> <a id="62651" href="lagda.2023-11-21-nbe.html#56818" class="Function Operator">Ⓡ</a> <a id="62653" href="lagda.2023-11-21-nbe.html#45252" class="Function">↑ᵀ</a> <a id="62656" class="Symbol">(</a><a id="62657" href="lagda.2023-11-21-nbe.html#46082" class="Function">𝓍̂</a> <a id="62660" href="lagda.2023-11-21-nbe.html#62587" class="Bound">T</a> <a id="62662" href="lagda.2023-11-21-nbe.html#62577" class="Bound">Γ</a><a id="62663" class="Symbol">)</a>
</pre>
<p>The second lemma is that if <code>Γ ⊢ t : T</code> and <code>a ∈ ⟦ T ⟧</code> are logically related,
then <code>t</code> is definitionally equal to the reification of <code>a</code> for all contexts
<code>Γ′ ≤ Γ</code>:</p>
<pre><code>Γ ⊢ t : T Ⓡ a ⇒ ∀ Γ′ ≤ Γ. Γ′ ⊢ t = ↓ᵀ a Γ′ : T</code></pre>
<pre class="Agda"><a id="Ⓡ→==↓"></a><a id="62896" href="lagda.2023-11-21-nbe.html#62896" class="Function">Ⓡ→==↓</a> <a id="62902" class="Symbol">:</a> <a id="62904" class="Symbol">∀</a> <a id="62906" class="Symbol">{</a><a id="62907" href="lagda.2023-11-21-nbe.html#62907" class="Bound">Γ′</a> <a id="62910" href="lagda.2023-11-21-nbe.html#62910" class="Bound">Γ</a> <a id="62912" class="Symbol">:</a> <a id="62914" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="62917" class="Symbol">}</a> <a id="62919" class="Symbol">{</a><a id="62920" href="lagda.2023-11-21-nbe.html#62920" class="Bound">T</a> <a id="62922" class="Symbol">:</a> <a id="62924" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="62928" class="Symbol">}</a> <a id="62930" class="Symbol">{</a><a id="62931" href="lagda.2023-11-21-nbe.html#62931" class="Bound">t</a> <a id="62933" class="Symbol">:</a> <a id="62935" href="lagda.2023-11-21-nbe.html#62910" class="Bound">Γ</a> <a id="62937" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="62939" href="lagda.2023-11-21-nbe.html#62920" class="Bound">T</a><a id="62940" class="Symbol">}</a> <a id="62942" class="Symbol">{</a><a id="62943" href="lagda.2023-11-21-nbe.html#62943" class="Bound">a</a> <a id="62945" class="Symbol">:</a> <a id="62947" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="62949" href="lagda.2023-11-21-nbe.html#62920" class="Bound">T</a> <a id="62951" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a><a id="62952" class="Symbol">}</a>
      <a id="62960" class="Symbol">→</a> <a id="62962" href="lagda.2023-11-21-nbe.html#62931" class="Bound">t</a> <a id="62964" href="lagda.2023-11-21-nbe.html#56818" class="Function Operator">Ⓡ</a> <a id="62966" href="lagda.2023-11-21-nbe.html#62943" class="Bound">a</a>
        <a id="62976" class="Comment">----------------------------</a>
      <a id="63011" class="Symbol">→</a> <a id="63013" class="Symbol">(</a><a id="63014" href="lagda.2023-11-21-nbe.html#63014" class="Bound">Γ′≤Γ</a> <a id="63019" class="Symbol">:</a> <a id="63021" href="lagda.2023-11-21-nbe.html#62907" class="Bound">Γ′</a> <a id="63024" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="63026" href="lagda.2023-11-21-nbe.html#62910" class="Bound">Γ</a><a id="63027" class="Symbol">)</a>
      <a id="63035" class="Symbol">→</a> <a id="63037" href="lagda.2023-11-21-nbe.html#63014" class="Bound">Γ′≤Γ</a> <a id="63042" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="63045" href="lagda.2023-11-21-nbe.html#62931" class="Bound">t</a> <a id="63047" href="lagda.2023-11-21-nbe.html#30265" class="Datatype Operator">==</a> <a id="63050" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="63056" class="Symbol">(</a><a id="63057" href="lagda.2023-11-21-nbe.html#45357" class="Function">↓ᵀ</a> <a id="63060" href="lagda.2023-11-21-nbe.html#62943" class="Bound">a</a> <a id="63062" href="lagda.2023-11-21-nbe.html#62907" class="Bound">Γ′</a><a id="63064" class="Symbol">)</a>
</pre>
<p>This lemma is in fact what we wanted in the first place: that if a term is
logically related to a semantic object, then it is definitionally equal to the
reification of said object. It is stronger than we need it to be, but again this
is necessary to actually prove the implication.</p>
<p>We will start by proving the first lemma, focusing on each case of the proof
separately, before moving on to proving the second lemma. Again, the first
lemma is:</p>
<pre><code>(∀ Γ′ ≤ Γ. Γ′ ⊢ 𝓊 = 𝓊̂(Γ) : T) ⇒ Γ ⊢ 𝓊 : T Ⓡ ↑ᵀ 𝓊̂</code></pre>
<p>We prove this by induction on the type <code>T</code>. At type <code>𝟙</code>, our proof is
immediate, as <code>Γ ⊢ u : 𝟙 Ⓡ ↑ᵘⁿⁱᵗ 𝓊̂</code> is defined as:</p>
<pre><code>∀ Γ′ ≤ Γ. Γ′ ⊢ 𝓊 = 𝓊̂(Γ) : 𝟙</code></pre>
<p>Which is exactly our given proof.</p>
<pre class="Agda"><a id="63774" href="lagda.2023-11-21-nbe.html#62184" class="Function">==^→Ⓡ↑</a> <a id="63781" class="Symbol">{</a><a id="63782" class="Argument">T</a> <a id="63784" class="Symbol">=</a> <a id="63786" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a><a id="63787" class="Symbol">}</a> <a id="63789" href="lagda.2023-11-21-nbe.html#63789" class="Bound">pf</a> <a id="63792" href="lagda.2023-11-21-nbe.html#63792" class="Bound">Γ′≤Γ</a> <a id="63797" class="Symbol">=</a> <a id="63799" href="lagda.2023-11-21-nbe.html#63789" class="Bound">pf</a> <a id="63802" href="lagda.2023-11-21-nbe.html#63792" class="Bound">Γ′≤Γ</a>
</pre>
<p>At type <code>S → T</code>, the proof is more complicated. We want to prove that:</p>
<pre><code>(∀ Γ′ ≤ Γ. Γ′ ⊢ 𝓊 = 𝓊̂(Γ) : S → T) ⇒ Γ ⊢ 𝓊 : S → T Ⓡ ↑ˢ  ⃕ ᵗ 𝓊̂</code></pre>
<p>By definition of <code>Ⓡ</code>, this expands to:</p>
<pre><code>(∀ Γ′ ≤ Γ. Γ′ ⊢ 𝓊 = 𝓊̂(Γ) : S → T) ⇒
  ∀ Γ′ ≤ Γ. Γ′ ⊢ s Ⓡ a ⇒
    Γ′ ⊢ 𝓊 s Ⓡ (↑ˢ  ⃕ ᵗ 𝓊̂) a</code></pre>
<p>This simplifies further by the definition of reflection:</p>
<pre><code>(∀ Γ′ ≤ Γ. Γ′ ⊢ 𝓊 = 𝓊̂(Γ) : S → T) ⇒
  ∀ Γ′ ≤ Γ. Γ′ ⊢ s Ⓡ a ⇒
    Γ′ ⊢ 𝓊 s Ⓡ ↑ᵀ (𝓊̂ · ↓ˢ a)</code></pre>
<p>Our induction hypothesis gives us that at type <code>T</code>, the following holds:</p>
<pre><code>(∀ Γ″ ≤ Γ′. Γ″ ⊢ 𝓊 s = (𝓊̂ · ↓ˢ a) Γ″) ⇒
    Γ′ ⊢ 𝓊 s Ⓡ ↑ᵀ (𝓊̂ · ↓ˢ a)</code></pre>
<p>With our induction hypothesis, our new goal is to prove only that:</p>
<pre><code>∀ Γ″ ≤ Γ′. Γ″ ⊢ 𝓊 s = (𝓊̂ · (↓ˢ a)) Γ″ : T</code></pre>
<p>Note that <code>(𝓊̂ · (↓ˢ a)) Γ″</code> is equivalent to <code>𝓊̂(Γ″) · (↓ˢ a)(Γ″)</code> (application
of liftable neutrals is overloaded), so the final form of the property we have
to prove is:</p>
<pre><code>Γ″ ⊢ 𝓊 s = 𝓊̂(Γ″) · ↓ˢ a Γ″ : T</code></pre>
<p>Using the definitional equality rule of compatibility for application, we need
only prove that:</p>
<pre><code>Γ″ ⊢ 𝓊 = 𝓊̂(Γ″) : S → T
Γ″ ⊢ s = ↓ˢ a Γ″ : S</code></pre>
<p>The first property is our given evidence. We can use our other given proof (that
<code>Γ′ ⊢ s : S Ⓡ a</code>) with the the second lemma we will be proving to prove the
second property:</p>
<pre><code>Γ′ ⊢ s : T Ⓡ a ⇒ ∀ Γ″ ≤ Γ′. Γ″ ⊢ s = ↓ᵀ a Γ″ : T</code></pre>
<pre class="Agda"><a id="65131" href="lagda.2023-11-21-nbe.html#62184" class="Function">==^→Ⓡ↑</a> <a id="65138" class="Symbol">{</a><a id="65139" class="Argument">T</a> <a id="65141" class="Symbol">=</a> <a id="65143" class="Symbol">_</a> <a id="65145" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="65147" class="Symbol">_}</a> <a id="65150" class="Symbol">{</a><a id="65151" href="lagda.2023-11-21-nbe.html#65151" class="Bound">𝓊</a><a id="65152" class="Symbol">}</a> <a id="65154" class="Symbol">{</a><a id="65155" href="lagda.2023-11-21-nbe.html#65155" class="Bound">𝓊̂</a><a id="65157" class="Symbol">}</a> <a id="65159" href="lagda.2023-11-21-nbe.html#65159" class="Bound">pf</a> <a id="65162" class="Symbol">{</a><a id="65163" href="lagda.2023-11-21-nbe.html#65163" class="Bound">Γ′</a><a id="65165" class="Symbol">}</a> <a id="65167" href="lagda.2023-11-21-nbe.html#65167" class="Bound">Γ′≤Γ</a> <a id="65172" class="Symbol">{</a><a id="65173" href="lagda.2023-11-21-nbe.html#65173" class="Bound">s</a><a id="65174" class="Symbol">}</a> <a id="65176" class="Symbol">{</a><a id="65177" href="lagda.2023-11-21-nbe.html#65177" class="Bound">a</a><a id="65178" class="Symbol">}</a> <a id="65180" href="lagda.2023-11-21-nbe.html#65180" class="Bound">sⓇa</a> <a id="65184" class="Symbol">=</a>
  <a id="65188" href="lagda.2023-11-21-nbe.html#62184" class="Function">==^→Ⓡ↑</a> <a id="65195" href="lagda.2023-11-21-nbe.html#65223" class="Function">𝓊·s==𝓊̂·↓ˢa</a>
    <a id="65211" class="Keyword">where</a>
      <a id="65223" href="lagda.2023-11-21-nbe.html#65223" class="Function">𝓊·s==𝓊̂·↓ˢa</a> <a id="65235" class="Symbol">:</a> <a id="65237" class="Symbol">∀</a> <a id="65239" class="Symbol">{</a><a id="65240" href="lagda.2023-11-21-nbe.html#65240" class="Bound">Γ″</a> <a id="65243" class="Symbol">:</a> <a id="65245" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="65248" class="Symbol">}</a>
                 <a id="65267" class="Symbol">→</a> <a id="65269" class="Symbol">(</a><a id="65270" href="lagda.2023-11-21-nbe.html#65270" class="Bound">Γ″≤Γ′</a> <a id="65276" class="Symbol">:</a> <a id="65278" href="lagda.2023-11-21-nbe.html#65240" class="Bound">Γ″</a> <a id="65281" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="65283" href="lagda.2023-11-21-nbe.html#65163" class="Bound">Γ′</a><a id="65285" class="Symbol">)</a>
                 <a id="65304" class="Symbol">→</a> <a id="65306" href="lagda.2023-11-21-nbe.html#65270" class="Bound">Γ″≤Γ′</a> <a id="65312" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="65315" class="Symbol">(</a><a id="65316" href="lagda.2023-11-21-nbe.html#65167" class="Bound">Γ′≤Γ</a> <a id="65321" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="65324" href="lagda.2023-11-21-nbe.html#65151" class="Bound">𝓊</a><a id="65325" class="Symbol">)</a> <a id="65327" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="65329" href="lagda.2023-11-21-nbe.html#65173" class="Bound">s</a> <a id="65331" href="lagda.2023-11-21-nbe.html#54968" class="Function Operator">==^</a> <a id="65335" href="lagda.2023-11-21-nbe.html#65155" class="Bound">𝓊̂</a> <a id="65338" href="lagda.2023-11-21-nbe.html#43123" class="Function Operator">·^</a> <a id="65341" class="Symbol">(</a><a id="65342" href="lagda.2023-11-21-nbe.html#45357" class="Function">↓ᵀ</a> <a id="65345" href="lagda.2023-11-21-nbe.html#65177" class="Bound">a</a><a id="65346" class="Symbol">)</a>
      <a id="65354" href="lagda.2023-11-21-nbe.html#65223" class="Function">𝓊·s==𝓊̂·↓ˢa</a>  <a id="65367" class="Symbol">{</a><a id="65368" href="lagda.2023-11-21-nbe.html#65368" class="Bound">Γ″</a><a id="65370" class="Symbol">}</a> <a id="65372" href="lagda.2023-11-21-nbe.html#65372" class="Bound">Γ″≤Γ′</a>
        <a id="65386" class="Keyword">with</a> <a id="65391" href="lagda.2023-11-21-nbe.html#65155" class="Bound">𝓊̂</a> <a id="65394" href="lagda.2023-11-21-nbe.html#65368" class="Bound">Γ″</a>           <a id="65407" class="Symbol">|</a> <a id="65409" href="lagda.2023-11-21-nbe.html#65159" class="Bound">pf</a> <a id="65412" class="Symbol">(</a><a id="65413" href="lagda.2023-11-21-nbe.html#9166" class="Function">≤-trans</a> <a id="65421" href="lagda.2023-11-21-nbe.html#65372" class="Bound">Γ″≤Γ′</a> <a id="65427" href="lagda.2023-11-21-nbe.html#65167" class="Bound">Γ′≤Γ</a><a id="65431" class="Symbol">)</a>
      <a id="65439" class="Symbol">...</a> <a id="65443" class="Symbol">|</a> <a id="65445" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="65450" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="65452" href="lagda.2023-11-21-nbe.html#65452" class="Bound">𝓊″</a> <a id="65455" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="65457" class="Symbol">_</a> <a id="65459" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a> <a id="65461" class="Symbol">|</a> <a id="65463" href="lagda.2023-11-21-nbe.html#65463" class="Bound">𝓊==𝓊″</a>                   <a id="65487" class="Symbol">=</a>
        <a id="65497" href="lagda.2023-11-21-nbe.html#31890" class="Function Operator">begin==</a>
          <a id="65515" class="Bound">Γ″≤Γ′</a> <a id="65521" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="65524" class="Symbol">(</a><a id="65525" href="lagda.2023-11-21-nbe.html#65167" class="Bound">Γ′≤Γ</a> <a id="65530" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="65533" href="lagda.2023-11-21-nbe.html#65151" class="Bound">𝓊</a><a id="65534" class="Symbol">)</a> <a id="65536" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="65538" href="lagda.2023-11-21-nbe.html#65173" class="Bound">s</a>
        <a id="65548" href="lagda.2023-11-21-nbe.html#32023" class="Function Operator">==⟨</a> <a id="65552" href="lagda.2023-11-21-nbe.html#30884" class="InductiveConstructor">app-compatible</a> <a id="65567" class="Symbol">(</a><a id="65568" href="lagda.2023-11-21-nbe.html#32496" class="Function">≡→==</a> <a id="65573" href="lagda.2023-11-21-nbe.html#65819" class="Function">compose-weaken-𝓊</a><a id="65589" class="Symbol">)</a> <a id="65591" href="lagda.2023-11-21-nbe.html#31141" class="InductiveConstructor">refl⁼⁼</a> <a id="65598" href="lagda.2023-11-21-nbe.html#32023" class="Function Operator">⟩</a>
          <a id="65610" class="Symbol">(</a><a id="65611" href="lagda.2023-11-21-nbe.html#65913" class="Function">Γ″≤Γ</a> <a id="65616" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="65619" href="lagda.2023-11-21-nbe.html#65151" class="Bound">𝓊</a><a id="65620" class="Symbol">)</a> <a id="65622" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="65624" class="Symbol">(</a><a id="65625" class="Bound">Γ″≤Γ′</a> <a id="65631" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="65634" href="lagda.2023-11-21-nbe.html#65173" class="Bound">s</a><a id="65635" class="Symbol">)</a>
        <a id="65645" href="lagda.2023-11-21-nbe.html#32023" class="Function Operator">==⟨</a> <a id="65649" href="lagda.2023-11-21-nbe.html#30884" class="InductiveConstructor">app-compatible</a> <a id="65664" href="lagda.2023-11-21-nbe.html#65463" class="Bound">𝓊==𝓊″</a> <a id="65670" href="lagda.2023-11-21-nbe.html#31141" class="InductiveConstructor">refl⁼⁼</a> <a id="65677" href="lagda.2023-11-21-nbe.html#32023" class="Function Operator">⟩</a>
          <a id="65689" href="lagda.2023-11-21-nbe.html#65452" class="Bound">𝓊″</a> <a id="65692" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="65694" class="Symbol">(</a><a id="65695" class="Bound">Γ″≤Γ′</a> <a id="65701" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="65704" href="lagda.2023-11-21-nbe.html#65173" class="Bound">s</a><a id="65705" class="Symbol">)</a>
        <a id="65715" href="lagda.2023-11-21-nbe.html#32023" class="Function Operator">==⟨</a> <a id="65719" href="lagda.2023-11-21-nbe.html#30884" class="InductiveConstructor">app-compatible</a> <a id="65734" href="lagda.2023-11-21-nbe.html#31141" class="InductiveConstructor">refl⁼⁼</a> <a id="65741" href="lagda.2023-11-21-nbe.html#65876" class="Function">s==↓ᵀaΓ″</a> <a id="65750" href="lagda.2023-11-21-nbe.html#32023" class="Function Operator">⟩</a>
          <a id="65762" href="lagda.2023-11-21-nbe.html#65452" class="Bound">𝓊″</a> <a id="65765" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="65767" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="65773" class="Symbol">(</a><a id="65774" href="lagda.2023-11-21-nbe.html#45357" class="Function">↓ᵀ</a> <a id="65777" href="lagda.2023-11-21-nbe.html#65177" class="Bound">a</a> <a id="65779" class="Bound">Γ″</a><a id="65781" class="Symbol">)</a>
        <a id="65791" href="lagda.2023-11-21-nbe.html#32231" class="Function Operator">==∎</a>
        <a id="65803" class="Keyword">where</a>
          <a id="65819" href="lagda.2023-11-21-nbe.html#65819" class="Function">compose-weaken-𝓊</a> <a id="65836" class="Symbol">=</a> <a id="65838" href="lagda.2023-11-21-nbe.html#60433" class="Function">compose-weaken</a> <a id="65853" class="Bound">Γ″≤Γ′</a> <a id="65859" href="lagda.2023-11-21-nbe.html#65167" class="Bound">Γ′≤Γ</a> <a id="65864" href="lagda.2023-11-21-nbe.html#65151" class="Bound">𝓊</a>
          <a id="65876" href="lagda.2023-11-21-nbe.html#65876" class="Function">s==↓ᵀaΓ″</a> <a id="65885" class="Symbol">=</a> <a id="65887" href="lagda.2023-11-21-nbe.html#62896" class="Function">Ⓡ→==↓</a> <a id="65893" href="lagda.2023-11-21-nbe.html#65180" class="Bound">sⓇa</a> <a id="65897" class="Bound">Γ″≤Γ′</a>
          <a id="65913" href="lagda.2023-11-21-nbe.html#65913" class="Function">Γ″≤Γ</a> <a id="65918" class="Symbol">=</a> <a id="65920" href="lagda.2023-11-21-nbe.html#9166" class="Function">≤-trans</a> <a id="65928" class="Bound">Γ″≤Γ′</a> <a id="65934" href="lagda.2023-11-21-nbe.html#65167" class="Bound">Γ′≤Γ</a>
</pre>
<p>This brings us to our second lemma:</p>
<pre><code>Γ ⊢ t : T Ⓡ a ⇒ ∀ Γ′ ≤ Γ. Γ′ ⊢ t = ↓ᵀ a Γ′ : T</code></pre>
<p>It will similarly be proven by induction on the type <code>T</code>. First, let us prove
the lemma for the type <code>𝟙</code>. At type <code>𝟙</code>, our lemma simplifies (by definition
of <code>Ⓡ</code>) to:</p>
<pre><code>(∀ Γ′ ≤ Γ. Γ′ ⊢ t : T = a (Γ′)) ⇒ ∀ Γ′ ≤ Γ. Γ′ ⊢ t = ↓ᵘⁿⁱᵗ a Γ′ : T</code></pre>
<p>We can break this down further into a case analysis on <code>a</code>, which can be either
<code>unit</code> or an embedded liftable neutral <code>𝓊̂</code>. In both cases, we can use our given
proof.</p>
<pre class="Agda"><a id="66451" href="lagda.2023-11-21-nbe.html#62896" class="Function">Ⓡ→==↓</a> <a id="66457" class="Symbol">{</a><a id="66458" class="Argument">T</a> <a id="66460" class="Symbol">=</a> <a id="66462" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a><a id="66463" class="Symbol">}</a> <a id="66465" class="Symbol">{</a><a id="66466" class="Argument">a</a> <a id="66468" class="Symbol">=</a> <a id="66470" href="lagda.2023-11-21-nbe.html#43682" class="InductiveConstructor">unit</a><a id="66474" class="Symbol">}</a> <a id="66476" href="lagda.2023-11-21-nbe.html#66476" class="Bound">pf</a> <a id="66479" class="Keyword">with</a> <a id="66484" href="lagda.2023-11-21-nbe.html#45357" class="Function">↓ᵀ</a> <a id="66487" class="Symbol">{</a><a id="66488" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a><a id="66489" class="Symbol">}</a> <a id="66491" href="lagda.2023-11-21-nbe.html#43682" class="InductiveConstructor">unit</a>
<a id="66496" class="Symbol">...</a> <a id="66500" class="Symbol">|</a> <a id="66502" class="Symbol">_</a> <a id="66504" class="Symbol">=</a> <a id="66506" class="Bound">pf</a>
<a id="66509" href="lagda.2023-11-21-nbe.html#62896" class="Function">Ⓡ→==↓</a> <a id="66515" class="Symbol">{</a><a id="66516" href="lagda.2023-11-21-nbe.html#66516" class="Bound">Γ′</a><a id="66518" class="Symbol">}</a> <a id="66520" class="Symbol">{</a><a id="66521" class="Argument">T</a> <a id="66523" class="Symbol">=</a> <a id="66525" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a><a id="66526" class="Symbol">}</a> <a id="66528" class="Symbol">{</a><a id="66529" class="Argument">a</a> <a id="66531" class="Symbol">=</a> <a id="66533" href="lagda.2023-11-21-nbe.html#43694" class="InductiveConstructor">ne</a> <a id="66536" href="lagda.2023-11-21-nbe.html#66536" class="Bound">𝓊̂</a><a id="66538" class="Symbol">}</a> <a id="66540" href="lagda.2023-11-21-nbe.html#66540" class="Bound">pf</a> <a id="66543" href="lagda.2023-11-21-nbe.html#66543" class="Bound">Γ′≤Γ</a>
  <a id="66550" class="Keyword">with</a> <a id="66555" href="lagda.2023-11-21-nbe.html#66536" class="Bound">𝓊̂</a> <a id="66558" href="lagda.2023-11-21-nbe.html#66516" class="Bound">Γ′</a>           <a id="66571" class="Symbol">|</a> <a id="66573" href="lagda.2023-11-21-nbe.html#66540" class="Bound">pf</a> <a id="66576" href="lagda.2023-11-21-nbe.html#66543" class="Bound">Γ′≤Γ</a>
<a id="66581" class="Symbol">...</a> <a id="66585" class="Symbol">|</a> <a id="66587" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="66592" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="66594" href="lagda.2023-11-21-nbe.html#66594" class="Bound">𝓊</a> <a id="66596" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="66598" class="Symbol">_</a> <a id="66600" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a>  <a id="66603" class="Symbol">|</a> <a id="66605" href="lagda.2023-11-21-nbe.html#66605" class="Bound">t==𝓊</a> <a id="66610" class="Symbol">=</a> <a id="66612" href="lagda.2023-11-21-nbe.html#66605" class="Bound">t==𝓊</a>
</pre>
<p>For the case where we are at a function type <code>S → T</code>, our lemma now simplifies
to:</p>
<pre><code>(∀ Γ′ ≤ Γ. Γ′ ⊢ x : S Ⓡ a ⇒ Γ′ ⊢ t x : T Ⓡ f a) ⇒
  ∀ Γ′ ≤ Γ. Γ′ ⊢ t = ↓ˢ  ⃕  ᵗ f Γ′ : S → T</code></pre>
<p>We can once again expand out the definition of reification at type <code>S → T</code>,
simplifying the lemma to:</p>
<pre><code>(∀ Γ′ ≤ Γ. Γ′ ⊢ x : S Ⓡ a ⇒ Γ′ ⊢ t x : T Ⓡ f a) ⇒
  Γ′ ⊢ t = λx. ↓ᵀ f a (Γ′, x:S) : T , where a = ↑ˢ (𝓍̂ S Γ′)</code></pre>
<p>We prove this by η-expanding <code>t</code> to <code>λx. t x</code> and then using the compatibility
rule for abstractions to simplify our goal to proving:</p>
<pre><code>  Γ′, x:S ⊢ t x = λx. ↓ᵀ f a (Γ′, x:S) : T</code></pre>
<p>Our inductive hypothesis gives us that:</p>
<pre><code>  ∀ Γ″ ≤ Γ′. Γ″ ⊢ t x = ↓ᵀ f a : T</code></pre>
<p>With it, all we need to prove is:</p>
<pre><code>Γ′ , x : S ⊢ t x : T Ⓡ f a</code></pre>
<p>Our given proof further simplifies this goal to simply proving that
<code>∀ Γ″ ≤ Γ′, x:S. Γ″ ⊢ x : S Ⓡ a</code>. We have been using <code>a</code> for simplicity,
but again, <code>a = ↑ˢ (𝓍̂ S Γ′)</code>. Earlier, we established a lemma <code>xⓇ↑ᵀ𝓍̂</code> giving us
exactly this goal, so we use it here to finish our proof.</p>
<pre class="Agda"><a id="67652" href="lagda.2023-11-21-nbe.html#62896" class="Function">Ⓡ→==↓</a> <a id="67658" class="Symbol">{</a><a id="67659" href="lagda.2023-11-21-nbe.html#67659" class="Bound">Γ′</a><a id="67661" class="Symbol">}</a> <a id="67663" class="Symbol">{</a><a id="67664" class="Argument">T</a> <a id="67666" class="Symbol">=</a> <a id="67668" href="lagda.2023-11-21-nbe.html#67668" class="Bound">S</a> <a id="67670" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="67672" class="Symbol">_}</a> <a id="67675" class="Symbol">{</a><a id="67676" href="lagda.2023-11-21-nbe.html#67676" class="Bound">t</a><a id="67677" class="Symbol">}</a> <a id="67679" class="Symbol">{</a><a id="67680" href="lagda.2023-11-21-nbe.html#67680" class="Bound">f</a><a id="67681" class="Symbol">}</a> <a id="67683" href="lagda.2023-11-21-nbe.html#67683" class="Bound">pf</a> <a id="67686" href="lagda.2023-11-21-nbe.html#67686" class="Bound">Γ′≤Γ</a> <a id="67691" class="Symbol">=</a>
  <a id="67695" href="lagda.2023-11-21-nbe.html#31890" class="Function Operator">begin==</a>
    <a id="67707" href="lagda.2023-11-21-nbe.html#67686" class="Bound">Γ′≤Γ</a> <a id="67712" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="67715" href="lagda.2023-11-21-nbe.html#67676" class="Bound">t</a>
  <a id="67719" href="lagda.2023-11-21-nbe.html#32023" class="Function Operator">==⟨</a> <a id="67723" href="lagda.2023-11-21-nbe.html#30589" class="InductiveConstructor">η</a> <a id="67725" href="lagda.2023-11-21-nbe.html#32023" class="Function Operator">⟩</a>
    <a id="67731" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="67733" class="Symbol">(</a><a id="67734" href="lagda.2023-11-21-nbe.html#67668" class="Bound">S</a> <a id="67736" href="lagda.2023-11-21-nbe.html#17302" class="Function Operator">↥⊢</a> <a id="67739" href="lagda.2023-11-21-nbe.html#67686" class="Bound">Γ′≤Γ</a> <a id="67744" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="67747" href="lagda.2023-11-21-nbe.html#67676" class="Bound">t</a><a id="67748" class="Symbol">)</a> <a id="67750" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="67752" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="67754" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>
  <a id="67758" href="lagda.2023-11-21-nbe.html#32023" class="Function Operator">==⟨</a>
    <a id="67766" href="lagda.2023-11-21-nbe.html#30725" class="InductiveConstructor">abs-compatible</a> <a id="67781" class="Symbol">(</a>
      <a id="67789" href="lagda.2023-11-21-nbe.html#31890" class="Function Operator">begin==</a>
        <a id="67805" class="Symbol">(</a><a id="67806" href="lagda.2023-11-21-nbe.html#67668" class="Bound">S</a> <a id="67808" href="lagda.2023-11-21-nbe.html#17302" class="Function Operator">↥⊢</a> <a id="67811" href="lagda.2023-11-21-nbe.html#67686" class="Bound">Γ′≤Γ</a> <a id="67816" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="67819" href="lagda.2023-11-21-nbe.html#67676" class="Bound">t</a><a id="67820" class="Symbol">)</a> <a id="67822" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="67824" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="67826" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>
      <a id="67834" href="lagda.2023-11-21-nbe.html#32023" class="Function Operator">==⟨</a> <a id="67838" href="lagda.2023-11-21-nbe.html#30884" class="InductiveConstructor">app-compatible</a> <a id="67853" href="lagda.2023-11-21-nbe.html#68097" class="Function">subst-lemma</a> <a id="67865" href="lagda.2023-11-21-nbe.html#31141" class="InductiveConstructor">refl⁼⁼</a> <a id="67872" href="lagda.2023-11-21-nbe.html#32023" class="Function Operator">⟩</a>
        <a id="67882" class="Symbol">(</a><a id="67883" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="67889" href="lagda.2023-11-21-nbe.html#67686" class="Bound">Γ′≤Γ</a> <a id="67894" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="67897" href="lagda.2023-11-21-nbe.html#67676" class="Bound">t</a><a id="67898" class="Symbol">)</a> <a id="67900" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="67902" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="67905" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a> <a id="67907" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="67909" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="67911" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>
      <a id="67919" href="lagda.2023-11-21-nbe.html#32023" class="Function Operator">==⟨</a> <a id="67923" href="lagda.2023-11-21-nbe.html#62896" class="Function">Ⓡ→==↓</a> <a id="67929" class="Symbol">(</a><a id="67930" href="lagda.2023-11-21-nbe.html#67683" class="Bound">pf</a> <a id="67933" class="Symbol">(</a><a id="67934" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="67940" href="lagda.2023-11-21-nbe.html#67686" class="Bound">Γ′≤Γ</a><a id="67944" class="Symbol">)</a> <a id="67946" href="lagda.2023-11-21-nbe.html#68070" class="Function">xⓇa</a><a id="67949" class="Symbol">)</a> <a id="67951" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a> <a id="67956" href="lagda.2023-11-21-nbe.html#32023" class="Function Operator">⟩</a>
        <a id="67966" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="67972" class="Symbol">(</a><a id="67973" href="lagda.2023-11-21-nbe.html#45357" class="Function">↓ᵀ</a> <a id="67976" class="Symbol">(</a><a id="67977" href="lagda.2023-11-21-nbe.html#67680" class="Bound">f</a> <a id="67979" href="lagda.2023-11-21-nbe.html#68045" class="Function">a</a><a id="67980" class="Symbol">)</a> <a id="67982" class="Symbol">(</a><a id="67983" href="lagda.2023-11-21-nbe.html#67659" class="Bound">Γ′</a> <a id="67986" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="67988" href="lagda.2023-11-21-nbe.html#67668" class="Bound">S</a><a id="67989" class="Symbol">))</a>
      <a id="67998" href="lagda.2023-11-21-nbe.html#32231" class="Function Operator">==∎</a>
  <a id="68004" class="Symbol">)</a><a id="68005" href="lagda.2023-11-21-nbe.html#32023" class="Function Operator">⟩</a>
    <a id="68011" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="68017" class="Symbol">(</a><a id="68018" href="lagda.2023-11-21-nbe.html#45357" class="Function">↓ᵀ</a> <a id="68021" href="lagda.2023-11-21-nbe.html#67680" class="Bound">f</a> <a id="68023" href="lagda.2023-11-21-nbe.html#67659" class="Bound">Γ′</a><a id="68025" class="Symbol">)</a>
  <a id="68029" href="lagda.2023-11-21-nbe.html#32231" class="Function Operator">==∎</a>
  <a id="68035" class="Keyword">where</a>
    <a id="68045" href="lagda.2023-11-21-nbe.html#68045" class="Function">a</a> <a id="68047" class="Symbol">=</a> <a id="68049" href="lagda.2023-11-21-nbe.html#45252" class="Function">↑ᵀ</a> <a id="68052" class="Symbol">{</a><a id="68053" href="lagda.2023-11-21-nbe.html#67668" class="Bound">S</a><a id="68054" class="Symbol">}</a> <a id="68056" class="Symbol">(</a><a id="68057" href="lagda.2023-11-21-nbe.html#46082" class="Function">𝓍̂</a> <a id="68060" href="lagda.2023-11-21-nbe.html#67668" class="Bound">S</a> <a id="68062" href="lagda.2023-11-21-nbe.html#67659" class="Bound">Γ′</a><a id="68064" class="Symbol">)</a>
    <a id="68070" href="lagda.2023-11-21-nbe.html#68070" class="Function">xⓇa</a> <a id="68074" class="Symbol">=</a> <a id="68076" href="lagda.2023-11-21-nbe.html#62565" class="Function">xⓇ↑ᵀ𝓍̂</a> <a id="68083" class="Symbol">{</a><a id="68084" href="lagda.2023-11-21-nbe.html#67659" class="Bound">Γ′</a><a id="68086" class="Symbol">}</a> <a id="68088" class="Symbol">{</a><a id="68089" href="lagda.2023-11-21-nbe.html#67668" class="Bound">S</a><a id="68090" class="Symbol">}</a>

    <a id="68097" href="lagda.2023-11-21-nbe.html#68097" class="Function">subst-lemma</a> <a id="68109" class="Symbol">=</a>
      <a id="68117" href="lagda.2023-11-21-nbe.html#32496" class="Function">≡→==</a> <a id="68122" class="Symbol">(</a><a id="68123" href="Relation.Binary.PropositionalEquality.Core.html#1729" class="Function">trans</a>
             <a id="68142" class="Symbol">(</a><a id="68143" href="lagda.2023-11-21-nbe.html#25552" class="Function">sub-sub</a> <a id="68151" class="Symbol">{</a><a id="68152" class="Argument">τ</a> <a id="68154" class="Symbol">=</a> <a id="68156" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a><a id="68157" class="Symbol">}</a> <a id="68159" class="Symbol">{</a><a id="68160" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="68167" href="lagda.2023-11-21-nbe.html#67686" class="Bound">Γ′≤Γ</a><a id="68171" class="Symbol">}</a> <a id="68173" class="Symbol">{</a><a id="68174" href="lagda.2023-11-21-nbe.html#67676" class="Bound">t</a><a id="68175" class="Symbol">})</a>
             <a id="68191" class="Symbol">(</a><a id="68192" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="68196" href="lagda.2023-11-21-nbe.html#22591" class="Function">[id]-identity</a><a id="68209" class="Symbol">))</a>
</pre>
<p>Lastly, we can quickly derive the lemma <code>Γ, x:T ⊢ x : T Ⓡ ↑ᵀ 𝓍̂ Γ</code> as a special
case of <code>(∀ Γ′ ≤ Γ. Γ′ ⊢ 𝓊 = 𝓊̂(Γ′) : T) ⇒ Γ ⊢ 𝓊 Ⓡ ↑ᵀ 𝓊̂</code>. The proof requires an
additional lemma with its proof ommitted, <code>≤-pf-irrelevance</code>: any proof of
context extension is equivalent.</p>
<pre class="Agda"><a id="≤-pf-irrelevance"></a><a id="68495" href="lagda.2023-11-21-nbe.html#68495" class="Function">≤-pf-irrelevance</a> <a id="68512" class="Symbol">:</a> <a id="68514" class="Symbol">∀</a> <a id="68516" class="Symbol">{</a><a id="68517" href="lagda.2023-11-21-nbe.html#68517" class="Bound">Γ′</a> <a id="68520" href="lagda.2023-11-21-nbe.html#68520" class="Bound">Γ</a> <a id="68522" class="Symbol">:</a> <a id="68524" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="68527" class="Symbol">}</a>
                 <a id="68546" class="Symbol">→</a> <a id="68548" class="Symbol">(</a><a id="68549" href="lagda.2023-11-21-nbe.html#68549" class="Bound">pf₁</a> <a id="68553" class="Symbol">:</a> <a id="68555" href="lagda.2023-11-21-nbe.html#68517" class="Bound">Γ′</a> <a id="68558" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="68560" href="lagda.2023-11-21-nbe.html#68520" class="Bound">Γ</a><a id="68561" class="Symbol">)</a>
                 <a id="68580" class="Symbol">→</a> <a id="68582" class="Symbol">(</a><a id="68583" href="lagda.2023-11-21-nbe.html#68583" class="Bound">pf₂</a> <a id="68587" class="Symbol">:</a> <a id="68589" href="lagda.2023-11-21-nbe.html#68517" class="Bound">Γ′</a> <a id="68592" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="68594" href="lagda.2023-11-21-nbe.html#68520" class="Bound">Γ</a><a id="68595" class="Symbol">)</a>
                 <a id="68614" class="Symbol">→</a> <a id="68616" href="lagda.2023-11-21-nbe.html#68549" class="Bound">pf₁</a> <a id="68620" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="68622" href="lagda.2023-11-21-nbe.html#68583" class="Bound">pf₂</a>
</pre>
<!---
<pre class="Agda"><a id="68645" href="lagda.2023-11-21-nbe.html#68495" class="Function">≤-pf-irrelevance</a> <a id="68662" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a> <a id="68667" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a>               <a id="68686" class="Symbol">=</a> <a id="68688" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="68693" href="lagda.2023-11-21-nbe.html#68495" class="Function">≤-pf-irrelevance</a> <a id="68710" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a> <a id="68715" class="Symbol">(</a><a id="68716" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="68722" href="lagda.2023-11-21-nbe.html#68722" class="Bound">pf</a><a id="68724" class="Symbol">)</a>         <a id="68734" class="Symbol">=</a> <a id="68736" href="Data.Empty.html#628" class="Function">⊥-elim</a> <a id="68743" class="Symbol">(</a><a id="68744" href="lagda.2023-11-21-nbe.html#8333" class="Function">Γ≰Γ,T</a> <a id="68750" href="lagda.2023-11-21-nbe.html#68722" class="Bound">pf</a><a id="68752" class="Symbol">)</a>
<a id="68754" href="lagda.2023-11-21-nbe.html#68495" class="Function">≤-pf-irrelevance</a> <a id="68771" class="Symbol">(</a><a id="68772" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="68778" href="lagda.2023-11-21-nbe.html#68778" class="Bound">pf</a><a id="68780" class="Symbol">)</a> <a id="68782" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a>         <a id="68795" class="Symbol">=</a> <a id="68797" href="Data.Empty.html#628" class="Function">⊥-elim</a> <a id="68804" class="Symbol">(</a><a id="68805" href="lagda.2023-11-21-nbe.html#8333" class="Function">Γ≰Γ,T</a> <a id="68811" href="lagda.2023-11-21-nbe.html#68778" class="Bound">pf</a><a id="68813" class="Symbol">)</a>
<a id="68815" href="lagda.2023-11-21-nbe.html#68495" class="Function">≤-pf-irrelevance</a> <a id="68832" class="Symbol">(</a><a id="68833" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="68839" href="lagda.2023-11-21-nbe.html#68839" class="Bound">pf₁</a><a id="68842" class="Symbol">)</a> <a id="68844" class="Symbol">(</a><a id="68845" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="68851" href="lagda.2023-11-21-nbe.html#68851" class="Bound">pf₂</a><a id="68854" class="Symbol">)</a>
  <a id="68858" class="Keyword">rewrite</a> <a id="68866" href="lagda.2023-11-21-nbe.html#68495" class="Function">≤-pf-irrelevance</a> <a id="68883" href="lagda.2023-11-21-nbe.html#68839" class="Bound">pf₁</a> <a id="68887" href="lagda.2023-11-21-nbe.html#68851" class="Bound">pf₂</a>       <a id="68897" class="Symbol">=</a> <a id="68899" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
</pre>--->
<pre class="Agda"><a id="68922" href="lagda.2023-11-21-nbe.html#62565" class="Function">xⓇ↑ᵀ𝓍̂</a> <a id="68929" class="Symbol">{_}</a> <a id="68933" class="Symbol">{</a><a id="68934" href="lagda.2023-11-21-nbe.html#68934" class="Bound">T</a><a id="68935" class="Symbol">}</a> <a id="68937" class="Symbol">=</a> <a id="68939" href="lagda.2023-11-21-nbe.html#62184" class="Function">==^→Ⓡ↑</a> <a id="68946" href="lagda.2023-11-21-nbe.html#68960" class="Function">x==𝓍̂</a> <a id="68952" class="Keyword">where</a>
  <a id="68960" href="lagda.2023-11-21-nbe.html#68960" class="Function">x==𝓍̂</a> <a id="68966" class="Symbol">:</a> <a id="68968" class="Symbol">∀</a> <a id="68970" class="Symbol">{</a><a id="68971" href="lagda.2023-11-21-nbe.html#68971" class="Bound">Γ</a> <a id="68973" href="lagda.2023-11-21-nbe.html#68973" class="Bound">Γ′</a> <a id="68976" class="Symbol">:</a> <a id="68978" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="68981" class="Symbol">}</a>
       <a id="68990" class="Symbol">→</a> <a id="68992" class="Symbol">(</a><a id="68993" href="lagda.2023-11-21-nbe.html#68993" class="Bound">Γ′≤Γ,T</a> <a id="69000" class="Symbol">:</a> <a id="69002" href="lagda.2023-11-21-nbe.html#68973" class="Bound">Γ′</a> <a id="69005" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="69007" href="lagda.2023-11-21-nbe.html#68971" class="Bound">Γ</a> <a id="69009" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="69011" href="lagda.2023-11-21-nbe.html#68934" class="Bound">T</a><a id="69012" class="Symbol">)</a>
       <a id="69021" class="Symbol">→</a> <a id="69023" href="lagda.2023-11-21-nbe.html#68993" class="Bound">Γ′≤Γ,T</a> <a id="69030" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="69033" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="69035" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a> <a id="69037" href="lagda.2023-11-21-nbe.html#54968" class="Function Operator">==^</a> <a id="69041" href="lagda.2023-11-21-nbe.html#46082" class="Function">𝓍̂</a> <a id="69044" href="lagda.2023-11-21-nbe.html#68934" class="Bound">T</a> <a id="69046" href="lagda.2023-11-21-nbe.html#68971" class="Bound">Γ</a>
  <a id="69050" href="lagda.2023-11-21-nbe.html#68960" class="Function">x==𝓍̂</a> <a id="69056" class="Symbol">{</a><a id="69057" href="lagda.2023-11-21-nbe.html#69057" class="Bound">Γ</a><a id="69058" class="Symbol">}</a> <a id="69060" class="Symbol">{</a><a id="69061" href="lagda.2023-11-21-nbe.html#69061" class="Bound">Γ′</a><a id="69063" class="Symbol">}</a> <a id="69065" href="lagda.2023-11-21-nbe.html#69065" class="Bound">pf</a>
    <a id="69072" class="Keyword">with</a> <a id="69077" href="lagda.2023-11-21-nbe.html#69061" class="Bound">Γ′</a> <a id="69080" href="lagda.2023-11-21-nbe.html#10889" class="Function Operator">≤?</a> <a id="69083" class="Symbol">(</a><a id="69084" href="lagda.2023-11-21-nbe.html#69057" class="Bound">Γ</a> <a id="69086" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="69088" href="lagda.2023-11-21-nbe.html#68934" class="Bound">T</a><a id="69089" class="Symbol">)</a>
  <a id="69093" class="Symbol">...</a> <a id="69097" class="Symbol">|</a> <a id="69099" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="69102" href="lagda.2023-11-21-nbe.html#69102" class="Bound">¬pf</a>                           <a id="69132" class="Symbol">=</a> <a id="69134" href="lagda.2023-11-21-nbe.html#69102" class="Bound">¬pf</a> <a id="69138" class="Bound">pf</a>
  <a id="69143" class="Symbol">...</a> <a id="69147" class="Symbol">|</a> <a id="69149" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="69153" href="lagda.2023-11-21-nbe.html#69153" class="Bound">pf′</a>
    <a id="69161" class="Keyword">with</a> <a id="69166" href="lagda.2023-11-21-nbe.html#46082" class="Function">𝓍̂</a> <a id="69169" href="lagda.2023-11-21-nbe.html#68934" class="Bound">T</a> <a id="69171" class="Bound">Γ</a> <a id="69173" class="Symbol">|</a> <a id="69175" href="lagda.2023-11-21-nbe.html#68495" class="Function">≤-pf-irrelevance</a> <a id="69192" class="Bound">pf</a> <a id="69195" href="lagda.2023-11-21-nbe.html#69153" class="Bound">pf′</a>
  <a id="69201" class="Symbol">...</a> <a id="69205" class="Symbol">|</a> <a id="69207" class="Symbol">_</a>      <a id="69214" class="Symbol">|</a> <a id="69216" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
    <a id="69225" class="Keyword">with</a> <a id="69230" href="lagda.2023-11-21-nbe.html#13819" class="Function">ρ-≤</a> <a id="69234" class="Bound">pf′</a> <a id="69238" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>
  <a id="69242" class="Symbol">...|</a> <a id="69247" class="Symbol">_</a>                                 <a id="69281" class="Symbol">=</a> <a id="69283" href="lagda.2023-11-21-nbe.html#31141" class="InductiveConstructor">refl⁼⁼</a>
</pre>
<p>Let’s focus on one of the lemmas we have proven:</p>
<pre><code>Γ ⊢ t : T Ⓡ a ⇒ ∀ Γ′ ≤ Γ. Γ′ ⊢ t = ↓ᵀ a Γ : T</code></pre>
<p>We have defined our logical relation with the goal of having the following case
of this property:</p>
<pre><code>Γ ⊢ t : T Ⓡ a ⇒ Γ ⊢ t = ↓ᵀ a Γ : T</code></pre>
<p>We now need to show that:</p>
<pre><code>Γ ⊢ t : T Ⓡ ⟦t⟧ ↑Γ</code></pre>
<p>With this, we can arrive at the definitional equality of a term and its normal
form as obtained from our algorithm for normalization by evaluation:</p>
<pre><code>Γ ⊢ t = ↓ᵀ (⟦t⟧ ↑Γ) Γ : T</code></pre>
<p>To prove <code>Γ ⊢ t : T Ⓡ ⟦t⟧ ↑Γ</code>, we will need to extend our logical relation to
include substitutions and environments.</p>
<p>A parallel substitution <code>Γ ⊢ σ : Δ</code> will be logically related to an environment
<code>δ ∈ ⟦ Δ ⟧</code> if every term that the substitution <code>σ</code> is substituting for the
context <code>Δ</code> is logically related to the corresponding semantic object in the
environment <code>δ</code>. In Agda, we will use <code>Ⓡˢ</code> as <code>Ⓡ</code> is already reserved for terms
and semantic objects, though we will refer to the relation as <code>Γ ⊢ σ : Δ Ⓡ δ</code>.</p>
<pre class="Agda"><a id="_Ⓡˢ_"></a><a id="70286" href="lagda.2023-11-21-nbe.html#70286" class="Function Operator">_Ⓡˢ_</a> <a id="70291" class="Symbol">:</a> <a id="70293" class="Symbol">∀</a> <a id="70295" class="Symbol">{</a><a id="70296" href="lagda.2023-11-21-nbe.html#70296" class="Bound">Γ</a> <a id="70298" href="lagda.2023-11-21-nbe.html#70298" class="Bound">Δ</a> <a id="70300" class="Symbol">:</a> <a id="70302" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="70305" class="Symbol">}</a> <a id="70307" class="Symbol">→</a> <a id="70309" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="70313" href="lagda.2023-11-21-nbe.html#70296" class="Bound">Γ</a> <a id="70315" href="lagda.2023-11-21-nbe.html#70298" class="Bound">Δ</a> <a id="70317" class="Symbol">→</a> <a id="70319" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="70321" href="lagda.2023-11-21-nbe.html#70298" class="Bound">Δ</a> <a id="70323" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a> <a id="70325" class="Symbol">→</a> <a id="70327" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="70331" href="lagda.2023-11-21-nbe.html#70286" class="Function Operator">_Ⓡˢ_</a> <a id="70336" class="Symbol">{</a><a id="70337" class="Argument">Δ</a> <a id="70339" class="Symbol">=</a> <a id="70341" href="lagda.2023-11-21-nbe.html#70341" class="Bound">Δ</a><a id="70342" class="Symbol">}</a> <a id="70344" href="lagda.2023-11-21-nbe.html#70344" class="Bound">σ</a> <a id="70346" href="lagda.2023-11-21-nbe.html#70346" class="Bound">δ</a> <a id="70348" class="Symbol">=</a>
  <a id="70352" class="Symbol">∀</a> <a id="70354" class="Symbol">{</a><a id="70355" href="lagda.2023-11-21-nbe.html#70355" class="Bound">T</a> <a id="70357" class="Symbol">:</a> <a id="70359" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="70363" class="Symbol">}</a> <a id="70365" class="Symbol">→</a> <a id="70367" class="Symbol">(</a><a id="70368" href="lagda.2023-11-21-nbe.html#70368" class="Bound">x</a> <a id="70370" class="Symbol">:</a> <a id="70372" href="lagda.2023-11-21-nbe.html#70341" class="Bound">Δ</a> <a id="70374" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="70376" href="lagda.2023-11-21-nbe.html#70355" class="Bound">T</a><a id="70377" class="Symbol">)</a> <a id="70379" class="Symbol">→</a> <a id="70381" href="lagda.2023-11-21-nbe.html#70344" class="Bound">σ</a> <a id="70383" href="lagda.2023-11-21-nbe.html#70368" class="Bound">x</a> <a id="70385" href="lagda.2023-11-21-nbe.html#56818" class="Function Operator">Ⓡ</a> <a id="70387" href="lagda.2023-11-21-nbe.html#43841" class="Function">env-lookup</a> <a id="70398" href="lagda.2023-11-21-nbe.html#70368" class="Bound">x</a> <a id="70400" href="lagda.2023-11-21-nbe.html#70346" class="Bound">δ</a>
</pre>
<!---
<pre class="Agda"><a id="70421" class="Keyword">infix</a> <a id="70427" class="Number">4</a> <a id="70429" href="lagda.2023-11-21-nbe.html#70286" class="Function Operator">_Ⓡˢ_</a>
</pre>--->
<p>Similarly as for the logical relation between terms and semantic objects, if a
logical relation holds between a substitution and an environment, it holds for
any weakening of the substitution. The proof is immediate using <code>Ⓡ-weaken</code>.</p>
<pre class="Agda"><a id="Ⓡˢ-weaken"></a><a id="70687" href="lagda.2023-11-21-nbe.html#70687" class="Function">Ⓡˢ-weaken</a> <a id="70697" class="Symbol">:</a> <a id="70699" class="Symbol">∀</a> <a id="70701" class="Symbol">{</a><a id="70702" href="lagda.2023-11-21-nbe.html#70702" class="Bound">Γ′</a> <a id="70705" href="lagda.2023-11-21-nbe.html#70705" class="Bound">Γ</a> <a id="70707" href="lagda.2023-11-21-nbe.html#70707" class="Bound">Δ</a> <a id="70709" class="Symbol">:</a> <a id="70711" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="70714" class="Symbol">}</a> <a id="70716" class="Symbol">{</a><a id="70717" href="lagda.2023-11-21-nbe.html#70717" class="Bound">Γ′≤Γ</a> <a id="70722" class="Symbol">:</a> <a id="70724" href="lagda.2023-11-21-nbe.html#70702" class="Bound">Γ′</a> <a id="70727" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="70729" href="lagda.2023-11-21-nbe.html#70705" class="Bound">Γ</a><a id="70730" class="Symbol">}</a> <a id="70732" class="Symbol">{</a><a id="70733" href="lagda.2023-11-21-nbe.html#70733" class="Bound">σ</a> <a id="70735" class="Symbol">:</a> <a id="70737" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="70741" href="lagda.2023-11-21-nbe.html#70705" class="Bound">Γ</a> <a id="70743" href="lagda.2023-11-21-nbe.html#70707" class="Bound">Δ</a><a id="70744" class="Symbol">}</a>
              <a id="70760" class="Symbol">{</a><a id="70761" href="lagda.2023-11-21-nbe.html#70761" class="Bound">δ</a> <a id="70763" class="Symbol">:</a> <a id="70765" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="70767" href="lagda.2023-11-21-nbe.html#70707" class="Bound">Δ</a> <a id="70769" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a><a id="70770" class="Symbol">}</a>
           <a id="70783" class="Symbol">→</a> <a id="70785" href="lagda.2023-11-21-nbe.html#70733" class="Bound">σ</a> <a id="70787" href="lagda.2023-11-21-nbe.html#70286" class="Function Operator">Ⓡˢ</a> <a id="70790" href="lagda.2023-11-21-nbe.html#70761" class="Bound">δ</a>
           <a id="70803" class="Symbol">→</a> <a id="70805" href="lagda.2023-11-21-nbe.html#70733" class="Bound">σ</a> <a id="70807" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="70809" class="Symbol">(</a><a id="70810" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="70817" href="lagda.2023-11-21-nbe.html#70717" class="Bound">Γ′≤Γ</a><a id="70821" class="Symbol">)</a> <a id="70823" href="lagda.2023-11-21-nbe.html#70286" class="Function Operator">Ⓡˢ</a> <a id="70826" href="lagda.2023-11-21-nbe.html#70761" class="Bound">δ</a>
<a id="70828" href="lagda.2023-11-21-nbe.html#70687" class="Function">Ⓡˢ-weaken</a> <a id="70838" class="Symbol">{</a><a id="70839" class="Argument">Γ′≤Γ</a> <a id="70844" class="Symbol">=</a> <a id="70846" href="lagda.2023-11-21-nbe.html#70846" class="Bound">Γ′≤Γ</a><a id="70850" class="Symbol">}</a> <a id="70852" href="lagda.2023-11-21-nbe.html#70852" class="Bound">σⓇδ</a> <a id="70856" href="lagda.2023-11-21-nbe.html#70856" class="Bound">x</a> <a id="70858" class="Symbol">=</a> <a id="70860" href="lagda.2023-11-21-nbe.html#60859" class="Function">Ⓡ-weaken</a> <a id="70869" class="Symbol">{</a><a id="70870" class="Argument">Γ′≤Γ</a> <a id="70875" class="Symbol">=</a> <a id="70877" href="lagda.2023-11-21-nbe.html#70846" class="Bound">Γ′≤Γ</a><a id="70881" class="Symbol">}</a> <a id="70883" class="Symbol">(</a><a id="70884" href="lagda.2023-11-21-nbe.html#70852" class="Bound">σⓇδ</a> <a id="70888" href="lagda.2023-11-21-nbe.html#70856" class="Bound">x</a><a id="70889" class="Symbol">)</a>
</pre>
<p>With the logical relation extended to substitutions and environments, we can
introduce the semantic typing judgement <code>Δ ⊨ t : T</code>: for any substitution
<code>Γ ⊢ σ : Δ</code> that is logically related to an environment <code>δ ∈ ⟦ Δ ⟧</code>,
<code>Γ ⊢ t[σ] : T</code> must be logically related to <code>⟦ t ⟧ δ</code>. Using the semantic typing
judgement, we will be able to derive that <code>Γ ⊢ t Ⓡ ⟦ t ⟧ ↑Γ</code>.</p>
<pre class="Agda"><a id="_⊨_"></a><a id="71268" href="lagda.2023-11-21-nbe.html#71268" class="Function Operator">_⊨_</a> <a id="71272" class="Symbol">:</a> <a id="71274" class="Symbol">∀</a> <a id="71276" class="Symbol">{</a><a id="71277" href="lagda.2023-11-21-nbe.html#71277" class="Bound">T</a> <a id="71279" class="Symbol">:</a> <a id="71281" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="71285" class="Symbol">}</a> <a id="71287" class="Symbol">→</a> <a id="71289" class="Symbol">(</a><a id="71290" href="lagda.2023-11-21-nbe.html#71290" class="Bound">Δ</a> <a id="71292" class="Symbol">:</a> <a id="71294" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="71297" class="Symbol">)</a> <a id="71299" class="Symbol">→</a> <a id="71301" href="lagda.2023-11-21-nbe.html#71290" class="Bound">Δ</a> <a id="71303" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="71305" href="lagda.2023-11-21-nbe.html#71277" class="Bound">T</a> <a id="71307" class="Symbol">→</a> <a id="71309" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="71313" href="lagda.2023-11-21-nbe.html#71268" class="Function Operator">_⊨_</a> <a id="71317" class="Symbol">{</a><a id="71318" href="lagda.2023-11-21-nbe.html#71318" class="Bound">T</a><a id="71319" class="Symbol">}</a> <a id="71321" href="lagda.2023-11-21-nbe.html#71321" class="Bound">Δ</a> <a id="71323" href="lagda.2023-11-21-nbe.html#71323" class="Bound">t</a> <a id="71325" class="Symbol">=</a>
  <a id="71329" class="Symbol">∀</a> <a id="71331" class="Symbol">{</a><a id="71332" href="lagda.2023-11-21-nbe.html#71332" class="Bound">Γ</a> <a id="71334" class="Symbol">:</a> <a id="71336" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="71339" class="Symbol">}</a> <a id="71341" class="Symbol">{</a><a id="71342" href="lagda.2023-11-21-nbe.html#71342" class="Bound">σ</a> <a id="71344" class="Symbol">:</a> <a id="71346" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="71350" href="lagda.2023-11-21-nbe.html#71332" class="Bound">Γ</a> <a id="71352" href="lagda.2023-11-21-nbe.html#71321" class="Bound">Δ</a><a id="71353" class="Symbol">}</a> <a id="71355" class="Symbol">{</a><a id="71356" href="lagda.2023-11-21-nbe.html#71356" class="Bound">δ</a> <a id="71358" class="Symbol">:</a> <a id="71360" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="71362" href="lagda.2023-11-21-nbe.html#71321" class="Bound">Δ</a> <a id="71364" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a><a id="71365" class="Symbol">}</a>
  <a id="71369" class="Symbol">→</a> <a id="71371" href="lagda.2023-11-21-nbe.html#71342" class="Bound">σ</a> <a id="71373" href="lagda.2023-11-21-nbe.html#70286" class="Function Operator">Ⓡˢ</a> <a id="71376" href="lagda.2023-11-21-nbe.html#71356" class="Bound">δ</a>
    <a id="71382" class="Comment">-------</a>
  <a id="71392" class="Symbol">→</a> <a id="71394" href="lagda.2023-11-21-nbe.html#71323" class="Bound">t</a> <a id="71396" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="71398" href="lagda.2023-11-21-nbe.html#71342" class="Bound">σ</a> <a id="71400" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a> <a id="71402" href="lagda.2023-11-21-nbe.html#56818" class="Function Operator">Ⓡ</a> <a id="71404" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟦⊢</a> <a id="71407" href="lagda.2023-11-21-nbe.html#71323" class="Bound">t</a> <a id="71409" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟧</a> <a id="71411" href="lagda.2023-11-21-nbe.html#71356" class="Bound">δ</a>
</pre>
<p>We can prove the semantic typing judgement <code>Δ ⊨ t : T</code> by induction on the
typing judgement <code>Δ ⊢ t : T</code>; this is called the fundamental lemma of logical
relations.</p>
<p>For <code>unit</code>, the proof follows immediately from how we have defined the logical
relation between terms and semantic objects at type <code>𝟙</code>. In the case of
variables, the given proof is exactly what we need. Application follows from our
inductive hypotheses, leaving us at the abstraction case, which is the most
complicated to prove. Here are the first three cases:</p>
<pre class="Agda"><a id="fundamental-lemma"></a><a id="71954" href="lagda.2023-11-21-nbe.html#71954" class="Function">fundamental-lemma</a> <a id="71972" class="Symbol">:</a> <a id="71974" class="Symbol">∀</a> <a id="71976" class="Symbol">{</a><a id="71977" href="lagda.2023-11-21-nbe.html#71977" class="Bound">Δ</a> <a id="71979" class="Symbol">:</a> <a id="71981" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="71984" class="Symbol">}</a> <a id="71986" class="Symbol">{</a><a id="71987" href="lagda.2023-11-21-nbe.html#71987" class="Bound">T</a> <a id="71989" class="Symbol">:</a> <a id="71991" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="71995" class="Symbol">}</a> <a id="71997" class="Symbol">{</a><a id="71998" href="lagda.2023-11-21-nbe.html#71998" class="Bound">t</a> <a id="72000" class="Symbol">:</a> <a id="72002" href="lagda.2023-11-21-nbe.html#71977" class="Bound">Δ</a> <a id="72004" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="72006" href="lagda.2023-11-21-nbe.html#71987" class="Bound">T</a><a id="72007" class="Symbol">}</a>
                  <a id="72027" class="Symbol">→</a> <a id="72029" href="lagda.2023-11-21-nbe.html#71977" class="Bound">Δ</a> <a id="72031" href="lagda.2023-11-21-nbe.html#71268" class="Function Operator">⊨</a> <a id="72033" href="lagda.2023-11-21-nbe.html#71998" class="Bound">t</a>
<a id="72035" href="lagda.2023-11-21-nbe.html#71954" class="Function">fundamental-lemma</a> <a id="72053" class="Symbol">{</a><a id="72054" class="Argument">t</a> <a id="72056" class="Symbol">=</a> <a id="72058" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a><a id="72062" class="Symbol">}</a> <a id="72064" href="lagda.2023-11-21-nbe.html#72064" class="Bound">σⓇδ</a> <a id="72068" class="Symbol">_</a> <a id="72070" class="Symbol">=</a> <a id="72072" href="lagda.2023-11-21-nbe.html#31141" class="InductiveConstructor">refl⁼⁼</a>
<a id="72079" href="lagda.2023-11-21-nbe.html#71954" class="Function">fundamental-lemma</a> <a id="72097" class="Symbol">{</a><a id="72098" class="Argument">t</a> <a id="72100" class="Symbol">=</a> <a id="72102" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="72104" href="lagda.2023-11-21-nbe.html#72104" class="Bound">x</a><a id="72105" class="Symbol">}</a> <a id="72107" href="lagda.2023-11-21-nbe.html#72107" class="Bound">σⓇδ</a> <a id="72111" class="Symbol">=</a> <a id="72113" href="lagda.2023-11-21-nbe.html#72107" class="Bound">σⓇδ</a> <a id="72117" href="lagda.2023-11-21-nbe.html#72104" class="Bound">x</a>
<a id="72119" href="lagda.2023-11-21-nbe.html#71954" class="Function">fundamental-lemma</a> <a id="72137" class="Symbol">{</a><a id="72138" class="Argument">t</a> <a id="72140" class="Symbol">=</a> <a id="72142" href="lagda.2023-11-21-nbe.html#72142" class="Bound">r</a> <a id="72144" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="72146" href="lagda.2023-11-21-nbe.html#72146" class="Bound">s</a><a id="72147" class="Symbol">}</a> <a id="72149" class="Symbol">{</a><a id="72150" class="Argument">σ</a> <a id="72152" class="Symbol">=</a> <a id="72154" href="lagda.2023-11-21-nbe.html#72154" class="Bound">σ</a><a id="72155" class="Symbol">}</a> <a id="72157" href="lagda.2023-11-21-nbe.html#72157" class="Bound">σⓇδ</a>
  <a id="72163" class="Keyword">with</a> <a id="72168" href="lagda.2023-11-21-nbe.html#71954" class="Function">fundamental-lemma</a> <a id="72186" class="Symbol">{</a><a id="72187" class="Argument">t</a> <a id="72189" class="Symbol">=</a> <a id="72191" href="lagda.2023-11-21-nbe.html#72142" class="Bound">r</a><a id="72192" class="Symbol">}</a> <a id="72194" href="lagda.2023-11-21-nbe.html#72157" class="Bound">σⓇδ</a>
<a id="72198" class="Symbol">...</a> <a id="72202" class="Symbol">|</a> <a id="72204" href="lagda.2023-11-21-nbe.html#72204" class="Bound">Γ⊨r</a>
  <a id="72210" class="Keyword">with</a> <a id="72215" href="lagda.2023-11-21-nbe.html#71954" class="Function">fundamental-lemma</a> <a id="72233" class="Symbol">{</a><a id="72234" class="Argument">t</a> <a id="72236" class="Symbol">=</a> <a id="72238" class="Bound">s</a><a id="72239" class="Symbol">}</a> <a id="72241" class="Bound">σⓇδ</a>
<a id="72245" class="Symbol">...</a> <a id="72249" class="Symbol">|</a> <a id="72251" href="lagda.2023-11-21-nbe.html#72251" class="Bound">Γ⊨s</a>
  <a id="72257" class="Keyword">with</a> <a id="72262" class="Bound">Γ⊨r</a> <a id="72266" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a> <a id="72271" href="lagda.2023-11-21-nbe.html#72251" class="Bound">Γ⊨s</a>
<a id="72275" class="Symbol">...</a> <a id="72279" class="Symbol">|</a> <a id="72281" href="lagda.2023-11-21-nbe.html#72281" class="Bound">pf</a>
  <a id="72286" class="Keyword">rewrite</a> <a id="72294" href="lagda.2023-11-21-nbe.html#22591" class="Function">[id]-identity</a> <a id="72308" class="Symbol">{</a><a id="72309" class="Argument">t</a> <a id="72311" class="Symbol">=</a> <a id="72313" class="Bound">r</a> <a id="72315" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="72317" class="Bound">σ</a> <a id="72319" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a><a id="72320" class="Symbol">}</a> <a id="72322" class="Symbol">=</a> <a id="72324" href="lagda.2023-11-21-nbe.html#72281" class="Bound">pf</a>
</pre>
<p>In the case of an abstraction <code>Γ ⊢ λx. t : S → T</code>, we want to prove:</p>
<pre><code>Γ ⊢ σ : Δ Ⓡ δ ⇒
  Γ ⊢ (λx. t)[σ] : S → T Ⓡ ⟦ Γ ⊢ λx. t : S → T ⟧ δ</code></pre>
<p>By the definition of the application of a substitution to an abstraction, as
well as the definition of evaluation of an abstraction, this simplifies to:</p>
<pre><code>Γ ⊢ σ : Δ Ⓡ δ ⇒
  Γ ⊢ λx. t[exts σ] : S → T Ⓡ f

      where f = λ a → ⟦ Γ, x:S ⊢ t : T ⟧ (δ , a)</code></pre>
<p>We can also expand this using the definition of <code>Ⓡ</code> for functions (and
immediately reducing the application of <code>f</code> to <code>a</code>):</p>
<pre><code>Γ ⊢ σ : Δ Ⓡ δ ⇒
  ∀ Γ′ ≤ Γ. Γ′ ⊢ s : S Ⓡ a ⇒
    Γ′ ⊢ (λx. t[exts σ]) · s : T Ⓡ ⟦ Γ, x:S ⊢ t : T ⟧ (δ , a)</code></pre>
<p>Already, this is a tricky property to parse. To start, we can use our lemma
that <code>Ⓡ</code> is transitive with respect to definitional equality, and use the <code>β</code>
rule to reduce <code>(λx. t[exts σ]) · s</code> to <code>t[exts σ][s/x]</code>. Now, we need only
prove:</p>
<pre><code>Γ′ ⊢ t[exts σ][s/x] : T Ⓡ ⟦ Γ, x:S ⊢ t : T ⟧ (δ , a)</code></pre>
<p>Here, we can use a few substitution lemma to compose these two substitutions and
reduce them into just <code>σ ∷ s</code>, giving us:</p>
<pre><code>Γ′ ⊢ t [σ ∷ s] : T Ⓡ ⟦ Γ, x:S ⊢ t : T ⟧ (δ , a)</code></pre>
<p>The property we want to show now looks like our induction hypothesis! Using the
induction hypothesis, we only need to show that:</p>
<pre><code> Γ′ ⊢ σ ∷ s : (Δ, x:S) Ⓡ (δ , a)</code></pre>
<p>In other words, we need to prove that for any variable <code>x</code> in the context
<code>Δ, x:S</code> that <code>σ</code> is substituting a term for, the term being substituted for
that variable must be logically related to its corresponding semantic object in
the environment <code>(δ , a)</code>. We can do a case analysis on <code>x</code> to break this down
further. The first case is what the relation simplifies to in the case that the
variable being substituted for is <code>𝑍</code> ─ all that needs to be proven is that the
term being substituted for the first variable in <code>Δ, x:S</code> (which is <code>s</code>) is
logically related to the first semantic object in <code>(δ , a)</code>. In other words,
for this case, what needs to be proven is:</p>
<pre><code>Γ′ ⊢ s : S Ⓡ a</code></pre>
<p>This is already our given proof, so this case follows immediately. The second
case is what the relation simplifies to in the case that the variable being
substituted for is in <code>Δ</code>, meaning <code>x</code> is <code>𝑆 x</code>:</p>
<pre><code>Γ′ ⊢ (σ ∷ s) (𝑆 x) : U Ⓡ env-lookup x δ</code></pre>
<p>Here, we need to use a few substitution lemmas (which have been omitted as their
proofs are unrelated to the logical relation itself) to rewrite this to:</p>
<pre><code>Γ′ ⊢ σ x : U Ⓡ env-lookup x δ</code></pre>
<p>This is again already given to us from our given proof that <code>Γ ⊢ σ : Δ Ⓡ δ</code>.
There is one small problem: we are now considering the context <code>Γ′</code> while our
given proof is over the context <code>Γ</code>. There was, in fact, an implict <em>weakening</em>
of <code>σ</code> in the changing of contexts (and it would be more correct to have been
writing <code>σ ∘ weaken Γ′≤Γ</code> throughout, though the explanation used <code>σ</code> for
simplicity). Here, we can use the earlier lemma that if a substitution is
logically related to an environment, then so is a weakening of the substitution.
With that, the abstraction case is proven.</p>
<p>In Agda, we require some substitution lemmas (both for the conversion of
<code>t[exts σ][s/x]</code> to <code>t[σ ∷ s]</code> and to handle the implcit weakening) which have
been omitted (and for convenience, we use the variables <code>t[exts-σ]</code> and <code>σ∷s</code>,
whose definitions are also omitted).</p>
<pre class="Agda"><a id="75622" href="lagda.2023-11-21-nbe.html#71954" class="Function">fundamental-lemma</a> <a id="75640" class="Symbol">{</a><a id="75641" href="lagda.2023-11-21-nbe.html#75641" class="Bound">Δ</a><a id="75642" class="Symbol">}</a> <a id="75644" class="Symbol">{</a><a id="75645" href="lagda.2023-11-21-nbe.html#75645" class="Bound">S</a> <a id="75647" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="75649" href="lagda.2023-11-21-nbe.html#75649" class="Bound">T</a><a id="75650" class="Symbol">}</a> <a id="75652" class="Symbol">{</a><a id="75653" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="75655" href="lagda.2023-11-21-nbe.html#75655" class="Bound">t</a><a id="75656" class="Symbol">}</a> <a id="75658" class="Symbol">{</a><a id="75659" class="Argument">σ</a> <a id="75661" class="Symbol">=</a> <a id="75663" href="lagda.2023-11-21-nbe.html#75663" class="Bound">σ</a><a id="75664" class="Symbol">}</a> <a id="75666" class="Symbol">{</a><a id="75667" href="lagda.2023-11-21-nbe.html#75667" class="Bound">δ</a><a id="75668" class="Symbol">}</a> <a id="75670" href="lagda.2023-11-21-nbe.html#75670" class="Bound">σⓇδ</a> <a id="75674" class="Symbol">{</a><a id="75675" href="lagda.2023-11-21-nbe.html#75675" class="Bound">Γ′</a><a id="75677" class="Symbol">}</a> <a id="75679" href="lagda.2023-11-21-nbe.html#75679" class="Bound">Γ′≤Γ</a> <a id="75684" class="Symbol">{</a><a id="75685" href="lagda.2023-11-21-nbe.html#75685" class="Bound">s</a><a id="75686" class="Symbol">}</a>
    <a id="75692" class="Symbol">{</a><a id="75693" href="lagda.2023-11-21-nbe.html#75693" class="Bound">a</a><a id="75694" class="Symbol">}</a> <a id="75696" href="lagda.2023-11-21-nbe.html#75696" class="Bound">sⓇa</a> <a id="75700" class="Symbol">=</a>
  <a id="75704" href="lagda.2023-11-21-nbe.html#58848" class="Function">==-Ⓡ-trans</a> <a id="75715" class="Symbol">(</a><a id="75716" href="lagda.2023-11-21-nbe.html#31224" class="InductiveConstructor">sym⁼⁼</a> <a id="75722" href="lagda.2023-11-21-nbe.html#30363" class="InductiveConstructor">β</a><a id="75723" class="Symbol">)</a> <a id="75725" href="lagda.2023-11-21-nbe.html#77239" class="Function">t[exts-σ][s/x]Ⓡ⟦t⟧⟨δ,a⟩</a>
  <a id="75751" class="Keyword">where</a>
    <a id="75761" href="lagda.2023-11-21-nbe.html#75761" class="Function">t[exts-σ]</a> <a id="75771" class="Symbol">:</a> <a id="75773" href="lagda.2023-11-21-nbe.html#75675" class="Bound">Γ′</a> <a id="75776" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="75778" href="lagda.2023-11-21-nbe.html#75645" class="Bound">S</a> <a id="75780" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="75782" href="lagda.2023-11-21-nbe.html#75649" class="Bound">T</a>
    <a id="75788" href="lagda.2023-11-21-nbe.html#75788" class="Function">σ∷s</a> <a id="75792" class="Symbol">:</a> <a id="75794" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="75798" href="lagda.2023-11-21-nbe.html#75675" class="Bound">Γ′</a> <a id="75801" class="Symbol">(</a><a id="75802" href="lagda.2023-11-21-nbe.html#75641" class="Bound">Δ</a> <a id="75804" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="75806" href="lagda.2023-11-21-nbe.html#75645" class="Bound">S</a><a id="75807" class="Symbol">)</a>
</pre>
<!---
<pre class="Agda">    <a id="75832" href="lagda.2023-11-21-nbe.html#75761" class="Function">t[exts-σ]</a> <a id="75842" class="Symbol">=</a> <a id="75844" href="lagda.2023-11-21-nbe.html#75655" class="Bound">t</a> <a id="75846" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="75848" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="75853" href="lagda.2023-11-21-nbe.html#75663" class="Bound">σ</a> <a id="75855" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a> <a id="75857" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="75859" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="75864" class="Symbol">(</a><a id="75865" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="75872" href="lagda.2023-11-21-nbe.html#75679" class="Bound">Γ′≤Γ</a><a id="75876" class="Symbol">)</a> <a id="75878" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a>
    <a id="75884" href="lagda.2023-11-21-nbe.html#75788" class="Function">σ∷s</a> <a id="75888" class="Symbol">=</a> <a id="75890" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="75895" href="lagda.2023-11-21-nbe.html#75663" class="Bound">σ</a> <a id="75897" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="75899" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="75904" class="Symbol">(</a><a id="75905" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="75912" href="lagda.2023-11-21-nbe.html#75679" class="Bound">Γ′≤Γ</a><a id="75916" class="Symbol">)</a> <a id="75918" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="75920" class="Symbol">(</a><a id="75921" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="75924" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="75926" href="lagda.2023-11-21-nbe.html#75685" class="Bound">s</a><a id="75927" class="Symbol">)</a>

    <a id="75934" href="lagda.2023-11-21-nbe.html#75934" class="Function">subst-lemma₁</a> <a id="75947" class="Symbol">:</a> <a id="75949" class="Symbol">∀</a> <a id="75951" class="Symbol">{</a><a id="75952" href="lagda.2023-11-21-nbe.html#75952" class="Bound">U</a> <a id="75954" class="Symbol">:</a> <a id="75956" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="75960" class="Symbol">}</a> <a id="75962" class="Symbol">{</a><a id="75963" href="lagda.2023-11-21-nbe.html#75963" class="Bound">x</a> <a id="75965" class="Symbol">:</a> <a id="75967" href="lagda.2023-11-21-nbe.html#75641" class="Bound">Δ</a> <a id="75969" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="75971" href="lagda.2023-11-21-nbe.html#75952" class="Bound">U</a><a id="75972" class="Symbol">}</a> <a id="75974" class="Symbol">→</a> <a id="75976" href="lagda.2023-11-21-nbe.html#75788" class="Function">σ∷s</a> <a id="75980" class="Symbol">(</a><a id="75981" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="75983" href="lagda.2023-11-21-nbe.html#75963" class="Bound">x</a><a id="75984" class="Symbol">)</a> <a id="75986" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="75988" class="Symbol">(</a><a id="75989" href="lagda.2023-11-21-nbe.html#75663" class="Bound">σ</a> <a id="75991" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="75993" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="76000" href="lagda.2023-11-21-nbe.html#75679" class="Bound">Γ′≤Γ</a><a id="76004" class="Symbol">)</a> <a id="76006" href="lagda.2023-11-21-nbe.html#75963" class="Bound">x</a>
    <a id="76012" href="lagda.2023-11-21-nbe.html#75934" class="Function">subst-lemma₁</a> <a id="76025" class="Symbol">{</a><a id="76026" class="Argument">x</a> <a id="76028" class="Symbol">=</a> <a id="76030" href="lagda.2023-11-21-nbe.html#76030" class="Bound">x</a><a id="76031" class="Symbol">}</a> <a id="76033" class="Symbol">=</a>
      <a id="76041" href="Relation.Binary.PropositionalEquality.Core.html#2806" class="Function Operator">begin</a>
        <a id="76055" href="lagda.2023-11-21-nbe.html#75788" class="Function">σ∷s</a> <a id="76059" class="Symbol">(</a><a id="76060" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="76062" href="lagda.2023-11-21-nbe.html#76030" class="Bound">x</a><a id="76063" class="Symbol">)</a>
      <a id="76071" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="76074" href="lagda.2023-11-21-nbe.html#25008" class="Function">sub-𝑆-shift</a> <a id="76086" class="Symbol">{</a><a id="76087" class="Argument">σ</a> <a id="76089" class="Symbol">=</a> <a id="76091" href="lagda.2023-11-21-nbe.html#75788" class="Function">σ∷s</a><a id="76094" class="Symbol">}</a> <a id="76096" class="Symbol">{</a><a id="76097" href="lagda.2023-11-21-nbe.html#76030" class="Bound">x</a><a id="76098" class="Symbol">}</a> <a id="76100" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
        <a id="76110" class="Symbol">(</a><a id="76111" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a> <a id="76113" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76115" href="lagda.2023-11-21-nbe.html#75788" class="Function">σ∷s</a><a id="76118" class="Symbol">)</a> <a id="76120" href="lagda.2023-11-21-nbe.html#76030" class="Bound">x</a>
      <a id="76128" href="Relation.Binary.PropositionalEquality.Core.html#2864" class="Function Operator">≡⟨⟩</a>
        <a id="76140" class="Symbol">(</a><a id="76141" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a> <a id="76143" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76145" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="76150" href="lagda.2023-11-21-nbe.html#75663" class="Bound">σ</a> <a id="76152" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76154" class="Symbol">(</a><a id="76155" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="76160" class="Symbol">(</a><a id="76161" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="76168" href="lagda.2023-11-21-nbe.html#75679" class="Bound">Γ′≤Γ</a><a id="76172" class="Symbol">)</a> <a id="76174" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76176" class="Symbol">(</a><a id="76177" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="76180" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="76182" href="lagda.2023-11-21-nbe.html#75685" class="Bound">s</a><a id="76183" class="Symbol">)))</a> <a id="76187" href="lagda.2023-11-21-nbe.html#76030" class="Bound">x</a>
      <a id="76195" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="76198" href="Relation.Binary.PropositionalEquality.Core.html#1461" class="Function">cong-app</a> <a id="76207" class="Symbol">(</a><a id="76208" href="lagda.2023-11-21-nbe.html#20470" class="Function">cong-seq</a> <a id="76217" class="Symbol">{</a><a id="76218" class="Argument">σ</a> <a id="76220" class="Symbol">=</a> <a id="76222" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a> <a id="76224" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76226" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="76231" href="lagda.2023-11-21-nbe.html#75663" class="Bound">σ</a><a id="76232" class="Symbol">}</a> <a id="76234" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="76239" href="lagda.2023-11-21-nbe.html#26401" class="Function">subst-zero-exts-cons</a><a id="76259" class="Symbol">)</a> <a id="76261" href="lagda.2023-11-21-nbe.html#76030" class="Bound">x</a> <a id="76263" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
        <a id="76273" class="Symbol">(</a><a id="76274" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a> <a id="76276" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76278" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="76283" href="lagda.2023-11-21-nbe.html#75663" class="Bound">σ</a> <a id="76285" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76287" class="Symbol">(</a><a id="76288" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="76295" href="lagda.2023-11-21-nbe.html#75679" class="Bound">Γ′≤Γ</a> <a id="76300" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="76302" href="lagda.2023-11-21-nbe.html#75685" class="Bound">s</a><a id="76303" class="Symbol">))</a> <a id="76306" href="lagda.2023-11-21-nbe.html#76030" class="Bound">x</a>
      <a id="76314" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="76317" href="Relation.Binary.PropositionalEquality.Core.html#1461" class="Function">cong-app</a> <a id="76326" class="Symbol">(</a><a id="76327" href="lagda.2023-11-21-nbe.html#20470" class="Function">cong-seq</a> <a id="76336" class="Symbol">{</a><a id="76337" class="Argument">σ</a> <a id="76339" class="Symbol">=</a> <a id="76341" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a><a id="76342" class="Symbol">}</a> <a id="76344" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="76349" class="Symbol">(</a><a id="76350" href="lagda.2023-11-21-nbe.html#20470" class="Function">cong-seq</a> <a id="76359" class="Symbol">{</a><a id="76360" class="Argument">σ</a> <a id="76362" class="Symbol">=</a> <a id="76364" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="76369" href="lagda.2023-11-21-nbe.html#75663" class="Bound">σ</a><a id="76370" class="Symbol">}</a> <a id="76372" href="lagda.2023-11-21-nbe.html#22075" class="Function">exts-cons-shift</a> <a id="76388" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="76392" class="Symbol">))</a> <a id="76395" href="lagda.2023-11-21-nbe.html#76030" class="Bound">x</a> <a id="76397" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
        <a id="76407" class="Symbol">(</a><a id="76408" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a> <a id="76410" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76412" class="Symbol">((</a><a id="76414" href="lagda.2023-11-21-nbe.html#75663" class="Bound">σ</a> <a id="76416" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76418" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a><a id="76419" class="Symbol">)</a> <a id="76421" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="76423" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="76425" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a><a id="76426" class="Symbol">)</a> <a id="76428" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76430" class="Symbol">(</a><a id="76431" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="76438" href="lagda.2023-11-21-nbe.html#75679" class="Bound">Γ′≤Γ</a> <a id="76443" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="76445" href="lagda.2023-11-21-nbe.html#75685" class="Bound">s</a><a id="76446" class="Symbol">))</a> <a id="76449" href="lagda.2023-11-21-nbe.html#76030" class="Bound">x</a>
      <a id="76457" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="76460" href="Relation.Binary.PropositionalEquality.Core.html#1461" class="Function">cong-app</a> <a id="76469" class="Symbol">(</a><a id="76470" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="76474" class="Symbol">(</a><a id="76475" href="lagda.2023-11-21-nbe.html#26095" class="Function">sub-assoc</a> <a id="76485" class="Symbol">{</a><a id="76486" class="Argument">σ</a> <a id="76488" class="Symbol">=</a> <a id="76490" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a><a id="76491" class="Symbol">}</a> <a id="76493" class="Symbol">{(</a><a id="76495" href="lagda.2023-11-21-nbe.html#75663" class="Bound">σ</a> <a id="76497" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76499" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a><a id="76500" class="Symbol">)</a> <a id="76502" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="76504" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="76506" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a><a id="76507" class="Symbol">}</a> <a id="76509" class="Symbol">{</a><a id="76510" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="76517" href="lagda.2023-11-21-nbe.html#75679" class="Bound">Γ′≤Γ</a> <a id="76522" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="76524" href="lagda.2023-11-21-nbe.html#75685" class="Bound">s</a><a id="76525" class="Symbol">}))</a> <a id="76529" href="lagda.2023-11-21-nbe.html#76030" class="Bound">x</a> <a id="76531" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
        <a id="76541" class="Symbol">((</a><a id="76543" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a> <a id="76545" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76547" class="Symbol">((</a><a id="76549" href="lagda.2023-11-21-nbe.html#75663" class="Bound">σ</a> <a id="76551" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76553" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a><a id="76554" class="Symbol">)</a> <a id="76556" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="76558" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="76560" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a><a id="76561" class="Symbol">))</a> <a id="76564" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76566" class="Symbol">(</a><a id="76567" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="76574" href="lagda.2023-11-21-nbe.html#75679" class="Bound">Γ′≤Γ</a> <a id="76579" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="76581" href="lagda.2023-11-21-nbe.html#75685" class="Bound">s</a><a id="76582" class="Symbol">))</a> <a id="76585" href="lagda.2023-11-21-nbe.html#76030" class="Bound">x</a>
      <a id="76593" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="76596" href="Relation.Binary.PropositionalEquality.Core.html#1461" class="Function">cong-app</a> <a id="76605" class="Symbol">(</a><a id="76606" href="lagda.2023-11-21-nbe.html#20470" class="Function">cong-seq</a> <a id="76615" class="Symbol">(</a><a id="76616" href="lagda.2023-11-21-nbe.html#17835" class="Function">sub-tail</a> <a id="76625" class="Symbol">{</a><a id="76626" class="Argument">s</a> <a id="76628" class="Symbol">=</a> <a id="76630" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="76632" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a><a id="76633" class="Symbol">}</a> <a id="76635" class="Symbol">{</a><a id="76636" href="lagda.2023-11-21-nbe.html#75663" class="Bound">σ</a> <a id="76638" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76640" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a><a id="76641" class="Symbol">})</a> <a id="76644" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="76648" class="Symbol">)</a> <a id="76650" href="lagda.2023-11-21-nbe.html#76030" class="Bound">x</a> <a id="76652" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
        <a id="76662" class="Symbol">((</a><a id="76664" href="lagda.2023-11-21-nbe.html#75663" class="Bound">σ</a> <a id="76666" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76668" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a><a id="76669" class="Symbol">)</a> <a id="76671" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76673" class="Symbol">(</a><a id="76674" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="76681" href="lagda.2023-11-21-nbe.html#75679" class="Bound">Γ′≤Γ</a> <a id="76686" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="76688" href="lagda.2023-11-21-nbe.html#75685" class="Bound">s</a><a id="76689" class="Symbol">))</a> <a id="76692" href="lagda.2023-11-21-nbe.html#76030" class="Bound">x</a>
      <a id="76700" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="76703" href="Relation.Binary.PropositionalEquality.Core.html#1461" class="Function">cong-app</a> <a id="76712" class="Symbol">(</a><a id="76713" href="lagda.2023-11-21-nbe.html#26095" class="Function">sub-assoc</a> <a id="76723" class="Symbol">{</a><a id="76724" class="Argument">σ</a> <a id="76726" class="Symbol">=</a> <a id="76728" href="lagda.2023-11-21-nbe.html#75663" class="Bound">σ</a><a id="76729" class="Symbol">}</a> <a id="76731" class="Symbol">{</a><a id="76732" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a><a id="76733" class="Symbol">}</a> <a id="76735" class="Symbol">{</a><a id="76736" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="76743" href="lagda.2023-11-21-nbe.html#75679" class="Bound">Γ′≤Γ</a> <a id="76748" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="76750" href="lagda.2023-11-21-nbe.html#75685" class="Bound">s</a><a id="76751" class="Symbol">})</a> <a id="76754" href="lagda.2023-11-21-nbe.html#76030" class="Bound">x</a> <a id="76756" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
        <a id="76766" class="Symbol">(</a><a id="76767" href="lagda.2023-11-21-nbe.html#75663" class="Bound">σ</a> <a id="76769" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76771" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a> <a id="76773" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76775" class="Symbol">(</a><a id="76776" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="76783" href="lagda.2023-11-21-nbe.html#75679" class="Bound">Γ′≤Γ</a> <a id="76788" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="76790" href="lagda.2023-11-21-nbe.html#75685" class="Bound">s</a><a id="76791" class="Symbol">))</a> <a id="76794" href="lagda.2023-11-21-nbe.html#76030" class="Bound">x</a>
      <a id="76802" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="76805" href="Relation.Binary.PropositionalEquality.Core.html#1461" class="Function">cong-app</a> <a id="76814" class="Symbol">(</a><a id="76815" href="lagda.2023-11-21-nbe.html#20470" class="Function">cong-seq</a> <a id="76824" class="Symbol">{</a><a id="76825" class="Argument">σ</a> <a id="76827" class="Symbol">=</a> <a id="76829" href="lagda.2023-11-21-nbe.html#75663" class="Bound">σ</a><a id="76830" class="Symbol">}</a> <a id="76832" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="76837" class="Symbol">(</a><a id="76838" href="lagda.2023-11-21-nbe.html#17835" class="Function">sub-tail</a> <a id="76847" class="Symbol">{</a><a id="76848" class="Argument">s</a> <a id="76850" class="Symbol">=</a> <a id="76852" href="lagda.2023-11-21-nbe.html#75685" class="Bound">s</a><a id="76853" class="Symbol">}</a> <a id="76855" class="Symbol">{</a><a id="76856" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="76863" href="lagda.2023-11-21-nbe.html#75679" class="Bound">Γ′≤Γ</a><a id="76867" class="Symbol">}))</a> <a id="76871" href="lagda.2023-11-21-nbe.html#76030" class="Bound">x</a> <a id="76873" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
        <a id="76883" class="Symbol">(</a><a id="76884" href="lagda.2023-11-21-nbe.html#75663" class="Bound">σ</a> <a id="76886" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76888" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="76895" href="lagda.2023-11-21-nbe.html#75679" class="Bound">Γ′≤Γ</a><a id="76899" class="Symbol">)</a> <a id="76901" href="lagda.2023-11-21-nbe.html#76030" class="Bound">x</a>
      <a id="76909" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>

    <a id="76916" href="lagda.2023-11-21-nbe.html#76916" class="Function">subst-lemma₂</a> <a id="76929" class="Symbol">=</a> <a id="76931" href="lagda.2023-11-21-nbe.html#25552" class="Function">sub-sub</a> <a id="76939" class="Symbol">{</a><a id="76940" class="Argument">τ</a> <a id="76942" class="Symbol">=</a> <a id="76944" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="76947" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="76949" href="lagda.2023-11-21-nbe.html#75685" class="Bound">s</a><a id="76950" class="Symbol">}</a> <a id="76952" class="Symbol">{</a><a id="76953" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="76958" class="Symbol">(</a><a id="76959" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="76966" href="lagda.2023-11-21-nbe.html#75679" class="Bound">Γ′≤Γ</a><a id="76970" class="Symbol">)}</a> <a id="76973" class="Symbol">{</a><a id="76974" href="lagda.2023-11-21-nbe.html#75655" class="Bound">t</a> <a id="76976" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="76978" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="76983" href="lagda.2023-11-21-nbe.html#75663" class="Bound">σ</a> <a id="76985" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a><a id="76986" class="Symbol">}</a>
    <a id="76992" href="lagda.2023-11-21-nbe.html#76992" class="Function">subst-lemma₃</a> <a id="77005" class="Symbol">=</a> <a id="77007" href="lagda.2023-11-21-nbe.html#25552" class="Function">sub-sub</a> <a id="77015" class="Symbol">{</a><a id="77016" class="Argument">τ</a> <a id="77018" class="Symbol">=</a> <a id="77020" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="77025" class="Symbol">(</a><a id="77026" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="77033" href="lagda.2023-11-21-nbe.html#75679" class="Bound">Γ′≤Γ</a><a id="77037" class="Symbol">)</a> <a id="77039" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="77041" class="Symbol">(</a><a id="77042" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="77045" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="77047" href="lagda.2023-11-21-nbe.html#75685" class="Bound">s</a><a id="77048" class="Symbol">)}</a> <a id="77051" class="Symbol">{</a><a id="77052" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="77057" href="lagda.2023-11-21-nbe.html#75663" class="Bound">σ</a><a id="77058" class="Symbol">}</a> <a id="77060" class="Symbol">{</a><a id="77061" href="lagda.2023-11-21-nbe.html#75655" class="Bound">t</a><a id="77062" class="Symbol">}</a>
</pre>--->
<pre class="Agda">    <a id="77086" href="lagda.2023-11-21-nbe.html#77086" class="Function">σ∷sⓇ⟨δ,a⟩</a> <a id="77096" class="Symbol">:</a> <a id="77098" href="lagda.2023-11-21-nbe.html#75788" class="Function">σ∷s</a>  <a id="77103" href="lagda.2023-11-21-nbe.html#70286" class="Function Operator">Ⓡˢ</a> <a id="77106" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="77108" href="lagda.2023-11-21-nbe.html#75667" class="Bound">δ</a> <a id="77110" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="77112" href="lagda.2023-11-21-nbe.html#75693" class="Bound">a</a> <a id="77114" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a>
    <a id="77120" href="lagda.2023-11-21-nbe.html#77086" class="Function">σ∷sⓇ⟨δ,a⟩</a> <a id="77130" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a> <a id="77132" class="Symbol">=</a> <a id="77134" href="lagda.2023-11-21-nbe.html#75696" class="Bound">sⓇa</a>
    <a id="77142" href="lagda.2023-11-21-nbe.html#77086" class="Function">σ∷sⓇ⟨δ,a⟩</a> <a id="77152" class="Symbol">(</a><a id="77153" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆_</a> <a id="77156" class="Symbol">{</a><a id="77157" class="Argument">T</a> <a id="77159" class="Symbol">=</a> <a id="77161" href="lagda.2023-11-21-nbe.html#77161" class="Bound">U</a><a id="77162" class="Symbol">}</a> <a id="77164" href="lagda.2023-11-21-nbe.html#77164" class="Bound">x</a><a id="77165" class="Symbol">)</a> <a id="77167" class="Keyword">rewrite</a> <a id="77175" href="lagda.2023-11-21-nbe.html#75934" class="Function">subst-lemma₁</a> <a id="77188" class="Symbol">{</a><a id="77189" class="Argument">x</a> <a id="77191" class="Symbol">=</a> <a id="77193" href="lagda.2023-11-21-nbe.html#77164" class="Bound">x</a><a id="77194" class="Symbol">}</a> <a id="77196" class="Symbol">=</a>
      <a id="77204" href="lagda.2023-11-21-nbe.html#70687" class="Function">Ⓡˢ-weaken</a> <a id="77214" class="Symbol">{</a><a id="77215" class="Argument">Γ′≤Γ</a> <a id="77220" class="Symbol">=</a> <a id="77222" href="lagda.2023-11-21-nbe.html#75679" class="Bound">Γ′≤Γ</a><a id="77226" class="Symbol">}</a> <a id="77228" href="lagda.2023-11-21-nbe.html#75670" class="Bound">σⓇδ</a> <a id="77232" href="lagda.2023-11-21-nbe.html#77164" class="Bound">x</a>

    <a id="77239" href="lagda.2023-11-21-nbe.html#77239" class="Function">t[exts-σ][s/x]Ⓡ⟦t⟧⟨δ,a⟩</a> <a id="77263" class="Symbol">:</a> <a id="77265" href="lagda.2023-11-21-nbe.html#75761" class="Function">t[exts-σ]</a> <a id="77275" href="lagda.2023-11-21-nbe.html#29378" class="Function Operator">[</a> <a id="77277" href="lagda.2023-11-21-nbe.html#75685" class="Bound">s</a> <a id="77279" href="lagda.2023-11-21-nbe.html#29378" class="Function Operator">]₀</a> <a id="77282" href="lagda.2023-11-21-nbe.html#56818" class="Function Operator">Ⓡ</a> <a id="77284" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟦⊢</a> <a id="77287" href="lagda.2023-11-21-nbe.html#75655" class="Bound">t</a> <a id="77289" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟧</a> <a id="77291" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="77293" href="lagda.2023-11-21-nbe.html#75667" class="Bound">δ</a> <a id="77295" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="77297" href="lagda.2023-11-21-nbe.html#75693" class="Bound">a</a> <a id="77299" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a>
    <a id="77305" href="lagda.2023-11-21-nbe.html#77239" class="Function">t[exts-σ][s/x]Ⓡ⟦t⟧⟨δ,a⟩</a> <a id="77329" class="Keyword">rewrite</a> <a id="77337" href="lagda.2023-11-21-nbe.html#76916" class="Function">subst-lemma₂</a> <a id="77350" class="Symbol">|</a> <a id="77352" href="lagda.2023-11-21-nbe.html#76992" class="Function">subst-lemma₃</a> <a id="77365" class="Symbol">=</a>
        <a id="77375" href="lagda.2023-11-21-nbe.html#71954" class="Function">fundamental-lemma</a> <a id="77393" class="Symbol">{</a><a id="77394" class="Argument">t</a> <a id="77396" class="Symbol">=</a> <a id="77398" href="lagda.2023-11-21-nbe.html#75655" class="Bound">t</a><a id="77399" class="Symbol">}</a> <a id="77401" href="lagda.2023-11-21-nbe.html#77086" class="Function">σ∷sⓇ⟨δ,a⟩</a>
</pre>
<p>Separately, we have that the identity substitution is logically related to
our environment of reflected variables, <code>Γ ⊢ id : Γ Ⓡ ↑Γ</code>. We prove this by
induction on the variable being substituted for, using the lemma that
<code>Γ, x:T ⊢ x : T Ⓡ ↑ᵀ 𝓍̂ Γ</code> for the base case. For the inductive step, there is a
need to weaken the inductive hypothesis (which gives us that
<code>Γ ⊢ y : T Ⓡ ↑ᵀ 𝓍̂ Γ</code>) to the context <code>Γ, x:S</code>.</p>
<pre class="Agda"><a id="idⓇ↑Γ"></a><a id="77836" href="lagda.2023-11-21-nbe.html#77836" class="Function">idⓇ↑Γ</a> <a id="77842" class="Symbol">:</a> <a id="77844" class="Symbol">∀</a> <a id="77846" class="Symbol">{</a><a id="77847" href="lagda.2023-11-21-nbe.html#77847" class="Bound">Γ</a> <a id="77849" class="Symbol">:</a> <a id="77851" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="77854" class="Symbol">}</a>
       <a id="77863" class="Symbol">→</a> <a id="77865" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="77868" href="lagda.2023-11-21-nbe.html#70286" class="Function Operator">Ⓡˢ</a> <a id="77871" class="Symbol">(</a><a id="77872" href="lagda.2023-11-21-nbe.html#46436" class="Function">↑ᶜᵗˣ</a> <a id="77877" href="lagda.2023-11-21-nbe.html#77847" class="Bound">Γ</a><a id="77878" class="Symbol">)</a>
<a id="77880" href="lagda.2023-11-21-nbe.html#77836" class="Function">idⓇ↑Γ</a> <a id="77886" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>             <a id="77900" class="Symbol">=</a> <a id="77902" href="lagda.2023-11-21-nbe.html#62565" class="Function">xⓇ↑ᵀ𝓍̂</a>
<a id="77909" href="lagda.2023-11-21-nbe.html#77836" class="Function">idⓇ↑Γ</a> <a id="77915" class="Symbol">{</a><a id="77916" href="lagda.2023-11-21-nbe.html#77916" class="Bound">Γ</a> <a id="77918" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="77920" href="lagda.2023-11-21-nbe.html#77920" class="Bound">T</a><a id="77921" class="Symbol">}</a> <a id="77923" class="Symbol">(</a><a id="77924" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="77926" href="lagda.2023-11-21-nbe.html#77926" class="Bound">x</a><a id="77927" class="Symbol">)</a> <a id="77929" class="Symbol">=</a>
  <a id="77933" href="lagda.2023-11-21-nbe.html#60859" class="Function">Ⓡ-weaken</a> <a id="77942" class="Symbol">{</a><a id="77943" class="Argument">Γ′≤Γ</a> <a id="77948" class="Symbol">=</a> <a id="77950" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="77956" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a><a id="77960" class="Symbol">}</a> <a id="77962" class="Symbol">{</a><a id="77963" class="Argument">t</a> <a id="77965" class="Symbol">=</a> <a id="77967" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="77969" href="lagda.2023-11-21-nbe.html#77926" class="Bound">x</a><a id="77970" class="Symbol">}</a> <a id="77972" class="Symbol">(</a><a id="77973" href="lagda.2023-11-21-nbe.html#77836" class="Function">idⓇ↑Γ</a> <a id="77979" class="Symbol">{</a><a id="77980" href="lagda.2023-11-21-nbe.html#77916" class="Bound">Γ</a><a id="77981" class="Symbol">}</a> <a id="77983" href="lagda.2023-11-21-nbe.html#77926" class="Bound">x</a><a id="77984" class="Symbol">)</a>
</pre>
<p>Now, we can arrive at the soundness of our algorithm for normalization by
evaluation. We have <code>Γ ⊢ id : Γ Ⓡ ↑Γ</code>, so we can use the fundamental lemma
here:</p>
<pre><code>Γ ⊢ t [ id ] Ⓡ ⟦ t ⟧ ↑Γ</code></pre>
<p>Note also that <code>t [ id ] ≡ t</code>. Using the lemma that a logical relation between a
term and a semantic object implies the definitional equality of the term to the
reification of the semantic object, we have:</p>
<pre><code>Γ ⊢ t = ↓ᵀ (⟦ t ⟧ ↑Γ) Γ : T</code></pre>
<p>Thus, our algorithm for normalization by evaluation preserves the meaning of a
term that it normalizes. By extension, the algorithm is also idempotent (as we
have already shown it is complete), so the algorithm as a whole satisifies the
soundness properties we wanted (as a reminder, the well-typedness of the
algorithm is given automatically with our intrinsically typed representation).</p>
<pre class="Agda"><a id="nf-=="></a><a id="78814" href="lagda.2023-11-21-nbe.html#78814" class="Function">nf-==</a> <a id="78820" class="Symbol">:</a> <a id="78822" class="Symbol">∀</a> <a id="78824" class="Symbol">{</a><a id="78825" href="lagda.2023-11-21-nbe.html#78825" class="Bound">Γ</a> <a id="78827" class="Symbol">:</a> <a id="78829" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="78832" class="Symbol">}</a> <a id="78834" class="Symbol">{</a><a id="78835" href="lagda.2023-11-21-nbe.html#78835" class="Bound">T</a> <a id="78837" class="Symbol">:</a> <a id="78839" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="78843" class="Symbol">}</a> <a id="78845" class="Symbol">{</a><a id="78846" href="lagda.2023-11-21-nbe.html#78846" class="Bound">t</a> <a id="78848" class="Symbol">:</a> <a id="78850" href="lagda.2023-11-21-nbe.html#78825" class="Bound">Γ</a> <a id="78852" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="78854" href="lagda.2023-11-21-nbe.html#78835" class="Bound">T</a><a id="78855" class="Symbol">}</a>
      <a id="78863" class="Symbol">→</a> <a id="78865" href="lagda.2023-11-21-nbe.html#78846" class="Bound">t</a> <a id="78867" href="lagda.2023-11-21-nbe.html#30265" class="Datatype Operator">==</a> <a id="78870" href="lagda.2023-11-21-nbe.html#46860" class="Function">nf</a> <a id="78873" href="lagda.2023-11-21-nbe.html#78846" class="Bound">t</a>
<a id="78875" href="lagda.2023-11-21-nbe.html#78814" class="Function">nf-==</a> <a id="78881" class="Symbol">{</a><a id="78882" href="lagda.2023-11-21-nbe.html#78882" class="Bound">Γ</a><a id="78883" class="Symbol">}</a> <a id="78885" class="Symbol">{</a><a id="78886" href="lagda.2023-11-21-nbe.html#78886" class="Bound">T</a><a id="78887" class="Symbol">}</a> <a id="78889" class="Symbol">{</a><a id="78890" href="lagda.2023-11-21-nbe.html#78890" class="Bound">t</a><a id="78891" class="Symbol">}</a>
  <a id="78895" class="Keyword">with</a> <a id="78900" href="lagda.2023-11-21-nbe.html#71954" class="Function">fundamental-lemma</a> <a id="78918" class="Symbol">{</a><a id="78919" class="Argument">t</a> <a id="78921" class="Symbol">=</a> <a id="78923" href="lagda.2023-11-21-nbe.html#78890" class="Bound">t</a><a id="78924" class="Symbol">}</a> <a id="78926" class="Symbol">(</a><a id="78927" href="lagda.2023-11-21-nbe.html#77836" class="Function">idⓇ↑Γ</a> <a id="78933" class="Symbol">{</a><a id="78934" href="lagda.2023-11-21-nbe.html#78882" class="Bound">Γ</a><a id="78935" class="Symbol">})</a>
<a id="78938" class="Symbol">...</a> <a id="78942" class="Symbol">|</a> <a id="78944" href="lagda.2023-11-21-nbe.html#78944" class="Bound">tⓇ⟦t⟧↑Γ</a>
  <a id="78954" class="Keyword">with</a> <a id="78959" href="lagda.2023-11-21-nbe.html#62896" class="Function">Ⓡ→==↓</a> <a id="78965" href="lagda.2023-11-21-nbe.html#78944" class="Bound">tⓇ⟦t⟧↑Γ</a> <a id="78973" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a>
<a id="78978" class="Symbol">...</a> <a id="78982" class="Symbol">|</a> <a id="78984" href="lagda.2023-11-21-nbe.html#78984" class="Bound">t==↓ᵀ⟦t⟧↑Γ</a>
  <a id="78997" class="Keyword">rewrite</a> <a id="79005" href="lagda.2023-11-21-nbe.html#22591" class="Function">[id]-identity</a> <a id="79019" class="Symbol">{</a><a id="79020" class="Argument">t</a> <a id="79022" class="Symbol">=</a> <a id="79024" class="Bound">t</a> <a id="79026" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="79028" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="79031" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a><a id="79032" class="Symbol">}</a>
        <a id="79042" class="Symbol">|</a> <a id="79044" href="lagda.2023-11-21-nbe.html#22591" class="Function">[id]-identity</a> <a id="79058" class="Symbol">{</a><a id="79059" class="Argument">t</a> <a id="79061" class="Symbol">=</a> <a id="79063" class="Bound">t</a><a id="79064" class="Symbol">}</a>                <a id="79081" class="Symbol">=</a> <a id="79083" href="lagda.2023-11-21-nbe.html#78984" class="Bound">t==↓ᵀ⟦t⟧↑Γ</a>

<a id="nf-preserves-meaning"></a><a id="79095" href="lagda.2023-11-21-nbe.html#79095" class="Function">nf-preserves-meaning</a> <a id="79116" class="Symbol">:</a> <a id="79118" class="Symbol">∀</a> <a id="79120" class="Symbol">{</a><a id="79121" href="lagda.2023-11-21-nbe.html#79121" class="Bound">Γ</a> <a id="79123" class="Symbol">:</a> <a id="79125" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="79128" class="Symbol">}</a> <a id="79130" class="Symbol">{</a><a id="79131" href="lagda.2023-11-21-nbe.html#79131" class="Bound">T</a> <a id="79133" class="Symbol">:</a> <a id="79135" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="79139" class="Symbol">}</a> <a id="79141" class="Symbol">{</a><a id="79142" href="lagda.2023-11-21-nbe.html#79142" class="Bound">t</a> <a id="79144" class="Symbol">:</a> <a id="79146" href="lagda.2023-11-21-nbe.html#79121" class="Bound">Γ</a> <a id="79148" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="79150" href="lagda.2023-11-21-nbe.html#79131" class="Bound">T</a><a id="79151" class="Symbol">}</a> <a id="79153" class="Symbol">{</a><a id="79154" href="lagda.2023-11-21-nbe.html#79154" class="Bound">γ</a> <a id="79156" class="Symbol">:</a> <a id="79158" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="79160" href="lagda.2023-11-21-nbe.html#79121" class="Bound">Γ</a> <a id="79162" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a><a id="79163" class="Symbol">}</a>
                     <a id="79186" class="Symbol">→</a> <a id="79188" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟦⊢</a> <a id="79191" href="lagda.2023-11-21-nbe.html#79142" class="Bound">t</a> <a id="79193" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟧</a> <a id="79195" href="lagda.2023-11-21-nbe.html#79154" class="Bound">γ</a> <a id="79197" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="79199" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟦⊢</a> <a id="79202" href="lagda.2023-11-21-nbe.html#46860" class="Function">nf</a> <a id="79205" href="lagda.2023-11-21-nbe.html#79142" class="Bound">t</a> <a id="79207" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟧</a> <a id="79209" href="lagda.2023-11-21-nbe.html#79154" class="Bound">γ</a>
<a id="79211" href="lagda.2023-11-21-nbe.html#79095" class="Function">nf-preserves-meaning</a> <a id="79232" class="Symbol">{</a><a id="79233" class="Argument">t</a> <a id="79235" class="Symbol">=</a> <a id="79237" href="lagda.2023-11-21-nbe.html#79237" class="Bound">t</a><a id="79238" class="Symbol">}</a> <a id="79240" class="Symbol">=</a> <a id="79242" href="lagda.2023-11-21-nbe.html#51593" class="Function">==→⟦≡⟧</a> <a id="79249" class="Symbol">(</a><a id="79250" href="lagda.2023-11-21-nbe.html#78814" class="Function">nf-==</a> <a id="79256" class="Symbol">{</a><a id="79257" class="Argument">t</a> <a id="79259" class="Symbol">=</a> <a id="79261" href="lagda.2023-11-21-nbe.html#79237" class="Bound">t</a><a id="79262" class="Symbol">})</a>

<a id="nf-idempotent"></a><a id="79266" href="lagda.2023-11-21-nbe.html#79266" class="Function">nf-idempotent</a> <a id="79280" class="Symbol">:</a> <a id="79282" class="Symbol">∀</a> <a id="79284" class="Symbol">{</a><a id="79285" href="lagda.2023-11-21-nbe.html#79285" class="Bound">Γ</a> <a id="79287" class="Symbol">:</a> <a id="79289" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="79292" class="Symbol">}</a> <a id="79294" class="Symbol">{</a><a id="79295" href="lagda.2023-11-21-nbe.html#79295" class="Bound">T</a> <a id="79297" class="Symbol">:</a> <a id="79299" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="79303" class="Symbol">}</a> <a id="79305" class="Symbol">{</a><a id="79306" href="lagda.2023-11-21-nbe.html#79306" class="Bound">t</a> <a id="79308" class="Symbol">:</a> <a id="79310" href="lagda.2023-11-21-nbe.html#79285" class="Bound">Γ</a> <a id="79312" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="79314" href="lagda.2023-11-21-nbe.html#79295" class="Bound">T</a><a id="79315" class="Symbol">}</a>
              <a id="79331" class="Symbol">→</a> <a id="79333" href="lagda.2023-11-21-nbe.html#46860" class="Function">nf</a> <a id="79336" href="lagda.2023-11-21-nbe.html#79306" class="Bound">t</a> <a id="79338" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="79340" href="lagda.2023-11-21-nbe.html#46860" class="Function">nf</a> <a id="79343" class="Symbol">(</a><a id="79344" href="lagda.2023-11-21-nbe.html#46860" class="Function">nf</a> <a id="79347" href="lagda.2023-11-21-nbe.html#79306" class="Bound">t</a><a id="79348" class="Symbol">)</a>
<a id="79350" href="lagda.2023-11-21-nbe.html#79266" class="Function">nf-idempotent</a> <a id="79364" class="Symbol">{</a><a id="79365" class="Argument">t</a> <a id="79367" class="Symbol">=</a> <a id="79369" href="lagda.2023-11-21-nbe.html#79369" class="Bound">t</a><a id="79370" class="Symbol">}</a> <a id="79372" class="Symbol">=</a> <a id="79374" href="lagda.2023-11-21-nbe.html#52733" class="Function">completeness</a> <a id="79387" class="Symbol">(</a><a id="79388" href="lagda.2023-11-21-nbe.html#78814" class="Function">nf-==</a> <a id="79394" class="Symbol">{</a><a id="79395" class="Argument">t</a> <a id="79397" class="Symbol">=</a> <a id="79399" href="lagda.2023-11-21-nbe.html#79369" class="Bound">t</a><a id="79400" class="Symbol">})</a>

<a id="soundness"></a><a id="79404" href="lagda.2023-11-21-nbe.html#79404" class="Function">soundness</a> <a id="79414" class="Symbol">:</a> <a id="79416" class="Symbol">∀</a> <a id="79418" class="Symbol">{</a><a id="79419" href="lagda.2023-11-21-nbe.html#79419" class="Bound">Γ</a> <a id="79421" class="Symbol">:</a> <a id="79423" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="79426" class="Symbol">}</a> <a id="79428" class="Symbol">{</a><a id="79429" href="lagda.2023-11-21-nbe.html#79429" class="Bound">T</a> <a id="79431" class="Symbol">:</a> <a id="79433" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="79437" class="Symbol">}</a> <a id="79439" class="Symbol">{</a><a id="79440" href="lagda.2023-11-21-nbe.html#79440" class="Bound">t</a> <a id="79442" class="Symbol">:</a> <a id="79444" href="lagda.2023-11-21-nbe.html#79419" class="Bound">Γ</a> <a id="79446" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="79448" href="lagda.2023-11-21-nbe.html#79429" class="Bound">T</a><a id="79449" class="Symbol">}</a> <a id="79451" class="Symbol">{</a><a id="79452" href="lagda.2023-11-21-nbe.html#79452" class="Bound">γ</a> <a id="79454" class="Symbol">:</a> <a id="79456" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟦</a> <a id="79458" href="lagda.2023-11-21-nbe.html#79419" class="Bound">Γ</a> <a id="79460" href="lagda.2023-11-21-nbe.html#34557" class="Field Operator">⟧</a> <a id="79462" class="Symbol">}</a>
          <a id="79474" class="Symbol">→</a> <a id="79476" class="Symbol">(</a><a id="79477" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟦⊢</a> <a id="79480" href="lagda.2023-11-21-nbe.html#79440" class="Bound">t</a> <a id="79482" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟧</a> <a id="79484" href="lagda.2023-11-21-nbe.html#79452" class="Bound">γ</a> <a id="79486" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="79488" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟦⊢</a> <a id="79491" href="lagda.2023-11-21-nbe.html#46860" class="Function">nf</a> <a id="79494" href="lagda.2023-11-21-nbe.html#79440" class="Bound">t</a> <a id="79496" href="lagda.2023-11-21-nbe.html#43993" class="Function Operator">⟧</a> <a id="79498" href="lagda.2023-11-21-nbe.html#79452" class="Bound">γ</a><a id="79499" class="Symbol">)</a> <a id="79501" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="79503" class="Symbol">(</a><a id="79504" href="lagda.2023-11-21-nbe.html#46860" class="Function">nf</a> <a id="79507" href="lagda.2023-11-21-nbe.html#79440" class="Bound">t</a> <a id="79509" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="79511" href="lagda.2023-11-21-nbe.html#46860" class="Function">nf</a> <a id="79514" class="Symbol">(</a><a id="79515" href="lagda.2023-11-21-nbe.html#46860" class="Function">nf</a> <a id="79518" href="lagda.2023-11-21-nbe.html#79440" class="Bound">t</a><a id="79519" class="Symbol">))</a>
<a id="79522" href="lagda.2023-11-21-nbe.html#79404" class="Function">soundness</a> <a id="79532" class="Symbol">{</a><a id="79533" class="Argument">t</a> <a id="79535" class="Symbol">=</a> <a id="79537" href="lagda.2023-11-21-nbe.html#79537" class="Bound">t</a><a id="79538" class="Symbol">}</a> <a id="79540" class="Symbol">=</a>
  <a id="79544" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="79546" href="lagda.2023-11-21-nbe.html#79095" class="Function">nf-preserves-meaning</a> <a id="79567" class="Symbol">{</a><a id="79568" class="Argument">t</a> <a id="79570" class="Symbol">=</a> <a id="79572" href="lagda.2023-11-21-nbe.html#79537" class="Bound">t</a><a id="79573" class="Symbol">}</a> <a id="79575" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="79577" href="lagda.2023-11-21-nbe.html#79266" class="Function">nf-idempotent</a> <a id="79591" class="Symbol">{</a><a id="79592" class="Argument">t</a> <a id="79594" class="Symbol">=</a> <a id="79596" href="lagda.2023-11-21-nbe.html#79537" class="Bound">t</a><a id="79597" class="Symbol">}</a> <a id="79599" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a>
</pre>
<h3 id="conclusion">Conclusion</h3>
<p>In the end, we have formalized an algorithm in Agda for normalization by
evaluation that is based on the intuition of leaving the parts of a term that
cannot be evaluated (i.e. “unknowns”) unchanged while still evaluating the parts
of the term that we do know how to reduce. The algorithm is both complete and
sound with respect to definitional equality, as we have proven. Completeness
followed quickly from the definition of the algorithm, while soundness required
a more in-depth proof involving the use of logical relations and their
fundamental lemma.</p>
<p>In his habilitation thesis, Andreas Abel goes on to introduce the algorithm for
the untyped lambda calculus after introducing normalization by evaluation for
System T (an extension of the simply typed lambda calculus with primitive
recursion). He continues to build upon these concepts, arriving at an algorithm
for a language with dependent types and a language with impredicativity. This
introduction to normalization to evaluation should hopefully be a good starting
point to explore these and other extensions of the algorithm, such as simply
trying out these proofs for yourself with a different extension of the simply
typed lambda calculus, or implementing the algorithm in a language other than
Agda.</p>
<h4 id="unicode">Unicode</h4>
<p>This site uses the following unicode in its Agda source code<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>:</p>
<pre><code>λ  U+03BB  GREEK SMALL LETTER LAMBDA (\Gl)
⊥  U+22A5  UP TACK (\bot)
⊤  U+22A4  DOWN TACK (\top)
⊎  U+228E  MULTISET UNION (\u+)
₁  U+2081  SUBSCRIPT ONE (\_1)
₂  U+2082  SUBSCRIPT TWO (\_2)
×  U+00D7  MULTIPLICATION SIGN (\x)
∃  U+2203  THERE EXISTS (\ex)
⟨  U+27E8  MATHEMATICAL LEFT ANGLE BRACKET (\&lt;)
⟩  U+27E9  MATHEMATICAL RIGHT ANGLE BRACKET (\&gt;)
¬  U+00AC  NOT SIGN (\neg)
≡  U+2261  IDENTICAL TO (\==)
⇒  U+21D2  RIGHTWARDS DOUBLE ARROW (\=&gt;)
∀  U+2200  FOR ALL (\all)
→  U+2192  RIGHTWARDS ARROW
‌≟  U+225F  QUESTIONED EQUAL TO (\?=)
∅  U+2205  EMPTY SET (\0)
∋  U+220B  CONTAINS AS MEMBER (\ni)
𝑍  U+1D44D  MATHEMATICAL ITALIC CAPITAL Z (\MiZ)
Γ  U+0393  GREEK CAPITAL LETTER GAMMA (\GG)
𝑆  U+1D446  MATHEMATICAL ITALIC CAPITAL S (\MiS)
≤  U+2264  LESS-THAN OR EQUAL TO (\le)
′  U+2032  PRIME (\'1)
≢  U+2262  NOT IDENTICAL TO (\==n)
⊢  U+22A2  RIGHT TACK (\|-)
ƛ  U+019B  LATIN SMALL LETTER LAMBDA WITH STROKE (\Gl-)
·  U+00B7  MIDDLE DOT (\cdot)
σ  U+03C3  GREEK SMALL LETTER SIGMA (\Gs)
Δ  U+0394  GREEK CAPITAL LETTER DELTA (\GD)
ʳ  U+02B3  MODIFIER LETTER SMALL R (\^r4)
↥  U+21A5  UPWARDS ARROW FROM BAR (\u-|)
Σ  U+03A3  GREE CAPITAL LETTER SIGMA (\GS)
∘  U+2218  RING OPERATOR (\o)
ω  U+03C9  GREEK SMALL LETTER OMEGA (\Go)
∷  U+2237  PROPORTION (\::)
θ  U+03B8  GREEK SMALL LETTER THETA (\Gth)
Φ  U+03A6  GREEK CAPITAL LETTER PHI (\Gf)
⟦  U+27E6  MATHEMATICAL LEFT WHITE SQUARE BRACKET (\[[)
⟦  U+27E7  MATHEMATICAL RIGHT WHITE SQUARE BRACKET (\]])
β  U+03B2  GREEK SMALL LETTER BETA (\Gb)
η  U+03B7  GREEK SMALL LETTER ETA (\Gh)
∎  U+220E  END OF PROOF (\qed)
⦃  U+2983  LEFT WHITE CURLY BRACKET (\{{)
⦄  U+2984  RIGHT WHITE CURLY BRACKET (\}})
𝓊  U+1D4CA  MATHEMATICAL SCRIPT SMALL U (\Mcu)
𝓋  U+1D4CB  MATHEMATICAL SCRIPT SMALL V (\Mcv)
γ  U+03B3  GREEK SMALL LETTER GAMMA (\Gg)
↑  U+2191  UPWARDS ARROW (\u)
ᵀ  U+1D40  MODIFIER LETTER CAPITAL T (\^T)
↓  U+2193  DOWNWARDS ARROW (\d)
ᶜ  U+1D9C  MODIFIER LETTER SMALL C (\^c)
ᵗ  U+1D57  MODIFIER LETTER SMALL T (\^t)
ˣ  U+02E3  MODIFIER LETTER SMALL X (\^x)
̂  U+0302  COMBINING CIRCUMFLEX ACCENT (\^)
𝓍  U+1D4CD  MATHEMATICAL SCRIPT SMALL X (\Mcx)
≰  U+2270  NEITHER LESS THAN NOR EQUAL TO (\len)
₃  U+2083  SUBSCRIPT 3 (\_3)
Ⓡ  U+24C7  CIRCLED LATIN CAPITAL LETTER R (\(r)2)
″  U+2033  DOUBLE PRIME (\'2)
δ  U+03B4  GREEK SMALL LETTER DELTA (\Gd)</code></pre>
<aside id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr />
<ol>
<li id="fn1"><p>̂ (<code>\^</code>) may be displayed on top of another character when written after it (e.g. <code>\Mcu\^</code> produces 𝓊̂)<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</aside>
    </section>
</article>

        </main>

        <footer>
            Site generated with <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        </footer>
    </body>
</html>
