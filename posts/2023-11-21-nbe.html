<!doctype html>
<html lang="en">
    <head>
        <style>
          @font-face { font-family: PressStart2P; src: url('/fonts/PressStart2P.ttf'); }
          html { font-family: PressStart2P }
        </style>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Emmanuel Suárez Acevedo - Normalization by Evaluation</title>
        <link rel="stylesheet" href="../css/default.css" />
        <link rel="stylesheet" href="../css/agda.css" />
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.0/css/all.css" integrity="sha384-Mmxa0mLqhmOeaE8vgOSbKacftZcsNYDjQzuCOm6D02luYSzBG8vpaOykv9lFQ51Y" crossorigin="anonymous" />
        <link rel="shortcut icon" type="image/x-icon" href="../files/favicon.ico" />
    </head>
    <body>
        <header>
            <div class="logo">
                <a href="../">Emmanuel Suárez Acevedo (he/him)</a>
            </div>
            <nav>
                <a href="../posts.html">Posts</a>
                <a href="../research.html">Research</a>
                <a href="../files/resume.pdf">CV</a>
            </nav>
        </header>

        <main role="main">
            <article>
    <section class="header">
        <h2>Normalization by Evaluation</h2>
        <h4>posted on November 21, 2023</h4>
        
    </section>
    <section class="post">
        <p>* This post has the content of a <a href="https://emmanueljs1.github.io/nbe/NbE.html">tutorial</a> I
wrote before creating this website.</p>
<h3 id="background">Background</h3>
<p>This site is both an overview of normalization by evaluation and a formalization
in Agda of the algorithm for the simply typed lambda calculus, based largely on
its presentation in Chapter 2 of Andreas Abel’s habilitation thesis,
“Normalization by Evaluation: Dependent Types and Impredicativity”. It
was compiled from a literate Agda file available
<a href="https://github.com/emmanueljs1/nbe/blob/main/NbE.lagda.md">here</a> by following
the helpful advice in <a href="https://jesper.sikanda.be/posts/literate-agda.html">this</a>
blog post by Jesper Cockx.</p>
<p>For clarity and readability, some parts of the source file are left out in this
rendering, and this will be called out when possible.</p>
<p>Some familiarity with Agda (e.g. such as having worked through the first part of
<a href="https://plfa.inf.ed.ac.uk/22.08/">Programming Languages Foundations in Agda</a>)
is assumed along with some knowledge of programming language foundations, though
the content is mostly self contained.</p>
<h3 id="introduction">Introduction</h3>
<p>Consider the following term in the lambda calculus:</p>
<pre><code>λx. (λy. y) x</code></pre>
<p>This term is not in its <em>normal form</em>, that is, it can still undergo some
reductions. In this case, we can apply a beta reduction under the first binder
and arrive at:</p>
<pre><code>λx. x</code></pre>
<p>This new term is now the normal form of <code>λx. (λy. y) x</code>. What we’ve just done,
believe it or not, is normalization by evaluation!</p>
<p>Normalization by evaluation is a technique for deriving the normal form of a
term in an object language by <em>evaluating</em> the term in a meta language (a
language we are using to describe the object language). In this case, our
object language was the untyped lambda calculus, and our meta language was,
well, just plain English.</p>
<p>In essence, you can reduce a term by evaluating the parts that <em>can</em> be
evaluated while leaving the parts that <em>can’t</em> untouched. That is the intuition
behind normalization by evaluation.</p>
<p>To actually formalize normalization by evaluation and prove its correctness in
Agda, the algorithm may seem to become less intuitive, but it will still be
based on this initial idea.</p>
<!---
### Imports

<pre class="Agda"><a id="2273" class="Keyword">import</a> <a id="2280" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="2318" class="Symbol">as</a> <a id="2321" class="Module">Eq</a>
<a id="2324" class="Keyword">open</a> <a id="2329" class="Keyword">import</a> <a id="2336" href="Data.Empty.html" class="Module">Data.Empty</a> <a id="2347" class="Keyword">using</a> <a id="2353" class="Symbol">(</a><a id="2354" href="Data.Empty.html#526" class="Datatype">⊥</a><a id="2355" class="Symbol">;</a> <a id="2357" href="Data.Empty.html#628" class="Function">⊥-elim</a><a id="2363" class="Symbol">)</a>
<a id="2365" class="Keyword">open</a> <a id="2370" class="Keyword">import</a> <a id="2377" href="Data.Unit.html" class="Module">Data.Unit</a> <a id="2387" class="Keyword">using</a> <a id="2393" class="Symbol">(</a><a id="2394" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a><a id="2395" class="Symbol">;</a> <a id="2397" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a><a id="2399" class="Symbol">)</a>
<a id="2401" class="Keyword">open</a> <a id="2406" class="Keyword">import</a> <a id="2413" href="Data.Sum.html" class="Module">Data.Sum</a> <a id="2422" class="Keyword">using</a> <a id="2428" class="Symbol">(</a><a id="2429" href="Data.Sum.Base.html#734" class="Datatype Operator">_⊎_</a><a id="2432" class="Symbol">;</a> <a id="2434" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a><a id="2438" class="Symbol">;</a> <a id="2440" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a><a id="2444" class="Symbol">)</a>
<a id="2446" class="Keyword">open</a> <a id="2451" class="Keyword">import</a> <a id="2458" href="Data.Product.html" class="Module">Data.Product</a> <a id="2471" class="Keyword">using</a> <a id="2477" class="Symbol">(</a><a id="2478" href="Data.Product.html#1167" class="Function Operator">_×_</a><a id="2481" class="Symbol">;</a> <a id="2483" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a><a id="2488" class="Symbol">;</a> <a id="2490" href="Data.Product.html#1369" class="Function">∃</a><a id="2491" class="Symbol">;</a> <a id="2493" href="Data.Product.html#1806" class="Function">∃-syntax</a><a id="2501" class="Symbol">)</a> <a id="2503" class="Keyword">renaming</a> <a id="2512" class="Symbol">(</a><a id="2513" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="2517" class="Symbol">to</a> <a id="2520" class="InductiveConstructor Operator">⟨_,_⟩</a><a id="2525" class="Symbol">)</a>
<a id="2527" class="Keyword">open</a> <a id="2532" class="Keyword">import</a> <a id="2539" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="2556" class="Keyword">using</a> <a id="2562" class="Symbol">(</a><a id="2563" href="Relation.Nullary.html#1511" class="Record">Dec</a><a id="2566" class="Symbol">;</a> <a id="2568" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a><a id="2571" class="Symbol">;</a> <a id="2573" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a><a id="2575" class="Symbol">;</a> <a id="2577" href="Relation.Nullary.html#656" class="Function Operator">¬_</a><a id="2579" class="Symbol">)</a>
<a id="2581" class="Keyword">open</a> <a id="2586" href="Relation.Binary.PropositionalEquality.html" class="Module">Eq</a> <a id="2589" class="Keyword">using</a> <a id="2595" class="Symbol">(</a><a id="2596" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="2600" class="Symbol">;</a> <a id="2602" href="Relation.Binary.PropositionalEquality.Core.html#1729" class="Function">trans</a><a id="2607" class="Symbol">;</a> <a id="2609" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a><a id="2612" class="Symbol">;</a> <a id="2614" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="2617" class="Symbol">;</a> <a id="2619" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a><a id="2623" class="Symbol">;</a> <a id="2625" href="Relation.Binary.PropositionalEquality.Core.html#1367" class="Function">cong₂</a><a id="2630" class="Symbol">;</a> <a id="2632" href="Relation.Binary.PropositionalEquality.Core.html#1461" class="Function">cong-app</a><a id="2640" class="Symbol">)</a>
<a id="2642" class="Keyword">open</a> <a id="2647" href="Relation.Binary.PropositionalEquality.Core.html#2708" class="Module">Eq.≡-Reasoning</a> <a id="2662" class="Keyword">using</a> <a id="2668" class="Symbol">(</a><a id="2669" href="Relation.Binary.PropositionalEquality.Core.html#2864" class="Function Operator">_≡⟨⟩_</a><a id="2674" class="Symbol">;</a> <a id="2676" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">step-≡</a><a id="2682" class="Symbol">;</a> <a id="2684" href="Relation.Binary.PropositionalEquality.Core.html#2806" class="Function Operator">begin_</a><a id="2690" class="Symbol">;</a> <a id="2692" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">_∎</a><a id="2694" class="Symbol">)</a>

<a id="2697" class="Keyword">module</a> <a id="2704" href="lagda.2023-11-21-nbe.html" class="Module">lagda.2023-11-21-nbe</a> <a id="2725" class="Keyword">where</a>

<a id="2732" class="Keyword">postulate</a>
  <a id="extensionality"></a><a id="2744" href="lagda.2023-11-21-nbe.html#2744" class="Postulate">extensionality</a> <a id="2759" class="Symbol">:</a> <a id="2761" class="Symbol">∀</a> <a id="2763" class="Symbol">{</a><a id="2764" href="lagda.2023-11-21-nbe.html#2764" class="Bound">A</a> <a id="2766" href="lagda.2023-11-21-nbe.html#2766" class="Bound">B</a> <a id="2768" class="Symbol">:</a> <a id="2770" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="2773" class="Symbol">}</a> <a id="2775" class="Symbol">{</a><a id="2776" href="lagda.2023-11-21-nbe.html#2776" class="Bound">f</a> <a id="2778" href="lagda.2023-11-21-nbe.html#2778" class="Bound">g</a> <a id="2780" class="Symbol">:</a> <a id="2782" href="lagda.2023-11-21-nbe.html#2764" class="Bound">A</a> <a id="2784" class="Symbol">→</a> <a id="2786" href="lagda.2023-11-21-nbe.html#2766" class="Bound">B</a><a id="2787" class="Symbol">}</a>
    <a id="2793" class="Symbol">→</a> <a id="2795" class="Symbol">(∀</a> <a id="2798" class="Symbol">(</a><a id="2799" href="lagda.2023-11-21-nbe.html#2799" class="Bound">x</a> <a id="2801" class="Symbol">:</a> <a id="2803" href="lagda.2023-11-21-nbe.html#2764" class="Bound">A</a><a id="2804" class="Symbol">)</a> <a id="2806" class="Symbol">→</a> <a id="2808" href="lagda.2023-11-21-nbe.html#2776" class="Bound">f</a> <a id="2810" href="lagda.2023-11-21-nbe.html#2799" class="Bound">x</a> <a id="2812" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2814" href="lagda.2023-11-21-nbe.html#2778" class="Bound">g</a> <a id="2816" href="lagda.2023-11-21-nbe.html#2799" class="Bound">x</a><a id="2817" class="Symbol">)</a>
      <a id="2825" class="Comment">-----------------------</a>
    <a id="2853" class="Symbol">→</a> <a id="2855" href="lagda.2023-11-21-nbe.html#2776" class="Bound">f</a> <a id="2857" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2859" href="lagda.2023-11-21-nbe.html#2778" class="Bound">g</a>
</pre>--->
<h3 id="stlc">STLC</h3>
<p>The object language that will be used here to define normalization by evaluation
will be the simply-typed lambda calculus with <code>𝟙</code> (“unit”) as a base type. It
has variables, functions, application, and a single value of type <code>𝟙</code>: <code>unit</code>.</p>
<pre class="Agda"><a id="3128" class="Keyword">data</a> <a id="Type"></a><a id="3133" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a> <a id="3138" class="Symbol">:</a> <a id="3140" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="3144" class="Keyword">where</a>
  <a id="3152" class="Comment">-- unit</a>
  <a id="Type.𝟙"></a><a id="3162" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a>   <a id="3166" class="Symbol">:</a> <a id="3168" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a>

  <a id="3176" class="Comment">-- functions</a>
  <a id="Type._⇒_"></a><a id="3191" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">_⇒_</a> <a id="3195" class="Symbol">:</a> <a id="3197" class="Symbol">∀</a> <a id="3199" class="Symbol">(</a><a id="3200" href="lagda.2023-11-21-nbe.html#3200" class="Bound">S</a> <a id="3202" href="lagda.2023-11-21-nbe.html#3202" class="Bound">T</a> <a id="3204" class="Symbol">:</a> <a id="3206" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="3210" class="Symbol">)</a> <a id="3212" class="Symbol">→</a> <a id="3214" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a>
</pre>
<!---
<pre class="Agda"><a id="3238" class="Keyword">infixr</a> <a id="3245" class="Number">7</a> <a id="3247" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">_⇒_</a>
</pre>--->
<p>A typing context (for which the metavariable <code>Γ</code> will be used) is either the
empty context <code>∅</code> or an extension to a context <code>Γ , x:S</code> mapping an object
language variable to a type (here, <code>Γ</code> is extended with the variable <code>x</code> mapped
to the type <code>S</code>).</p>
<p>The Agda definition does not actually mention variable names at all, and is
really just a list of types. This is because a de Brujin representation will be
used for variables, so instead of a name, a variable will be an index into the
list of types making up the context (i.e. a de Brujin index). For example, the
variable <code>x</code> in the context <code>Γ, x:S</code> would be represented simply as the zeroth
index.</p>
<pre class="Agda"><a id="3921" class="Keyword">data</a> <a id="Ctx"></a><a id="3926" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a> <a id="3930" class="Symbol">:</a> <a id="3932" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="3936" class="Keyword">where</a>
  <a id="Ctx.∅"></a><a id="3944" href="lagda.2023-11-21-nbe.html#3944" class="InductiveConstructor">∅</a> <a id="3946" class="Symbol">:</a> <a id="3948" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a>
  <a id="Ctx._,_"></a><a id="3954" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">_,_</a> <a id="3958" class="Symbol">:</a> <a id="3960" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a> <a id="3964" class="Symbol">→</a> <a id="3966" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a> <a id="3971" class="Symbol">→</a> <a id="3973" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a>
</pre>
<!---
<pre class="Agda"><a id="3992" class="Keyword">infixl</a> <a id="3999" class="Number">5</a> <a id="4001" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">_,_</a>
</pre>--->
<p>The de Brujin index representing a variable will not actually be a natural
number “index”, but rather a lookup judgements into a context. These lookup
judgements are very similar to natural numbers (and their contructors have been
named suggestively based on this similarity: <code>𝑍</code> for zero and <code>𝑆</code> for
successor). Defining them this way instead of simply using Agda’s natural
numbers will allow for an index into a context to always be well-defined (and
for variables to be intrinsically typed, as will be shown in a moment).</p>
<pre class="Agda"><a id="4549" class="Keyword">data</a> <a id="_∋_"></a><a id="4554" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">_∋_</a> <a id="4558" class="Symbol">:</a> <a id="4560" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a> <a id="4564" class="Symbol">→</a> <a id="4566" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a> <a id="4571" class="Symbol">→</a> <a id="4573" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="4577" class="Keyword">where</a>
  <a id="_∋_.𝑍"></a><a id="4585" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a> <a id="4587" class="Symbol">:</a> <a id="4589" class="Symbol">∀</a> <a id="4591" class="Symbol">{</a><a id="4592" href="lagda.2023-11-21-nbe.html#4592" class="Bound">Γ</a> <a id="4594" class="Symbol">:</a> <a id="4596" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="4599" class="Symbol">}</a> <a id="4601" class="Symbol">{</a><a id="4602" href="lagda.2023-11-21-nbe.html#4602" class="Bound">T</a> <a id="4604" class="Symbol">:</a> <a id="4606" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="4610" class="Symbol">}</a>
        <a id="4620" class="Comment">---------</a>
      <a id="4636" class="Symbol">→</a> <a id="4638" href="lagda.2023-11-21-nbe.html#4592" class="Bound">Γ</a> <a id="4640" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="4642" href="lagda.2023-11-21-nbe.html#4602" class="Bound">T</a> <a id="4644" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="4646" href="lagda.2023-11-21-nbe.html#4602" class="Bound">T</a>

  <a id="_∋_.𝑆_"></a><a id="4651" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆_</a> <a id="4654" class="Symbol">:</a> <a id="4656" class="Symbol">∀</a> <a id="4658" class="Symbol">{</a><a id="4659" href="lagda.2023-11-21-nbe.html#4659" class="Bound">Γ</a> <a id="4661" class="Symbol">:</a> <a id="4663" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="4666" class="Symbol">}</a> <a id="4668" class="Symbol">{</a><a id="4669" href="lagda.2023-11-21-nbe.html#4669" class="Bound">S</a> <a id="4671" href="lagda.2023-11-21-nbe.html#4671" class="Bound">T</a> <a id="4673" class="Symbol">:</a> <a id="4675" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="4679" class="Symbol">}</a>
      <a id="4687" class="Symbol">→</a> <a id="4689" href="lagda.2023-11-21-nbe.html#4659" class="Bound">Γ</a> <a id="4691" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="4693" href="lagda.2023-11-21-nbe.html#4671" class="Bound">T</a>
        <a id="4703" class="Comment">---------</a>
      <a id="4719" class="Symbol">→</a> <a id="4721" href="lagda.2023-11-21-nbe.html#4659" class="Bound">Γ</a> <a id="4723" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="4725" href="lagda.2023-11-21-nbe.html#4669" class="Bound">S</a> <a id="4727" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="4729" href="lagda.2023-11-21-nbe.html#4671" class="Bound">T</a>
</pre>
<!---
<pre class="Agda"><a id="4746" class="Keyword">infix</a> <a id="4752" class="Number">4</a> <a id="4754" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">_∋_</a>
<a id="4758" class="Keyword">infix</a> <a id="4764" class="Number">9</a> <a id="4766" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆_</a>
</pre>--->
<p>Using these, the context <code>∅, x:S, y:T</code> can be represented along with the
variable names <code>"x"</code> and <code>"y"</code> as is done in the following example.</p>
<pre class="Agda"><a id="4929" class="Keyword">module</a> <a id="Example"></a><a id="4936" href="lagda.2023-11-21-nbe.html#4936" class="Module">Example</a> <a id="4944" class="Symbol">(</a><a id="4945" href="lagda.2023-11-21-nbe.html#4945" class="Bound">S</a> <a id="4947" href="lagda.2023-11-21-nbe.html#4947" class="Bound">T</a> <a id="4949" class="Symbol">:</a> <a id="4951" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="4955" class="Symbol">)</a> <a id="4957" class="Keyword">where</a>
  <a id="Example.∅,x:S,y:T"></a><a id="4965" href="lagda.2023-11-21-nbe.html#4965" class="Function">∅,x:S,y:T</a> <a id="4975" class="Symbol">=</a> <a id="4977" href="lagda.2023-11-21-nbe.html#3944" class="InductiveConstructor">∅</a> <a id="4979" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="4981" href="lagda.2023-11-21-nbe.html#4945" class="Bound">S</a> <a id="4983" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="4985" href="lagda.2023-11-21-nbe.html#4947" class="Bound">T</a>

  <a id="Example.x"></a><a id="4990" href="lagda.2023-11-21-nbe.html#4990" class="Function">x</a> <a id="4992" class="Symbol">:</a> <a id="4994" href="lagda.2023-11-21-nbe.html#4965" class="Function">∅,x:S,y:T</a> <a id="5004" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="5006" href="lagda.2023-11-21-nbe.html#4945" class="Bound">S</a>
  <a id="5010" href="lagda.2023-11-21-nbe.html#4990" class="Function">x</a> <a id="5012" class="Symbol">=</a> <a id="5014" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="5016" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>

  <a id="Example.y"></a><a id="5021" href="lagda.2023-11-21-nbe.html#5021" class="Function">y</a> <a id="5023" class="Symbol">:</a> <a id="5025" href="lagda.2023-11-21-nbe.html#4965" class="Function">∅,x:S,y:T</a> <a id="5035" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="5037" href="lagda.2023-11-21-nbe.html#4947" class="Bound">T</a>
  <a id="5041" href="lagda.2023-11-21-nbe.html#5021" class="Function">y</a> <a id="5043" class="Symbol">=</a> <a id="5045" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>
</pre>
<p>STLC terms will be embedded in Agda using an <em>intrinsically</em> typed
representation. Types are defined first, and terms are only every considered
with respect to their type.</p>
<p>Using this representation, terms that are not well-typed don’t even have to be
considered, as they are impossible to represent. An STLC term <code>t</code> embedded in
Agda as an expression of type <code>Γ ⊢ T</code> is, by definition, a well-typed STLC
term of type <code>T</code> in the context <code>Γ</code> (written as <code>Γ ⊢ t : T</code>).</p>
<p>For clarity, when talking about terms their representation in the STLC will be
used over their intrinsically typed representation using de Brujin indices, and
all terms will be assumed to be well-typed. (e.g. the variable <code># 𝑍</code> will be
referred to as <code>Γ, x:T ⊢ x : T</code>, or just <code>x</code>.)</p>
<pre class="Agda"><a id="5812" class="Keyword">data</a> <a id="_⊢_"></a><a id="5817" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">_⊢_</a> <a id="5821" class="Symbol">(</a><a id="5822" href="lagda.2023-11-21-nbe.html#5822" class="Bound">Γ</a> <a id="5824" class="Symbol">:</a> <a id="5826" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="5829" class="Symbol">)</a> <a id="5831" class="Symbol">:</a> <a id="5833" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a> <a id="5838" class="Symbol">→</a> <a id="5840" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="5844" class="Keyword">where</a>
  <a id="5852" class="Comment">-- unit term</a>
  <a id="_⊢_.unit"></a><a id="5867" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a> <a id="5872" class="Symbol">:</a> <a id="5874" href="lagda.2023-11-21-nbe.html#5822" class="Bound">Γ</a> <a id="5876" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="5878" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a>

  <a id="5883" class="Comment">-- variable</a>
  <a id="_⊢_.#_"></a><a id="5897" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#_</a> <a id="5900" class="Symbol">:</a> <a id="5902" class="Symbol">∀</a> <a id="5904" class="Symbol">{</a><a id="5905" href="lagda.2023-11-21-nbe.html#5905" class="Bound">S</a> <a id="5907" class="Symbol">:</a> <a id="5909" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="5913" class="Symbol">}</a>
     <a id="5920" class="Symbol">→</a> <a id="5922" href="lagda.2023-11-21-nbe.html#5822" class="Bound">Γ</a> <a id="5924" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="5926" href="lagda.2023-11-21-nbe.html#5905" class="Bound">S</a>
       <a id="5935" class="Comment">-----</a>
     <a id="5946" class="Symbol">→</a> <a id="5948" href="lagda.2023-11-21-nbe.html#5822" class="Bound">Γ</a> <a id="5950" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="5952" href="lagda.2023-11-21-nbe.html#5905" class="Bound">S</a>

  <a id="5957" class="Comment">-- abstraction</a>
  <a id="_⊢_.ƛ_"></a><a id="5974" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ_</a> <a id="5977" class="Symbol">:</a> <a id="5979" class="Symbol">∀</a> <a id="5981" class="Symbol">{</a><a id="5982" href="lagda.2023-11-21-nbe.html#5982" class="Bound">S</a> <a id="5984" href="lagda.2023-11-21-nbe.html#5984" class="Bound">T</a> <a id="5986" class="Symbol">:</a> <a id="5988" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="5992" class="Symbol">}</a>
     <a id="5999" class="Symbol">→</a> <a id="6001" href="lagda.2023-11-21-nbe.html#5822" class="Bound">Γ</a> <a id="6003" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="6005" href="lagda.2023-11-21-nbe.html#5982" class="Bound">S</a> <a id="6007" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="6009" href="lagda.2023-11-21-nbe.html#5984" class="Bound">T</a>
       <a id="6018" class="Comment">---------</a>
     <a id="6033" class="Symbol">→</a> <a id="6035" href="lagda.2023-11-21-nbe.html#5822" class="Bound">Γ</a> <a id="6037" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="6039" href="lagda.2023-11-21-nbe.html#5982" class="Bound">S</a> <a id="6041" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="6043" href="lagda.2023-11-21-nbe.html#5984" class="Bound">T</a>

  <a id="6048" class="Comment">-- application</a>
  <a id="_⊢_._·_"></a><a id="6065" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">_·_</a> <a id="6069" class="Symbol">:</a> <a id="6071" class="Symbol">∀</a> <a id="6073" class="Symbol">{</a><a id="6074" href="lagda.2023-11-21-nbe.html#6074" class="Bound">S</a> <a id="6076" href="lagda.2023-11-21-nbe.html#6076" class="Bound">T</a> <a id="6078" class="Symbol">:</a> <a id="6080" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="6084" class="Symbol">}</a>
      <a id="6092" class="Symbol">→</a> <a id="6094" href="lagda.2023-11-21-nbe.html#5822" class="Bound">Γ</a> <a id="6096" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="6098" href="lagda.2023-11-21-nbe.html#6074" class="Bound">S</a> <a id="6100" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="6102" href="lagda.2023-11-21-nbe.html#6076" class="Bound">T</a>
      <a id="6110" class="Symbol">→</a> <a id="6112" href="lagda.2023-11-21-nbe.html#5822" class="Bound">Γ</a> <a id="6114" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="6116" href="lagda.2023-11-21-nbe.html#6074" class="Bound">S</a>
        <a id="6126" class="Comment">---------</a>
      <a id="6142" class="Symbol">→</a> <a id="6144" href="lagda.2023-11-21-nbe.html#5822" class="Bound">Γ</a> <a id="6146" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="6148" href="lagda.2023-11-21-nbe.html#6076" class="Bound">T</a>
</pre>
<!---
<pre class="Agda"><a id="6169" class="Keyword">infix</a> <a id="6175" class="Number">4</a> <a id="6177" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">_⊢_</a>
<a id="6181" class="Keyword">infix</a> <a id="6187" class="Number">5</a> <a id="6189" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ_</a>
<a id="6192" class="Keyword">infixl</a> <a id="6199" class="Number">7</a> <a id="6201" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">_·_</a>
<a id="6205" class="Keyword">infix</a> <a id="6211" class="Number">9</a> <a id="6213" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#_</a>
</pre>--->
<p>Here are some sample programs in STLC embedded here using these constructors:</p>
<pre class="Agda"><a id="6313" class="Keyword">module</a> <a id="SamplePrograms"></a><a id="6320" href="lagda.2023-11-21-nbe.html#6320" class="Module">SamplePrograms</a> <a id="6335" class="Keyword">where</a>
  <a id="6343" class="Comment">-- Γ ⊢ λx. x : T → T</a>
  <a id="SamplePrograms.ex0"></a><a id="6366" href="lagda.2023-11-21-nbe.html#6366" class="Function">ex0</a> <a id="6370" class="Symbol">:</a> <a id="6372" class="Symbol">∀</a> <a id="6374" class="Symbol">{</a><a id="6375" href="lagda.2023-11-21-nbe.html#6375" class="Bound">Γ</a> <a id="6377" class="Symbol">:</a> <a id="6379" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="6382" class="Symbol">}</a> <a id="6384" class="Symbol">{</a><a id="6385" href="lagda.2023-11-21-nbe.html#6385" class="Bound">T</a> <a id="6387" class="Symbol">:</a> <a id="6389" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="6393" class="Symbol">}</a> <a id="6395" class="Symbol">→</a> <a id="6397" href="lagda.2023-11-21-nbe.html#6375" class="Bound">Γ</a> <a id="6399" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="6401" href="lagda.2023-11-21-nbe.html#6385" class="Bound">T</a> <a id="6403" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="6405" href="lagda.2023-11-21-nbe.html#6385" class="Bound">T</a>
  <a id="6409" href="lagda.2023-11-21-nbe.html#6366" class="Function">ex0</a> <a id="6413" class="Symbol">=</a> <a id="6415" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="6417" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="6419" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>

  <a id="6424" class="Comment">-- ∅ ⊢ (λx. x) unit : 𝟙</a>
  <a id="SamplePrograms.ex1"></a><a id="6450" href="lagda.2023-11-21-nbe.html#6450" class="Function">ex1</a> <a id="6454" class="Symbol">:</a> <a id="6456" href="lagda.2023-11-21-nbe.html#3944" class="InductiveConstructor">∅</a> <a id="6458" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="6460" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a>
  <a id="6464" href="lagda.2023-11-21-nbe.html#6450" class="Function">ex1</a> <a id="6468" class="Symbol">=</a> <a id="6470" href="lagda.2023-11-21-nbe.html#6366" class="Function">ex0</a> <a id="6474" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="6476" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a>
</pre>
<p>With this embedding of the simply typed lambda calculus in Agda, an algorithm
for normalization by evaluation can actually be written. However, to prove
properties about the algorithm (e.g. that it is actually correct), a few more
language constructs are still needed. They are: context extension,
substitutions, and definitional equality. These will be defined before getting
into the details of the algorithm itself.</p>
<h4 id="context-extension">Context extension</h4>
<p>When defining the algorithm for normalization by evaluation, it will be
necessary to determine whether or not a context is an extension of another. A
context <code>Γ′</code> extends another context <code>Γ</code> if every mapping in <code>Γ</code> is also in
<code>Γ′</code>.</p>
<p>Since contexts are really just lists in their Agda representation, <code>Γ′</code> will be
an extension of <code>Γ</code> if <code>Γ</code> is a “sublist” of <code>Γ′</code>. The relation for context
extension is defined inductively based somewhat on this idea: a context extends
itself, and given that a context <code>Γ′</code> extends another context <code>Γ</code>, an extension
of <code>Γ′</code> is still an extension of <code>Γ′</code>.</p>
<pre class="Agda"><a id="7527" class="Keyword">data</a> <a id="_≤_"></a><a id="7532" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">_≤_</a> <a id="7536" class="Symbol">:</a> <a id="7538" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a> <a id="7542" class="Symbol">→</a> <a id="7544" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a> <a id="7548" class="Symbol">→</a> <a id="7550" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="7554" class="Keyword">where</a>
  <a id="_≤_.≤-id"></a><a id="7562" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a> <a id="7567" class="Symbol">:</a> <a id="7569" class="Symbol">∀</a> <a id="7571" class="Symbol">{</a><a id="7572" href="lagda.2023-11-21-nbe.html#7572" class="Bound">Γ</a> <a id="7574" class="Symbol">:</a> <a id="7576" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="7579" class="Symbol">}</a> <a id="7581" class="Symbol">→</a> <a id="7583" href="lagda.2023-11-21-nbe.html#7572" class="Bound">Γ</a> <a id="7585" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="7587" href="lagda.2023-11-21-nbe.html#7572" class="Bound">Γ</a>

  <a id="_≤_.≤-ext"></a><a id="7592" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="7598" class="Symbol">:</a> <a id="7600" class="Symbol">∀</a> <a id="7602" class="Symbol">{</a><a id="7603" href="lagda.2023-11-21-nbe.html#7603" class="Bound">Γ</a> <a id="7605" href="lagda.2023-11-21-nbe.html#7605" class="Bound">Γ′</a> <a id="7608" class="Symbol">:</a> <a id="7610" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="7613" class="Symbol">}</a> <a id="7615" class="Symbol">{</a><a id="7616" href="lagda.2023-11-21-nbe.html#7616" class="Bound">T</a> <a id="7618" class="Symbol">:</a> <a id="7620" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="7624" class="Symbol">}</a>
        <a id="7634" class="Symbol">→</a> <a id="7636" href="lagda.2023-11-21-nbe.html#7605" class="Bound">Γ′</a> <a id="7639" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="7641" href="lagda.2023-11-21-nbe.html#7603" class="Bound">Γ</a>
          <a id="7653" class="Comment">----------</a>
        <a id="7672" class="Symbol">→</a> <a id="7674" href="lagda.2023-11-21-nbe.html#7605" class="Bound">Γ′</a> <a id="7677" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="7679" href="lagda.2023-11-21-nbe.html#7616" class="Bound">T</a> <a id="7681" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="7683" href="lagda.2023-11-21-nbe.html#7603" class="Bound">Γ</a>
</pre>
<!---
<pre class="Agda"><a id="7704" class="Keyword">infix</a> <a id="7710" class="Number">4</a> <a id="7712" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">_≤_</a>
</pre>--->
<!---

The relation is invertible: if `Γ′ ≤ Γ , T`, then `Γ′ ≤ Γ`.

<pre class="Agda"><a id="invert-≤"></a><a id="7802" href="lagda.2023-11-21-nbe.html#7802" class="Function">invert-≤</a> <a id="7811" class="Symbol">:</a> <a id="7813" class="Symbol">∀</a> <a id="7815" class="Symbol">{</a><a id="7816" href="lagda.2023-11-21-nbe.html#7816" class="Bound">Γ</a> <a id="7818" href="lagda.2023-11-21-nbe.html#7818" class="Bound">Γ′</a> <a id="7821" class="Symbol">:</a> <a id="7823" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="7826" class="Symbol">}</a> <a id="7828" class="Symbol">{</a><a id="7829" href="lagda.2023-11-21-nbe.html#7829" class="Bound">T</a> <a id="7831" class="Symbol">:</a> <a id="7833" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="7837" class="Symbol">}</a>
         <a id="7848" class="Symbol">→</a> <a id="7850" href="lagda.2023-11-21-nbe.html#7818" class="Bound">Γ′</a> <a id="7853" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="7855" href="lagda.2023-11-21-nbe.html#7816" class="Bound">Γ</a> <a id="7857" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="7859" href="lagda.2023-11-21-nbe.html#7829" class="Bound">T</a>
           <a id="7872" class="Comment">----------</a>
         <a id="7892" class="Symbol">→</a> <a id="7894" href="lagda.2023-11-21-nbe.html#7818" class="Bound">Γ′</a> <a id="7897" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="7899" href="lagda.2023-11-21-nbe.html#7816" class="Bound">Γ</a>
<a id="7901" href="lagda.2023-11-21-nbe.html#7802" class="Function">invert-≤</a> <a id="7910" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a> <a id="7915" class="Symbol">=</a> <a id="7917" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="7923" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a>
<a id="7928" href="lagda.2023-11-21-nbe.html#7802" class="Function">invert-≤</a> <a id="7937" class="Symbol">(</a><a id="7938" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="7944" href="lagda.2023-11-21-nbe.html#7944" class="Bound">x</a><a id="7945" class="Symbol">)</a> <a id="7947" class="Symbol">=</a> <a id="7949" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="7955" class="Symbol">(</a><a id="7956" href="lagda.2023-11-21-nbe.html#7802" class="Function">invert-≤</a> <a id="7965" href="lagda.2023-11-21-nbe.html#7944" class="Bound">x</a><a id="7966" class="Symbol">)</a>
</pre>--->
<p>The relation is antisymmetric, meaning that if <code>Γ′ ≤ Γ</code> and <code>Γ ≤ Γ′</code>, then
<code>Γ′</code> and <code>Γ</code> must be the same context. This proof is left out in the rendering,
though it is proven mutually with the fact that <code>Γ</code> is never an extension of
<code>Γ, x:T</code>.</p>
<pre class="Agda"><a id="≤-antisym"></a><a id="8229" href="lagda.2023-11-21-nbe.html#8229" class="Function">≤-antisym</a> <a id="8239" class="Symbol">:</a> <a id="8241" class="Symbol">∀</a> <a id="8243" class="Symbol">{</a><a id="8244" href="lagda.2023-11-21-nbe.html#8244" class="Bound">Γ</a> <a id="8246" href="lagda.2023-11-21-nbe.html#8246" class="Bound">Γ′</a> <a id="8249" class="Symbol">:</a> <a id="8251" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="8254" class="Symbol">}</a>
          <a id="8266" class="Symbol">→</a> <a id="8268" href="lagda.2023-11-21-nbe.html#8244" class="Bound">Γ</a> <a id="8270" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="8272" href="lagda.2023-11-21-nbe.html#8246" class="Bound">Γ′</a>
          <a id="8285" class="Symbol">→</a> <a id="8287" href="lagda.2023-11-21-nbe.html#8246" class="Bound">Γ′</a> <a id="8290" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="8292" href="lagda.2023-11-21-nbe.html#8244" class="Bound">Γ</a>
            <a id="8306" class="Comment">------</a>
          <a id="8323" class="Symbol">→</a> <a id="8325" href="lagda.2023-11-21-nbe.html#8244" class="Bound">Γ</a> <a id="8327" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="8329" href="lagda.2023-11-21-nbe.html#8246" class="Bound">Γ′</a>

<a id="Γ≰Γ,T"></a><a id="8333" href="lagda.2023-11-21-nbe.html#8333" class="Function">Γ≰Γ,T</a> <a id="8339" class="Symbol">:</a> <a id="8341" class="Symbol">∀</a> <a id="8343" class="Symbol">{</a><a id="8344" href="lagda.2023-11-21-nbe.html#8344" class="Bound">Γ</a> <a id="8346" class="Symbol">:</a> <a id="8348" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="8351" class="Symbol">}</a> <a id="8353" class="Symbol">{</a><a id="8354" href="lagda.2023-11-21-nbe.html#8354" class="Bound">T</a> <a id="8356" class="Symbol">:</a> <a id="8358" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="8362" class="Symbol">}</a> <a id="8364" class="Symbol">→</a> <a id="8366" href="Relation.Nullary.html#656" class="Function Operator">¬</a> <a id="8368" class="Symbol">(</a><a id="8369" href="lagda.2023-11-21-nbe.html#8344" class="Bound">Γ</a> <a id="8371" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="8373" href="lagda.2023-11-21-nbe.html#8344" class="Bound">Γ</a> <a id="8375" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="8377" href="lagda.2023-11-21-nbe.html#8354" class="Bound">T</a><a id="8378" class="Symbol">)</a>
</pre>
<!---
<pre class="Agda"><a id="≤-ext-uniq-T"></a><a id="8399" href="lagda.2023-11-21-nbe.html#8399" class="Function">≤-ext-uniq-T</a> <a id="8412" class="Symbol">:</a> <a id="8414" class="Symbol">∀</a> <a id="8416" class="Symbol">{</a><a id="8417" href="lagda.2023-11-21-nbe.html#8417" class="Bound">Γ</a> <a id="8419" href="lagda.2023-11-21-nbe.html#8419" class="Bound">Γ′</a> <a id="8422" class="Symbol">:</a> <a id="8424" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="8427" class="Symbol">}</a> <a id="8429" class="Symbol">{</a><a id="8430" href="lagda.2023-11-21-nbe.html#8430" class="Bound">S</a> <a id="8432" href="lagda.2023-11-21-nbe.html#8432" class="Bound">T</a> <a id="8434" class="Symbol">:</a> <a id="8436" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="8440" class="Symbol">}</a>
           <a id="8453" class="Symbol">→</a> <a id="8455" href="lagda.2023-11-21-nbe.html#8419" class="Bound">Γ′</a> <a id="8458" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="8460" href="lagda.2023-11-21-nbe.html#8417" class="Bound">Γ</a> <a id="8462" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="8464" href="lagda.2023-11-21-nbe.html#8432" class="Bound">T</a>
           <a id="8477" class="Symbol">→</a> <a id="8479" href="lagda.2023-11-21-nbe.html#8419" class="Bound">Γ′</a> <a id="8482" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="8484" href="lagda.2023-11-21-nbe.html#8417" class="Bound">Γ</a> <a id="8486" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="8488" href="lagda.2023-11-21-nbe.html#8430" class="Bound">S</a>
             <a id="8503" class="Comment">----------</a>
           <a id="8525" class="Symbol">→</a> <a id="8527" href="lagda.2023-11-21-nbe.html#8432" class="Bound">T</a> <a id="8529" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="8531" href="lagda.2023-11-21-nbe.html#8430" class="Bound">S</a>

<a id="8534" href="lagda.2023-11-21-nbe.html#8399" class="Function">≤-ext-uniq-T</a> <a id="8547" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a> <a id="8552" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a> <a id="8557" class="Symbol">=</a> <a id="8559" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="8564" href="lagda.2023-11-21-nbe.html#8399" class="Function">≤-ext-uniq-T</a> <a id="8577" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a> <a id="8582" class="Symbol">(</a><a id="8583" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="8589" href="lagda.2023-11-21-nbe.html#8589" class="Bound">c</a><a id="8590" class="Symbol">)</a> <a id="8592" class="Symbol">=</a> <a id="8594" href="Data.Empty.html#628" class="Function">⊥-elim</a> <a id="8601" class="Symbol">(</a><a id="8602" href="lagda.2023-11-21-nbe.html#8333" class="Function">Γ≰Γ,T</a> <a id="8608" href="lagda.2023-11-21-nbe.html#8589" class="Bound">c</a><a id="8609" class="Symbol">)</a>
<a id="8611" href="lagda.2023-11-21-nbe.html#8399" class="Function">≤-ext-uniq-T</a> <a id="8624" class="Symbol">(</a><a id="8625" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="8631" href="lagda.2023-11-21-nbe.html#8631" class="Bound">c</a><a id="8632" class="Symbol">)</a> <a id="8634" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a> <a id="8639" class="Symbol">=</a> <a id="8641" href="Data.Empty.html#628" class="Function">⊥-elim</a> <a id="8648" class="Symbol">(</a><a id="8649" href="lagda.2023-11-21-nbe.html#8333" class="Function">Γ≰Γ,T</a> <a id="8655" href="lagda.2023-11-21-nbe.html#8631" class="Bound">c</a><a id="8656" class="Symbol">)</a>
<a id="8658" href="lagda.2023-11-21-nbe.html#8399" class="Function">≤-ext-uniq-T</a> <a id="8671" class="Symbol">(</a><a id="8672" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="8678" href="lagda.2023-11-21-nbe.html#8678" class="Bound">p₁</a><a id="8680" class="Symbol">)</a> <a id="8682" class="Symbol">(</a><a id="8683" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="8689" href="lagda.2023-11-21-nbe.html#8689" class="Bound">p₂</a><a id="8691" class="Symbol">)</a>
  <a id="8695" class="Keyword">rewrite</a> <a id="8703" href="lagda.2023-11-21-nbe.html#8399" class="Function">≤-ext-uniq-T</a> <a id="8716" href="lagda.2023-11-21-nbe.html#8678" class="Bound">p₁</a> <a id="8719" href="lagda.2023-11-21-nbe.html#8689" class="Bound">p₂</a> <a id="8722" class="Symbol">=</a> <a id="8724" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="8730" href="lagda.2023-11-21-nbe.html#8229" class="Function">≤-antisym</a> <a id="8740" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a> <a id="8745" href="lagda.2023-11-21-nbe.html#8745" class="Bound">Γ′≤Γ</a> <a id="8750" class="Symbol">=</a> <a id="8752" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="8757" href="lagda.2023-11-21-nbe.html#8229" class="Function">≤-antisym</a> <a id="8767" class="Symbol">(</a><a id="8768" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="8774" href="lagda.2023-11-21-nbe.html#8774" class="Bound">Γ≤Γ′</a><a id="8778" class="Symbol">)</a> <a id="8780" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a> <a id="8785" class="Symbol">=</a> <a id="8787" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="8792" href="lagda.2023-11-21-nbe.html#8229" class="Function">≤-antisym</a> <a id="8802" class="Symbol">(</a><a id="8803" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="8809" class="Symbol">{</a><a id="8810" class="Argument">T</a> <a id="8812" class="Symbol">=</a> <a id="8814" href="lagda.2023-11-21-nbe.html#8814" class="Bound">T₁</a><a id="8816" class="Symbol">}</a> <a id="8818" href="lagda.2023-11-21-nbe.html#8818" class="Bound">p₁</a><a id="8820" class="Symbol">)</a> <a id="8822" class="Symbol">(</a><a id="8823" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="8829" class="Symbol">{</a><a id="8830" class="Argument">T</a> <a id="8832" class="Symbol">=</a> <a id="8834" href="lagda.2023-11-21-nbe.html#8834" class="Bound">T₂</a><a id="8836" class="Symbol">}</a> <a id="8838" href="lagda.2023-11-21-nbe.html#8838" class="Bound">p₂</a><a id="8840" class="Symbol">)</a>
  <a id="8844" class="Keyword">with</a> <a id="8849" href="lagda.2023-11-21-nbe.html#7802" class="Function">invert-≤</a> <a id="8858" href="lagda.2023-11-21-nbe.html#8818" class="Bound">p₁</a> <a id="8861" class="Symbol">|</a> <a id="8863" href="lagda.2023-11-21-nbe.html#7802" class="Function">invert-≤</a> <a id="8872" href="lagda.2023-11-21-nbe.html#8838" class="Bound">p₂</a>
<a id="8875" class="Symbol">...</a>  <a id="8880" class="Symbol">|</a> <a id="8882" href="lagda.2023-11-21-nbe.html#8882" class="Bound">≤→</a>         <a id="8893" class="Symbol">|</a> <a id="8895" href="lagda.2023-11-21-nbe.html#8895" class="Bound">≤←</a>
  <a id="8900" class="Keyword">with</a> <a id="8905" href="lagda.2023-11-21-nbe.html#8229" class="Function">≤-antisym</a> <a id="8915" href="lagda.2023-11-21-nbe.html#8882" class="Bound">≤→</a> <a id="8918" href="lagda.2023-11-21-nbe.html#8895" class="Bound">≤←</a>
<a id="8921" class="Symbol">...</a>  <a id="8926" class="Symbol">|</a> <a id="8928" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="8935" class="Keyword">rewrite</a> <a id="8943" href="lagda.2023-11-21-nbe.html#8399" class="Function">≤-ext-uniq-T</a> <a id="8956" class="Bound">p₁</a> <a id="8959" class="Bound">p₂</a>     <a id="8966" class="Symbol">=</a> <a id="8968" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="8974" href="lagda.2023-11-21-nbe.html#8333" class="Function">Γ≰Γ,T</a> <a id="8980" class="Symbol">{</a><a id="8981" href="lagda.2023-11-21-nbe.html#8981" class="Bound">Γ</a><a id="8982" class="Symbol">}</a> <a id="8984" class="Symbol">{</a><a id="8985" href="lagda.2023-11-21-nbe.html#8985" class="Bound">T</a><a id="8986" class="Symbol">}</a> <a id="8988" href="lagda.2023-11-21-nbe.html#8988" class="Bound">Γ≤Γ,T</a>
  <a id="8996" class="Keyword">with</a> <a id="9001" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="9007" class="Symbol">{</a><a id="9008" class="Argument">T</a> <a id="9010" class="Symbol">=</a> <a id="9012" href="lagda.2023-11-21-nbe.html#8985" class="Bound">T</a><a id="9013" class="Symbol">}</a> <a id="9015" class="Symbol">(</a><a id="9016" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a> <a id="9021" class="Symbol">{</a><a id="9022" href="lagda.2023-11-21-nbe.html#8981" class="Bound">Γ</a><a id="9023" class="Symbol">})</a>
<a id="9026" class="Symbol">...</a>  <a id="9031" class="Symbol">|</a> <a id="9033" href="lagda.2023-11-21-nbe.html#9033" class="Bound">Γ,T≤Γ</a>
  <a id="9041" class="Keyword">with</a> <a id="9046" href="lagda.2023-11-21-nbe.html#8229" class="Function">≤-antisym</a> <a id="9056" class="Bound">Γ≤Γ,T</a> <a id="9062" href="lagda.2023-11-21-nbe.html#9033" class="Bound">Γ,T≤Γ</a>
<a id="9068" class="Symbol">...</a>  <a id="9073" class="Symbol">|</a> <a id="9075" class="Symbol">()</a>
</pre>--->
<p>This relation is also transitive, a proof that follows by induction:</p>
<pre class="Agda"><a id="≤-trans"></a><a id="9166" href="lagda.2023-11-21-nbe.html#9166" class="Function">≤-trans</a> <a id="9174" class="Symbol">:</a> <a id="9176" class="Symbol">∀</a> <a id="9178" class="Symbol">{</a><a id="9179" href="lagda.2023-11-21-nbe.html#9179" class="Bound">Γ″</a> <a id="9182" href="lagda.2023-11-21-nbe.html#9182" class="Bound">Γ′</a> <a id="9185" href="lagda.2023-11-21-nbe.html#9185" class="Bound">Γ</a> <a id="9187" class="Symbol">:</a> <a id="9189" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="9192" class="Symbol">}</a>
         <a id="9203" class="Symbol">→</a> <a id="9205" href="lagda.2023-11-21-nbe.html#9179" class="Bound">Γ″</a> <a id="9208" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="9210" href="lagda.2023-11-21-nbe.html#9182" class="Bound">Γ′</a>
         <a id="9222" class="Symbol">→</a> <a id="9224" href="lagda.2023-11-21-nbe.html#9182" class="Bound">Γ′</a> <a id="9227" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="9229" href="lagda.2023-11-21-nbe.html#9185" class="Bound">Γ</a>
           <a id="9242" class="Comment">-------</a>
         <a id="9259" class="Symbol">→</a> <a id="9261" href="lagda.2023-11-21-nbe.html#9179" class="Bound">Γ″</a> <a id="9264" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="9266" href="lagda.2023-11-21-nbe.html#9185" class="Bound">Γ</a>
<a id="9268" href="lagda.2023-11-21-nbe.html#9166" class="Function">≤-trans</a> <a id="9276" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a> <a id="9281" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a>               <a id="9300" class="Symbol">=</a> <a id="9302" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a>
<a id="9307" href="lagda.2023-11-21-nbe.html#9166" class="Function">≤-trans</a> <a id="9315" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a> <a id="9320" class="Symbol">(</a><a id="9321" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="9327" href="lagda.2023-11-21-nbe.html#9327" class="Bound">pf</a><a id="9329" class="Symbol">)</a>         <a id="9339" class="Symbol">=</a> <a id="9341" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="9347" href="lagda.2023-11-21-nbe.html#9327" class="Bound">pf</a>
<a id="9350" href="lagda.2023-11-21-nbe.html#9166" class="Function">≤-trans</a> <a id="9358" class="Symbol">(</a><a id="9359" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="9365" href="lagda.2023-11-21-nbe.html#9365" class="Bound">pf</a><a id="9367" class="Symbol">)</a> <a id="9369" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a>         <a id="9382" class="Symbol">=</a> <a id="9384" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="9390" href="lagda.2023-11-21-nbe.html#9365" class="Bound">pf</a>
<a id="9393" href="lagda.2023-11-21-nbe.html#9166" class="Function">≤-trans</a> <a id="9401" class="Symbol">(</a><a id="9402" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="9408" href="lagda.2023-11-21-nbe.html#9408" class="Bound">pf₁</a><a id="9411" class="Symbol">)</a> <a id="9413" class="Symbol">(</a><a id="9414" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="9420" href="lagda.2023-11-21-nbe.html#9420" class="Bound">pf₂</a><a id="9423" class="Symbol">)</a> <a id="9425" class="Symbol">=</a> <a id="9427" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="9433" class="Symbol">(</a><a id="9434" href="lagda.2023-11-21-nbe.html#9166" class="Function">≤-trans</a> <a id="9442" href="lagda.2023-11-21-nbe.html#9408" class="Bound">pf₁</a> <a id="9446" class="Symbol">(</a><a id="9447" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="9453" href="lagda.2023-11-21-nbe.html#9420" class="Bound">pf₂</a><a id="9456" class="Symbol">))</a>
</pre>
<p>Finally, this relation can be made decidable. Its decidability requires that
equality between contexts (and by extension, type) also be decidable; these
proofs are also left out in the rendering.</p>
<pre class="Agda"><a id="_≟Tp_"></a><a id="9669" href="lagda.2023-11-21-nbe.html#9669" class="Function Operator">_≟Tp_</a> <a id="9675" class="Symbol">:</a> <a id="9677" class="Symbol">∀</a> <a id="9679" class="Symbol">(</a><a id="9680" href="lagda.2023-11-21-nbe.html#9680" class="Bound">S</a> <a id="9682" href="lagda.2023-11-21-nbe.html#9682" class="Bound">T</a> <a id="9684" class="Symbol">:</a> <a id="9686" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="9690" class="Symbol">)</a> <a id="9692" class="Symbol">→</a> <a id="9694" href="Relation.Nullary.html#1511" class="Record">Dec</a> <a id="9698" class="Symbol">(</a><a id="9699" href="lagda.2023-11-21-nbe.html#9680" class="Bound">S</a> <a id="9701" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="9703" href="lagda.2023-11-21-nbe.html#9682" class="Bound">T</a><a id="9704" class="Symbol">)</a>
</pre>
<!---
<pre class="Agda"><a id="9725" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a>         <a id="9735" href="lagda.2023-11-21-nbe.html#9669" class="Function Operator">≟Tp</a> <a id="9739" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a>                                    <a id="9776" class="Symbol">=</a> <a id="9778" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="9782" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="9787" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a>         <a id="9797" href="lagda.2023-11-21-nbe.html#9669" class="Function Operator">≟Tp</a> <a id="9801" class="Symbol">(</a><a id="9802" href="lagda.2023-11-21-nbe.html#9802" class="Bound">S</a> <a id="9804" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="9806" href="lagda.2023-11-21-nbe.html#9806" class="Bound">T</a><a id="9807" class="Symbol">)</a>                              <a id="9838" class="Symbol">=</a> <a id="9840" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="9843" class="Symbol">λ()</a>
<a id="9847" class="Symbol">(</a><a id="9848" href="lagda.2023-11-21-nbe.html#9848" class="Bound">S₁</a> <a id="9851" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="9853" href="lagda.2023-11-21-nbe.html#9853" class="Bound">T₁</a><a id="9855" class="Symbol">)</a> <a id="9857" href="lagda.2023-11-21-nbe.html#9669" class="Function Operator">≟Tp</a> <a id="9861" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a>                                    <a id="9898" class="Symbol">=</a> <a id="9900" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="9903" class="Symbol">λ()</a>
<a id="9907" class="Symbol">(</a><a id="9908" href="lagda.2023-11-21-nbe.html#9908" class="Bound">S₁</a> <a id="9911" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="9913" href="lagda.2023-11-21-nbe.html#9913" class="Bound">T₁</a><a id="9915" class="Symbol">)</a> <a id="9917" href="lagda.2023-11-21-nbe.html#9669" class="Function Operator">≟Tp</a> <a id="9921" class="Symbol">(</a><a id="9922" href="lagda.2023-11-21-nbe.html#9922" class="Bound">S₂</a> <a id="9925" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="9927" href="lagda.2023-11-21-nbe.html#9927" class="Bound">T₂</a><a id="9929" class="Symbol">)</a> <a id="9931" class="Keyword">with</a> <a id="9936" href="lagda.2023-11-21-nbe.html#9908" class="Bound">S₁</a> <a id="9939" href="lagda.2023-11-21-nbe.html#9669" class="Function Operator">≟Tp</a> <a id="9943" href="lagda.2023-11-21-nbe.html#9922" class="Bound">S₂</a> <a id="9946" class="Symbol">|</a> <a id="9948" href="lagda.2023-11-21-nbe.html#9913" class="Bound">T₁</a> <a id="9951" href="lagda.2023-11-21-nbe.html#9669" class="Function Operator">≟Tp</a> <a id="9955" href="lagda.2023-11-21-nbe.html#9927" class="Bound">T₂</a>
<a id="9958" class="Symbol">...</a>                        <a id="9985" class="Symbol">|</a> <a id="9987" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="9990" href="lagda.2023-11-21-nbe.html#9990" class="Bound">¬pf</a>    <a id="9997" class="Symbol">|</a> <a id="9999" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="10002" class="Symbol">_</a>      <a id="10009" class="Symbol">=</a> <a id="10011" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="10014" class="Symbol">λ{</a><a id="10016" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="10021" class="Symbol">→</a> <a id="10023" href="lagda.2023-11-21-nbe.html#9990" class="Bound">¬pf</a> <a id="10027" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="10031" class="Symbol">}</a>
<a id="10033" class="Symbol">...</a>                        <a id="10060" class="Symbol">|</a> <a id="10062" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="10065" href="lagda.2023-11-21-nbe.html#10065" class="Bound">¬pf</a>    <a id="10072" class="Symbol">|</a> <a id="10074" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="10078" class="Symbol">_</a>     <a id="10084" class="Symbol">=</a> <a id="10086" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="10089" class="Symbol">λ{</a><a id="10091" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="10096" class="Symbol">→</a> <a id="10098" href="lagda.2023-11-21-nbe.html#10065" class="Bound">¬pf</a> <a id="10102" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="10106" class="Symbol">}</a>
<a id="10108" class="Symbol">...</a>                        <a id="10135" class="Symbol">|</a> <a id="10137" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="10141" class="Symbol">_</a>     <a id="10147" class="Symbol">|</a> <a id="10149" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="10152" href="lagda.2023-11-21-nbe.html#10152" class="Bound">¬pf</a>    <a id="10159" class="Symbol">=</a> <a id="10161" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="10164" class="Symbol">λ{</a><a id="10166" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="10171" class="Symbol">→</a> <a id="10173" href="lagda.2023-11-21-nbe.html#10152" class="Bound">¬pf</a> <a id="10177" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="10181" class="Symbol">}</a>
<a id="10183" class="Symbol">...</a>                        <a id="10210" class="Symbol">|</a> <a id="10212" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="10216" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>  <a id="10222" class="Symbol">|</a> <a id="10224" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="10228" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>  <a id="10234" class="Symbol">=</a> <a id="10236" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="10240" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
</pre>--->
<pre class="Agda"><a id="_≟Ctx_"></a><a id="10263" href="lagda.2023-11-21-nbe.html#10263" class="Function Operator">_≟Ctx_</a> <a id="10270" class="Symbol">:</a> <a id="10272" class="Symbol">(</a><a id="10273" href="lagda.2023-11-21-nbe.html#10273" class="Bound">Γ</a> <a id="10275" href="lagda.2023-11-21-nbe.html#10275" class="Bound">Γ′</a> <a id="10278" class="Symbol">:</a> <a id="10280" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="10283" class="Symbol">)</a> <a id="10285" class="Symbol">→</a> <a id="10287" href="Relation.Nullary.html#1511" class="Record">Dec</a> <a id="10291" class="Symbol">(</a><a id="10292" href="lagda.2023-11-21-nbe.html#10273" class="Bound">Γ</a> <a id="10294" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="10296" href="lagda.2023-11-21-nbe.html#10275" class="Bound">Γ′</a><a id="10298" class="Symbol">)</a>
</pre>
<!---
<pre class="Agda"><a id="10319" href="lagda.2023-11-21-nbe.html#3944" class="InductiveConstructor">∅</a>       <a id="10327" href="lagda.2023-11-21-nbe.html#10263" class="Function Operator">≟Ctx</a> <a id="10332" href="lagda.2023-11-21-nbe.html#3944" class="InductiveConstructor">∅</a>                                  <a id="10367" class="Symbol">=</a> <a id="10369" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="10373" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="10378" href="lagda.2023-11-21-nbe.html#3944" class="InductiveConstructor">∅</a>       <a id="10386" href="lagda.2023-11-21-nbe.html#10263" class="Function Operator">≟Ctx</a> <a id="10391" class="Symbol">(_</a> <a id="10394" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="10396" class="Symbol">_)</a>                            <a id="10426" class="Symbol">=</a> <a id="10428" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="10431" class="Symbol">λ()</a>
<a id="10435" class="Symbol">(_</a> <a id="10438" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="10440" class="Symbol">_)</a> <a id="10443" href="lagda.2023-11-21-nbe.html#10263" class="Function Operator">≟Ctx</a> <a id="10448" href="lagda.2023-11-21-nbe.html#3944" class="InductiveConstructor">∅</a>                                  <a id="10483" class="Symbol">=</a> <a id="10485" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="10488" class="Symbol">λ()</a>
<a id="10492" class="Symbol">(</a><a id="10493" href="lagda.2023-11-21-nbe.html#10493" class="Bound">Γ′</a> <a id="10496" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="10498" href="lagda.2023-11-21-nbe.html#10498" class="Bound">S</a><a id="10499" class="Symbol">)</a> <a id="10501" href="lagda.2023-11-21-nbe.html#10263" class="Function Operator">≟Ctx</a> <a id="10506" class="Symbol">(</a><a id="10507" href="lagda.2023-11-21-nbe.html#10507" class="Bound">Γ</a> <a id="10509" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="10511" href="lagda.2023-11-21-nbe.html#10511" class="Bound">T</a><a id="10512" class="Symbol">)</a> <a id="10514" class="Keyword">with</a> <a id="10519" href="lagda.2023-11-21-nbe.html#10493" class="Bound">Γ′</a> <a id="10522" href="lagda.2023-11-21-nbe.html#10263" class="Function Operator">≟Ctx</a> <a id="10527" href="lagda.2023-11-21-nbe.html#10507" class="Bound">Γ</a> <a id="10529" class="Symbol">|</a> <a id="10531" href="lagda.2023-11-21-nbe.html#10498" class="Bound">S</a> <a id="10533" href="lagda.2023-11-21-nbe.html#9669" class="Function Operator">≟Tp</a> <a id="10537" href="lagda.2023-11-21-nbe.html#10511" class="Bound">T</a>
<a id="10539" class="Symbol">...</a>                      <a id="10564" class="Symbol">|</a> <a id="10566" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="10569" href="lagda.2023-11-21-nbe.html#10569" class="Bound">¬pf</a>    <a id="10576" class="Symbol">|</a> <a id="10578" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="10581" class="Symbol">_</a>     <a id="10587" class="Symbol">=</a> <a id="10589" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="10592" class="Symbol">λ{</a><a id="10594" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="10599" class="Symbol">→</a> <a id="10601" href="lagda.2023-11-21-nbe.html#10569" class="Bound">¬pf</a> <a id="10605" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="10609" class="Symbol">}</a>
<a id="10611" class="Symbol">...</a>                      <a id="10636" class="Symbol">|</a> <a id="10638" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="10641" href="lagda.2023-11-21-nbe.html#10641" class="Bound">¬pf</a>    <a id="10648" class="Symbol">|</a> <a id="10650" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="10654" class="Symbol">_</a>    <a id="10659" class="Symbol">=</a> <a id="10661" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="10664" class="Symbol">λ{</a><a id="10666" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="10671" class="Symbol">→</a> <a id="10673" href="lagda.2023-11-21-nbe.html#10641" class="Bound">¬pf</a> <a id="10677" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="10681" class="Symbol">}</a>
<a id="10683" class="Symbol">...</a>                      <a id="10708" class="Symbol">|</a> <a id="10710" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="10714" class="Symbol">_</a>     <a id="10720" class="Symbol">|</a> <a id="10722" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="10725" href="lagda.2023-11-21-nbe.html#10725" class="Bound">¬pf</a>   <a id="10731" class="Symbol">=</a> <a id="10733" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="10736" class="Symbol">λ{</a><a id="10738" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="10743" class="Symbol">→</a> <a id="10745" href="lagda.2023-11-21-nbe.html#10725" class="Bound">¬pf</a> <a id="10749" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="10753" class="Symbol">}</a>
<a id="10755" class="Symbol">...</a>                      <a id="10780" class="Symbol">|</a> <a id="10782" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="10786" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>  <a id="10792" class="Symbol">|</a> <a id="10794" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="10798" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="10803" class="Symbol">=</a> <a id="10805" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="10809" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
</pre>--->
<p>With these, the relation can be made decidable in Agda:</p>
<pre class="Agda"><a id="_≤?_"></a><a id="10889" href="lagda.2023-11-21-nbe.html#10889" class="Function Operator">_≤?_</a> <a id="10894" class="Symbol">:</a> <a id="10896" class="Symbol">∀</a> <a id="10898" class="Symbol">(</a><a id="10899" href="lagda.2023-11-21-nbe.html#10899" class="Bound">Γ′</a> <a id="10902" href="lagda.2023-11-21-nbe.html#10902" class="Bound">Γ</a> <a id="10904" class="Symbol">:</a> <a id="10906" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="10909" class="Symbol">)</a> <a id="10911" class="Symbol">→</a> <a id="10913" href="Relation.Nullary.html#1511" class="Record">Dec</a> <a id="10917" class="Symbol">(</a><a id="10918" href="lagda.2023-11-21-nbe.html#10899" class="Bound">Γ′</a> <a id="10921" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="10923" href="lagda.2023-11-21-nbe.html#10902" class="Bound">Γ</a><a id="10924" class="Symbol">)</a>
<a id="10926" href="lagda.2023-11-21-nbe.html#3944" class="InductiveConstructor">∅</a>        <a id="10935" href="lagda.2023-11-21-nbe.html#10889" class="Function Operator">≤?</a> <a id="10938" href="lagda.2023-11-21-nbe.html#3944" class="InductiveConstructor">∅</a>          <a id="10949" class="Symbol">=</a> <a id="10951" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="10955" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a>
<a id="10960" href="lagda.2023-11-21-nbe.html#3944" class="InductiveConstructor">∅</a>        <a id="10969" href="lagda.2023-11-21-nbe.html#10889" class="Function Operator">≤?</a> <a id="10972" class="Symbol">(_</a> <a id="10975" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="10977" class="Symbol">_)</a>    <a id="10983" class="Symbol">=</a> <a id="10985" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="10988" class="Symbol">λ()</a>
<a id="10992" class="Symbol">(_</a> <a id="10995" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="10997" class="Symbol">_)</a>  <a id="11001" href="lagda.2023-11-21-nbe.html#10889" class="Function Operator">≤?</a> <a id="11004" href="lagda.2023-11-21-nbe.html#3944" class="InductiveConstructor">∅</a>          <a id="11015" class="Symbol">=</a> <a id="11017" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="11021" href="lagda.2023-11-21-nbe.html#11033" class="Function">Γ≤∅</a> <a id="11025" class="Keyword">where</a>
  <a id="11033" href="lagda.2023-11-21-nbe.html#11033" class="Function">Γ≤∅</a> <a id="11037" class="Symbol">:</a> <a id="11039" class="Symbol">∀</a> <a id="11041" class="Symbol">{</a><a id="11042" href="lagda.2023-11-21-nbe.html#11042" class="Bound">Γ</a> <a id="11044" class="Symbol">:</a> <a id="11046" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="11049" class="Symbol">}</a> <a id="11051" class="Symbol">→</a> <a id="11053" href="lagda.2023-11-21-nbe.html#11042" class="Bound">Γ</a> <a id="11055" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="11057" href="lagda.2023-11-21-nbe.html#3944" class="InductiveConstructor">∅</a>
  <a id="11061" href="lagda.2023-11-21-nbe.html#11033" class="Function">Γ≤∅</a> <a id="11065" class="Symbol">{</a><a id="11066" href="lagda.2023-11-21-nbe.html#3944" class="InductiveConstructor">∅</a><a id="11067" class="Symbol">}</a>     <a id="11073" class="Symbol">=</a> <a id="11075" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a>
  <a id="11082" href="lagda.2023-11-21-nbe.html#11033" class="Function">Γ≤∅</a> <a id="11086" class="Symbol">{</a><a id="11087" href="lagda.2023-11-21-nbe.html#11087" class="Bound">Γ</a> <a id="11089" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="11091" class="Symbol">_}</a> <a id="11094" class="Symbol">=</a> <a id="11096" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="11102" href="lagda.2023-11-21-nbe.html#11033" class="Function">Γ≤∅</a>
<a id="11106" class="Symbol">(</a><a id="11107" href="lagda.2023-11-21-nbe.html#11107" class="Bound">Γ′</a> <a id="11110" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="11112" href="lagda.2023-11-21-nbe.html#11112" class="Bound">T</a><a id="11113" class="Symbol">)</a> <a id="11115" href="lagda.2023-11-21-nbe.html#10889" class="Function Operator">≤?</a> <a id="11118" href="lagda.2023-11-21-nbe.html#11118" class="Bound">Γ</a><a id="11119" class="Symbol">@(_</a> <a id="11123" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="11125" class="Symbol">_)</a>
  <a id="11130" class="Keyword">with</a> <a id="11135" class="Symbol">(</a><a id="11136" href="lagda.2023-11-21-nbe.html#11107" class="Bound">Γ′</a> <a id="11139" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="11141" href="lagda.2023-11-21-nbe.html#11112" class="Bound">T</a><a id="11142" class="Symbol">)</a> <a id="11144" href="lagda.2023-11-21-nbe.html#10263" class="Function Operator">≟Ctx</a> <a id="11149" href="lagda.2023-11-21-nbe.html#11118" class="Bound">Γ</a>
<a id="11151" class="Symbol">...</a>  <a id="11156" class="Symbol">|</a> <a id="11158" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="11162" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>        <a id="11174" class="Symbol">=</a> <a id="11176" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="11180" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a>
<a id="11185" class="Symbol">...</a>  <a id="11190" class="Symbol">|</a> <a id="11192" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="11195" href="lagda.2023-11-21-nbe.html#11195" class="Bound">Γ′≢Γ</a>
  <a id="11202" class="Keyword">with</a> <a id="11207" class="Bound">Γ′</a> <a id="11210" href="lagda.2023-11-21-nbe.html#10889" class="Function Operator">≤?</a> <a id="11213" class="Bound">Γ</a>
<a id="11215" class="Symbol">...</a>  <a id="11220" class="Symbol">|</a> <a id="11222" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="11226" href="lagda.2023-11-21-nbe.html#11226" class="Bound">pf</a>          <a id="11238" class="Symbol">=</a> <a id="11240" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="11244" class="Symbol">(</a><a id="11245" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="11251" href="lagda.2023-11-21-nbe.html#11226" class="Bound">pf</a><a id="11253" class="Symbol">)</a>
<a id="11255" class="Symbol">...</a>  <a id="11260" class="Symbol">|</a> <a id="11262" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="11265" href="lagda.2023-11-21-nbe.html#11265" class="Bound">¬pf</a>          <a id="11278" class="Symbol">=</a> <a id="11280" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="11283" class="Symbol">λ</a> <a id="11285" class="Keyword">where</a>
                           <a id="11318" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a>       <a id="11329" class="Symbol">→</a> <a id="11331" class="Bound">Γ′≢Γ</a> <a id="11336" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
                           <a id="11368" class="Symbol">(</a><a id="11369" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="11375" href="lagda.2023-11-21-nbe.html#11375" class="Bound">pf</a><a id="11377" class="Symbol">)</a> <a id="11379" class="Symbol">→</a> <a id="11381" href="lagda.2023-11-21-nbe.html#11265" class="Bound">¬pf</a> <a id="11385" href="lagda.2023-11-21-nbe.html#11375" class="Bound">pf</a>
</pre>
<h4 id="substitution">Substitution</h4>
<p>A parallel substitution <code>Γ ⊢ σ : Δ</code> provides a term in <code>Γ</code> to substitute for
each variable in the context <code>Δ</code>. In other words, a substitution <code>σ</code> is a
function from variables in a context to terms in another context.</p>
<pre class="Agda"><a id="Sub"></a><a id="11638" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="11642" class="Symbol">:</a> <a id="11644" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a> <a id="11648" class="Symbol">→</a> <a id="11650" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a> <a id="11654" class="Symbol">→</a> <a id="11656" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="11660" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="11664" href="lagda.2023-11-21-nbe.html#11664" class="Bound">Γ</a> <a id="11666" href="lagda.2023-11-21-nbe.html#11666" class="Bound">Δ</a> <a id="11668" class="Symbol">=</a> <a id="11670" class="Symbol">∀</a> <a id="11672" class="Symbol">{</a><a id="11673" href="lagda.2023-11-21-nbe.html#11673" class="Bound">T</a> <a id="11675" class="Symbol">:</a> <a id="11677" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="11681" class="Symbol">}</a> <a id="11683" class="Symbol">→</a> <a id="11685" href="lagda.2023-11-21-nbe.html#11666" class="Bound">Δ</a> <a id="11687" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="11689" href="lagda.2023-11-21-nbe.html#11673" class="Bound">T</a> <a id="11691" class="Symbol">→</a> <a id="11693" href="lagda.2023-11-21-nbe.html#11664" class="Bound">Γ</a> <a id="11695" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="11697" href="lagda.2023-11-21-nbe.html#11673" class="Bound">T</a>
</pre>
<p>To actually use a substitution, an operation is needed to apply the substitution
to a term in the context being used by the substitution:</p>
<pre><code>Δ ⊢ σ : Γ      Δ ⊢ t : T
------------------------
     Γ ⊢ t[σ] : T</code></pre>
<p>This operation would allow for transforming a term <code>t</code> that is well-typed in the
context <code>Δ</code> using a substitution <code>σ</code> that maps every variable in <code>Δ</code> to a term
that is well-typed in <code>Γ</code>.</p>
<p>Defining this operation is actually a little tricky in Agda, because the
typical definition of the application of a substitution <code>σ</code> is not obviously
terminating. To solve this problem, it is necessary to separately define a
smaller subset of substitution: renaming.</p>
<p>A renaming is a specialized substitution where the only terms that can be
substituted for variables are other variables (i.e. a renaming <code>Γ ⊢ ρ : Δ</code>
provides a variable in <code>Γ</code>, not a term in <code>Γ</code>, to replace for every variable
in <code>Δ</code>).</p>
<pre class="Agda"><a id="Ren"></a><a id="12625" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="12629" class="Symbol">:</a> <a id="12631" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a> <a id="12635" class="Symbol">→</a> <a id="12637" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a> <a id="12641" class="Symbol">→</a> <a id="12643" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="12647" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="12651" href="lagda.2023-11-21-nbe.html#12651" class="Bound">Γ</a> <a id="12653" href="lagda.2023-11-21-nbe.html#12653" class="Bound">Δ</a> <a id="12655" class="Symbol">=</a> <a id="12657" class="Symbol">∀</a> <a id="12659" class="Symbol">{</a><a id="12660" href="lagda.2023-11-21-nbe.html#12660" class="Bound">T</a> <a id="12662" class="Symbol">:</a> <a id="12664" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="12668" class="Symbol">}</a> <a id="12670" class="Symbol">→</a> <a id="12672" href="lagda.2023-11-21-nbe.html#12653" class="Bound">Δ</a> <a id="12674" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="12676" href="lagda.2023-11-21-nbe.html#12660" class="Bound">T</a> <a id="12678" class="Symbol">→</a> <a id="12680" href="lagda.2023-11-21-nbe.html#12651" class="Bound">Γ</a> <a id="12682" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="12684" href="lagda.2023-11-21-nbe.html#12660" class="Bound">T</a>
</pre>
<p>Any renaming can be transformed to the more general definition for
substitutions:</p>
<pre class="Agda"><a id="ren"></a><a id="12782" href="lagda.2023-11-21-nbe.html#12782" class="Function">ren</a> <a id="12786" class="Symbol">:</a> <a id="12788" class="Symbol">∀</a> <a id="12790" class="Symbol">{</a><a id="12791" href="lagda.2023-11-21-nbe.html#12791" class="Bound">Γ</a> <a id="12793" href="lagda.2023-11-21-nbe.html#12793" class="Bound">Δ</a> <a id="12795" class="Symbol">:</a> <a id="12797" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="12800" class="Symbol">}</a> <a id="12802" class="Symbol">→</a> <a id="12804" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="12808" href="lagda.2023-11-21-nbe.html#12791" class="Bound">Γ</a> <a id="12810" href="lagda.2023-11-21-nbe.html#12793" class="Bound">Δ</a> <a id="12812" class="Symbol">→</a> <a id="12814" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="12818" href="lagda.2023-11-21-nbe.html#12791" class="Bound">Γ</a> <a id="12820" href="lagda.2023-11-21-nbe.html#12793" class="Bound">Δ</a>
<a id="12822" href="lagda.2023-11-21-nbe.html#12782" class="Function">ren</a> <a id="12826" href="lagda.2023-11-21-nbe.html#12826" class="Bound">ρ</a> <a id="12828" href="lagda.2023-11-21-nbe.html#12828" class="Bound">x</a> <a id="12830" class="Symbol">=</a> <a id="12832" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="12834" href="lagda.2023-11-21-nbe.html#12826" class="Bound">ρ</a> <a id="12836" href="lagda.2023-11-21-nbe.html#12828" class="Bound">x</a>
</pre>
<p>Two renamings that will be especially relevant are the identity renaming (which
substitutes variables for themselves) and the shifting renaming (which shifts
all variables by 1). To indicate that these are renamings specifically (as they
will also be defined for the more general definition of substitutions), the
superscript <code>ʳ</code> is used.</p>
<pre class="Agda"><a id="idʳ"></a><a id="13191" href="lagda.2023-11-21-nbe.html#13191" class="Function">idʳ</a> <a id="13195" class="Symbol">:</a> <a id="13197" class="Symbol">∀</a> <a id="13199" class="Symbol">{</a><a id="13200" href="lagda.2023-11-21-nbe.html#13200" class="Bound">Γ</a> <a id="13202" class="Symbol">:</a> <a id="13204" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="13207" class="Symbol">}</a> <a id="13209" class="Symbol">→</a> <a id="13211" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="13215" href="lagda.2023-11-21-nbe.html#13200" class="Bound">Γ</a> <a id="13217" href="lagda.2023-11-21-nbe.html#13200" class="Bound">Γ</a>
<a id="13219" href="lagda.2023-11-21-nbe.html#13191" class="Function">idʳ</a> <a id="13223" href="lagda.2023-11-21-nbe.html#13223" class="Bound">x</a> <a id="13225" class="Symbol">=</a> <a id="13227" href="lagda.2023-11-21-nbe.html#13223" class="Bound">x</a>

<a id="↥ʳ"></a><a id="13230" href="lagda.2023-11-21-nbe.html#13230" class="Function">↥ʳ</a> <a id="13233" class="Symbol">:</a> <a id="13235" class="Symbol">∀</a> <a id="13237" class="Symbol">{</a><a id="13238" href="lagda.2023-11-21-nbe.html#13238" class="Bound">Γ</a> <a id="13240" class="Symbol">:</a> <a id="13242" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="13245" class="Symbol">}</a> <a id="13247" class="Symbol">{</a><a id="13248" href="lagda.2023-11-21-nbe.html#13248" class="Bound">T</a> <a id="13250" class="Symbol">:</a> <a id="13252" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="13256" class="Symbol">}</a> <a id="13258" class="Symbol">→</a> <a id="13260" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="13264" class="Symbol">(</a><a id="13265" href="lagda.2023-11-21-nbe.html#13238" class="Bound">Γ</a> <a id="13267" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="13269" href="lagda.2023-11-21-nbe.html#13248" class="Bound">T</a><a id="13270" class="Symbol">)</a> <a id="13272" href="lagda.2023-11-21-nbe.html#13238" class="Bound">Γ</a>
<a id="13274" href="lagda.2023-11-21-nbe.html#13230" class="Function">↥ʳ</a> <a id="13277" href="lagda.2023-11-21-nbe.html#13277" class="Bound">x</a> <a id="13279" class="Symbol">=</a> <a id="13281" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="13283" href="lagda.2023-11-21-nbe.html#13277" class="Bound">x</a>
</pre>
<p>Any two renamings can also be composed. For a renaming substitution, this is
really just function compostition. Agda’s own symbol for function composition,
<code>∘</code>, is used for this reason (though again with the superscript <code>ʳ</code>).</p>
<pre class="Agda"><a id="_∘ʳ_"></a><a id="13525" href="lagda.2023-11-21-nbe.html#13525" class="Function Operator">_∘ʳ_</a> <a id="13530" class="Symbol">:</a> <a id="13532" class="Symbol">∀</a> <a id="13534" class="Symbol">{</a><a id="13535" href="lagda.2023-11-21-nbe.html#13535" class="Bound">Γ</a> <a id="13537" href="lagda.2023-11-21-nbe.html#13537" class="Bound">Δ</a> <a id="13539" href="lagda.2023-11-21-nbe.html#13539" class="Bound">Σ</a> <a id="13541" class="Symbol">:</a> <a id="13543" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="13546" class="Symbol">}</a> <a id="13548" class="Symbol">→</a> <a id="13550" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="13554" href="lagda.2023-11-21-nbe.html#13537" class="Bound">Δ</a> <a id="13556" href="lagda.2023-11-21-nbe.html#13535" class="Bound">Γ</a> <a id="13558" class="Symbol">→</a> <a id="13560" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="13564" href="lagda.2023-11-21-nbe.html#13539" class="Bound">Σ</a> <a id="13566" href="lagda.2023-11-21-nbe.html#13537" class="Bound">Δ</a> <a id="13568" class="Symbol">→</a> <a id="13570" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="13574" href="lagda.2023-11-21-nbe.html#13539" class="Bound">Σ</a> <a id="13576" href="lagda.2023-11-21-nbe.html#13535" class="Bound">Γ</a>
<a id="13578" href="lagda.2023-11-21-nbe.html#13578" class="Bound">ρ</a> <a id="13580" href="lagda.2023-11-21-nbe.html#13525" class="Function Operator">∘ʳ</a> <a id="13583" href="lagda.2023-11-21-nbe.html#13583" class="Bound">ω</a> <a id="13585" class="Symbol">=</a> <a id="13587" class="Symbol">λ</a> <a id="13589" href="lagda.2023-11-21-nbe.html#13589" class="Bound">x</a> <a id="13591" class="Symbol">→</a> <a id="13593" href="lagda.2023-11-21-nbe.html#13583" class="Bound">ω</a> <a id="13595" class="Symbol">(</a><a id="13596" href="lagda.2023-11-21-nbe.html#13578" class="Bound">ρ</a> <a id="13598" href="lagda.2023-11-21-nbe.html#13589" class="Bound">x</a><a id="13599" class="Symbol">)</a>
</pre>
<!---
<pre class="Agda"><a id="13620" class="Keyword">infixr</a> <a id="13627" class="Number">9</a> <a id="13629" href="lagda.2023-11-21-nbe.html#13525" class="Function Operator">_∘ʳ_</a>
</pre>--->
<p>It is possible to define a renaming for a context <code>Γ′</code> using a context <code>Γ</code> that
it extends by composing many shifting renamings, ending finally at the identity
renaming.</p>
<pre class="Agda"><a id="ρ-≤"></a><a id="13819" href="lagda.2023-11-21-nbe.html#13819" class="Function">ρ-≤</a> <a id="13823" class="Symbol">:</a> <a id="13825" class="Symbol">∀</a> <a id="13827" class="Symbol">{</a><a id="13828" href="lagda.2023-11-21-nbe.html#13828" class="Bound">Γ′</a> <a id="13831" href="lagda.2023-11-21-nbe.html#13831" class="Bound">Γ</a> <a id="13833" class="Symbol">:</a> <a id="13835" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="13838" class="Symbol">}</a> <a id="13840" class="Symbol">→</a> <a id="13842" href="lagda.2023-11-21-nbe.html#13828" class="Bound">Γ′</a> <a id="13845" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="13847" href="lagda.2023-11-21-nbe.html#13831" class="Bound">Γ</a> <a id="13849" class="Symbol">→</a> <a id="13851" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="13855" href="lagda.2023-11-21-nbe.html#13828" class="Bound">Γ′</a> <a id="13858" href="lagda.2023-11-21-nbe.html#13831" class="Bound">Γ</a>
<a id="13860" href="lagda.2023-11-21-nbe.html#13819" class="Function">ρ-≤</a> <a id="13864" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a>       <a id="13875" class="Symbol">=</a> <a id="13877" href="lagda.2023-11-21-nbe.html#13191" class="Function">idʳ</a>
<a id="13881" href="lagda.2023-11-21-nbe.html#13819" class="Function">ρ-≤</a> <a id="13885" class="Symbol">(</a><a id="13886" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="13892" href="lagda.2023-11-21-nbe.html#13892" class="Bound">pf</a><a id="13894" class="Symbol">)</a> <a id="13896" class="Symbol">=</a> <a id="13898" href="lagda.2023-11-21-nbe.html#13819" class="Function">ρ-≤</a> <a id="13902" href="lagda.2023-11-21-nbe.html#13892" class="Bound">pf</a> <a id="13905" href="lagda.2023-11-21-nbe.html#13525" class="Function Operator">∘ʳ</a> <a id="13908" href="lagda.2023-11-21-nbe.html#13230" class="Function">↥ʳ</a>
</pre>
<p>The application of a renaming substituion <code>Γ ⊢ ρ : Δ</code> to a term <code>Δ ⊢ t : T</code>
rebases the term to the context <code>Γ</code>. This is done by “distributing” the
renaming substitution across all subterms of the term, renaming all variables
used in the term with their corresponding variable in <code>Γ</code>. When going under a
binder, the renaming substitution has to be “extended” (<code>ext</code>) to now use the
newly bound variable <code>𝑍</code>.</p>
<pre class="Agda"><a id="ext"></a><a id="14333" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="14337" class="Symbol">:</a> <a id="14339" class="Symbol">∀</a> <a id="14341" class="Symbol">{</a><a id="14342" href="lagda.2023-11-21-nbe.html#14342" class="Bound">Γ</a> <a id="14344" href="lagda.2023-11-21-nbe.html#14344" class="Bound">Δ</a> <a id="14346" class="Symbol">:</a> <a id="14348" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="14351" class="Symbol">}</a> <a id="14353" class="Symbol">→</a> <a id="14355" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="14359" href="lagda.2023-11-21-nbe.html#14342" class="Bound">Γ</a> <a id="14361" href="lagda.2023-11-21-nbe.html#14344" class="Bound">Δ</a> <a id="14363" class="Symbol">→</a> <a id="14365" class="Symbol">∀</a> <a id="14367" class="Symbol">{</a><a id="14368" href="lagda.2023-11-21-nbe.html#14368" class="Bound">T</a> <a id="14370" class="Symbol">:</a> <a id="14372" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="14376" class="Symbol">}</a> <a id="14378" class="Symbol">→</a> <a id="14380" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="14384" class="Symbol">(</a><a id="14385" href="lagda.2023-11-21-nbe.html#14342" class="Bound">Γ</a> <a id="14387" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="14389" href="lagda.2023-11-21-nbe.html#14368" class="Bound">T</a><a id="14390" class="Symbol">)</a> <a id="14392" class="Symbol">(</a><a id="14393" href="lagda.2023-11-21-nbe.html#14344" class="Bound">Δ</a> <a id="14395" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="14397" href="lagda.2023-11-21-nbe.html#14368" class="Bound">T</a><a id="14398" class="Symbol">)</a>
<a id="14400" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="14404" href="lagda.2023-11-21-nbe.html#14404" class="Bound">ρ</a> <a id="14406" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>     <a id="14412" class="Symbol">=</a> <a id="14414" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>
<a id="14416" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="14420" href="lagda.2023-11-21-nbe.html#14420" class="Bound">ρ</a> <a id="14422" class="Symbol">(</a><a id="14423" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="14425" href="lagda.2023-11-21-nbe.html#14425" class="Bound">x</a><a id="14426" class="Symbol">)</a> <a id="14428" class="Symbol">=</a> <a id="14430" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="14432" href="lagda.2023-11-21-nbe.html#14420" class="Bound">ρ</a> <a id="14434" href="lagda.2023-11-21-nbe.html#14425" class="Bound">x</a>

<a id="_[_]ʳ"></a><a id="14437" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">_[_]ʳ</a> <a id="14443" class="Symbol">:</a> <a id="14445" class="Symbol">∀</a> <a id="14447" class="Symbol">{</a><a id="14448" href="lagda.2023-11-21-nbe.html#14448" class="Bound">Γ</a> <a id="14450" href="lagda.2023-11-21-nbe.html#14450" class="Bound">Δ</a> <a id="14452" class="Symbol">:</a> <a id="14454" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="14457" class="Symbol">}</a> <a id="14459" class="Symbol">{</a><a id="14460" href="lagda.2023-11-21-nbe.html#14460" class="Bound">T</a> <a id="14462" class="Symbol">:</a> <a id="14464" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="14468" class="Symbol">}</a>
      <a id="14476" class="Symbol">→</a> <a id="14478" href="lagda.2023-11-21-nbe.html#14450" class="Bound">Δ</a> <a id="14480" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="14482" href="lagda.2023-11-21-nbe.html#14460" class="Bound">T</a>
      <a id="14490" class="Symbol">→</a> <a id="14492" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="14496" href="lagda.2023-11-21-nbe.html#14448" class="Bound">Γ</a> <a id="14498" href="lagda.2023-11-21-nbe.html#14450" class="Bound">Δ</a>
        <a id="14508" class="Comment">-------</a>
      <a id="14522" class="Symbol">→</a> <a id="14524" href="lagda.2023-11-21-nbe.html#14448" class="Bound">Γ</a> <a id="14526" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="14528" href="lagda.2023-11-21-nbe.html#14460" class="Bound">T</a>
<a id="14530" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a> <a id="14535" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">[</a> <a id="14537" class="Symbol">_</a> <a id="14539" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">]ʳ</a>    <a id="14545" class="Symbol">=</a> <a id="14547" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a>
<a id="14552" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="14554" href="lagda.2023-11-21-nbe.html#14554" class="Bound">x</a> <a id="14556" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">[</a> <a id="14558" href="lagda.2023-11-21-nbe.html#14558" class="Bound">ρ</a> <a id="14560" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">]ʳ</a>     <a id="14567" class="Symbol">=</a> <a id="14569" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="14571" href="lagda.2023-11-21-nbe.html#14558" class="Bound">ρ</a> <a id="14573" href="lagda.2023-11-21-nbe.html#14554" class="Bound">x</a>
<a id="14575" class="Symbol">(</a><a id="14576" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="14578" href="lagda.2023-11-21-nbe.html#14578" class="Bound">t</a><a id="14579" class="Symbol">)</a> <a id="14581" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">[</a> <a id="14583" href="lagda.2023-11-21-nbe.html#14583" class="Bound">ρ</a> <a id="14585" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">]ʳ</a>   <a id="14590" class="Symbol">=</a> <a id="14592" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="14594" href="lagda.2023-11-21-nbe.html#14578" class="Bound">t</a> <a id="14596" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">[</a> <a id="14598" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="14602" href="lagda.2023-11-21-nbe.html#14583" class="Bound">ρ</a> <a id="14604" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">]ʳ</a>
<a id="14607" class="Symbol">(</a><a id="14608" href="lagda.2023-11-21-nbe.html#14608" class="Bound">r</a> <a id="14610" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="14612" href="lagda.2023-11-21-nbe.html#14612" class="Bound">s</a><a id="14613" class="Symbol">)</a> <a id="14615" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">[</a> <a id="14617" href="lagda.2023-11-21-nbe.html#14617" class="Bound">ρ</a> <a id="14619" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">]ʳ</a> <a id="14622" class="Symbol">=</a> <a id="14624" href="lagda.2023-11-21-nbe.html#14608" class="Bound">r</a> <a id="14626" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">[</a> <a id="14628" href="lagda.2023-11-21-nbe.html#14617" class="Bound">ρ</a> <a id="14630" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">]ʳ</a> <a id="14633" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="14635" href="lagda.2023-11-21-nbe.html#14612" class="Bound">s</a> <a id="14637" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">[</a> <a id="14639" href="lagda.2023-11-21-nbe.html#14617" class="Bound">ρ</a> <a id="14641" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">]ʳ</a>
</pre>
<!---
<pre class="Agda"><a id="14663" class="Keyword">infix</a> <a id="14669" class="Number">8</a> <a id="14671" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">_[_]ʳ</a>
</pre>--->
<p>With the application of a renaming substitution, it is now possible to define
the application of any general substitution such that it is guaranteed to
terminate. Extending the terms in the substitution under a binder requires
applying a shifting substitution to every term in the binder. By defining
the application of renaming substitutions separately, extending a substitution
can be done such that the overall definition of the application <code>Γ ⊢ t [ σ ]: T</code>
of a substitution <code>Γ ⊢ σ : Δ</code> is guaranteed to be terminating. The definition is
very similar to the more specific application of a renaming substitution, except
variables are now being replcaed with entire terms.</p>
<pre class="Agda"><a id="exts"></a><a id="15372" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="15377" class="Symbol">:</a> <a id="15379" class="Symbol">∀</a> <a id="15381" class="Symbol">{</a><a id="15382" href="lagda.2023-11-21-nbe.html#15382" class="Bound">Γ</a> <a id="15384" href="lagda.2023-11-21-nbe.html#15384" class="Bound">Δ</a> <a id="15386" class="Symbol">:</a> <a id="15388" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="15391" class="Symbol">}</a> <a id="15393" class="Symbol">→</a> <a id="15395" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="15399" href="lagda.2023-11-21-nbe.html#15382" class="Bound">Γ</a> <a id="15401" href="lagda.2023-11-21-nbe.html#15384" class="Bound">Δ</a> <a id="15403" class="Symbol">→</a> <a id="15405" class="Symbol">∀</a> <a id="15407" class="Symbol">{</a><a id="15408" href="lagda.2023-11-21-nbe.html#15408" class="Bound">T</a> <a id="15410" class="Symbol">:</a> <a id="15412" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="15416" class="Symbol">}</a> <a id="15418" class="Symbol">→</a> <a id="15420" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="15424" class="Symbol">(</a><a id="15425" href="lagda.2023-11-21-nbe.html#15382" class="Bound">Γ</a> <a id="15427" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="15429" href="lagda.2023-11-21-nbe.html#15408" class="Bound">T</a><a id="15430" class="Symbol">)</a> <a id="15432" class="Symbol">(</a><a id="15433" href="lagda.2023-11-21-nbe.html#15384" class="Bound">Δ</a> <a id="15435" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="15437" href="lagda.2023-11-21-nbe.html#15408" class="Bound">T</a><a id="15438" class="Symbol">)</a>
<a id="15440" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="15445" href="lagda.2023-11-21-nbe.html#15445" class="Bound">σ</a> <a id="15447" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>     <a id="15453" class="Symbol">=</a> <a id="15455" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="15457" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>
<a id="15459" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="15464" href="lagda.2023-11-21-nbe.html#15464" class="Bound">σ</a> <a id="15466" class="Symbol">(</a><a id="15467" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="15469" href="lagda.2023-11-21-nbe.html#15469" class="Bound">x</a><a id="15470" class="Symbol">)</a> <a id="15472" class="Symbol">=</a> <a id="15474" class="Symbol">(</a><a id="15475" href="lagda.2023-11-21-nbe.html#15464" class="Bound">σ</a> <a id="15477" href="lagda.2023-11-21-nbe.html#15469" class="Bound">x</a><a id="15478" class="Symbol">)</a> <a id="15480" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">[</a> <a id="15482" href="lagda.2023-11-21-nbe.html#13230" class="Function">↥ʳ</a> <a id="15485" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">]ʳ</a>

<a id="_[_]"></a><a id="15489" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">_[_]</a> <a id="15494" class="Symbol">:</a> <a id="15496" class="Symbol">∀</a> <a id="15498" class="Symbol">{</a><a id="15499" href="lagda.2023-11-21-nbe.html#15499" class="Bound">Γ</a> <a id="15501" href="lagda.2023-11-21-nbe.html#15501" class="Bound">Δ</a> <a id="15503" class="Symbol">:</a> <a id="15505" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="15508" class="Symbol">}</a> <a id="15510" class="Symbol">{</a><a id="15511" href="lagda.2023-11-21-nbe.html#15511" class="Bound">T</a> <a id="15513" class="Symbol">:</a> <a id="15515" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="15519" class="Symbol">}</a>
     <a id="15526" class="Symbol">→</a> <a id="15528" href="lagda.2023-11-21-nbe.html#15501" class="Bound">Δ</a> <a id="15530" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="15532" href="lagda.2023-11-21-nbe.html#15511" class="Bound">T</a>
     <a id="15539" class="Symbol">→</a> <a id="15541" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="15545" href="lagda.2023-11-21-nbe.html#15499" class="Bound">Γ</a> <a id="15547" href="lagda.2023-11-21-nbe.html#15501" class="Bound">Δ</a>
       <a id="15556" class="Comment">-------</a>
     <a id="15569" class="Symbol">→</a> <a id="15571" href="lagda.2023-11-21-nbe.html#15499" class="Bound">Γ</a> <a id="15573" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="15575" href="lagda.2023-11-21-nbe.html#15511" class="Bound">T</a>
<a id="15577" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a> <a id="15582" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="15584" class="Symbol">_</a> <a id="15586" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a>    <a id="15591" class="Symbol">=</a> <a id="15593" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a>
<a id="15598" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="15600" href="lagda.2023-11-21-nbe.html#15600" class="Bound">x</a> <a id="15602" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="15604" href="lagda.2023-11-21-nbe.html#15604" class="Bound">σ</a> <a id="15606" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a>     <a id="15612" class="Symbol">=</a> <a id="15614" href="lagda.2023-11-21-nbe.html#15604" class="Bound">σ</a> <a id="15616" href="lagda.2023-11-21-nbe.html#15600" class="Bound">x</a>
<a id="15618" class="Symbol">(</a><a id="15619" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="15621" href="lagda.2023-11-21-nbe.html#15621" class="Bound">t</a><a id="15622" class="Symbol">)</a> <a id="15624" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="15626" href="lagda.2023-11-21-nbe.html#15626" class="Bound">σ</a> <a id="15628" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a>   <a id="15632" class="Symbol">=</a> <a id="15634" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="15636" href="lagda.2023-11-21-nbe.html#15621" class="Bound">t</a> <a id="15638" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="15640" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="15645" href="lagda.2023-11-21-nbe.html#15626" class="Bound">σ</a> <a id="15647" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a>
<a id="15649" class="Symbol">(</a><a id="15650" href="lagda.2023-11-21-nbe.html#15650" class="Bound">r</a> <a id="15652" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="15654" href="lagda.2023-11-21-nbe.html#15654" class="Bound">s</a><a id="15655" class="Symbol">)</a> <a id="15657" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="15659" href="lagda.2023-11-21-nbe.html#15659" class="Bound">σ</a> <a id="15661" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a> <a id="15663" class="Symbol">=</a> <a id="15665" href="lagda.2023-11-21-nbe.html#15650" class="Bound">r</a> <a id="15667" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="15669" href="lagda.2023-11-21-nbe.html#15659" class="Bound">σ</a> <a id="15671" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a> <a id="15673" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="15675" href="lagda.2023-11-21-nbe.html#15654" class="Bound">s</a> <a id="15677" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="15679" href="lagda.2023-11-21-nbe.html#15659" class="Bound">σ</a> <a id="15681" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a>
</pre>
<!---
<pre class="Agda"><a id="15698" class="Keyword">infix</a> <a id="15704" class="Number">8</a> <a id="15706" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">_[_]</a>
</pre>--->
<p>The more general identity and shifting substitutions are defined exactly as they
were for renamings, except now the variable term is used. Parallel substitutions
can also be composed, by applying a substitution <code>Γ ⊢ τ : Δ</code> to every term in a
substitution <code>Δ ⊢ σ : Σ</code>.</p>
<pre class="Agda"><a id="id"></a><a id="15998" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="16001" class="Symbol">:</a> <a id="16003" class="Symbol">∀</a> <a id="16005" class="Symbol">{</a><a id="16006" href="lagda.2023-11-21-nbe.html#16006" class="Bound">Γ</a> <a id="16008" class="Symbol">:</a> <a id="16010" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="16013" class="Symbol">}</a> <a id="16015" class="Symbol">→</a> <a id="16017" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="16021" href="lagda.2023-11-21-nbe.html#16006" class="Bound">Γ</a> <a id="16023" href="lagda.2023-11-21-nbe.html#16006" class="Bound">Γ</a>
<a id="16025" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="16028" href="lagda.2023-11-21-nbe.html#16028" class="Bound">x</a> <a id="16030" class="Symbol">=</a> <a id="16032" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="16034" href="lagda.2023-11-21-nbe.html#16028" class="Bound">x</a>

<a id="↥"></a><a id="16037" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a> <a id="16039" class="Symbol">:</a> <a id="16041" class="Symbol">∀</a> <a id="16043" class="Symbol">{</a><a id="16044" href="lagda.2023-11-21-nbe.html#16044" class="Bound">Γ</a> <a id="16046" class="Symbol">:</a> <a id="16048" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="16051" class="Symbol">}</a> <a id="16053" class="Symbol">{</a><a id="16054" href="lagda.2023-11-21-nbe.html#16054" class="Bound">T</a> <a id="16056" class="Symbol">:</a> <a id="16058" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="16062" class="Symbol">}</a> <a id="16064" class="Symbol">→</a> <a id="16066" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="16070" class="Symbol">(</a><a id="16071" href="lagda.2023-11-21-nbe.html#16044" class="Bound">Γ</a> <a id="16073" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="16075" href="lagda.2023-11-21-nbe.html#16054" class="Bound">T</a><a id="16076" class="Symbol">)</a> <a id="16078" href="lagda.2023-11-21-nbe.html#16044" class="Bound">Γ</a>
<a id="16080" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a> <a id="16082" href="lagda.2023-11-21-nbe.html#16082" class="Bound">x</a> <a id="16084" class="Symbol">=</a> <a id="16086" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="16088" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="16090" href="lagda.2023-11-21-nbe.html#16082" class="Bound">x</a>

<a id="_∘_"></a><a id="16093" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">_∘_</a> <a id="16097" class="Symbol">:</a> <a id="16099" class="Symbol">∀</a> <a id="16101" class="Symbol">{</a><a id="16102" href="lagda.2023-11-21-nbe.html#16102" class="Bound">Γ</a> <a id="16104" href="lagda.2023-11-21-nbe.html#16104" class="Bound">Δ</a> <a id="16106" href="lagda.2023-11-21-nbe.html#16106" class="Bound">Σ</a> <a id="16108" class="Symbol">:</a> <a id="16110" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="16113" class="Symbol">}</a> <a id="16115" class="Symbol">→</a> <a id="16117" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="16121" href="lagda.2023-11-21-nbe.html#16104" class="Bound">Δ</a> <a id="16123" href="lagda.2023-11-21-nbe.html#16102" class="Bound">Γ</a> <a id="16125" class="Symbol">→</a> <a id="16127" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="16131" href="lagda.2023-11-21-nbe.html#16106" class="Bound">Σ</a> <a id="16133" href="lagda.2023-11-21-nbe.html#16104" class="Bound">Δ</a> <a id="16135" class="Symbol">→</a> <a id="16137" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="16141" href="lagda.2023-11-21-nbe.html#16106" class="Bound">Σ</a> <a id="16143" href="lagda.2023-11-21-nbe.html#16102" class="Bound">Γ</a>
<a id="16145" class="Symbol">(</a><a id="16146" href="lagda.2023-11-21-nbe.html#16146" class="Bound">σ</a> <a id="16148" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="16150" href="lagda.2023-11-21-nbe.html#16150" class="Bound">τ</a><a id="16151" class="Symbol">)</a> <a id="16153" href="lagda.2023-11-21-nbe.html#16153" class="Bound">x</a> <a id="16155" class="Symbol">=</a> <a id="16157" class="Symbol">(</a><a id="16158" href="lagda.2023-11-21-nbe.html#16146" class="Bound">σ</a> <a id="16160" href="lagda.2023-11-21-nbe.html#16153" class="Bound">x</a><a id="16161" class="Symbol">)</a> <a id="16163" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="16165" href="lagda.2023-11-21-nbe.html#16150" class="Bound">τ</a> <a id="16167" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a>
</pre>
<p>Any substitution <code>Γ ⊢ σ : Δ</code> can be have a well-typed term <code>Γ ⊢ s : S</code> added to
it as well, which will be written as <code>Γ ⊢ σ ∷ s : Δ, x:S</code> (with <code>∷</code> used for
“cons”). This operation is similar to the extension <code>exts</code> of a substitution,
except that terms in the substitution do not need to be shifted (and in fact,
<code>exts σ</code> is equivalent to <code>(σ ∘ ↥) ∷ # 𝑍</code>).</p>
<pre class="Agda"><a id="_∷_"></a><a id="16540" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">_∷_</a> <a id="16544" class="Symbol">:</a> <a id="16546" class="Symbol">∀</a> <a id="16548" class="Symbol">{</a><a id="16549" href="lagda.2023-11-21-nbe.html#16549" class="Bound">Γ</a> <a id="16551" href="lagda.2023-11-21-nbe.html#16551" class="Bound">Δ</a> <a id="16553" class="Symbol">:</a> <a id="16555" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="16558" class="Symbol">}</a> <a id="16560" class="Symbol">{</a><a id="16561" href="lagda.2023-11-21-nbe.html#16561" class="Bound">S</a> <a id="16563" class="Symbol">:</a> <a id="16565" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="16569" class="Symbol">}</a> <a id="16571" class="Symbol">→</a> <a id="16573" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="16577" href="lagda.2023-11-21-nbe.html#16549" class="Bound">Γ</a> <a id="16579" href="lagda.2023-11-21-nbe.html#16551" class="Bound">Δ</a> <a id="16581" class="Symbol">→</a> <a id="16583" href="lagda.2023-11-21-nbe.html#16549" class="Bound">Γ</a> <a id="16585" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="16587" href="lagda.2023-11-21-nbe.html#16561" class="Bound">S</a> <a id="16589" class="Symbol">→</a> <a id="16591" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="16595" href="lagda.2023-11-21-nbe.html#16549" class="Bound">Γ</a> <a id="16597" class="Symbol">(</a><a id="16598" href="lagda.2023-11-21-nbe.html#16551" class="Bound">Δ</a> <a id="16600" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="16602" href="lagda.2023-11-21-nbe.html#16561" class="Bound">S</a><a id="16603" class="Symbol">)</a>
<a id="16605" class="Symbol">(_</a> <a id="16608" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="16610" href="lagda.2023-11-21-nbe.html#16610" class="Bound">s</a><a id="16611" class="Symbol">)</a> <a id="16613" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>     <a id="16619" class="Symbol">=</a> <a id="16621" href="lagda.2023-11-21-nbe.html#16610" class="Bound">s</a>
<a id="16623" class="Symbol">(</a><a id="16624" href="lagda.2023-11-21-nbe.html#16624" class="Bound">σ</a> <a id="16626" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="16628" class="Symbol">_)</a> <a id="16631" class="Symbol">(</a><a id="16632" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="16634" href="lagda.2023-11-21-nbe.html#16634" class="Bound">x</a><a id="16635" class="Symbol">)</a> <a id="16637" class="Symbol">=</a> <a id="16639" href="lagda.2023-11-21-nbe.html#16624" class="Bound">σ</a> <a id="16641" href="lagda.2023-11-21-nbe.html#16634" class="Bound">x</a>
</pre>
<!---
<pre class="Agda"><a id="16662" class="Keyword">infix</a> <a id="16668" class="Number">8</a> <a id="16670" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">_∷_</a>
<a id="16674" class="Keyword">infixr</a> <a id="16681" class="Number">9</a> <a id="16683" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">_∘_</a>
</pre>--->
<p>Using the renaming substitution for context extension, any well-typed term in
<code>Γ</code> can be “weakened” to a well-typed term in a context <code>Γ′</code>. <code>≤⊢</code> will be used
as shorthand for the application of a weakening substitution (and in Agda, this
will look a lot like an extended judgement: <code>Γ′≤Γ ≤⊢ t</code>).</p>
<pre class="Agda"><a id="weaken"></a><a id="17002" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="17009" class="Symbol">:</a> <a id="17011" class="Symbol">∀</a> <a id="17013" class="Symbol">{</a><a id="17014" href="lagda.2023-11-21-nbe.html#17014" class="Bound">Γ′</a> <a id="17017" href="lagda.2023-11-21-nbe.html#17017" class="Bound">Γ</a> <a id="17019" class="Symbol">:</a> <a id="17021" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="17024" class="Symbol">}</a>
       <a id="17033" class="Symbol">→</a> <a id="17035" href="lagda.2023-11-21-nbe.html#17014" class="Bound">Γ′</a> <a id="17038" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="17040" href="lagda.2023-11-21-nbe.html#17017" class="Bound">Γ</a>
         <a id="17051" class="Comment">--------</a>
       <a id="17067" class="Symbol">→</a> <a id="17069" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="17073" href="lagda.2023-11-21-nbe.html#17014" class="Bound">Γ′</a> <a id="17076" href="lagda.2023-11-21-nbe.html#17017" class="Bound">Γ</a>
<a id="17078" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="17085" href="lagda.2023-11-21-nbe.html#17085" class="Bound">pf</a> <a id="17088" href="lagda.2023-11-21-nbe.html#17088" class="Bound">x</a> <a id="17090" class="Symbol">=</a> <a id="17092" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="17094" href="lagda.2023-11-21-nbe.html#13819" class="Function">ρ-≤</a> <a id="17098" href="lagda.2023-11-21-nbe.html#17085" class="Bound">pf</a> <a id="17101" href="lagda.2023-11-21-nbe.html#17088" class="Bound">x</a>

<a id="_≤⊢_"></a><a id="17104" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">_≤⊢_</a> <a id="17109" class="Symbol">:</a> <a id="17111" class="Symbol">∀</a> <a id="17113" class="Symbol">{</a><a id="17114" href="lagda.2023-11-21-nbe.html#17114" class="Bound">Γ′</a> <a id="17117" href="lagda.2023-11-21-nbe.html#17117" class="Bound">Γ</a> <a id="17119" class="Symbol">:</a> <a id="17121" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="17124" class="Symbol">}</a> <a id="17126" class="Symbol">{</a><a id="17127" href="lagda.2023-11-21-nbe.html#17127" class="Bound">T</a> <a id="17129" class="Symbol">:</a> <a id="17131" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="17135" class="Symbol">}</a> <a id="17137" class="Symbol">→</a> <a id="17139" href="lagda.2023-11-21-nbe.html#17114" class="Bound">Γ′</a> <a id="17142" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="17144" href="lagda.2023-11-21-nbe.html#17117" class="Bound">Γ</a> <a id="17146" class="Symbol">→</a> <a id="17148" href="lagda.2023-11-21-nbe.html#17117" class="Bound">Γ</a> <a id="17150" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="17152" href="lagda.2023-11-21-nbe.html#17127" class="Bound">T</a> <a id="17154" class="Symbol">→</a> <a id="17156" href="lagda.2023-11-21-nbe.html#17114" class="Bound">Γ′</a> <a id="17159" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="17161" href="lagda.2023-11-21-nbe.html#17127" class="Bound">T</a>
<a id="17163" href="lagda.2023-11-21-nbe.html#17163" class="Bound">pf</a> <a id="17166" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="17169" href="lagda.2023-11-21-nbe.html#17169" class="Bound">t</a> <a id="17171" class="Symbol">=</a> <a id="17173" href="lagda.2023-11-21-nbe.html#17169" class="Bound">t</a> <a id="17175" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="17177" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="17184" href="lagda.2023-11-21-nbe.html#17163" class="Bound">pf</a> <a id="17187" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a>
</pre>
<p>It will similarly be useful to introduce shorthand for the application of a
shifting substitution:</p>
<pre class="Agda"><a id="_↥⊢_"></a><a id="17302" href="lagda.2023-11-21-nbe.html#17302" class="Function Operator">_↥⊢_</a> <a id="17307" class="Symbol">:</a> <a id="17309" class="Symbol">∀</a> <a id="17311" class="Symbol">{</a><a id="17312" href="lagda.2023-11-21-nbe.html#17312" class="Bound">Γ</a> <a id="17314" class="Symbol">:</a> <a id="17316" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="17319" class="Symbol">}</a> <a id="17321" class="Symbol">{</a><a id="17322" href="lagda.2023-11-21-nbe.html#17322" class="Bound">T</a> <a id="17324" class="Symbol">:</a> <a id="17326" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="17330" class="Symbol">}</a> <a id="17332" class="Symbol">→</a> <a id="17334" class="Symbol">(</a><a id="17335" href="lagda.2023-11-21-nbe.html#17335" class="Bound">S</a> <a id="17337" class="Symbol">:</a> <a id="17339" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="17343" class="Symbol">)</a> <a id="17345" class="Symbol">→</a> <a id="17347" href="lagda.2023-11-21-nbe.html#17312" class="Bound">Γ</a> <a id="17349" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="17351" href="lagda.2023-11-21-nbe.html#17322" class="Bound">T</a> <a id="17353" class="Symbol">→</a> <a id="17355" href="lagda.2023-11-21-nbe.html#17312" class="Bound">Γ</a> <a id="17357" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="17359" href="lagda.2023-11-21-nbe.html#17335" class="Bound">S</a> <a id="17361" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="17363" href="lagda.2023-11-21-nbe.html#17322" class="Bound">T</a>
<a id="17365" class="Symbol">_</a> <a id="17367" href="lagda.2023-11-21-nbe.html#17302" class="Function Operator">↥⊢</a> <a id="17370" href="lagda.2023-11-21-nbe.html#17370" class="Bound">t</a> <a id="17372" class="Symbol">=</a> <a id="17374" href="lagda.2023-11-21-nbe.html#17370" class="Bound">t</a> <a id="17376" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="17378" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a> <a id="17380" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a>
</pre>
<!---
<pre class="Agda"><a id="17397" class="Keyword">infixr</a> <a id="17404" class="Number">5</a> <a id="17406" href="lagda.2023-11-21-nbe.html#17302" class="Function Operator">_↥⊢_</a>
<a id="17411" class="Keyword">infixr</a> <a id="17418" class="Number">5</a> <a id="17420" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">_≤⊢_</a>
</pre>--->
<p>To actually prove results about terms, a number of substitution lemmas will be
necessary. Their proofs are omitted, though they are directly inspired from the
<a href="https://plfa.github.io/20.07/Substitution/">Substitution</a> chapter of PLFA. The
most import ones are <code>sub-sub</code> (substitutions can be composed) and
<code>[id]-identity</code> (the application of the identity substitution is an identity).</p>
<!---
<pre class="Agda"><a id="sub-tail"></a><a id="17835" href="lagda.2023-11-21-nbe.html#17835" class="Function">sub-tail</a> <a id="17844" class="Symbol">:</a> <a id="17846" class="Symbol">∀</a> <a id="17848" class="Symbol">{</a><a id="17849" href="lagda.2023-11-21-nbe.html#17849" class="Bound">Γ</a> <a id="17851" href="lagda.2023-11-21-nbe.html#17851" class="Bound">Δ</a> <a id="17853" class="Symbol">:</a> <a id="17855" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="17858" class="Symbol">}</a> <a id="17860" class="Symbol">{</a><a id="17861" href="lagda.2023-11-21-nbe.html#17861" class="Bound">S</a> <a id="17863" href="lagda.2023-11-21-nbe.html#17863" class="Bound">T</a> <a id="17865" class="Symbol">:</a> <a id="17867" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="17871" class="Symbol">}</a> <a id="17873" class="Symbol">{</a><a id="17874" href="lagda.2023-11-21-nbe.html#17874" class="Bound">s</a> <a id="17876" class="Symbol">:</a> <a id="17878" href="lagda.2023-11-21-nbe.html#17849" class="Bound">Γ</a> <a id="17880" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="17882" href="lagda.2023-11-21-nbe.html#17861" class="Bound">S</a><a id="17883" class="Symbol">}</a> <a id="17885" class="Symbol">{</a><a id="17886" href="lagda.2023-11-21-nbe.html#17886" class="Bound">σ</a> <a id="17888" class="Symbol">:</a> <a id="17890" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="17894" href="lagda.2023-11-21-nbe.html#17849" class="Bound">Γ</a> <a id="17896" href="lagda.2023-11-21-nbe.html#17851" class="Bound">Δ</a><a id="17897" class="Symbol">}</a>
         <a id="17908" class="Symbol">→</a> <a id="17910" class="Symbol">(</a><a id="17911" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a> <a id="17913" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="17915" class="Symbol">(</a><a id="17916" href="lagda.2023-11-21-nbe.html#17886" class="Bound">σ</a> <a id="17918" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="17920" href="lagda.2023-11-21-nbe.html#17874" class="Bound">s</a><a id="17921" class="Symbol">))</a> <a id="17924" class="Symbol">{</a><a id="17925" class="Argument">T</a> <a id="17927" class="Symbol">=</a> <a id="17929" href="lagda.2023-11-21-nbe.html#17863" class="Bound">T</a><a id="17930" class="Symbol">}</a> <a id="17932" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="17934" href="lagda.2023-11-21-nbe.html#17886" class="Bound">σ</a>
<a id="17936" href="lagda.2023-11-21-nbe.html#17835" class="Function">sub-tail</a> <a id="17945" class="Symbol">=</a> <a id="17947" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="sub-dist"></a><a id="17953" href="lagda.2023-11-21-nbe.html#17953" class="Function">sub-dist</a> <a id="17962" class="Symbol">:</a> <a id="17964" class="Symbol">∀</a> <a id="17966" class="Symbol">{</a><a id="17967" href="lagda.2023-11-21-nbe.html#17967" class="Bound">Γ</a> <a id="17969" href="lagda.2023-11-21-nbe.html#17969" class="Bound">Δ</a> <a id="17971" href="lagda.2023-11-21-nbe.html#17971" class="Bound">Σ</a> <a id="17973" class="Symbol">:</a> <a id="17975" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="17978" class="Symbol">}</a> <a id="17980" class="Symbol">{</a><a id="17981" href="lagda.2023-11-21-nbe.html#17981" class="Bound">S</a> <a id="17983" href="lagda.2023-11-21-nbe.html#17983" class="Bound">T</a> <a id="17985" class="Symbol">:</a> <a id="17987" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="17991" class="Symbol">}</a> <a id="17993" class="Symbol">{</a><a id="17994" href="lagda.2023-11-21-nbe.html#17994" class="Bound">τ</a> <a id="17996" class="Symbol">:</a> <a id="17998" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="18002" href="lagda.2023-11-21-nbe.html#17967" class="Bound">Γ</a> <a id="18004" href="lagda.2023-11-21-nbe.html#17969" class="Bound">Δ</a><a id="18005" class="Symbol">}</a> <a id="18007" class="Symbol">{</a><a id="18008" href="lagda.2023-11-21-nbe.html#18008" class="Bound">σ</a> <a id="18010" class="Symbol">:</a> <a id="18012" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="18016" href="lagda.2023-11-21-nbe.html#17969" class="Bound">Δ</a> <a id="18018" href="lagda.2023-11-21-nbe.html#17971" class="Bound">Σ</a><a id="18019" class="Symbol">}</a> <a id="18021" class="Symbol">{</a><a id="18022" href="lagda.2023-11-21-nbe.html#18022" class="Bound">s</a> <a id="18024" class="Symbol">:</a> <a id="18026" href="lagda.2023-11-21-nbe.html#17969" class="Bound">Δ</a> <a id="18028" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="18030" href="lagda.2023-11-21-nbe.html#17981" class="Bound">S</a><a id="18031" class="Symbol">}</a>
         <a id="18042" class="Symbol">→</a> <a id="18044" class="Symbol">(</a><a id="18045" href="lagda.2023-11-21-nbe.html#18008" class="Bound">σ</a> <a id="18047" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="18049" href="lagda.2023-11-21-nbe.html#18022" class="Bound">s</a><a id="18050" class="Symbol">)</a> <a id="18052" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="18054" href="lagda.2023-11-21-nbe.html#17994" class="Bound">τ</a> <a id="18056" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="18058" class="Symbol">(</a><a id="18059" href="lagda.2023-11-21-nbe.html#18008" class="Bound">σ</a> <a id="18061" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="18063" href="lagda.2023-11-21-nbe.html#17994" class="Bound">τ</a> <a id="18065" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="18067" class="Symbol">(</a><a id="18068" href="lagda.2023-11-21-nbe.html#18022" class="Bound">s</a> <a id="18070" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="18072" href="lagda.2023-11-21-nbe.html#17994" class="Bound">τ</a> <a id="18074" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a><a id="18075" class="Symbol">))</a> <a id="18078" class="Symbol">{</a><a id="18079" href="lagda.2023-11-21-nbe.html#17983" class="Bound">T</a><a id="18080" class="Symbol">}</a>
<a id="18082" href="lagda.2023-11-21-nbe.html#17953" class="Function">sub-dist</a> <a id="18091" class="Symbol">{</a><a id="18092" class="Argument">Σ</a> <a id="18094" class="Symbol">=</a> <a id="18096" href="lagda.2023-11-21-nbe.html#18096" class="Bound">Σ</a><a id="18097" class="Symbol">}</a> <a id="18099" class="Symbol">{</a><a id="18100" href="lagda.2023-11-21-nbe.html#18100" class="Bound">S</a><a id="18101" class="Symbol">}</a> <a id="18103" class="Symbol">{</a><a id="18104" href="lagda.2023-11-21-nbe.html#18104" class="Bound">T</a><a id="18105" class="Symbol">}</a> <a id="18107" class="Symbol">{</a><a id="18108" href="lagda.2023-11-21-nbe.html#18108" class="Bound">τ</a><a id="18109" class="Symbol">}</a> <a id="18111" class="Symbol">{</a><a id="18112" href="lagda.2023-11-21-nbe.html#18112" class="Bound">σ</a><a id="18113" class="Symbol">}</a> <a id="18115" class="Symbol">{</a><a id="18116" href="lagda.2023-11-21-nbe.html#18116" class="Bound">s</a><a id="18117" class="Symbol">}</a> <a id="18119" class="Symbol">=</a> <a id="18121" href="lagda.2023-11-21-nbe.html#2744" class="Postulate">extensionality</a> <a id="18136" href="lagda.2023-11-21-nbe.html#18150" class="Function">lemma</a> <a id="18142" class="Keyword">where</a>
  <a id="18150" href="lagda.2023-11-21-nbe.html#18150" class="Function">lemma</a> <a id="18156" class="Symbol">:</a> <a id="18158" class="Symbol">∀</a> <a id="18160" class="Symbol">(</a><a id="18161" href="lagda.2023-11-21-nbe.html#18161" class="Bound">x</a> <a id="18163" class="Symbol">:</a> <a id="18165" href="lagda.2023-11-21-nbe.html#18096" class="Bound">Σ</a> <a id="18167" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="18169" href="lagda.2023-11-21-nbe.html#18100" class="Bound">S</a> <a id="18171" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="18173" href="lagda.2023-11-21-nbe.html#18104" class="Bound">T</a><a id="18174" class="Symbol">)</a> <a id="18176" class="Symbol">→</a> <a id="18178" class="Symbol">((</a><a id="18180" href="lagda.2023-11-21-nbe.html#18112" class="Bound">σ</a> <a id="18182" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="18184" href="lagda.2023-11-21-nbe.html#18116" class="Bound">s</a><a id="18185" class="Symbol">)</a> <a id="18187" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="18189" href="lagda.2023-11-21-nbe.html#18108" class="Bound">τ</a><a id="18190" class="Symbol">)</a> <a id="18192" href="lagda.2023-11-21-nbe.html#18161" class="Bound">x</a> <a id="18194" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="18196" class="Symbol">((</a><a id="18198" href="lagda.2023-11-21-nbe.html#18112" class="Bound">σ</a> <a id="18200" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="18202" href="lagda.2023-11-21-nbe.html#18108" class="Bound">τ</a><a id="18203" class="Symbol">)</a> <a id="18205" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="18207" class="Symbol">(</a><a id="18208" href="lagda.2023-11-21-nbe.html#18116" class="Bound">s</a> <a id="18210" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="18212" href="lagda.2023-11-21-nbe.html#18108" class="Bound">τ</a> <a id="18214" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a><a id="18215" class="Symbol">))</a> <a id="18218" href="lagda.2023-11-21-nbe.html#18161" class="Bound">x</a>
  <a id="18222" href="lagda.2023-11-21-nbe.html#18150" class="Function">lemma</a> <a id="18228" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>     <a id="18234" class="Symbol">=</a> <a id="18236" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="18243" href="lagda.2023-11-21-nbe.html#18150" class="Function">lemma</a> <a id="18249" class="Symbol">(</a><a id="18250" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="18252" href="lagda.2023-11-21-nbe.html#18252" class="Bound">x</a><a id="18253" class="Symbol">)</a> <a id="18255" class="Symbol">=</a> <a id="18257" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="cong-ext"></a><a id="18263" href="lagda.2023-11-21-nbe.html#18263" class="Function">cong-ext</a> <a id="18272" class="Symbol">:</a> <a id="18274" class="Symbol">∀</a> <a id="18276" class="Symbol">{</a><a id="18277" href="lagda.2023-11-21-nbe.html#18277" class="Bound">Γ</a> <a id="18279" href="lagda.2023-11-21-nbe.html#18279" class="Bound">Δ</a> <a id="18281" class="Symbol">:</a> <a id="18283" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="18286" class="Symbol">}</a> <a id="18288" class="Symbol">{</a><a id="18289" href="lagda.2023-11-21-nbe.html#18289" class="Bound">ρ</a> <a id="18291" href="lagda.2023-11-21-nbe.html#18291" class="Bound">ρ′</a> <a id="18294" class="Symbol">:</a> <a id="18296" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="18300" href="lagda.2023-11-21-nbe.html#18277" class="Bound">Γ</a> <a id="18302" href="lagda.2023-11-21-nbe.html#18279" class="Bound">Δ</a><a id="18303" class="Symbol">}</a> <a id="18305" class="Symbol">{</a><a id="18306" href="lagda.2023-11-21-nbe.html#18306" class="Bound">T</a> <a id="18308" class="Symbol">:</a> <a id="18310" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="18314" class="Symbol">}</a>
         <a id="18325" class="Symbol">→</a> <a id="18327" class="Symbol">(∀</a> <a id="18330" class="Symbol">{</a><a id="18331" href="lagda.2023-11-21-nbe.html#18331" class="Bound">S</a> <a id="18333" class="Symbol">:</a> <a id="18335" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="18339" class="Symbol">}</a> <a id="18341" class="Symbol">→</a> <a id="18343" href="lagda.2023-11-21-nbe.html#18289" class="Bound">ρ</a> <a id="18345" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="18347" href="lagda.2023-11-21-nbe.html#18291" class="Bound">ρ′</a> <a id="18350" class="Symbol">{</a><a id="18351" href="lagda.2023-11-21-nbe.html#18331" class="Bound">S</a><a id="18352" class="Symbol">})</a>
         <a id="18364" class="Symbol">→</a> <a id="18366" class="Symbol">∀</a> <a id="18368" class="Symbol">{</a><a id="18369" href="lagda.2023-11-21-nbe.html#18369" class="Bound">S</a> <a id="18371" class="Symbol">:</a> <a id="18373" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="18377" class="Symbol">}</a> <a id="18379" class="Symbol">→</a> <a id="18381" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="18385" href="lagda.2023-11-21-nbe.html#18289" class="Bound">ρ</a> <a id="18387" class="Symbol">{</a><a id="18388" href="lagda.2023-11-21-nbe.html#18306" class="Bound">T</a><a id="18389" class="Symbol">}</a> <a id="18391" class="Symbol">{</a><a id="18392" href="lagda.2023-11-21-nbe.html#18369" class="Bound">S</a><a id="18393" class="Symbol">}</a> <a id="18395" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="18397" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="18401" href="lagda.2023-11-21-nbe.html#18291" class="Bound">ρ′</a>
<a id="18404" href="lagda.2023-11-21-nbe.html#18263" class="Function">cong-ext</a> <a id="18413" class="Symbol">{</a><a id="18414" class="Argument">Δ</a> <a id="18416" class="Symbol">=</a> <a id="18418" href="lagda.2023-11-21-nbe.html#18418" class="Bound">Δ</a><a id="18419" class="Symbol">}</a> <a id="18421" class="Symbol">{</a><a id="18422" href="lagda.2023-11-21-nbe.html#18422" class="Bound">ρ</a><a id="18423" class="Symbol">}</a> <a id="18425" class="Symbol">{</a><a id="18426" href="lagda.2023-11-21-nbe.html#18426" class="Bound">ρ′</a><a id="18428" class="Symbol">}</a> <a id="18430" class="Symbol">{</a><a id="18431" href="lagda.2023-11-21-nbe.html#18431" class="Bound">T</a><a id="18432" class="Symbol">}</a> <a id="18434" href="lagda.2023-11-21-nbe.html#18434" class="Bound">ρ≡ρ′</a> <a id="18439" class="Symbol">{</a><a id="18440" href="lagda.2023-11-21-nbe.html#18440" class="Bound">S</a><a id="18441" class="Symbol">}</a> <a id="18443" class="Symbol">=</a> <a id="18445" href="lagda.2023-11-21-nbe.html#2744" class="Postulate">extensionality</a> <a id="18460" href="lagda.2023-11-21-nbe.html#18474" class="Function">lemma</a> <a id="18466" class="Keyword">where</a>
  <a id="18474" href="lagda.2023-11-21-nbe.html#18474" class="Function">lemma</a> <a id="18480" class="Symbol">:</a> <a id="18482" class="Symbol">∀</a> <a id="18484" class="Symbol">(</a><a id="18485" href="lagda.2023-11-21-nbe.html#18485" class="Bound">x</a> <a id="18487" class="Symbol">:</a> <a id="18489" href="lagda.2023-11-21-nbe.html#18418" class="Bound">Δ</a> <a id="18491" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="18493" href="lagda.2023-11-21-nbe.html#18431" class="Bound">T</a> <a id="18495" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="18497" href="lagda.2023-11-21-nbe.html#18440" class="Bound">S</a><a id="18498" class="Symbol">)</a> <a id="18500" class="Symbol">→</a> <a id="18502" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="18506" href="lagda.2023-11-21-nbe.html#18422" class="Bound">ρ</a> <a id="18508" href="lagda.2023-11-21-nbe.html#18485" class="Bound">x</a> <a id="18510" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="18512" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="18516" href="lagda.2023-11-21-nbe.html#18426" class="Bound">ρ′</a> <a id="18519" href="lagda.2023-11-21-nbe.html#18485" class="Bound">x</a>
  <a id="18523" href="lagda.2023-11-21-nbe.html#18474" class="Function">lemma</a> <a id="18529" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>                      <a id="18552" class="Symbol">=</a> <a id="18554" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="18561" href="lagda.2023-11-21-nbe.html#18474" class="Function">lemma</a> <a id="18567" class="Symbol">(</a><a id="18568" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="18570" href="lagda.2023-11-21-nbe.html#18570" class="Bound">x</a><a id="18571" class="Symbol">)</a> <a id="18573" class="Keyword">rewrite</a> <a id="18581" href="lagda.2023-11-21-nbe.html#18434" class="Bound">ρ≡ρ′</a> <a id="18586" class="Symbol">{</a><a id="18587" href="lagda.2023-11-21-nbe.html#18440" class="Bound">S</a><a id="18588" class="Symbol">}</a> <a id="18590" class="Symbol">=</a> <a id="18592" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="cong-rename"></a><a id="18598" href="lagda.2023-11-21-nbe.html#18598" class="Function">cong-rename</a> <a id="18610" class="Symbol">:</a> <a id="18612" class="Symbol">∀</a> <a id="18614" class="Symbol">{</a><a id="18615" href="lagda.2023-11-21-nbe.html#18615" class="Bound">Γ</a> <a id="18617" href="lagda.2023-11-21-nbe.html#18617" class="Bound">Δ</a> <a id="18619" class="Symbol">:</a> <a id="18621" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="18624" class="Symbol">}</a> <a id="18626" class="Symbol">{</a><a id="18627" href="lagda.2023-11-21-nbe.html#18627" class="Bound">ρ</a> <a id="18629" href="lagda.2023-11-21-nbe.html#18629" class="Bound">ρ′</a> <a id="18632" class="Symbol">:</a> <a id="18634" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="18638" href="lagda.2023-11-21-nbe.html#18615" class="Bound">Γ</a> <a id="18640" href="lagda.2023-11-21-nbe.html#18617" class="Bound">Δ</a><a id="18641" class="Symbol">}</a> <a id="18643" class="Symbol">{</a><a id="18644" href="lagda.2023-11-21-nbe.html#18644" class="Bound">T</a> <a id="18646" class="Symbol">:</a> <a id="18648" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="18652" class="Symbol">}</a> <a id="18654" class="Symbol">{</a><a id="18655" href="lagda.2023-11-21-nbe.html#18655" class="Bound">t</a> <a id="18657" class="Symbol">:</a> <a id="18659" href="lagda.2023-11-21-nbe.html#18617" class="Bound">Δ</a> <a id="18661" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="18663" href="lagda.2023-11-21-nbe.html#18644" class="Bound">T</a><a id="18664" class="Symbol">}</a>
            <a id="18678" class="Symbol">→</a> <a id="18680" class="Symbol">(∀</a> <a id="18683" class="Symbol">{</a><a id="18684" href="lagda.2023-11-21-nbe.html#18684" class="Bound">S</a> <a id="18686" class="Symbol">:</a> <a id="18688" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="18692" class="Symbol">}</a> <a id="18694" class="Symbol">→</a> <a id="18696" href="lagda.2023-11-21-nbe.html#18627" class="Bound">ρ</a> <a id="18698" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="18700" href="lagda.2023-11-21-nbe.html#18629" class="Bound">ρ′</a> <a id="18703" class="Symbol">{</a><a id="18704" href="lagda.2023-11-21-nbe.html#18684" class="Bound">S</a><a id="18705" class="Symbol">})</a>
            <a id="18720" class="Symbol">→</a> <a id="18722" href="lagda.2023-11-21-nbe.html#18655" class="Bound">t</a> <a id="18724" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">[</a> <a id="18726" href="lagda.2023-11-21-nbe.html#18627" class="Bound">ρ</a> <a id="18728" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">]ʳ</a> <a id="18731" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="18733" href="lagda.2023-11-21-nbe.html#18655" class="Bound">t</a> <a id="18735" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">[</a> <a id="18737" href="lagda.2023-11-21-nbe.html#18629" class="Bound">ρ′</a> <a id="18740" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">]ʳ</a>
<a id="18743" href="lagda.2023-11-21-nbe.html#18598" class="Function">cong-rename</a> <a id="18755" class="Symbol">{</a><a id="18756" class="Argument">t</a> <a id="18758" class="Symbol">=</a> <a id="18760" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a><a id="18764" class="Symbol">}</a> <a id="18766" class="Symbol">_</a>                                                <a id="18815" class="Symbol">=</a> <a id="18817" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="18822" href="lagda.2023-11-21-nbe.html#18598" class="Function">cong-rename</a> <a id="18834" class="Symbol">{</a><a id="18835" class="Argument">T</a> <a id="18837" class="Symbol">=</a> <a id="18839" href="lagda.2023-11-21-nbe.html#18839" class="Bound">T</a><a id="18840" class="Symbol">}</a> <a id="18842" class="Symbol">{</a><a id="18843" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="18845" href="lagda.2023-11-21-nbe.html#18845" class="Bound">x</a><a id="18846" class="Symbol">}</a> <a id="18848" href="lagda.2023-11-21-nbe.html#18848" class="Bound">ρ≡ρ′</a> <a id="18853" class="Keyword">rewrite</a> <a id="18861" href="lagda.2023-11-21-nbe.html#18848" class="Bound">ρ≡ρ′</a> <a id="18866" class="Symbol">{</a><a id="18867" href="lagda.2023-11-21-nbe.html#18839" class="Bound">T</a><a id="18868" class="Symbol">}</a>                         <a id="18894" class="Symbol">=</a> <a id="18896" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="18901" href="lagda.2023-11-21-nbe.html#18598" class="Function">cong-rename</a> <a id="18913" class="Symbol">{</a><a id="18914" class="Argument">ρ</a> <a id="18916" class="Symbol">=</a> <a id="18918" href="lagda.2023-11-21-nbe.html#18918" class="Bound">ρ</a><a id="18919" class="Symbol">}</a> <a id="18921" class="Symbol">{</a><a id="18922" href="lagda.2023-11-21-nbe.html#18922" class="Bound">ρ′</a><a id="18924" class="Symbol">}</a> <a id="18926" class="Symbol">{</a><a id="18927" class="Argument">t</a> <a id="18929" class="Symbol">=</a> <a id="18931" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="18933" href="lagda.2023-11-21-nbe.html#18933" class="Bound">t</a><a id="18934" class="Symbol">}</a> <a id="18936" href="lagda.2023-11-21-nbe.html#18936" class="Bound">ρ≡ρ′</a>
  <a id="18943" class="Keyword">rewrite</a> <a id="18951" href="lagda.2023-11-21-nbe.html#18598" class="Function">cong-rename</a> <a id="18963" class="Symbol">{</a><a id="18964" class="Argument">ρ</a> <a id="18966" class="Symbol">=</a> <a id="18968" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="18972" href="lagda.2023-11-21-nbe.html#18918" class="Bound">ρ</a><a id="18973" class="Symbol">}</a> <a id="18975" class="Symbol">{</a><a id="18976" class="Argument">ρ′</a> <a id="18979" class="Symbol">=</a> <a id="18981" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="18985" href="lagda.2023-11-21-nbe.html#18922" class="Bound">ρ′</a><a id="18987" class="Symbol">}</a> <a id="18989" class="Symbol">{</a><a id="18990" class="Argument">t</a> <a id="18992" class="Symbol">=</a> <a id="18994" href="lagda.2023-11-21-nbe.html#18933" class="Bound">t</a><a id="18995" class="Symbol">}</a> <a id="18997" class="Symbol">(</a><a id="18998" href="lagda.2023-11-21-nbe.html#18263" class="Function">cong-ext</a> <a id="19007" href="lagda.2023-11-21-nbe.html#18936" class="Bound">ρ≡ρ′</a><a id="19011" class="Symbol">)</a> <a id="19013" class="Symbol">=</a> <a id="19015" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="19020" href="lagda.2023-11-21-nbe.html#18598" class="Function">cong-rename</a> <a id="19032" class="Symbol">{</a><a id="19033" class="Argument">t</a> <a id="19035" class="Symbol">=</a> <a id="19037" href="lagda.2023-11-21-nbe.html#19037" class="Bound">r</a> <a id="19039" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="19041" href="lagda.2023-11-21-nbe.html#19041" class="Bound">s</a><a id="19042" class="Symbol">}</a> <a id="19044" href="lagda.2023-11-21-nbe.html#19044" class="Bound">ρ≡ρ′</a>
  <a id="19051" class="Keyword">rewrite</a> <a id="19059" href="lagda.2023-11-21-nbe.html#18598" class="Function">cong-rename</a> <a id="19071" class="Symbol">{</a><a id="19072" class="Argument">t</a> <a id="19074" class="Symbol">=</a> <a id="19076" href="lagda.2023-11-21-nbe.html#19037" class="Bound">r</a><a id="19077" class="Symbol">}</a> <a id="19079" href="lagda.2023-11-21-nbe.html#19044" class="Bound">ρ≡ρ′</a> <a id="19084" class="Symbol">|</a> <a id="19086" href="lagda.2023-11-21-nbe.html#18598" class="Function">cong-rename</a> <a id="19098" class="Symbol">{</a><a id="19099" class="Argument">t</a> <a id="19101" class="Symbol">=</a> <a id="19103" href="lagda.2023-11-21-nbe.html#19041" class="Bound">s</a><a id="19104" class="Symbol">}</a> <a id="19106" href="lagda.2023-11-21-nbe.html#19044" class="Bound">ρ≡ρ′</a>           <a id="19121" class="Symbol">=</a> <a id="19123" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="cong-exts"></a><a id="19129" href="lagda.2023-11-21-nbe.html#19129" class="Function">cong-exts</a> <a id="19139" class="Symbol">:</a> <a id="19141" class="Symbol">∀</a> <a id="19143" class="Symbol">{</a><a id="19144" href="lagda.2023-11-21-nbe.html#19144" class="Bound">Γ</a> <a id="19146" href="lagda.2023-11-21-nbe.html#19146" class="Bound">Δ</a> <a id="19148" class="Symbol">:</a> <a id="19150" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="19153" class="Symbol">}</a> <a id="19155" class="Symbol">{</a><a id="19156" href="lagda.2023-11-21-nbe.html#19156" class="Bound">σ</a> <a id="19158" href="lagda.2023-11-21-nbe.html#19158" class="Bound">σ′</a> <a id="19161" class="Symbol">:</a> <a id="19163" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="19167" href="lagda.2023-11-21-nbe.html#19144" class="Bound">Γ</a> <a id="19169" href="lagda.2023-11-21-nbe.html#19146" class="Bound">Δ</a><a id="19170" class="Symbol">}</a> <a id="19172" class="Symbol">{</a><a id="19173" href="lagda.2023-11-21-nbe.html#19173" class="Bound">T</a> <a id="19175" class="Symbol">:</a> <a id="19177" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="19181" class="Symbol">}</a>
          <a id="19193" class="Symbol">→</a> <a id="19195" class="Symbol">(∀</a> <a id="19198" class="Symbol">{</a><a id="19199" href="lagda.2023-11-21-nbe.html#19199" class="Bound">S</a> <a id="19201" class="Symbol">:</a> <a id="19203" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="19207" class="Symbol">}</a> <a id="19209" class="Symbol">→</a> <a id="19211" href="lagda.2023-11-21-nbe.html#19156" class="Bound">σ</a> <a id="19213" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="19215" href="lagda.2023-11-21-nbe.html#19158" class="Bound">σ′</a> <a id="19218" class="Symbol">{</a><a id="19219" href="lagda.2023-11-21-nbe.html#19199" class="Bound">S</a><a id="19220" class="Symbol">})</a>
          <a id="19233" class="Symbol">→</a> <a id="19235" class="Symbol">(∀</a> <a id="19238" class="Symbol">{</a><a id="19239" href="lagda.2023-11-21-nbe.html#19239" class="Bound">S</a> <a id="19241" class="Symbol">:</a> <a id="19243" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="19247" class="Symbol">}</a> <a id="19249" class="Symbol">→</a> <a id="19251" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="19256" href="lagda.2023-11-21-nbe.html#19156" class="Bound">σ</a> <a id="19258" class="Symbol">{</a><a id="19259" href="lagda.2023-11-21-nbe.html#19173" class="Bound">T</a><a id="19260" class="Symbol">}</a> <a id="19262" class="Symbol">{</a><a id="19263" href="lagda.2023-11-21-nbe.html#19239" class="Bound">S</a><a id="19264" class="Symbol">}</a> <a id="19266" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="19268" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="19273" href="lagda.2023-11-21-nbe.html#19158" class="Bound">σ′</a><a id="19275" class="Symbol">)</a>
<a id="19277" href="lagda.2023-11-21-nbe.html#19129" class="Function">cong-exts</a> <a id="19287" class="Symbol">{</a><a id="19288" class="Argument">Δ</a> <a id="19290" class="Symbol">=</a> <a id="19292" href="lagda.2023-11-21-nbe.html#19292" class="Bound">Δ</a><a id="19293" class="Symbol">}</a> <a id="19295" class="Symbol">{</a><a id="19296" href="lagda.2023-11-21-nbe.html#19296" class="Bound">σ</a><a id="19297" class="Symbol">}</a> <a id="19299" class="Symbol">{</a><a id="19300" href="lagda.2023-11-21-nbe.html#19300" class="Bound">σ′</a><a id="19302" class="Symbol">}</a> <a id="19304" class="Symbol">{</a><a id="19305" href="lagda.2023-11-21-nbe.html#19305" class="Bound">T</a><a id="19306" class="Symbol">}</a> <a id="19308" href="lagda.2023-11-21-nbe.html#19308" class="Bound">σ≡σ′</a> <a id="19313" class="Symbol">{</a><a id="19314" href="lagda.2023-11-21-nbe.html#19314" class="Bound">S</a><a id="19315" class="Symbol">}</a> <a id="19317" class="Symbol">=</a> <a id="19319" href="lagda.2023-11-21-nbe.html#2744" class="Postulate">extensionality</a> <a id="19334" href="lagda.2023-11-21-nbe.html#19348" class="Function">lemma</a> <a id="19340" class="Keyword">where</a>
  <a id="19348" href="lagda.2023-11-21-nbe.html#19348" class="Function">lemma</a> <a id="19354" class="Symbol">:</a> <a id="19356" class="Symbol">∀</a> <a id="19358" class="Symbol">(</a><a id="19359" href="lagda.2023-11-21-nbe.html#19359" class="Bound">x</a> <a id="19361" class="Symbol">:</a> <a id="19363" href="lagda.2023-11-21-nbe.html#19292" class="Bound">Δ</a> <a id="19365" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="19367" href="lagda.2023-11-21-nbe.html#19305" class="Bound">T</a> <a id="19369" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="19371" href="lagda.2023-11-21-nbe.html#19314" class="Bound">S</a><a id="19372" class="Symbol">)</a> <a id="19374" class="Symbol">→</a> <a id="19376" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="19381" href="lagda.2023-11-21-nbe.html#19296" class="Bound">σ</a> <a id="19383" href="lagda.2023-11-21-nbe.html#19359" class="Bound">x</a> <a id="19385" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="19387" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="19392" href="lagda.2023-11-21-nbe.html#19300" class="Bound">σ′</a> <a id="19395" href="lagda.2023-11-21-nbe.html#19359" class="Bound">x</a>
  <a id="19399" href="lagda.2023-11-21-nbe.html#19348" class="Function">lemma</a> <a id="19405" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>                      <a id="19428" class="Symbol">=</a> <a id="19430" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="19437" href="lagda.2023-11-21-nbe.html#19348" class="Function">lemma</a> <a id="19443" class="Symbol">(</a><a id="19444" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="19446" href="lagda.2023-11-21-nbe.html#19446" class="Bound">x</a><a id="19447" class="Symbol">)</a> <a id="19449" class="Keyword">rewrite</a> <a id="19457" href="lagda.2023-11-21-nbe.html#19308" class="Bound">σ≡σ′</a> <a id="19462" class="Symbol">{</a><a id="19463" href="lagda.2023-11-21-nbe.html#19314" class="Bound">S</a><a id="19464" class="Symbol">}</a> <a id="19466" class="Symbol">=</a> <a id="19468" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="cong-sub"></a><a id="19474" href="lagda.2023-11-21-nbe.html#19474" class="Function">cong-sub</a> <a id="19483" class="Symbol">:</a> <a id="19485" class="Symbol">∀</a> <a id="19487" class="Symbol">{</a><a id="19488" href="lagda.2023-11-21-nbe.html#19488" class="Bound">Γ</a> <a id="19490" href="lagda.2023-11-21-nbe.html#19490" class="Bound">Δ</a> <a id="19492" class="Symbol">:</a> <a id="19494" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="19497" class="Symbol">}</a> <a id="19499" class="Symbol">{</a><a id="19500" href="lagda.2023-11-21-nbe.html#19500" class="Bound">σ</a> <a id="19502" href="lagda.2023-11-21-nbe.html#19502" class="Bound">σ′</a> <a id="19505" class="Symbol">:</a> <a id="19507" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="19511" href="lagda.2023-11-21-nbe.html#19488" class="Bound">Γ</a> <a id="19513" href="lagda.2023-11-21-nbe.html#19490" class="Bound">Δ</a><a id="19514" class="Symbol">}</a> <a id="19516" class="Symbol">{</a><a id="19517" href="lagda.2023-11-21-nbe.html#19517" class="Bound">T</a> <a id="19519" class="Symbol">:</a> <a id="19521" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="19525" class="Symbol">}</a> <a id="19527" class="Symbol">{</a><a id="19528" href="lagda.2023-11-21-nbe.html#19528" class="Bound">t</a> <a id="19530" href="lagda.2023-11-21-nbe.html#19530" class="Bound">t′</a> <a id="19533" class="Symbol">:</a> <a id="19535" href="lagda.2023-11-21-nbe.html#19490" class="Bound">Δ</a> <a id="19537" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="19539" href="lagda.2023-11-21-nbe.html#19517" class="Bound">T</a><a id="19540" class="Symbol">}</a>
         <a id="19551" class="Symbol">→</a> <a id="19553" class="Symbol">(∀</a> <a id="19556" class="Symbol">{</a><a id="19557" href="lagda.2023-11-21-nbe.html#19557" class="Bound">S</a> <a id="19559" class="Symbol">:</a> <a id="19561" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="19565" class="Symbol">}</a> <a id="19567" class="Symbol">→</a> <a id="19569" href="lagda.2023-11-21-nbe.html#19500" class="Bound">σ</a> <a id="19571" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="19573" href="lagda.2023-11-21-nbe.html#19502" class="Bound">σ′</a> <a id="19576" class="Symbol">{</a><a id="19577" href="lagda.2023-11-21-nbe.html#19557" class="Bound">S</a><a id="19578" class="Symbol">})</a>
         <a id="19590" class="Symbol">→</a> <a id="19592" href="lagda.2023-11-21-nbe.html#19528" class="Bound">t</a> <a id="19594" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="19596" href="lagda.2023-11-21-nbe.html#19530" class="Bound">t′</a>
         <a id="19608" class="Symbol">→</a> <a id="19610" href="lagda.2023-11-21-nbe.html#19528" class="Bound">t</a> <a id="19612" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="19614" href="lagda.2023-11-21-nbe.html#19500" class="Bound">σ</a> <a id="19616" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a> <a id="19618" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="19620" href="lagda.2023-11-21-nbe.html#19530" class="Bound">t′</a> <a id="19623" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="19625" href="lagda.2023-11-21-nbe.html#19502" class="Bound">σ′</a> <a id="19628" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a>
<a id="19630" href="lagda.2023-11-21-nbe.html#19474" class="Function">cong-sub</a> <a id="19639" class="Symbol">{</a><a id="19640" class="Argument">t</a> <a id="19642" class="Symbol">=</a> <a id="19644" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a><a id="19648" class="Symbol">}</a> <a id="19650" class="Symbol">{</a><a id="19651" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a><a id="19655" class="Symbol">}</a> <a id="19657" class="Symbol">_</a> <a id="19659" class="Symbol">_</a>                                          <a id="19702" class="Symbol">=</a> <a id="19704" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="19709" href="lagda.2023-11-21-nbe.html#19474" class="Function">cong-sub</a> <a id="19718" class="Symbol">{</a><a id="19719" class="Argument">T</a> <a id="19721" class="Symbol">=</a> <a id="19723" href="lagda.2023-11-21-nbe.html#19723" class="Bound">T</a><a id="19724" class="Symbol">}</a> <a id="19726" class="Symbol">{</a><a id="19727" class="Argument">t</a> <a id="19729" class="Symbol">=</a> <a id="19731" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="19733" href="lagda.2023-11-21-nbe.html#19733" class="Bound">x</a><a id="19734" class="Symbol">}</a> <a id="19736" href="lagda.2023-11-21-nbe.html#19736" class="Bound">σ≡σ′</a> <a id="19741" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="19746" class="Keyword">rewrite</a> <a id="19754" href="lagda.2023-11-21-nbe.html#19736" class="Bound">σ≡σ′</a> <a id="19759" class="Symbol">{</a><a id="19760" href="lagda.2023-11-21-nbe.html#19723" class="Bound">T</a><a id="19761" class="Symbol">}</a>                   <a id="19781" class="Symbol">=</a> <a id="19783" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="19788" href="lagda.2023-11-21-nbe.html#19474" class="Function">cong-sub</a> <a id="19797" class="Symbol">{</a><a id="19798" class="Argument">σ</a> <a id="19800" class="Symbol">=</a> <a id="19802" href="lagda.2023-11-21-nbe.html#19802" class="Bound">σ</a><a id="19803" class="Symbol">}</a> <a id="19805" class="Symbol">{</a><a id="19806" href="lagda.2023-11-21-nbe.html#19806" class="Bound">σ′</a><a id="19808" class="Symbol">}</a> <a id="19810" class="Symbol">{</a><a id="19811" class="Argument">t</a> <a id="19813" class="Symbol">=</a> <a id="19815" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="19817" href="lagda.2023-11-21-nbe.html#19817" class="Bound">t</a><a id="19818" class="Symbol">}</a> <a id="19820" href="lagda.2023-11-21-nbe.html#19820" class="Bound">σ≡σ′</a> <a id="19825" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="19832" class="Keyword">rewrite</a> <a id="19840" href="lagda.2023-11-21-nbe.html#19474" class="Function">cong-sub</a> <a id="19849" class="Symbol">{</a><a id="19850" class="Argument">σ</a> <a id="19852" class="Symbol">=</a> <a id="19854" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="19859" href="lagda.2023-11-21-nbe.html#19802" class="Bound">σ</a><a id="19860" class="Symbol">}</a> <a id="19862" class="Symbol">{</a><a id="19863" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="19868" href="lagda.2023-11-21-nbe.html#19806" class="Bound">σ′</a><a id="19870" class="Symbol">}</a> <a id="19872" class="Symbol">{</a><a id="19873" class="Argument">t</a> <a id="19875" class="Symbol">=</a> <a id="19877" href="lagda.2023-11-21-nbe.html#19817" class="Bound">t</a><a id="19878" class="Symbol">}</a> <a id="19880" class="Symbol">(</a><a id="19881" href="lagda.2023-11-21-nbe.html#19129" class="Function">cong-exts</a> <a id="19891" href="lagda.2023-11-21-nbe.html#19820" class="Bound">σ≡σ′</a><a id="19895" class="Symbol">)</a> <a id="19897" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="19902" class="Symbol">=</a> <a id="19904" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="19909" href="lagda.2023-11-21-nbe.html#19474" class="Function">cong-sub</a> <a id="19918" class="Symbol">{</a><a id="19919" class="Argument">σ</a> <a id="19921" class="Symbol">=</a> <a id="19923" href="lagda.2023-11-21-nbe.html#19923" class="Bound">σ</a><a id="19924" class="Symbol">}</a> <a id="19926" class="Symbol">{</a><a id="19927" href="lagda.2023-11-21-nbe.html#19927" class="Bound">σ′</a><a id="19929" class="Symbol">}</a> <a id="19931" class="Symbol">{</a><a id="19932" class="Argument">t</a> <a id="19934" class="Symbol">=</a> <a id="19936" href="lagda.2023-11-21-nbe.html#19936" class="Bound">r</a> <a id="19938" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="19940" href="lagda.2023-11-21-nbe.html#19940" class="Bound">s</a><a id="19941" class="Symbol">}</a> <a id="19943" href="lagda.2023-11-21-nbe.html#19943" class="Bound">σ≡σ′</a> <a id="19948" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="19955" class="Keyword">rewrite</a> <a id="19963" href="lagda.2023-11-21-nbe.html#19474" class="Function">cong-sub</a> <a id="19972" class="Symbol">{</a><a id="19973" class="Argument">σ</a> <a id="19975" class="Symbol">=</a> <a id="19977" href="lagda.2023-11-21-nbe.html#19923" class="Bound">σ</a><a id="19978" class="Symbol">}</a> <a id="19980" class="Symbol">{</a><a id="19981" href="lagda.2023-11-21-nbe.html#19927" class="Bound">σ′</a><a id="19983" class="Symbol">}</a> <a id="19985" class="Symbol">{</a><a id="19986" class="Argument">t</a> <a id="19988" class="Symbol">=</a> <a id="19990" href="lagda.2023-11-21-nbe.html#19936" class="Bound">r</a><a id="19991" class="Symbol">}</a> <a id="19993" href="lagda.2023-11-21-nbe.html#19943" class="Bound">σ≡σ′</a> <a id="19998" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
        <a id="20011" class="Symbol">|</a> <a id="20013" href="lagda.2023-11-21-nbe.html#19474" class="Function">cong-sub</a> <a id="20022" class="Symbol">{</a><a id="20023" class="Argument">σ</a> <a id="20025" class="Symbol">=</a> <a id="20027" href="lagda.2023-11-21-nbe.html#19923" class="Bound">σ</a><a id="20028" class="Symbol">}</a> <a id="20030" class="Symbol">{</a><a id="20031" href="lagda.2023-11-21-nbe.html#19927" class="Bound">σ′</a><a id="20033" class="Symbol">}</a> <a id="20035" class="Symbol">{</a><a id="20036" class="Argument">t</a> <a id="20038" class="Symbol">=</a> <a id="20040" href="lagda.2023-11-21-nbe.html#19940" class="Bound">s</a><a id="20041" class="Symbol">}</a> <a id="20043" href="lagda.2023-11-21-nbe.html#19943" class="Bound">σ≡σ′</a> <a id="20048" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>                       <a id="20075" class="Symbol">=</a> <a id="20077" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="cong-cons"></a><a id="20083" href="lagda.2023-11-21-nbe.html#20083" class="Function">cong-cons</a> <a id="20093" class="Symbol">:</a> <a id="20095" class="Symbol">∀</a> <a id="20097" class="Symbol">{</a><a id="20098" href="lagda.2023-11-21-nbe.html#20098" class="Bound">Γ</a> <a id="20100" href="lagda.2023-11-21-nbe.html#20100" class="Bound">Δ</a> <a id="20102" class="Symbol">:</a> <a id="20104" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="20107" class="Symbol">}</a> <a id="20109" class="Symbol">{</a><a id="20110" href="lagda.2023-11-21-nbe.html#20110" class="Bound">S</a> <a id="20112" class="Symbol">:</a> <a id="20114" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="20118" class="Symbol">}</a> <a id="20120" class="Symbol">{</a><a id="20121" href="lagda.2023-11-21-nbe.html#20121" class="Bound">s</a> <a id="20123" href="lagda.2023-11-21-nbe.html#20123" class="Bound">s′</a> <a id="20126" class="Symbol">:</a> <a id="20128" href="lagda.2023-11-21-nbe.html#20098" class="Bound">Γ</a> <a id="20130" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="20132" href="lagda.2023-11-21-nbe.html#20110" class="Bound">S</a><a id="20133" class="Symbol">}</a> <a id="20135" class="Symbol">{</a><a id="20136" href="lagda.2023-11-21-nbe.html#20136" class="Bound">σ</a> <a id="20138" href="lagda.2023-11-21-nbe.html#20138" class="Bound">τ</a> <a id="20140" class="Symbol">:</a> <a id="20142" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="20146" href="lagda.2023-11-21-nbe.html#20098" class="Bound">Γ</a> <a id="20148" href="lagda.2023-11-21-nbe.html#20100" class="Bound">Δ</a><a id="20149" class="Symbol">}</a>
          <a id="20161" class="Symbol">→</a> <a id="20163" href="lagda.2023-11-21-nbe.html#20121" class="Bound">s</a> <a id="20165" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="20167" href="lagda.2023-11-21-nbe.html#20123" class="Bound">s′</a>
          <a id="20180" class="Symbol">→</a> <a id="20182" class="Symbol">(∀</a> <a id="20185" class="Symbol">{</a><a id="20186" href="lagda.2023-11-21-nbe.html#20186" class="Bound">T</a> <a id="20188" class="Symbol">:</a> <a id="20190" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="20194" class="Symbol">}</a> <a id="20196" class="Symbol">→</a> <a id="20198" href="lagda.2023-11-21-nbe.html#20136" class="Bound">σ</a> <a id="20200" class="Symbol">{</a><a id="20201" href="lagda.2023-11-21-nbe.html#20186" class="Bound">T</a><a id="20202" class="Symbol">}</a> <a id="20204" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="20206" href="lagda.2023-11-21-nbe.html#20138" class="Bound">τ</a> <a id="20208" class="Symbol">{</a><a id="20209" href="lagda.2023-11-21-nbe.html#20186" class="Bound">T</a><a id="20210" class="Symbol">})</a>
          <a id="20223" class="Symbol">→</a> <a id="20225" class="Symbol">∀</a> <a id="20227" class="Symbol">{</a><a id="20228" href="lagda.2023-11-21-nbe.html#20228" class="Bound">T</a> <a id="20230" class="Symbol">:</a> <a id="20232" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="20236" class="Symbol">}</a> <a id="20238" class="Symbol">→</a> <a id="20240" href="lagda.2023-11-21-nbe.html#20136" class="Bound">σ</a> <a id="20242" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="20244" href="lagda.2023-11-21-nbe.html#20121" class="Bound">s</a> <a id="20246" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="20248" class="Symbol">(</a><a id="20249" href="lagda.2023-11-21-nbe.html#20138" class="Bound">τ</a> <a id="20251" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="20253" href="lagda.2023-11-21-nbe.html#20123" class="Bound">s′</a><a id="20255" class="Symbol">)</a> <a id="20257" class="Symbol">{</a><a id="20258" href="lagda.2023-11-21-nbe.html#20228" class="Bound">T</a><a id="20259" class="Symbol">}</a>
<a id="20261" href="lagda.2023-11-21-nbe.html#20083" class="Function">cong-cons</a> <a id="20271" class="Symbol">{</a><a id="20272" class="Argument">Δ</a> <a id="20274" class="Symbol">=</a> <a id="20276" href="lagda.2023-11-21-nbe.html#20276" class="Bound">Δ</a><a id="20277" class="Symbol">}</a> <a id="20279" class="Symbol">{</a><a id="20280" href="lagda.2023-11-21-nbe.html#20280" class="Bound">S</a><a id="20281" class="Symbol">}</a> <a id="20283" class="Symbol">{</a><a id="20284" href="lagda.2023-11-21-nbe.html#20284" class="Bound">s</a><a id="20285" class="Symbol">}</a> <a id="20287" class="Symbol">{</a><a id="20288" href="lagda.2023-11-21-nbe.html#20288" class="Bound">s′</a><a id="20290" class="Symbol">}</a> <a id="20292" class="Symbol">{</a><a id="20293" href="lagda.2023-11-21-nbe.html#20293" class="Bound">σ</a><a id="20294" class="Symbol">}</a> <a id="20296" class="Symbol">{</a><a id="20297" href="lagda.2023-11-21-nbe.html#20297" class="Bound">τ</a><a id="20298" class="Symbol">}</a> <a id="20300" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="20305" href="lagda.2023-11-21-nbe.html#20305" class="Bound">σ≡τ</a> <a id="20309" class="Symbol">{</a><a id="20310" href="lagda.2023-11-21-nbe.html#20310" class="Bound">T</a><a id="20311" class="Symbol">}</a> <a id="20313" class="Symbol">=</a> <a id="20315" href="lagda.2023-11-21-nbe.html#2744" class="Postulate">extensionality</a> <a id="20330" href="lagda.2023-11-21-nbe.html#20344" class="Function">lemma</a> <a id="20336" class="Keyword">where</a>
  <a id="20344" href="lagda.2023-11-21-nbe.html#20344" class="Function">lemma</a> <a id="20350" class="Symbol">:</a> <a id="20352" class="Symbol">∀</a> <a id="20354" class="Symbol">(</a><a id="20355" href="lagda.2023-11-21-nbe.html#20355" class="Bound">x</a> <a id="20357" class="Symbol">:</a> <a id="20359" href="lagda.2023-11-21-nbe.html#20276" class="Bound">Δ</a> <a id="20361" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="20363" href="lagda.2023-11-21-nbe.html#20280" class="Bound">S</a> <a id="20365" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="20367" href="lagda.2023-11-21-nbe.html#20310" class="Bound">T</a><a id="20368" class="Symbol">)</a> <a id="20370" class="Symbol">→</a> <a id="20372" class="Symbol">(</a><a id="20373" href="lagda.2023-11-21-nbe.html#20293" class="Bound">σ</a> <a id="20375" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="20377" href="lagda.2023-11-21-nbe.html#20284" class="Bound">s</a><a id="20378" class="Symbol">)</a> <a id="20380" href="lagda.2023-11-21-nbe.html#20355" class="Bound">x</a> <a id="20382" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="20384" class="Symbol">(</a><a id="20385" href="lagda.2023-11-21-nbe.html#20297" class="Bound">τ</a> <a id="20387" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="20389" href="lagda.2023-11-21-nbe.html#20288" class="Bound">s′</a><a id="20391" class="Symbol">)</a> <a id="20393" href="lagda.2023-11-21-nbe.html#20355" class="Bound">x</a>
  <a id="20397" href="lagda.2023-11-21-nbe.html#20344" class="Function">lemma</a> <a id="20403" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>                     <a id="20425" class="Symbol">=</a> <a id="20427" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="20434" href="lagda.2023-11-21-nbe.html#20344" class="Function">lemma</a> <a id="20440" class="Symbol">(</a><a id="20441" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="20443" href="lagda.2023-11-21-nbe.html#20443" class="Bound">x</a><a id="20444" class="Symbol">)</a> <a id="20446" class="Keyword">rewrite</a> <a id="20454" href="lagda.2023-11-21-nbe.html#20305" class="Bound">σ≡τ</a> <a id="20458" class="Symbol">{</a><a id="20459" href="lagda.2023-11-21-nbe.html#20310" class="Bound">T</a><a id="20460" class="Symbol">}</a> <a id="20462" class="Symbol">=</a> <a id="20464" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="cong-seq"></a><a id="20470" href="lagda.2023-11-21-nbe.html#20470" class="Function">cong-seq</a> <a id="20479" class="Symbol">:</a> <a id="20481" class="Symbol">∀</a> <a id="20483" class="Symbol">{</a><a id="20484" href="lagda.2023-11-21-nbe.html#20484" class="Bound">Γ</a> <a id="20486" href="lagda.2023-11-21-nbe.html#20486" class="Bound">Δ</a> <a id="20488" href="lagda.2023-11-21-nbe.html#20488" class="Bound">Σ</a> <a id="20490" class="Symbol">:</a> <a id="20492" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="20495" class="Symbol">}</a> <a id="20497" class="Symbol">{</a><a id="20498" href="lagda.2023-11-21-nbe.html#20498" class="Bound">τ</a> <a id="20500" href="lagda.2023-11-21-nbe.html#20500" class="Bound">τ′</a> <a id="20503" class="Symbol">:</a> <a id="20505" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="20509" href="lagda.2023-11-21-nbe.html#20484" class="Bound">Γ</a> <a id="20511" href="lagda.2023-11-21-nbe.html#20486" class="Bound">Δ</a><a id="20512" class="Symbol">}</a> <a id="20514" class="Symbol">{</a><a id="20515" href="lagda.2023-11-21-nbe.html#20515" class="Bound">σ</a> <a id="20517" href="lagda.2023-11-21-nbe.html#20517" class="Bound">σ′</a> <a id="20520" class="Symbol">:</a> <a id="20522" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="20526" href="lagda.2023-11-21-nbe.html#20486" class="Bound">Δ</a> <a id="20528" href="lagda.2023-11-21-nbe.html#20488" class="Bound">Σ</a><a id="20529" class="Symbol">}</a>
         <a id="20540" class="Symbol">→</a> <a id="20542" class="Symbol">(∀</a> <a id="20545" class="Symbol">{</a><a id="20546" href="lagda.2023-11-21-nbe.html#20546" class="Bound">T</a> <a id="20548" class="Symbol">:</a> <a id="20550" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="20554" class="Symbol">}</a> <a id="20556" class="Symbol">→</a> <a id="20558" href="lagda.2023-11-21-nbe.html#20515" class="Bound">σ</a> <a id="20560" class="Symbol">{</a><a id="20561" href="lagda.2023-11-21-nbe.html#20546" class="Bound">T</a><a id="20562" class="Symbol">}</a> <a id="20564" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="20566" href="lagda.2023-11-21-nbe.html#20517" class="Bound">σ′</a><a id="20568" class="Symbol">)</a>
         <a id="20579" class="Symbol">→</a> <a id="20581" class="Symbol">(∀</a> <a id="20584" class="Symbol">{</a><a id="20585" href="lagda.2023-11-21-nbe.html#20585" class="Bound">T</a> <a id="20587" class="Symbol">:</a> <a id="20589" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="20593" class="Symbol">}</a> <a id="20595" class="Symbol">→</a> <a id="20597" href="lagda.2023-11-21-nbe.html#20498" class="Bound">τ</a> <a id="20599" class="Symbol">{</a><a id="20600" href="lagda.2023-11-21-nbe.html#20585" class="Bound">T</a><a id="20601" class="Symbol">}</a> <a id="20603" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="20605" href="lagda.2023-11-21-nbe.html#20500" class="Bound">τ′</a><a id="20607" class="Symbol">)</a>
         <a id="20618" class="Symbol">→</a> <a id="20620" class="Symbol">(∀</a> <a id="20623" class="Symbol">{</a><a id="20624" href="lagda.2023-11-21-nbe.html#20624" class="Bound">T</a> <a id="20626" class="Symbol">:</a> <a id="20628" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="20632" class="Symbol">}</a> <a id="20634" class="Symbol">→</a> <a id="20636" class="Symbol">(</a><a id="20637" href="lagda.2023-11-21-nbe.html#20515" class="Bound">σ</a> <a id="20639" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="20641" href="lagda.2023-11-21-nbe.html#20498" class="Bound">τ</a><a id="20642" class="Symbol">)</a> <a id="20644" class="Symbol">{</a><a id="20645" href="lagda.2023-11-21-nbe.html#20624" class="Bound">T</a><a id="20646" class="Symbol">}</a> <a id="20648" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="20650" href="lagda.2023-11-21-nbe.html#20517" class="Bound">σ′</a> <a id="20653" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="20655" href="lagda.2023-11-21-nbe.html#20500" class="Bound">τ′</a><a id="20657" class="Symbol">)</a>
<a id="20659" href="lagda.2023-11-21-nbe.html#20470" class="Function">cong-seq</a> <a id="20668" class="Symbol">{</a><a id="20669" class="Argument">Σ</a> <a id="20671" class="Symbol">=</a> <a id="20673" href="lagda.2023-11-21-nbe.html#20673" class="Bound">Σ</a><a id="20674" class="Symbol">}</a> <a id="20676" class="Symbol">{</a><a id="20677" href="lagda.2023-11-21-nbe.html#20677" class="Bound">τ</a><a id="20678" class="Symbol">}</a> <a id="20680" class="Symbol">{</a><a id="20681" href="lagda.2023-11-21-nbe.html#20681" class="Bound">τ′</a><a id="20683" class="Symbol">}</a> <a id="20685" class="Symbol">{</a><a id="20686" href="lagda.2023-11-21-nbe.html#20686" class="Bound">σ</a><a id="20687" class="Symbol">}</a> <a id="20689" class="Symbol">{</a><a id="20690" href="lagda.2023-11-21-nbe.html#20690" class="Bound">σ′</a><a id="20692" class="Symbol">}</a> <a id="20694" href="lagda.2023-11-21-nbe.html#20694" class="Bound">σ≡σ′</a> <a id="20699" href="lagda.2023-11-21-nbe.html#20699" class="Bound">τ≡τ′</a> <a id="20704" class="Symbol">{</a><a id="20705" href="lagda.2023-11-21-nbe.html#20705" class="Bound">T</a><a id="20706" class="Symbol">}</a> <a id="20708" class="Symbol">=</a> <a id="20710" href="lagda.2023-11-21-nbe.html#2744" class="Postulate">extensionality</a> <a id="20725" href="lagda.2023-11-21-nbe.html#20739" class="Function">lemma</a> <a id="20731" class="Keyword">where</a>
  <a id="20739" href="lagda.2023-11-21-nbe.html#20739" class="Function">lemma</a> <a id="20745" class="Symbol">:</a> <a id="20747" class="Symbol">∀</a> <a id="20749" class="Symbol">(</a><a id="20750" href="lagda.2023-11-21-nbe.html#20750" class="Bound">x</a> <a id="20752" class="Symbol">:</a> <a id="20754" href="lagda.2023-11-21-nbe.html#20673" class="Bound">Σ</a> <a id="20756" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="20758" href="lagda.2023-11-21-nbe.html#20705" class="Bound">T</a><a id="20759" class="Symbol">)</a> <a id="20761" class="Symbol">→</a> <a id="20763" class="Symbol">(</a><a id="20764" href="lagda.2023-11-21-nbe.html#20686" class="Bound">σ</a> <a id="20766" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="20768" href="lagda.2023-11-21-nbe.html#20677" class="Bound">τ</a><a id="20769" class="Symbol">)</a> <a id="20771" href="lagda.2023-11-21-nbe.html#20750" class="Bound">x</a> <a id="20773" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="20775" class="Symbol">(</a><a id="20776" href="lagda.2023-11-21-nbe.html#20690" class="Bound">σ′</a> <a id="20779" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="20781" href="lagda.2023-11-21-nbe.html#20681" class="Bound">τ′</a><a id="20783" class="Symbol">)</a> <a id="20785" href="lagda.2023-11-21-nbe.html#20750" class="Bound">x</a>
  <a id="20789" href="lagda.2023-11-21-nbe.html#20739" class="Function">lemma</a> <a id="20795" href="lagda.2023-11-21-nbe.html#20795" class="Bound">x</a> <a id="20797" class="Keyword">rewrite</a> <a id="20805" href="lagda.2023-11-21-nbe.html#20694" class="Bound">σ≡σ′</a> <a id="20810" class="Symbol">{</a><a id="20811" href="lagda.2023-11-21-nbe.html#20705" class="Bound">T</a><a id="20812" class="Symbol">}</a> <a id="20814" class="Symbol">|</a> <a id="20816" href="lagda.2023-11-21-nbe.html#19474" class="Function">cong-sub</a> <a id="20825" class="Symbol">{</a><a id="20826" class="Argument">t</a> <a id="20828" class="Symbol">=</a> <a id="20830" href="lagda.2023-11-21-nbe.html#20690" class="Bound">σ′</a> <a id="20833" href="lagda.2023-11-21-nbe.html#20795" class="Bound">x</a><a id="20834" class="Symbol">}</a> <a id="20836" href="lagda.2023-11-21-nbe.html#20699" class="Bound">τ≡τ′</a> <a id="20841" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="20846" class="Symbol">=</a> <a id="20848" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="ren-ext"></a><a id="20854" href="lagda.2023-11-21-nbe.html#20854" class="Function">ren-ext</a> <a id="20862" class="Symbol">:</a> <a id="20864" class="Symbol">∀</a> <a id="20866" class="Symbol">{</a><a id="20867" href="lagda.2023-11-21-nbe.html#20867" class="Bound">Γ</a> <a id="20869" href="lagda.2023-11-21-nbe.html#20869" class="Bound">Δ</a> <a id="20871" class="Symbol">:</a> <a id="20873" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="20876" class="Symbol">}</a> <a id="20878" class="Symbol">{</a><a id="20879" href="lagda.2023-11-21-nbe.html#20879" class="Bound">S</a> <a id="20881" href="lagda.2023-11-21-nbe.html#20881" class="Bound">T</a> <a id="20883" class="Symbol">:</a> <a id="20885" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="20889" class="Symbol">}</a> <a id="20891" class="Symbol">{</a><a id="20892" href="lagda.2023-11-21-nbe.html#20892" class="Bound">ρ</a> <a id="20894" class="Symbol">:</a> <a id="20896" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="20900" href="lagda.2023-11-21-nbe.html#20867" class="Bound">Γ</a> <a id="20902" href="lagda.2023-11-21-nbe.html#20869" class="Bound">Δ</a><a id="20903" class="Symbol">}</a>
        <a id="20913" class="Symbol">→</a> <a id="20915" href="lagda.2023-11-21-nbe.html#12782" class="Function">ren</a> <a id="20919" class="Symbol">(</a><a id="20920" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="20924" href="lagda.2023-11-21-nbe.html#20892" class="Bound">ρ</a><a id="20925" class="Symbol">)</a> <a id="20927" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="20929" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="20934" class="Symbol">(</a><a id="20935" href="lagda.2023-11-21-nbe.html#12782" class="Function">ren</a> <a id="20939" href="lagda.2023-11-21-nbe.html#20892" class="Bound">ρ</a><a id="20940" class="Symbol">)</a> <a id="20942" class="Symbol">{</a><a id="20943" href="lagda.2023-11-21-nbe.html#20879" class="Bound">S</a><a id="20944" class="Symbol">}</a> <a id="20946" class="Symbol">{</a><a id="20947" href="lagda.2023-11-21-nbe.html#20881" class="Bound">T</a><a id="20948" class="Symbol">}</a>
<a id="20950" href="lagda.2023-11-21-nbe.html#20854" class="Function">ren-ext</a> <a id="20958" class="Symbol">{</a><a id="20959" class="Argument">Δ</a> <a id="20961" class="Symbol">=</a> <a id="20963" href="lagda.2023-11-21-nbe.html#20963" class="Bound">Δ</a><a id="20964" class="Symbol">}</a> <a id="20966" class="Symbol">{</a><a id="20967" href="lagda.2023-11-21-nbe.html#20967" class="Bound">S</a><a id="20968" class="Symbol">}</a> <a id="20970" class="Symbol">{</a><a id="20971" href="lagda.2023-11-21-nbe.html#20971" class="Bound">T</a><a id="20972" class="Symbol">}</a> <a id="20974" class="Symbol">{</a><a id="20975" href="lagda.2023-11-21-nbe.html#20975" class="Bound">ρ</a><a id="20976" class="Symbol">}</a> <a id="20978" class="Symbol">=</a> <a id="20980" href="lagda.2023-11-21-nbe.html#2744" class="Postulate">extensionality</a> <a id="20995" href="lagda.2023-11-21-nbe.html#21009" class="Function">lemma</a> <a id="21001" class="Keyword">where</a>
  <a id="21009" href="lagda.2023-11-21-nbe.html#21009" class="Function">lemma</a> <a id="21015" class="Symbol">:</a> <a id="21017" class="Symbol">∀</a> <a id="21019" class="Symbol">(</a><a id="21020" href="lagda.2023-11-21-nbe.html#21020" class="Bound">x</a> <a id="21022" class="Symbol">:</a> <a id="21024" href="lagda.2023-11-21-nbe.html#20963" class="Bound">Δ</a> <a id="21026" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="21028" href="lagda.2023-11-21-nbe.html#20967" class="Bound">S</a> <a id="21030" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="21032" href="lagda.2023-11-21-nbe.html#20971" class="Bound">T</a><a id="21033" class="Symbol">)</a> <a id="21035" class="Symbol">→</a> <a id="21037" class="Symbol">(</a><a id="21038" href="lagda.2023-11-21-nbe.html#12782" class="Function">ren</a> <a id="21042" class="Symbol">(</a><a id="21043" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="21047" href="lagda.2023-11-21-nbe.html#20975" class="Bound">ρ</a><a id="21048" class="Symbol">))</a> <a id="21051" href="lagda.2023-11-21-nbe.html#21020" class="Bound">x</a> <a id="21053" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="21055" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="21060" class="Symbol">(</a><a id="21061" href="lagda.2023-11-21-nbe.html#12782" class="Function">ren</a> <a id="21065" href="lagda.2023-11-21-nbe.html#20975" class="Bound">ρ</a><a id="21066" class="Symbol">)</a> <a id="21068" href="lagda.2023-11-21-nbe.html#21020" class="Bound">x</a>
  <a id="21072" href="lagda.2023-11-21-nbe.html#21009" class="Function">lemma</a> <a id="21078" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>     <a id="21084" class="Symbol">=</a> <a id="21086" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="21093" href="lagda.2023-11-21-nbe.html#21009" class="Function">lemma</a> <a id="21099" class="Symbol">(</a><a id="21100" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="21102" href="lagda.2023-11-21-nbe.html#21102" class="Bound">x</a><a id="21103" class="Symbol">)</a> <a id="21105" class="Symbol">=</a> <a id="21107" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="rename-subst-ren"></a><a id="21113" href="lagda.2023-11-21-nbe.html#21113" class="Function">rename-subst-ren</a> <a id="21130" class="Symbol">:</a> <a id="21132" class="Symbol">∀</a> <a id="21134" class="Symbol">{</a><a id="21135" href="lagda.2023-11-21-nbe.html#21135" class="Bound">Γ</a> <a id="21137" href="lagda.2023-11-21-nbe.html#21137" class="Bound">Δ</a> <a id="21139" class="Symbol">:</a> <a id="21141" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="21144" class="Symbol">}</a> <a id="21146" class="Symbol">{</a><a id="21147" href="lagda.2023-11-21-nbe.html#21147" class="Bound">T</a> <a id="21149" class="Symbol">:</a> <a id="21151" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="21155" class="Symbol">}</a> <a id="21157" class="Symbol">{</a><a id="21158" href="lagda.2023-11-21-nbe.html#21158" class="Bound">ρ</a> <a id="21160" class="Symbol">:</a> <a id="21162" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="21166" href="lagda.2023-11-21-nbe.html#21135" class="Bound">Γ</a> <a id="21168" href="lagda.2023-11-21-nbe.html#21137" class="Bound">Δ</a><a id="21169" class="Symbol">}</a> <a id="21171" class="Symbol">{</a><a id="21172" href="lagda.2023-11-21-nbe.html#21172" class="Bound">t</a> <a id="21174" class="Symbol">:</a> <a id="21176" href="lagda.2023-11-21-nbe.html#21137" class="Bound">Δ</a> <a id="21178" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="21180" href="lagda.2023-11-21-nbe.html#21147" class="Bound">T</a><a id="21181" class="Symbol">}</a>
                 <a id="21200" class="Symbol">→</a> <a id="21202" href="lagda.2023-11-21-nbe.html#21172" class="Bound">t</a> <a id="21204" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">[</a> <a id="21206" href="lagda.2023-11-21-nbe.html#21158" class="Bound">ρ</a> <a id="21208" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">]ʳ</a> <a id="21211" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="21213" href="lagda.2023-11-21-nbe.html#21172" class="Bound">t</a> <a id="21215" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="21217" href="lagda.2023-11-21-nbe.html#12782" class="Function">ren</a> <a id="21221" href="lagda.2023-11-21-nbe.html#21158" class="Bound">ρ</a> <a id="21223" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a>
<a id="21225" href="lagda.2023-11-21-nbe.html#21113" class="Function">rename-subst-ren</a> <a id="21242" class="Symbol">{</a><a id="21243" class="Argument">t</a> <a id="21245" class="Symbol">=</a> <a id="21247" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a><a id="21251" class="Symbol">}</a>                                           <a id="21295" class="Symbol">=</a> <a id="21297" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="21302" href="lagda.2023-11-21-nbe.html#21113" class="Function">rename-subst-ren</a> <a id="21319" class="Symbol">{</a><a id="21320" class="Argument">t</a> <a id="21322" class="Symbol">=</a> <a id="21324" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="21326" href="lagda.2023-11-21-nbe.html#21326" class="Bound">x</a><a id="21327" class="Symbol">}</a>                                            <a id="21372" class="Symbol">=</a> <a id="21374" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="21379" href="lagda.2023-11-21-nbe.html#21113" class="Function">rename-subst-ren</a> <a id="21396" class="Symbol">{</a><a id="21397" class="Argument">ρ</a> <a id="21399" class="Symbol">=</a> <a id="21401" href="lagda.2023-11-21-nbe.html#21401" class="Bound">ρ</a><a id="21402" class="Symbol">}</a> <a id="21404" class="Symbol">{</a><a id="21405" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="21407" href="lagda.2023-11-21-nbe.html#21407" class="Bound">t</a><a id="21408" class="Symbol">}</a>
  <a id="21412" class="Keyword">rewrite</a> <a id="21420" href="lagda.2023-11-21-nbe.html#21113" class="Function">rename-subst-ren</a> <a id="21437" class="Symbol">{</a><a id="21438" class="Argument">ρ</a> <a id="21440" class="Symbol">=</a> <a id="21442" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="21446" href="lagda.2023-11-21-nbe.html#21401" class="Bound">ρ</a><a id="21447" class="Symbol">}</a> <a id="21449" class="Symbol">{</a><a id="21450" href="lagda.2023-11-21-nbe.html#21407" class="Bound">t</a><a id="21451" class="Symbol">}</a>
        <a id="21461" class="Symbol">|</a> <a id="21463" href="lagda.2023-11-21-nbe.html#19474" class="Function">cong-sub</a> <a id="21472" class="Symbol">{</a><a id="21473" class="Argument">t</a> <a id="21475" class="Symbol">=</a> <a id="21477" href="lagda.2023-11-21-nbe.html#21407" class="Bound">t</a><a id="21478" class="Symbol">}</a> <a id="21480" class="Symbol">(</a><a id="21481" href="lagda.2023-11-21-nbe.html#20854" class="Function">ren-ext</a> <a id="21489" class="Symbol">{</a><a id="21490" class="Argument">ρ</a> <a id="21492" class="Symbol">=</a> <a id="21494" href="lagda.2023-11-21-nbe.html#21401" class="Bound">ρ</a><a id="21495" class="Symbol">})</a> <a id="21498" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>                     <a id="21523" class="Symbol">=</a> <a id="21525" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="21530" href="lagda.2023-11-21-nbe.html#21113" class="Function">rename-subst-ren</a> <a id="21547" class="Symbol">{</a><a id="21548" class="Argument">ρ</a> <a id="21550" class="Symbol">=</a> <a id="21552" href="lagda.2023-11-21-nbe.html#21552" class="Bound">ρ</a><a id="21553" class="Symbol">}</a> <a id="21555" class="Symbol">{</a><a id="21556" href="lagda.2023-11-21-nbe.html#21556" class="Bound">r</a> <a id="21558" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="21560" href="lagda.2023-11-21-nbe.html#21560" class="Bound">s</a><a id="21561" class="Symbol">}</a>
  <a id="21565" class="Keyword">rewrite</a> <a id="21573" href="lagda.2023-11-21-nbe.html#21113" class="Function">rename-subst-ren</a> <a id="21590" class="Symbol">{</a><a id="21591" class="Argument">ρ</a> <a id="21593" class="Symbol">=</a> <a id="21595" href="lagda.2023-11-21-nbe.html#21552" class="Bound">ρ</a><a id="21596" class="Symbol">}</a> <a id="21598" class="Symbol">{</a><a id="21599" href="lagda.2023-11-21-nbe.html#21556" class="Bound">r</a><a id="21600" class="Symbol">}</a> <a id="21602" class="Symbol">|</a> <a id="21604" href="lagda.2023-11-21-nbe.html#21113" class="Function">rename-subst-ren</a> <a id="21621" class="Symbol">{</a><a id="21622" class="Argument">ρ</a> <a id="21624" class="Symbol">=</a> <a id="21626" href="lagda.2023-11-21-nbe.html#21552" class="Bound">ρ</a><a id="21627" class="Symbol">}</a> <a id="21629" class="Symbol">{</a><a id="21630" href="lagda.2023-11-21-nbe.html#21560" class="Bound">s</a><a id="21631" class="Symbol">}</a> <a id="21633" class="Symbol">=</a> <a id="21635" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="ren-shift"></a><a id="21641" href="lagda.2023-11-21-nbe.html#21641" class="Function">ren-shift</a> <a id="21651" class="Symbol">:</a> <a id="21653" class="Symbol">∀</a> <a id="21655" class="Symbol">{</a><a id="21656" href="lagda.2023-11-21-nbe.html#21656" class="Bound">Γ</a> <a id="21658" class="Symbol">:</a> <a id="21660" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="21663" class="Symbol">}</a> <a id="21665" class="Symbol">{</a><a id="21666" href="lagda.2023-11-21-nbe.html#21666" class="Bound">S</a> <a id="21668" href="lagda.2023-11-21-nbe.html#21668" class="Bound">T</a> <a id="21670" class="Symbol">:</a> <a id="21672" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="21676" class="Symbol">}</a>
          <a id="21688" class="Symbol">→</a> <a id="21690" href="lagda.2023-11-21-nbe.html#12782" class="Function">ren</a> <a id="21694" href="lagda.2023-11-21-nbe.html#13230" class="Function">↥ʳ</a> <a id="21697" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="21699" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a> <a id="21701" class="Symbol">{</a><a id="21702" href="lagda.2023-11-21-nbe.html#21656" class="Bound">Γ</a><a id="21703" class="Symbol">}</a> <a id="21705" class="Symbol">{</a><a id="21706" href="lagda.2023-11-21-nbe.html#21666" class="Bound">S</a><a id="21707" class="Symbol">}</a> <a id="21709" class="Symbol">{</a><a id="21710" href="lagda.2023-11-21-nbe.html#21668" class="Bound">T</a><a id="21711" class="Symbol">}</a>
<a id="21713" href="lagda.2023-11-21-nbe.html#21641" class="Function">ren-shift</a> <a id="21723" class="Symbol">{</a><a id="21724" href="lagda.2023-11-21-nbe.html#21724" class="Bound">Γ</a><a id="21725" class="Symbol">}</a> <a id="21727" class="Symbol">{</a><a id="21728" href="lagda.2023-11-21-nbe.html#21728" class="Bound">S</a><a id="21729" class="Symbol">}</a> <a id="21731" class="Symbol">{</a><a id="21732" href="lagda.2023-11-21-nbe.html#21732" class="Bound">T</a><a id="21733" class="Symbol">}</a> <a id="21735" class="Symbol">=</a> <a id="21737" href="lagda.2023-11-21-nbe.html#2744" class="Postulate">extensionality</a> <a id="21752" href="lagda.2023-11-21-nbe.html#21766" class="Function">lemma</a> <a id="21758" class="Keyword">where</a>
  <a id="21766" href="lagda.2023-11-21-nbe.html#21766" class="Function">lemma</a> <a id="21772" class="Symbol">:</a> <a id="21774" class="Symbol">∀</a> <a id="21776" class="Symbol">(</a><a id="21777" href="lagda.2023-11-21-nbe.html#21777" class="Bound">x</a> <a id="21779" class="Symbol">:</a> <a id="21781" href="lagda.2023-11-21-nbe.html#21724" class="Bound">Γ</a> <a id="21783" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="21785" href="lagda.2023-11-21-nbe.html#21732" class="Bound">T</a><a id="21786" class="Symbol">)</a> <a id="21788" class="Symbol">→</a> <a id="21790" href="lagda.2023-11-21-nbe.html#12782" class="Function">ren</a> <a id="21794" href="lagda.2023-11-21-nbe.html#13230" class="Function">↥ʳ</a> <a id="21797" href="lagda.2023-11-21-nbe.html#21777" class="Bound">x</a> <a id="21799" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="21801" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a> <a id="21803" href="lagda.2023-11-21-nbe.html#21777" class="Bound">x</a>
  <a id="21807" href="lagda.2023-11-21-nbe.html#21766" class="Function">lemma</a> <a id="21813" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>     <a id="21819" class="Symbol">=</a> <a id="21821" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="21828" href="lagda.2023-11-21-nbe.html#21766" class="Function">lemma</a> <a id="21834" class="Symbol">(</a><a id="21835" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="21837" href="lagda.2023-11-21-nbe.html#21837" class="Bound">x</a><a id="21838" class="Symbol">)</a> <a id="21840" class="Symbol">=</a> <a id="21842" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="rename-shift"></a><a id="21848" href="lagda.2023-11-21-nbe.html#21848" class="Function">rename-shift</a> <a id="21861" class="Symbol">:</a> <a id="21863" class="Symbol">∀</a> <a id="21865" class="Symbol">{</a><a id="21866" href="lagda.2023-11-21-nbe.html#21866" class="Bound">Γ</a> <a id="21868" class="Symbol">:</a> <a id="21870" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="21873" class="Symbol">}</a> <a id="21875" class="Symbol">{</a><a id="21876" href="lagda.2023-11-21-nbe.html#21876" class="Bound">S</a> <a id="21878" href="lagda.2023-11-21-nbe.html#21878" class="Bound">T</a> <a id="21880" class="Symbol">:</a> <a id="21882" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="21886" class="Symbol">}</a> <a id="21888" class="Symbol">{</a><a id="21889" href="lagda.2023-11-21-nbe.html#21889" class="Bound">s</a> <a id="21891" class="Symbol">:</a> <a id="21893" href="lagda.2023-11-21-nbe.html#21866" class="Bound">Γ</a> <a id="21895" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="21897" href="lagda.2023-11-21-nbe.html#21876" class="Bound">S</a><a id="21898" class="Symbol">}</a>
             <a id="21913" class="Symbol">→</a> <a id="21915" href="lagda.2023-11-21-nbe.html#21889" class="Bound">s</a> <a id="21917" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">[</a> <a id="21919" href="lagda.2023-11-21-nbe.html#13230" class="Function">↥ʳ</a> <a id="21922" class="Symbol">{</a><a id="21923" class="Argument">T</a> <a id="21925" class="Symbol">=</a> <a id="21927" href="lagda.2023-11-21-nbe.html#21878" class="Bound">T</a><a id="21928" class="Symbol">}</a> <a id="21930" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">]ʳ</a> <a id="21933" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="21935" href="lagda.2023-11-21-nbe.html#21889" class="Bound">s</a> <a id="21937" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="21939" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a> <a id="21941" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a>
<a id="21943" href="lagda.2023-11-21-nbe.html#21848" class="Function">rename-shift</a> <a id="21956" class="Symbol">{</a><a id="21957" href="lagda.2023-11-21-nbe.html#21957" class="Bound">Γ</a><a id="21958" class="Symbol">}</a> <a id="21960" class="Symbol">{</a><a id="21961" href="lagda.2023-11-21-nbe.html#21961" class="Bound">S</a><a id="21962" class="Symbol">}</a> <a id="21964" class="Symbol">{</a><a id="21965" href="lagda.2023-11-21-nbe.html#21965" class="Bound">T</a><a id="21966" class="Symbol">}</a> <a id="21968" class="Symbol">{</a><a id="21969" href="lagda.2023-11-21-nbe.html#21969" class="Bound">s</a><a id="21970" class="Symbol">}</a>
  <a id="21974" class="Keyword">rewrite</a> <a id="21982" href="lagda.2023-11-21-nbe.html#21113" class="Function">rename-subst-ren</a> <a id="21999" class="Symbol">{</a><a id="22000" class="Argument">ρ</a> <a id="22002" class="Symbol">=</a> <a id="22004" href="lagda.2023-11-21-nbe.html#13230" class="Function">↥ʳ</a> <a id="22007" class="Symbol">{</a><a id="22008" class="Argument">T</a> <a id="22010" class="Symbol">=</a> <a id="22012" href="lagda.2023-11-21-nbe.html#21965" class="Bound">T</a><a id="22013" class="Symbol">}}</a> <a id="22016" class="Symbol">{</a><a id="22017" href="lagda.2023-11-21-nbe.html#21969" class="Bound">s</a><a id="22018" class="Symbol">}</a>
        <a id="22028" class="Symbol">|</a> <a id="22030" href="lagda.2023-11-21-nbe.html#21641" class="Function">ren-shift</a> <a id="22040" class="Symbol">{</a><a id="22041" href="lagda.2023-11-21-nbe.html#21957" class="Bound">Γ</a><a id="22042" class="Symbol">}</a> <a id="22044" class="Symbol">{</a><a id="22045" href="lagda.2023-11-21-nbe.html#21965" class="Bound">T</a><a id="22046" class="Symbol">}</a> <a id="22048" class="Symbol">{</a><a id="22049" href="lagda.2023-11-21-nbe.html#21961" class="Bound">S</a><a id="22050" class="Symbol">}</a>                <a id="22067" class="Symbol">=</a> <a id="22069" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="exts-cons-shift"></a><a id="22075" href="lagda.2023-11-21-nbe.html#22075" class="Function">exts-cons-shift</a> <a id="22091" class="Symbol">:</a> <a id="22093" class="Symbol">∀</a> <a id="22095" class="Symbol">{</a><a id="22096" href="lagda.2023-11-21-nbe.html#22096" class="Bound">Γ</a> <a id="22098" href="lagda.2023-11-21-nbe.html#22098" class="Bound">Δ</a> <a id="22100" class="Symbol">:</a> <a id="22102" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="22105" class="Symbol">}</a> <a id="22107" class="Symbol">{</a><a id="22108" href="lagda.2023-11-21-nbe.html#22108" class="Bound">S</a> <a id="22110" href="lagda.2023-11-21-nbe.html#22110" class="Bound">T</a> <a id="22112" class="Symbol">:</a> <a id="22114" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="22118" class="Symbol">}</a> <a id="22120" class="Symbol">{</a><a id="22121" href="lagda.2023-11-21-nbe.html#22121" class="Bound">σ</a> <a id="22123" class="Symbol">:</a> <a id="22125" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="22129" href="lagda.2023-11-21-nbe.html#22096" class="Bound">Γ</a> <a id="22131" href="lagda.2023-11-21-nbe.html#22098" class="Bound">Δ</a><a id="22132" class="Symbol">}</a>
                <a id="22150" class="Symbol">→</a> <a id="22152" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="22157" href="lagda.2023-11-21-nbe.html#22121" class="Bound">σ</a> <a id="22159" class="Symbol">{</a><a id="22160" href="lagda.2023-11-21-nbe.html#22108" class="Bound">S</a><a id="22161" class="Symbol">}</a> <a id="22163" class="Symbol">{</a><a id="22164" href="lagda.2023-11-21-nbe.html#22110" class="Bound">T</a><a id="22165" class="Symbol">}</a> <a id="22167" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="22169" class="Symbol">(</a><a id="22170" href="lagda.2023-11-21-nbe.html#22121" class="Bound">σ</a> <a id="22172" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="22174" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a><a id="22175" class="Symbol">)</a> <a id="22177" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="22179" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="22181" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>
<a id="22183" href="lagda.2023-11-21-nbe.html#22075" class="Function">exts-cons-shift</a> <a id="22199" class="Symbol">{</a><a id="22200" class="Argument">Δ</a> <a id="22202" class="Symbol">=</a> <a id="22204" href="lagda.2023-11-21-nbe.html#22204" class="Bound">Δ</a><a id="22205" class="Symbol">}</a> <a id="22207" class="Symbol">{</a><a id="22208" href="lagda.2023-11-21-nbe.html#22208" class="Bound">S</a><a id="22209" class="Symbol">}</a> <a id="22211" class="Symbol">{</a><a id="22212" href="lagda.2023-11-21-nbe.html#22212" class="Bound">T</a><a id="22213" class="Symbol">}</a> <a id="22215" class="Symbol">{</a><a id="22216" href="lagda.2023-11-21-nbe.html#22216" class="Bound">σ</a><a id="22217" class="Symbol">}</a> <a id="22219" class="Symbol">=</a> <a id="22221" href="lagda.2023-11-21-nbe.html#2744" class="Postulate">extensionality</a> <a id="22236" href="lagda.2023-11-21-nbe.html#22250" class="Function">lemma</a> <a id="22242" class="Keyword">where</a>
  <a id="22250" href="lagda.2023-11-21-nbe.html#22250" class="Function">lemma</a> <a id="22256" class="Symbol">:</a> <a id="22258" class="Symbol">∀</a> <a id="22260" class="Symbol">(</a><a id="22261" href="lagda.2023-11-21-nbe.html#22261" class="Bound">x</a> <a id="22263" class="Symbol">:</a> <a id="22265" href="lagda.2023-11-21-nbe.html#22204" class="Bound">Δ</a> <a id="22267" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="22269" href="lagda.2023-11-21-nbe.html#22208" class="Bound">S</a> <a id="22271" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="22273" href="lagda.2023-11-21-nbe.html#22212" class="Bound">T</a><a id="22274" class="Symbol">)</a> <a id="22276" class="Symbol">→</a> <a id="22278" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="22283" href="lagda.2023-11-21-nbe.html#22216" class="Bound">σ</a> <a id="22285" href="lagda.2023-11-21-nbe.html#22261" class="Bound">x</a> <a id="22287" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="22289" class="Symbol">((</a><a id="22291" href="lagda.2023-11-21-nbe.html#22216" class="Bound">σ</a> <a id="22293" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="22295" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a><a id="22296" class="Symbol">)</a> <a id="22298" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="22300" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="22302" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a><a id="22303" class="Symbol">)</a> <a id="22305" href="lagda.2023-11-21-nbe.html#22261" class="Bound">x</a>
  <a id="22309" href="lagda.2023-11-21-nbe.html#22250" class="Function">lemma</a> <a id="22315" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>     <a id="22321" class="Symbol">=</a> <a id="22323" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="22330" href="lagda.2023-11-21-nbe.html#22250" class="Function">lemma</a> <a id="22336" class="Symbol">(</a><a id="22337" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="22339" href="lagda.2023-11-21-nbe.html#22339" class="Bound">x</a><a id="22340" class="Symbol">)</a> <a id="22342" class="Symbol">=</a> <a id="22344" href="lagda.2023-11-21-nbe.html#21113" class="Function">rename-subst-ren</a>

<a id="exts-ids"></a><a id="22362" href="lagda.2023-11-21-nbe.html#22362" class="Function">exts-ids</a> <a id="22371" class="Symbol">:</a> <a id="22373" class="Symbol">∀</a> <a id="22375" class="Symbol">{</a><a id="22376" href="lagda.2023-11-21-nbe.html#22376" class="Bound">Γ</a> <a id="22378" class="Symbol">:</a> <a id="22380" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="22383" class="Symbol">}</a> <a id="22385" class="Symbol">{</a><a id="22386" href="lagda.2023-11-21-nbe.html#22386" class="Bound">S</a> <a id="22388" href="lagda.2023-11-21-nbe.html#22388" class="Bound">T</a> <a id="22390" class="Symbol">:</a> <a id="22392" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="22396" class="Symbol">}</a>
         <a id="22407" class="Symbol">→</a> <a id="22409" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="22414" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="22417" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="22419" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="22422" class="Symbol">{</a><a id="22423" href="lagda.2023-11-21-nbe.html#22376" class="Bound">Γ</a> <a id="22425" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="22427" href="lagda.2023-11-21-nbe.html#22386" class="Bound">S</a><a id="22428" class="Symbol">}</a> <a id="22430" class="Symbol">{</a><a id="22431" href="lagda.2023-11-21-nbe.html#22388" class="Bound">T</a><a id="22432" class="Symbol">}</a>
<a id="22434" href="lagda.2023-11-21-nbe.html#22362" class="Function">exts-ids</a> <a id="22443" class="Symbol">{</a><a id="22444" href="lagda.2023-11-21-nbe.html#22444" class="Bound">Γ</a><a id="22445" class="Symbol">}</a> <a id="22447" class="Symbol">{</a><a id="22448" href="lagda.2023-11-21-nbe.html#22448" class="Bound">S</a><a id="22449" class="Symbol">}</a> <a id="22451" class="Symbol">{</a><a id="22452" href="lagda.2023-11-21-nbe.html#22452" class="Bound">T</a><a id="22453" class="Symbol">}</a> <a id="22455" class="Symbol">=</a> <a id="22457" href="lagda.2023-11-21-nbe.html#2744" class="Postulate">extensionality</a> <a id="22472" href="lagda.2023-11-21-nbe.html#22486" class="Function">lemma</a> <a id="22478" class="Keyword">where</a>
  <a id="22486" href="lagda.2023-11-21-nbe.html#22486" class="Function">lemma</a> <a id="22492" class="Symbol">:</a> <a id="22494" class="Symbol">∀</a> <a id="22496" class="Symbol">(</a><a id="22497" href="lagda.2023-11-21-nbe.html#22497" class="Bound">x</a> <a id="22499" class="Symbol">:</a> <a id="22501" href="lagda.2023-11-21-nbe.html#22444" class="Bound">Γ</a> <a id="22503" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="22505" href="lagda.2023-11-21-nbe.html#22448" class="Bound">S</a> <a id="22507" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="22509" href="lagda.2023-11-21-nbe.html#22452" class="Bound">T</a><a id="22510" class="Symbol">)</a> <a id="22512" class="Symbol">→</a> <a id="22514" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="22519" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="22522" href="lagda.2023-11-21-nbe.html#22497" class="Bound">x</a> <a id="22524" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="22526" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="22529" href="lagda.2023-11-21-nbe.html#22497" class="Bound">x</a>
  <a id="22533" href="lagda.2023-11-21-nbe.html#22486" class="Function">lemma</a> <a id="22539" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>     <a id="22545" class="Symbol">=</a> <a id="22547" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="22554" href="lagda.2023-11-21-nbe.html#22486" class="Function">lemma</a> <a id="22560" class="Symbol">(</a><a id="22561" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="22563" href="lagda.2023-11-21-nbe.html#22563" class="Bound">x</a><a id="22564" class="Symbol">)</a> <a id="22566" class="Symbol">=</a> <a id="22568" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
</pre>--->
<pre class="Agda"><a id="[id]-identity"></a><a id="22591" href="lagda.2023-11-21-nbe.html#22591" class="Function">[id]-identity</a> <a id="22605" class="Symbol">:</a> <a id="22607" class="Symbol">∀</a> <a id="22609" class="Symbol">{</a><a id="22610" href="lagda.2023-11-21-nbe.html#22610" class="Bound">Γ</a> <a id="22612" class="Symbol">:</a> <a id="22614" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="22617" class="Symbol">}</a> <a id="22619" class="Symbol">{</a><a id="22620" href="lagda.2023-11-21-nbe.html#22620" class="Bound">T</a> <a id="22622" class="Symbol">:</a> <a id="22624" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="22628" class="Symbol">}</a> <a id="22630" class="Symbol">{</a><a id="22631" href="lagda.2023-11-21-nbe.html#22631" class="Bound">t</a> <a id="22633" class="Symbol">:</a> <a id="22635" href="lagda.2023-11-21-nbe.html#22610" class="Bound">Γ</a> <a id="22637" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="22639" href="lagda.2023-11-21-nbe.html#22620" class="Bound">T</a><a id="22640" class="Symbol">}</a>
              <a id="22656" class="Symbol">→</a> <a id="22658" href="lagda.2023-11-21-nbe.html#22631" class="Bound">t</a> <a id="22660" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="22662" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="22665" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a> <a id="22667" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="22669" href="lagda.2023-11-21-nbe.html#22631" class="Bound">t</a>
</pre>
<!---
<pre class="Agda"><a id="22690" href="lagda.2023-11-21-nbe.html#22591" class="Function">[id]-identity</a> <a id="22704" class="Symbol">{</a><a id="22705" class="Argument">t</a> <a id="22707" class="Symbol">=</a> <a id="22709" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a><a id="22713" class="Symbol">}</a>                                <a id="22746" class="Symbol">=</a> <a id="22748" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="22753" href="lagda.2023-11-21-nbe.html#22591" class="Function">[id]-identity</a> <a id="22767" class="Symbol">{</a><a id="22768" class="Argument">t</a> <a id="22770" class="Symbol">=</a> <a id="22772" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="22774" href="lagda.2023-11-21-nbe.html#22774" class="Bound">x</a><a id="22775" class="Symbol">}</a>                                 <a id="22809" class="Symbol">=</a> <a id="22811" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="22816" href="lagda.2023-11-21-nbe.html#22591" class="Function">[id]-identity</a> <a id="22830" class="Symbol">{</a><a id="22831" class="Argument">T</a> <a id="22833" class="Symbol">=</a> <a id="22835" href="lagda.2023-11-21-nbe.html#22835" class="Bound">S</a> <a id="22837" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="22839" href="lagda.2023-11-21-nbe.html#22839" class="Bound">T</a><a id="22840" class="Symbol">}</a> <a id="22842" class="Symbol">{</a><a id="22843" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="22845" href="lagda.2023-11-21-nbe.html#22845" class="Bound">t</a><a id="22846" class="Symbol">}</a>
  <a id="22850" class="Keyword">rewrite</a> <a id="22858" href="lagda.2023-11-21-nbe.html#19474" class="Function">cong-sub</a> <a id="22867" class="Symbol">{</a><a id="22868" class="Argument">t</a> <a id="22870" class="Symbol">=</a> <a id="22872" href="lagda.2023-11-21-nbe.html#22845" class="Bound">t</a><a id="22873" class="Symbol">}</a> <a id="22875" href="lagda.2023-11-21-nbe.html#22362" class="Function">exts-ids</a> <a id="22884" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
        <a id="22897" class="Symbol">|</a> <a id="22899" href="lagda.2023-11-21-nbe.html#22591" class="Function">[id]-identity</a> <a id="22913" class="Symbol">{</a><a id="22914" class="Argument">t</a> <a id="22916" class="Symbol">=</a> <a id="22918" href="lagda.2023-11-21-nbe.html#22845" class="Bound">t</a><a id="22919" class="Symbol">}</a>                         <a id="22945" class="Symbol">=</a> <a id="22947" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="22952" href="lagda.2023-11-21-nbe.html#22591" class="Function">[id]-identity</a> <a id="22966" class="Symbol">{</a><a id="22967" class="Argument">t</a> <a id="22969" class="Symbol">=</a> <a id="22971" href="lagda.2023-11-21-nbe.html#22971" class="Bound">r</a> <a id="22973" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="22975" href="lagda.2023-11-21-nbe.html#22975" class="Bound">s</a><a id="22976" class="Symbol">}</a>
  <a id="22980" class="Keyword">rewrite</a> <a id="22988" href="lagda.2023-11-21-nbe.html#22591" class="Function">[id]-identity</a> <a id="23002" class="Symbol">{</a><a id="23003" class="Argument">t</a> <a id="23005" class="Symbol">=</a> <a id="23007" href="lagda.2023-11-21-nbe.html#22971" class="Bound">r</a><a id="23008" class="Symbol">}</a> <a id="23010" class="Symbol">|</a> <a id="23012" href="lagda.2023-11-21-nbe.html#22591" class="Function">[id]-identity</a> <a id="23026" class="Symbol">{</a><a id="23027" class="Argument">t</a> <a id="23029" class="Symbol">=</a> <a id="23031" href="lagda.2023-11-21-nbe.html#22975" class="Bound">s</a><a id="23032" class="Symbol">}</a> <a id="23034" class="Symbol">=</a> <a id="23036" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="sub-idR"></a><a id="23042" href="lagda.2023-11-21-nbe.html#23042" class="Function">sub-idR</a> <a id="23050" class="Symbol">:</a> <a id="23052" class="Symbol">∀</a> <a id="23054" class="Symbol">{</a><a id="23055" href="lagda.2023-11-21-nbe.html#23055" class="Bound">Γ</a> <a id="23057" href="lagda.2023-11-21-nbe.html#23057" class="Bound">Δ</a> <a id="23059" class="Symbol">:</a> <a id="23061" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="23064" class="Symbol">}</a> <a id="23066" class="Symbol">{</a><a id="23067" href="lagda.2023-11-21-nbe.html#23067" class="Bound">σ</a> <a id="23069" class="Symbol">:</a> <a id="23071" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="23075" href="lagda.2023-11-21-nbe.html#23055" class="Bound">Γ</a> <a id="23077" href="lagda.2023-11-21-nbe.html#23057" class="Bound">Δ</a><a id="23078" class="Symbol">}</a> <a id="23080" class="Symbol">{</a><a id="23081" href="lagda.2023-11-21-nbe.html#23081" class="Bound">T</a> <a id="23083" class="Symbol">:</a> <a id="23085" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="23089" class="Symbol">}</a>
        <a id="23099" class="Symbol">→</a> <a id="23101" class="Symbol">(</a><a id="23102" href="lagda.2023-11-21-nbe.html#23067" class="Bound">σ</a> <a id="23104" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="23106" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a><a id="23108" class="Symbol">)</a> <a id="23110" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="23112" href="lagda.2023-11-21-nbe.html#23067" class="Bound">σ</a> <a id="23114" class="Symbol">{</a><a id="23115" href="lagda.2023-11-21-nbe.html#23081" class="Bound">T</a><a id="23116" class="Symbol">}</a>
<a id="23118" href="lagda.2023-11-21-nbe.html#23042" class="Function">sub-idR</a> <a id="23126" class="Symbol">=</a> <a id="23128" href="lagda.2023-11-21-nbe.html#2744" class="Postulate">extensionality</a> <a id="23143" class="Symbol">(λ</a> <a id="23146" href="lagda.2023-11-21-nbe.html#23146" class="Bound">_</a> <a id="23148" class="Symbol">→</a> <a id="23150" href="lagda.2023-11-21-nbe.html#22591" class="Function">[id]-identity</a><a id="23163" class="Symbol">)</a>

<a id="compose-ext"></a><a id="23166" href="lagda.2023-11-21-nbe.html#23166" class="Function">compose-ext</a> <a id="23178" class="Symbol">:</a> <a id="23180" class="Symbol">∀</a> <a id="23182" class="Symbol">{</a><a id="23183" href="lagda.2023-11-21-nbe.html#23183" class="Bound">Γ</a> <a id="23185" href="lagda.2023-11-21-nbe.html#23185" class="Bound">Δ</a> <a id="23187" href="lagda.2023-11-21-nbe.html#23187" class="Bound">Σ</a> <a id="23189" class="Symbol">:</a> <a id="23191" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="23194" class="Symbol">}</a> <a id="23196" class="Symbol">{</a><a id="23197" href="lagda.2023-11-21-nbe.html#23197" class="Bound">ρ</a> <a id="23199" class="Symbol">:</a> <a id="23201" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="23205" href="lagda.2023-11-21-nbe.html#23185" class="Bound">Δ</a> <a id="23207" href="lagda.2023-11-21-nbe.html#23187" class="Bound">Σ</a><a id="23208" class="Symbol">}</a> <a id="23210" class="Symbol">{</a><a id="23211" href="lagda.2023-11-21-nbe.html#23211" class="Bound">ω</a> <a id="23213" class="Symbol">:</a> <a id="23215" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="23219" href="lagda.2023-11-21-nbe.html#23183" class="Bound">Γ</a> <a id="23221" href="lagda.2023-11-21-nbe.html#23185" class="Bound">Δ</a><a id="23222" class="Symbol">}</a> <a id="23224" class="Symbol">{</a><a id="23225" href="lagda.2023-11-21-nbe.html#23225" class="Bound">S</a> <a id="23227" href="lagda.2023-11-21-nbe.html#23227" class="Bound">T</a> <a id="23229" class="Symbol">:</a> <a id="23231" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="23235" class="Symbol">}</a>
            <a id="23249" class="Symbol">→</a> <a id="23251" class="Symbol">(</a><a id="23252" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="23256" href="lagda.2023-11-21-nbe.html#23197" class="Bound">ρ</a><a id="23257" class="Symbol">)</a> <a id="23259" href="lagda.2023-11-21-nbe.html#13525" class="Function Operator">∘ʳ</a> <a id="23262" class="Symbol">(</a><a id="23263" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="23267" href="lagda.2023-11-21-nbe.html#23211" class="Bound">ω</a><a id="23268" class="Symbol">)</a> <a id="23270" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="23272" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="23276" class="Symbol">(</a><a id="23277" href="lagda.2023-11-21-nbe.html#23197" class="Bound">ρ</a> <a id="23279" href="lagda.2023-11-21-nbe.html#13525" class="Function Operator">∘ʳ</a> <a id="23282" href="lagda.2023-11-21-nbe.html#23211" class="Bound">ω</a><a id="23283" class="Symbol">)</a> <a id="23285" class="Symbol">{</a><a id="23286" href="lagda.2023-11-21-nbe.html#23225" class="Bound">S</a><a id="23287" class="Symbol">}</a> <a id="23289" class="Symbol">{</a><a id="23290" href="lagda.2023-11-21-nbe.html#23227" class="Bound">T</a><a id="23291" class="Symbol">}</a>
<a id="23293" href="lagda.2023-11-21-nbe.html#23166" class="Function">compose-ext</a> <a id="23305" class="Symbol">{</a><a id="23306" class="Argument">Σ</a> <a id="23308" class="Symbol">=</a> <a id="23310" href="lagda.2023-11-21-nbe.html#23310" class="Bound">Σ</a><a id="23311" class="Symbol">}</a> <a id="23313" class="Symbol">{</a><a id="23314" href="lagda.2023-11-21-nbe.html#23314" class="Bound">ρ</a><a id="23315" class="Symbol">}</a> <a id="23317" class="Symbol">{</a><a id="23318" href="lagda.2023-11-21-nbe.html#23318" class="Bound">ω</a><a id="23319" class="Symbol">}</a> <a id="23321" class="Symbol">{</a><a id="23322" href="lagda.2023-11-21-nbe.html#23322" class="Bound">S</a><a id="23323" class="Symbol">}</a> <a id="23325" class="Symbol">{</a><a id="23326" href="lagda.2023-11-21-nbe.html#23326" class="Bound">T</a><a id="23327" class="Symbol">}</a> <a id="23329" class="Symbol">=</a> <a id="23331" href="lagda.2023-11-21-nbe.html#2744" class="Postulate">extensionality</a> <a id="23346" href="lagda.2023-11-21-nbe.html#23360" class="Function">lemma</a> <a id="23352" class="Keyword">where</a>
  <a id="23360" href="lagda.2023-11-21-nbe.html#23360" class="Function">lemma</a> <a id="23366" class="Symbol">:</a> <a id="23368" class="Symbol">∀</a> <a id="23370" class="Symbol">(</a><a id="23371" href="lagda.2023-11-21-nbe.html#23371" class="Bound">x</a> <a id="23373" class="Symbol">:</a> <a id="23375" href="lagda.2023-11-21-nbe.html#23310" class="Bound">Σ</a> <a id="23377" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="23379" href="lagda.2023-11-21-nbe.html#23322" class="Bound">S</a> <a id="23381" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="23383" href="lagda.2023-11-21-nbe.html#23326" class="Bound">T</a><a id="23384" class="Symbol">)</a> <a id="23386" class="Symbol">→</a> <a id="23388" class="Symbol">((</a><a id="23390" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="23394" href="lagda.2023-11-21-nbe.html#23314" class="Bound">ρ</a><a id="23395" class="Symbol">)</a> <a id="23397" href="lagda.2023-11-21-nbe.html#13525" class="Function Operator">∘ʳ</a> <a id="23400" class="Symbol">(</a><a id="23401" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="23405" href="lagda.2023-11-21-nbe.html#23318" class="Bound">ω</a><a id="23406" class="Symbol">))</a> <a id="23409" href="lagda.2023-11-21-nbe.html#23371" class="Bound">x</a> <a id="23411" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="23413" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="23417" class="Symbol">(</a><a id="23418" href="lagda.2023-11-21-nbe.html#23314" class="Bound">ρ</a> <a id="23420" href="lagda.2023-11-21-nbe.html#13525" class="Function Operator">∘ʳ</a> <a id="23423" href="lagda.2023-11-21-nbe.html#23318" class="Bound">ω</a><a id="23424" class="Symbol">)</a> <a id="23426" href="lagda.2023-11-21-nbe.html#23371" class="Bound">x</a>
  <a id="23430" href="lagda.2023-11-21-nbe.html#23360" class="Function">lemma</a> <a id="23436" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>     <a id="23442" class="Symbol">=</a> <a id="23444" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="23451" href="lagda.2023-11-21-nbe.html#23360" class="Function">lemma</a> <a id="23457" class="Symbol">(</a><a id="23458" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="23460" href="lagda.2023-11-21-nbe.html#23460" class="Bound">x</a><a id="23461" class="Symbol">)</a> <a id="23463" class="Symbol">=</a> <a id="23465" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="compose-rename"></a><a id="23471" href="lagda.2023-11-21-nbe.html#23471" class="Function">compose-rename</a> <a id="23486" class="Symbol">:</a> <a id="23488" class="Symbol">∀</a> <a id="23490" class="Symbol">{</a><a id="23491" href="lagda.2023-11-21-nbe.html#23491" class="Bound">Γ</a> <a id="23493" href="lagda.2023-11-21-nbe.html#23493" class="Bound">Δ</a> <a id="23495" href="lagda.2023-11-21-nbe.html#23495" class="Bound">Σ</a> <a id="23497" class="Symbol">:</a> <a id="23499" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="23502" class="Symbol">}</a> <a id="23504" class="Symbol">{</a><a id="23505" href="lagda.2023-11-21-nbe.html#23505" class="Bound">T</a> <a id="23507" class="Symbol">:</a> <a id="23509" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="23513" class="Symbol">}</a> <a id="23515" class="Symbol">{</a><a id="23516" href="lagda.2023-11-21-nbe.html#23516" class="Bound">t</a> <a id="23518" class="Symbol">:</a> <a id="23520" href="lagda.2023-11-21-nbe.html#23495" class="Bound">Σ</a> <a id="23522" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="23524" href="lagda.2023-11-21-nbe.html#23505" class="Bound">T</a><a id="23525" class="Symbol">}</a> <a id="23527" class="Symbol">{</a><a id="23528" href="lagda.2023-11-21-nbe.html#23528" class="Bound">ω</a> <a id="23530" class="Symbol">:</a> <a id="23532" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="23536" href="lagda.2023-11-21-nbe.html#23491" class="Bound">Γ</a> <a id="23538" href="lagda.2023-11-21-nbe.html#23493" class="Bound">Δ</a><a id="23539" class="Symbol">}</a>
                   <a id="23560" class="Symbol">{</a><a id="23561" href="lagda.2023-11-21-nbe.html#23561" class="Bound">ρ</a> <a id="23563" class="Symbol">:</a> <a id="23565" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="23569" href="lagda.2023-11-21-nbe.html#23493" class="Bound">Δ</a> <a id="23571" href="lagda.2023-11-21-nbe.html#23495" class="Bound">Σ</a><a id="23572" class="Symbol">}</a>
               <a id="23589" class="Symbol">→</a> <a id="23591" href="lagda.2023-11-21-nbe.html#23516" class="Bound">t</a> <a id="23593" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">[</a> <a id="23595" href="lagda.2023-11-21-nbe.html#23561" class="Bound">ρ</a> <a id="23597" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">]ʳ</a> <a id="23600" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">[</a> <a id="23602" href="lagda.2023-11-21-nbe.html#23528" class="Bound">ω</a> <a id="23604" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">]ʳ</a> <a id="23607" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="23609" href="lagda.2023-11-21-nbe.html#23516" class="Bound">t</a> <a id="23611" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">[</a> <a id="23613" href="lagda.2023-11-21-nbe.html#23561" class="Bound">ρ</a> <a id="23615" href="lagda.2023-11-21-nbe.html#13525" class="Function Operator">∘ʳ</a> <a id="23618" href="lagda.2023-11-21-nbe.html#23528" class="Bound">ω</a> <a id="23620" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">]ʳ</a>
<a id="23623" href="lagda.2023-11-21-nbe.html#23471" class="Function">compose-rename</a> <a id="23638" class="Symbol">{</a><a id="23639" class="Argument">t</a> <a id="23641" class="Symbol">=</a> <a id="23643" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a><a id="23647" class="Symbol">}</a>                               <a id="23679" class="Symbol">=</a> <a id="23681" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="23686" href="lagda.2023-11-21-nbe.html#23471" class="Function">compose-rename</a> <a id="23701" class="Symbol">{</a><a id="23702" class="Argument">t</a> <a id="23704" class="Symbol">=</a> <a id="23706" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="23708" href="lagda.2023-11-21-nbe.html#23708" class="Bound">x</a><a id="23709" class="Symbol">}</a>                                <a id="23742" class="Symbol">=</a> <a id="23744" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="23749" href="lagda.2023-11-21-nbe.html#23471" class="Function">compose-rename</a> <a id="23764" class="Symbol">{</a><a id="23765" class="Argument">T</a> <a id="23767" class="Symbol">=</a> <a id="23769" href="lagda.2023-11-21-nbe.html#23769" class="Bound">S</a> <a id="23771" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="23773" href="lagda.2023-11-21-nbe.html#23773" class="Bound">T</a><a id="23774" class="Symbol">}</a> <a id="23776" class="Symbol">{</a><a id="23777" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="23779" href="lagda.2023-11-21-nbe.html#23779" class="Bound">t</a><a id="23780" class="Symbol">}</a> <a id="23782" class="Symbol">{</a><a id="23783" href="lagda.2023-11-21-nbe.html#23783" class="Bound">ω</a><a id="23784" class="Symbol">}</a> <a id="23786" class="Symbol">{</a><a id="23787" href="lagda.2023-11-21-nbe.html#23787" class="Bound">ρ</a><a id="23788" class="Symbol">}</a>
  <a id="23792" class="Keyword">rewrite</a> <a id="23800" href="lagda.2023-11-21-nbe.html#23471" class="Function">compose-rename</a> <a id="23815" class="Symbol">{</a><a id="23816" class="Argument">t</a> <a id="23818" class="Symbol">=</a> <a id="23820" href="lagda.2023-11-21-nbe.html#23779" class="Bound">t</a><a id="23821" class="Symbol">}</a> <a id="23823" class="Symbol">{</a><a id="23824" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="23828" href="lagda.2023-11-21-nbe.html#23783" class="Bound">ω</a><a id="23829" class="Symbol">}</a> <a id="23831" class="Symbol">{</a><a id="23832" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="23836" href="lagda.2023-11-21-nbe.html#23787" class="Bound">ρ</a><a id="23837" class="Symbol">}</a>
        <a id="23847" class="Symbol">|</a> <a id="23849" href="lagda.2023-11-21-nbe.html#18598" class="Function">cong-rename</a> <a id="23861" class="Symbol">{</a><a id="23862" class="Argument">t</a> <a id="23864" class="Symbol">=</a> <a id="23866" href="lagda.2023-11-21-nbe.html#23779" class="Bound">t</a><a id="23867" class="Symbol">}</a> <a id="23869" class="Symbol">(</a><a id="23870" href="lagda.2023-11-21-nbe.html#23166" class="Function">compose-ext</a> <a id="23882" class="Symbol">{</a><a id="23883" class="Argument">ρ</a> <a id="23885" class="Symbol">=</a> <a id="23887" href="lagda.2023-11-21-nbe.html#23787" class="Bound">ρ</a><a id="23888" class="Symbol">}</a> <a id="23890" class="Symbol">{</a><a id="23891" href="lagda.2023-11-21-nbe.html#23783" class="Bound">ω</a><a id="23892" class="Symbol">})</a> <a id="23895" class="Symbol">=</a> <a id="23897" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="23902" href="lagda.2023-11-21-nbe.html#23471" class="Function">compose-rename</a> <a id="23917" class="Symbol">{</a><a id="23918" class="Argument">t</a> <a id="23920" class="Symbol">=</a> <a id="23922" href="lagda.2023-11-21-nbe.html#23922" class="Bound">r</a> <a id="23924" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="23926" href="lagda.2023-11-21-nbe.html#23926" class="Bound">s</a><a id="23927" class="Symbol">}</a> <a id="23929" class="Symbol">{</a><a id="23930" href="lagda.2023-11-21-nbe.html#23930" class="Bound">ω</a><a id="23931" class="Symbol">}</a> <a id="23933" class="Symbol">{</a><a id="23934" href="lagda.2023-11-21-nbe.html#23934" class="Bound">ρ</a><a id="23935" class="Symbol">}</a>
  <a id="23939" class="Keyword">rewrite</a> <a id="23947" href="lagda.2023-11-21-nbe.html#23471" class="Function">compose-rename</a> <a id="23962" class="Symbol">{</a><a id="23963" class="Argument">t</a> <a id="23965" class="Symbol">=</a> <a id="23967" href="lagda.2023-11-21-nbe.html#23922" class="Bound">r</a><a id="23968" class="Symbol">}</a> <a id="23970" class="Symbol">{</a><a id="23971" href="lagda.2023-11-21-nbe.html#23930" class="Bound">ω</a><a id="23972" class="Symbol">}</a> <a id="23974" class="Symbol">{</a><a id="23975" href="lagda.2023-11-21-nbe.html#23934" class="Bound">ρ</a><a id="23976" class="Symbol">}</a>
        <a id="23986" class="Symbol">|</a> <a id="23988" href="lagda.2023-11-21-nbe.html#23471" class="Function">compose-rename</a> <a id="24003" class="Symbol">{</a><a id="24004" class="Argument">t</a> <a id="24006" class="Symbol">=</a> <a id="24008" href="lagda.2023-11-21-nbe.html#23926" class="Bound">s</a><a id="24009" class="Symbol">}</a> <a id="24011" class="Symbol">{</a><a id="24012" href="lagda.2023-11-21-nbe.html#23930" class="Bound">ω</a><a id="24013" class="Symbol">}</a> <a id="24015" class="Symbol">{</a><a id="24016" href="lagda.2023-11-21-nbe.html#23934" class="Bound">ρ</a><a id="24017" class="Symbol">}</a>                <a id="24034" class="Symbol">=</a> <a id="24036" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="commute-subst-rename"></a><a id="24042" href="lagda.2023-11-21-nbe.html#24042" class="Function">commute-subst-rename</a> <a id="24063" class="Symbol">:</a> <a id="24065" class="Symbol">∀</a> <a id="24067" class="Symbol">{</a><a id="24068" href="lagda.2023-11-21-nbe.html#24068" class="Bound">Γ</a> <a id="24070" href="lagda.2023-11-21-nbe.html#24070" class="Bound">Δ</a> <a id="24072" href="lagda.2023-11-21-nbe.html#24072" class="Bound">Σ</a> <a id="24074" href="lagda.2023-11-21-nbe.html#24074" class="Bound">Φ</a> <a id="24076" class="Symbol">:</a> <a id="24078" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="24081" class="Symbol">}</a> <a id="24083" class="Symbol">{</a><a id="24084" href="lagda.2023-11-21-nbe.html#24084" class="Bound">T</a> <a id="24086" class="Symbol">:</a> <a id="24088" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="24092" class="Symbol">}</a> <a id="24094" class="Symbol">{</a><a id="24095" href="lagda.2023-11-21-nbe.html#24095" class="Bound">t</a> <a id="24097" class="Symbol">:</a> <a id="24099" href="lagda.2023-11-21-nbe.html#24072" class="Bound">Σ</a> <a id="24101" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="24103" href="lagda.2023-11-21-nbe.html#24084" class="Bound">T</a><a id="24104" class="Symbol">}</a>
                         <a id="24131" class="Symbol">{</a><a id="24132" href="lagda.2023-11-21-nbe.html#24132" class="Bound">σ</a> <a id="24134" class="Symbol">:</a> <a id="24136" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="24140" href="lagda.2023-11-21-nbe.html#24068" class="Bound">Γ</a> <a id="24142" href="lagda.2023-11-21-nbe.html#24070" class="Bound">Δ</a><a id="24143" class="Symbol">}</a> <a id="24145" class="Symbol">{</a><a id="24146" href="lagda.2023-11-21-nbe.html#24146" class="Bound">ρ</a> <a id="24148" class="Symbol">:</a> <a id="24150" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="24154" href="lagda.2023-11-21-nbe.html#24070" class="Bound">Δ</a> <a id="24156" href="lagda.2023-11-21-nbe.html#24072" class="Bound">Σ</a><a id="24157" class="Symbol">}</a>
                         <a id="24184" class="Symbol">{</a><a id="24185" href="lagda.2023-11-21-nbe.html#24185" class="Bound">ρ′</a> <a id="24188" class="Symbol">:</a> <a id="24190" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="24194" href="lagda.2023-11-21-nbe.html#24068" class="Bound">Γ</a> <a id="24196" href="lagda.2023-11-21-nbe.html#24074" class="Bound">Φ</a> <a id="24198" class="Symbol">}</a> <a id="24200" class="Symbol">{</a><a id="24201" href="lagda.2023-11-21-nbe.html#24201" class="Bound">σ′</a> <a id="24204" class="Symbol">:</a> <a id="24206" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="24210" href="lagda.2023-11-21-nbe.html#24074" class="Bound">Φ</a> <a id="24212" href="lagda.2023-11-21-nbe.html#24072" class="Bound">Σ</a><a id="24213" class="Symbol">}</a>
                     <a id="24236" class="Symbol">→</a> <a id="24238" class="Symbol">(∀</a> <a id="24241" class="Symbol">{</a><a id="24242" href="lagda.2023-11-21-nbe.html#24242" class="Bound">S</a> <a id="24244" class="Symbol">:</a> <a id="24246" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="24250" class="Symbol">}</a> <a id="24252" class="Symbol">{</a><a id="24253" href="lagda.2023-11-21-nbe.html#24253" class="Bound">x</a> <a id="24255" class="Symbol">:</a> <a id="24257" href="lagda.2023-11-21-nbe.html#24072" class="Bound">Σ</a> <a id="24259" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="24261" href="lagda.2023-11-21-nbe.html#24242" class="Bound">S</a><a id="24262" class="Symbol">}</a> <a id="24264" class="Symbol">→</a> <a id="24266" href="lagda.2023-11-21-nbe.html#24132" class="Bound">σ</a> <a id="24268" class="Symbol">(</a><a id="24269" href="lagda.2023-11-21-nbe.html#24146" class="Bound">ρ</a> <a id="24271" href="lagda.2023-11-21-nbe.html#24253" class="Bound">x</a><a id="24272" class="Symbol">)</a> <a id="24274" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="24276" href="lagda.2023-11-21-nbe.html#24201" class="Bound">σ′</a> <a id="24279" href="lagda.2023-11-21-nbe.html#24253" class="Bound">x</a> <a id="24281" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">[</a> <a id="24283" href="lagda.2023-11-21-nbe.html#24185" class="Bound">ρ′</a> <a id="24286" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">]ʳ</a><a id="24288" class="Symbol">)</a>
                     <a id="24311" class="Symbol">→</a> <a id="24313" href="lagda.2023-11-21-nbe.html#24095" class="Bound">t</a> <a id="24315" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">[</a> <a id="24317" href="lagda.2023-11-21-nbe.html#24146" class="Bound">ρ</a> <a id="24319" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">]ʳ</a> <a id="24322" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="24324" href="lagda.2023-11-21-nbe.html#24132" class="Bound">σ</a> <a id="24326" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a> <a id="24328" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="24330" href="lagda.2023-11-21-nbe.html#24095" class="Bound">t</a> <a id="24332" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="24334" href="lagda.2023-11-21-nbe.html#24201" class="Bound">σ′</a> <a id="24337" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a> <a id="24339" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">[</a> <a id="24341" href="lagda.2023-11-21-nbe.html#24185" class="Bound">ρ′</a> <a id="24344" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">]ʳ</a>
<a id="24347" href="lagda.2023-11-21-nbe.html#24042" class="Function">commute-subst-rename</a> <a id="24368" class="Symbol">{</a><a id="24369" class="Argument">t</a> <a id="24371" class="Symbol">=</a> <a id="24373" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a><a id="24377" class="Symbol">}</a> <a id="24379" href="lagda.2023-11-21-nbe.html#24379" class="Bound">pf</a> <a id="24382" class="Symbol">=</a> <a id="24384" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="24389" href="lagda.2023-11-21-nbe.html#24042" class="Function">commute-subst-rename</a> <a id="24410" class="Symbol">{</a><a id="24411" class="Argument">t</a> <a id="24413" class="Symbol">=</a> <a id="24415" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="24417" href="lagda.2023-11-21-nbe.html#24417" class="Bound">x</a><a id="24418" class="Symbol">}</a> <a id="24420" href="lagda.2023-11-21-nbe.html#24420" class="Bound">pf</a> <a id="24423" class="Symbol">=</a> <a id="24425" href="lagda.2023-11-21-nbe.html#24420" class="Bound">pf</a>
<a id="24428" href="lagda.2023-11-21-nbe.html#24042" class="Function">commute-subst-rename</a> <a id="24449" class="Symbol">{</a><a id="24450" class="Argument">Σ</a> <a id="24452" class="Symbol">=</a> <a id="24454" href="lagda.2023-11-21-nbe.html#24454" class="Bound">Σ</a><a id="24455" class="Symbol">}</a> <a id="24457" class="Symbol">{</a><a id="24458" class="Argument">T</a> <a id="24460" class="Symbol">=</a> <a id="24462" href="lagda.2023-11-21-nbe.html#24462" class="Bound">S</a> <a id="24464" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="24466" href="lagda.2023-11-21-nbe.html#24466" class="Bound">T</a><a id="24467" class="Symbol">}</a> <a id="24469" class="Symbol">{</a><a id="24470" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="24472" href="lagda.2023-11-21-nbe.html#24472" class="Bound">t</a><a id="24473" class="Symbol">}</a> <a id="24475" class="Symbol">{</a><a id="24476" href="lagda.2023-11-21-nbe.html#24476" class="Bound">σ</a><a id="24477" class="Symbol">}</a> <a id="24479" class="Symbol">{</a><a id="24480" href="lagda.2023-11-21-nbe.html#24480" class="Bound">ρ</a><a id="24481" class="Symbol">}</a> <a id="24483" class="Symbol">{</a><a id="24484" href="lagda.2023-11-21-nbe.html#24484" class="Bound">ρ′</a><a id="24486" class="Symbol">}</a> <a id="24488" class="Symbol">{</a><a id="24489" href="lagda.2023-11-21-nbe.html#24489" class="Bound">σ′</a><a id="24491" class="Symbol">}</a> <a id="24493" href="lagda.2023-11-21-nbe.html#24493" class="Bound">pf</a> <a id="24496" class="Symbol">=</a>
  <a id="24500" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="24505" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ_</a> <a id="24508" class="Symbol">(</a><a id="24509" href="lagda.2023-11-21-nbe.html#24042" class="Function">commute-subst-rename</a> <a id="24530" class="Symbol">{</a><a id="24531" class="Argument">t</a> <a id="24533" class="Symbol">=</a> <a id="24535" href="lagda.2023-11-21-nbe.html#24472" class="Bound">t</a><a id="24536" class="Symbol">}</a> <a id="24538" class="Symbol">(λ</a> <a id="24541" class="Symbol">{</a><a id="24542" href="lagda.2023-11-21-nbe.html#24542" class="Bound">_</a><a id="24543" class="Symbol">}</a> <a id="24545" class="Symbol">{</a><a id="24546" href="lagda.2023-11-21-nbe.html#24546" class="Bound">x</a><a id="24547" class="Symbol">}</a> <a id="24549" class="Symbol">→</a> <a id="24551" href="lagda.2023-11-21-nbe.html#24569" class="Function">H</a> <a id="24553" href="lagda.2023-11-21-nbe.html#24546" class="Bound">x</a><a id="24554" class="Symbol">))</a>
  <a id="24559" class="Keyword">where</a>
    <a id="24569" href="lagda.2023-11-21-nbe.html#24569" class="Function">H</a> <a id="24571" class="Symbol">:</a> <a id="24573" class="Symbol">∀</a> <a id="24575" class="Symbol">{</a><a id="24576" href="lagda.2023-11-21-nbe.html#24576" class="Bound">U</a> <a id="24578" class="Symbol">:</a> <a id="24580" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="24584" class="Symbol">}</a> <a id="24586" class="Symbol">(</a><a id="24587" href="lagda.2023-11-21-nbe.html#24587" class="Bound">x</a> <a id="24589" class="Symbol">:</a> <a id="24591" href="lagda.2023-11-21-nbe.html#24454" class="Bound">Σ</a> <a id="24593" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="24595" href="lagda.2023-11-21-nbe.html#24462" class="Bound">S</a> <a id="24597" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="24599" href="lagda.2023-11-21-nbe.html#24576" class="Bound">U</a><a id="24600" class="Symbol">)</a> <a id="24602" class="Symbol">→</a> <a id="24604" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="24609" href="lagda.2023-11-21-nbe.html#24476" class="Bound">σ</a> <a id="24611" class="Symbol">(</a><a id="24612" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="24616" href="lagda.2023-11-21-nbe.html#24480" class="Bound">ρ</a> <a id="24618" href="lagda.2023-11-21-nbe.html#24587" class="Bound">x</a><a id="24619" class="Symbol">)</a> <a id="24621" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="24623" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="24628" href="lagda.2023-11-21-nbe.html#24489" class="Bound">σ′</a> <a id="24631" href="lagda.2023-11-21-nbe.html#24587" class="Bound">x</a> <a id="24633" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">[</a> <a id="24635" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="24639" href="lagda.2023-11-21-nbe.html#24484" class="Bound">ρ′</a> <a id="24642" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">]ʳ</a>
    <a id="24649" href="lagda.2023-11-21-nbe.html#24569" class="Function">H</a> <a id="24651" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a> <a id="24653" class="Symbol">=</a> <a id="24655" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
    <a id="24664" href="lagda.2023-11-21-nbe.html#24569" class="Function">H</a> <a id="24666" class="Symbol">(</a><a id="24667" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="24669" href="lagda.2023-11-21-nbe.html#24669" class="Bound">x</a><a id="24670" class="Symbol">)</a> <a id="24672" class="Keyword">rewrite</a> <a id="24680" href="lagda.2023-11-21-nbe.html#24493" class="Bound">pf</a> <a id="24683" class="Symbol">{</a><a id="24684" class="Argument">x</a> <a id="24686" class="Symbol">=</a> <a id="24688" href="lagda.2023-11-21-nbe.html#24669" class="Bound">x</a><a id="24689" class="Symbol">}</a>
                  <a id="24709" class="Symbol">|</a> <a id="24711" href="lagda.2023-11-21-nbe.html#23471" class="Function">compose-rename</a> <a id="24726" class="Symbol">{</a><a id="24727" class="Argument">t</a> <a id="24729" class="Symbol">=</a> <a id="24731" href="lagda.2023-11-21-nbe.html#24489" class="Bound">σ′</a> <a id="24734" href="lagda.2023-11-21-nbe.html#24669" class="Bound">x</a><a id="24735" class="Symbol">}</a> <a id="24737" class="Symbol">{</a><a id="24738" href="lagda.2023-11-21-nbe.html#13230" class="Function">↥ʳ</a> <a id="24741" class="Symbol">{</a><a id="24742" class="Argument">T</a> <a id="24744" class="Symbol">=</a> <a id="24746" href="lagda.2023-11-21-nbe.html#24462" class="Bound">S</a><a id="24747" class="Symbol">}}</a> <a id="24750" class="Symbol">{</a><a id="24751" href="lagda.2023-11-21-nbe.html#24484" class="Bound">ρ′</a><a id="24753" class="Symbol">}</a>
                  <a id="24773" class="Symbol">|</a> <a id="24775" href="lagda.2023-11-21-nbe.html#23471" class="Function">compose-rename</a> <a id="24790" class="Symbol">{</a><a id="24791" class="Argument">t</a> <a id="24793" class="Symbol">=</a> <a id="24795" href="lagda.2023-11-21-nbe.html#24489" class="Bound">σ′</a> <a id="24798" href="lagda.2023-11-21-nbe.html#24669" class="Bound">x</a><a id="24799" class="Symbol">}</a> <a id="24801" class="Symbol">{</a><a id="24802" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="24806" href="lagda.2023-11-21-nbe.html#24484" class="Bound">ρ′</a> <a id="24809" class="Symbol">{</a><a id="24810" href="lagda.2023-11-21-nbe.html#24462" class="Bound">S</a><a id="24811" class="Symbol">}}</a> <a id="24814" class="Symbol">{</a><a id="24815" href="lagda.2023-11-21-nbe.html#13230" class="Function">↥ʳ</a><a id="24817" class="Symbol">}</a> <a id="24819" class="Symbol">=</a> <a id="24821" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="24826" href="lagda.2023-11-21-nbe.html#24042" class="Function">commute-subst-rename</a> <a id="24847" class="Symbol">{</a><a id="24848" class="Argument">t</a> <a id="24850" class="Symbol">=</a> <a id="24852" href="lagda.2023-11-21-nbe.html#24852" class="Bound">r</a> <a id="24854" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="24856" href="lagda.2023-11-21-nbe.html#24856" class="Bound">s</a><a id="24857" class="Symbol">}</a> <a id="24859" class="Symbol">{</a><a id="24860" href="lagda.2023-11-21-nbe.html#24860" class="Bound">σ</a><a id="24861" class="Symbol">}</a> <a id="24863" class="Symbol">{</a><a id="24864" href="lagda.2023-11-21-nbe.html#24864" class="Bound">ρ</a><a id="24865" class="Symbol">}</a> <a id="24867" class="Symbol">{</a><a id="24868" href="lagda.2023-11-21-nbe.html#24868" class="Bound">ρ′</a><a id="24870" class="Symbol">}</a> <a id="24872" class="Symbol">{</a><a id="24873" href="lagda.2023-11-21-nbe.html#24873" class="Bound">σ′</a><a id="24875" class="Symbol">}</a> <a id="24877" href="lagda.2023-11-21-nbe.html#24877" class="Bound">pf</a>
  <a id="24882" class="Keyword">rewrite</a> <a id="24890" href="lagda.2023-11-21-nbe.html#24042" class="Function">commute-subst-rename</a> <a id="24911" class="Symbol">{</a><a id="24912" class="Argument">t</a> <a id="24914" class="Symbol">=</a> <a id="24916" href="lagda.2023-11-21-nbe.html#24852" class="Bound">r</a><a id="24917" class="Symbol">}</a> <a id="24919" class="Symbol">{</a><a id="24920" href="lagda.2023-11-21-nbe.html#24860" class="Bound">σ</a><a id="24921" class="Symbol">}</a> <a id="24923" class="Symbol">{</a><a id="24924" href="lagda.2023-11-21-nbe.html#24864" class="Bound">ρ</a><a id="24925" class="Symbol">}</a> <a id="24927" class="Symbol">{</a><a id="24928" href="lagda.2023-11-21-nbe.html#24868" class="Bound">ρ′</a><a id="24930" class="Symbol">}</a> <a id="24932" class="Symbol">{</a><a id="24933" href="lagda.2023-11-21-nbe.html#24873" class="Bound">σ′</a><a id="24935" class="Symbol">}</a> <a id="24937" href="lagda.2023-11-21-nbe.html#24877" class="Bound">pf</a>
        <a id="24948" class="Symbol">|</a> <a id="24950" href="lagda.2023-11-21-nbe.html#24042" class="Function">commute-subst-rename</a> <a id="24971" class="Symbol">{</a><a id="24972" class="Argument">t</a> <a id="24974" class="Symbol">=</a> <a id="24976" href="lagda.2023-11-21-nbe.html#24856" class="Bound">s</a><a id="24977" class="Symbol">}</a> <a id="24979" class="Symbol">{</a><a id="24980" href="lagda.2023-11-21-nbe.html#24860" class="Bound">σ</a><a id="24981" class="Symbol">}</a> <a id="24983" class="Symbol">{</a><a id="24984" href="lagda.2023-11-21-nbe.html#24864" class="Bound">ρ</a><a id="24985" class="Symbol">}</a> <a id="24987" class="Symbol">{</a><a id="24988" href="lagda.2023-11-21-nbe.html#24868" class="Bound">ρ′</a><a id="24990" class="Symbol">}</a> <a id="24992" class="Symbol">{</a><a id="24993" href="lagda.2023-11-21-nbe.html#24873" class="Bound">σ′</a><a id="24995" class="Symbol">}</a> <a id="24997" href="lagda.2023-11-21-nbe.html#24877" class="Bound">pf</a> <a id="25000" class="Symbol">=</a> <a id="25002" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="sub-𝑆-shift"></a><a id="25008" href="lagda.2023-11-21-nbe.html#25008" class="Function">sub-𝑆-shift</a> <a id="25020" class="Symbol">:</a> <a id="25022" class="Symbol">∀</a> <a id="25024" class="Symbol">{</a><a id="25025" href="lagda.2023-11-21-nbe.html#25025" class="Bound">Γ</a> <a id="25027" href="lagda.2023-11-21-nbe.html#25027" class="Bound">Δ</a> <a id="25029" class="Symbol">:</a> <a id="25031" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="25034" class="Symbol">}</a> <a id="25036" class="Symbol">{</a><a id="25037" href="lagda.2023-11-21-nbe.html#25037" class="Bound">S</a> <a id="25039" href="lagda.2023-11-21-nbe.html#25039" class="Bound">T</a> <a id="25041" class="Symbol">:</a> <a id="25043" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="25047" class="Symbol">}</a> <a id="25049" class="Symbol">{</a><a id="25050" href="lagda.2023-11-21-nbe.html#25050" class="Bound">σ</a> <a id="25052" class="Symbol">:</a> <a id="25054" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="25058" href="lagda.2023-11-21-nbe.html#25025" class="Bound">Γ</a> <a id="25060" class="Symbol">(</a><a id="25061" href="lagda.2023-11-21-nbe.html#25027" class="Bound">Δ</a> <a id="25063" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="25065" href="lagda.2023-11-21-nbe.html#25037" class="Bound">S</a><a id="25066" class="Symbol">)}</a> <a id="25069" class="Symbol">{</a><a id="25070" href="lagda.2023-11-21-nbe.html#25070" class="Bound">x</a> <a id="25072" class="Symbol">:</a> <a id="25074" href="lagda.2023-11-21-nbe.html#25027" class="Bound">Δ</a> <a id="25076" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="25078" href="lagda.2023-11-21-nbe.html#25039" class="Bound">T</a><a id="25079" class="Symbol">}</a>
            <a id="25093" class="Symbol">→</a> <a id="25095" href="lagda.2023-11-21-nbe.html#25050" class="Bound">σ</a> <a id="25097" class="Symbol">(</a><a id="25098" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆_</a> <a id="25101" class="Symbol">{</a><a id="25102" class="Argument">T</a> <a id="25104" class="Symbol">=</a> <a id="25106" href="lagda.2023-11-21-nbe.html#25039" class="Bound">T</a><a id="25107" class="Symbol">}</a> <a id="25109" href="lagda.2023-11-21-nbe.html#25070" class="Bound">x</a><a id="25110" class="Symbol">)</a> <a id="25112" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="25114" class="Symbol">(</a><a id="25115" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a> <a id="25117" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="25119" href="lagda.2023-11-21-nbe.html#25050" class="Bound">σ</a><a id="25120" class="Symbol">)</a> <a id="25122" href="lagda.2023-11-21-nbe.html#25070" class="Bound">x</a>
<a id="25124" href="lagda.2023-11-21-nbe.html#25008" class="Function">sub-𝑆-shift</a> <a id="25136" class="Symbol">=</a> <a id="25138" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="exts-seq"></a><a id="25144" href="lagda.2023-11-21-nbe.html#25144" class="Function">exts-seq</a> <a id="25153" class="Symbol">:</a> <a id="25155" class="Symbol">∀</a> <a id="25157" class="Symbol">{</a><a id="25158" href="lagda.2023-11-21-nbe.html#25158" class="Bound">Γ</a> <a id="25160" href="lagda.2023-11-21-nbe.html#25160" class="Bound">Δ</a> <a id="25162" href="lagda.2023-11-21-nbe.html#25162" class="Bound">Σ</a> <a id="25164" class="Symbol">:</a> <a id="25166" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="25169" class="Symbol">}</a> <a id="25171" class="Symbol">{</a><a id="25172" href="lagda.2023-11-21-nbe.html#25172" class="Bound">τ</a> <a id="25174" class="Symbol">:</a> <a id="25176" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="25180" href="lagda.2023-11-21-nbe.html#25158" class="Bound">Γ</a> <a id="25182" href="lagda.2023-11-21-nbe.html#25160" class="Bound">Δ</a><a id="25183" class="Symbol">}</a> <a id="25185" class="Symbol">{</a><a id="25186" href="lagda.2023-11-21-nbe.html#25186" class="Bound">σ</a> <a id="25188" class="Symbol">:</a> <a id="25190" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="25194" href="lagda.2023-11-21-nbe.html#25160" class="Bound">Δ</a> <a id="25196" href="lagda.2023-11-21-nbe.html#25162" class="Bound">Σ</a><a id="25197" class="Symbol">}</a> <a id="25199" class="Symbol">{</a><a id="25200" href="lagda.2023-11-21-nbe.html#25200" class="Bound">S</a> <a id="25202" class="Symbol">:</a> <a id="25204" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="25208" class="Symbol">}</a>
         <a id="25219" class="Symbol">→</a> <a id="25221" class="Symbol">∀</a> <a id="25223" class="Symbol">{</a><a id="25224" href="lagda.2023-11-21-nbe.html#25224" class="Bound">T</a> <a id="25226" class="Symbol">:</a> <a id="25228" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="25232" class="Symbol">}</a> <a id="25234" class="Symbol">→</a> <a id="25236" class="Symbol">(</a><a id="25237" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="25242" href="lagda.2023-11-21-nbe.html#25186" class="Bound">σ</a> <a id="25244" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="25246" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="25251" href="lagda.2023-11-21-nbe.html#25172" class="Bound">τ</a><a id="25252" class="Symbol">)</a> <a id="25254" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="25256" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="25261" class="Symbol">(</a><a id="25262" href="lagda.2023-11-21-nbe.html#25186" class="Bound">σ</a> <a id="25264" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="25266" href="lagda.2023-11-21-nbe.html#25172" class="Bound">τ</a><a id="25267" class="Symbol">)</a> <a id="25269" class="Symbol">{</a><a id="25270" href="lagda.2023-11-21-nbe.html#25200" class="Bound">S</a><a id="25271" class="Symbol">}</a> <a id="25273" class="Symbol">{</a><a id="25274" href="lagda.2023-11-21-nbe.html#25224" class="Bound">T</a><a id="25275" class="Symbol">}</a>
<a id="25277" href="lagda.2023-11-21-nbe.html#25144" class="Function">exts-seq</a> <a id="25286" class="Symbol">{</a><a id="25287" class="Argument">Σ</a> <a id="25289" class="Symbol">=</a> <a id="25291" href="lagda.2023-11-21-nbe.html#25291" class="Bound">Σ</a><a id="25292" class="Symbol">}</a> <a id="25294" class="Symbol">{</a><a id="25295" href="lagda.2023-11-21-nbe.html#25295" class="Bound">τ</a><a id="25296" class="Symbol">}</a> <a id="25298" class="Symbol">{</a><a id="25299" href="lagda.2023-11-21-nbe.html#25299" class="Bound">σ</a><a id="25300" class="Symbol">}</a> <a id="25302" class="Symbol">{</a><a id="25303" href="lagda.2023-11-21-nbe.html#25303" class="Bound">S</a><a id="25304" class="Symbol">}</a> <a id="25306" class="Symbol">{</a><a id="25307" href="lagda.2023-11-21-nbe.html#25307" class="Bound">T</a><a id="25308" class="Symbol">}</a> <a id="25310" class="Symbol">=</a> <a id="25312" href="lagda.2023-11-21-nbe.html#2744" class="Postulate">extensionality</a> <a id="25327" href="lagda.2023-11-21-nbe.html#25341" class="Function">lemma</a> <a id="25333" class="Keyword">where</a>
  <a id="25341" href="lagda.2023-11-21-nbe.html#25341" class="Function">lemma</a> <a id="25347" class="Symbol">:</a> <a id="25349" class="Symbol">∀</a> <a id="25351" class="Symbol">(</a><a id="25352" href="lagda.2023-11-21-nbe.html#25352" class="Bound">x</a> <a id="25354" class="Symbol">:</a> <a id="25356" href="lagda.2023-11-21-nbe.html#25291" class="Bound">Σ</a> <a id="25358" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="25360" href="lagda.2023-11-21-nbe.html#25303" class="Bound">S</a> <a id="25362" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="25364" href="lagda.2023-11-21-nbe.html#25307" class="Bound">T</a><a id="25365" class="Symbol">)</a> <a id="25367" class="Symbol">→</a> <a id="25369" class="Symbol">(</a><a id="25370" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="25375" href="lagda.2023-11-21-nbe.html#25299" class="Bound">σ</a> <a id="25377" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="25379" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="25384" href="lagda.2023-11-21-nbe.html#25295" class="Bound">τ</a><a id="25385" class="Symbol">)</a> <a id="25387" href="lagda.2023-11-21-nbe.html#25352" class="Bound">x</a> <a id="25389" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="25391" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="25396" class="Symbol">(</a><a id="25397" href="lagda.2023-11-21-nbe.html#25299" class="Bound">σ</a> <a id="25399" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="25401" href="lagda.2023-11-21-nbe.html#25295" class="Bound">τ</a><a id="25402" class="Symbol">)</a> <a id="25404" href="lagda.2023-11-21-nbe.html#25352" class="Bound">x</a>
  <a id="25408" href="lagda.2023-11-21-nbe.html#25341" class="Function">lemma</a> <a id="25414" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>  <a id="25417" class="Symbol">=</a> <a id="25419" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="25426" href="lagda.2023-11-21-nbe.html#25341" class="Function">lemma</a> <a id="25432" class="Symbol">(</a><a id="25433" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="25435" href="lagda.2023-11-21-nbe.html#25435" class="Bound">x</a><a id="25436" class="Symbol">)</a> <a id="25438" class="Keyword">rewrite</a> <a id="25446" href="lagda.2023-11-21-nbe.html#25008" class="Function">sub-𝑆-shift</a> <a id="25458" class="Symbol">{</a><a id="25459" class="Argument">S</a> <a id="25461" class="Symbol">=</a> <a id="25463" href="lagda.2023-11-21-nbe.html#25303" class="Bound">S</a><a id="25464" class="Symbol">}</a> <a id="25466" class="Symbol">{</a><a id="25467" class="Argument">σ</a> <a id="25469" class="Symbol">=</a> <a id="25471" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="25476" href="lagda.2023-11-21-nbe.html#25299" class="Bound">σ</a> <a id="25478" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="25480" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="25485" href="lagda.2023-11-21-nbe.html#25295" class="Bound">τ</a><a id="25486" class="Symbol">}</a> <a id="25488" class="Symbol">{</a><a id="25489" href="lagda.2023-11-21-nbe.html#25435" class="Bound">x</a><a id="25490" class="Symbol">}</a> <a id="25492" class="Symbol">=</a>
    <a id="25498" href="lagda.2023-11-21-nbe.html#24042" class="Function">commute-subst-rename</a> <a id="25519" class="Symbol">{</a><a id="25520" class="Argument">t</a> <a id="25522" class="Symbol">=</a> <a id="25524" href="lagda.2023-11-21-nbe.html#25299" class="Bound">σ</a> <a id="25526" href="lagda.2023-11-21-nbe.html#25435" class="Bound">x</a><a id="25527" class="Symbol">}</a> <a id="25529" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
</pre>--->
<pre class="Agda"><a id="sub-sub"></a><a id="25552" href="lagda.2023-11-21-nbe.html#25552" class="Function">sub-sub</a> <a id="25560" class="Symbol">:</a> <a id="25562" class="Symbol">∀</a> <a id="25564" class="Symbol">{</a><a id="25565" href="lagda.2023-11-21-nbe.html#25565" class="Bound">Γ</a> <a id="25567" href="lagda.2023-11-21-nbe.html#25567" class="Bound">Δ</a> <a id="25569" href="lagda.2023-11-21-nbe.html#25569" class="Bound">Σ</a> <a id="25571" class="Symbol">:</a> <a id="25573" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="25576" class="Symbol">}</a> <a id="25578" class="Symbol">{</a><a id="25579" href="lagda.2023-11-21-nbe.html#25579" class="Bound">T</a> <a id="25581" class="Symbol">:</a> <a id="25583" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="25587" class="Symbol">}</a> <a id="25589" class="Symbol">{</a><a id="25590" href="lagda.2023-11-21-nbe.html#25590" class="Bound">τ</a> <a id="25592" class="Symbol">:</a> <a id="25594" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="25598" href="lagda.2023-11-21-nbe.html#25565" class="Bound">Γ</a> <a id="25600" href="lagda.2023-11-21-nbe.html#25567" class="Bound">Δ</a><a id="25601" class="Symbol">}</a> <a id="25603" class="Symbol">{</a><a id="25604" href="lagda.2023-11-21-nbe.html#25604" class="Bound">σ</a> <a id="25606" class="Symbol">:</a> <a id="25608" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="25612" href="lagda.2023-11-21-nbe.html#25567" class="Bound">Δ</a> <a id="25614" href="lagda.2023-11-21-nbe.html#25569" class="Bound">Σ</a><a id="25615" class="Symbol">}</a> <a id="25617" class="Symbol">{</a><a id="25618" href="lagda.2023-11-21-nbe.html#25618" class="Bound">t</a> <a id="25620" class="Symbol">:</a> <a id="25622" href="lagda.2023-11-21-nbe.html#25569" class="Bound">Σ</a> <a id="25624" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="25626" href="lagda.2023-11-21-nbe.html#25579" class="Bound">T</a><a id="25627" class="Symbol">}</a>
        <a id="25637" class="Symbol">→</a> <a id="25639" href="lagda.2023-11-21-nbe.html#25618" class="Bound">t</a> <a id="25641" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="25643" href="lagda.2023-11-21-nbe.html#25604" class="Bound">σ</a> <a id="25645" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a> <a id="25647" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="25649" href="lagda.2023-11-21-nbe.html#25590" class="Bound">τ</a> <a id="25651" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a> <a id="25653" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="25655" href="lagda.2023-11-21-nbe.html#25618" class="Bound">t</a> <a id="25657" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="25659" href="lagda.2023-11-21-nbe.html#25604" class="Bound">σ</a> <a id="25661" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="25663" href="lagda.2023-11-21-nbe.html#25590" class="Bound">τ</a> <a id="25665" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a>
</pre>
<!---
<pre class="Agda"><a id="25686" href="lagda.2023-11-21-nbe.html#25552" class="Function">sub-sub</a> <a id="25694" class="Symbol">{</a><a id="25695" class="Argument">t</a> <a id="25697" class="Symbol">=</a> <a id="25699" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a><a id="25703" class="Symbol">}</a> <a id="25705" class="Symbol">=</a> <a id="25707" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="25712" href="lagda.2023-11-21-nbe.html#25552" class="Function">sub-sub</a> <a id="25720" class="Symbol">{</a><a id="25721" class="Argument">t</a> <a id="25723" class="Symbol">=</a> <a id="25725" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="25727" href="lagda.2023-11-21-nbe.html#25727" class="Bound">x</a><a id="25728" class="Symbol">}</a> <a id="25730" class="Symbol">=</a> <a id="25732" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="25737" href="lagda.2023-11-21-nbe.html#25552" class="Function">sub-sub</a> <a id="25745" class="Symbol">{</a><a id="25746" class="Argument">τ</a> <a id="25748" class="Symbol">=</a> <a id="25750" href="lagda.2023-11-21-nbe.html#25750" class="Bound">τ</a><a id="25751" class="Symbol">}</a> <a id="25753" class="Symbol">{</a><a id="25754" href="lagda.2023-11-21-nbe.html#25754" class="Bound">σ</a><a id="25755" class="Symbol">}</a> <a id="25757" class="Symbol">{</a><a id="25758" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="25760" href="lagda.2023-11-21-nbe.html#25760" class="Bound">t</a><a id="25761" class="Symbol">}</a> <a id="25763" class="Symbol">=</a>
  <a id="25767" href="Relation.Binary.PropositionalEquality.Core.html#2806" class="Function Operator">begin</a>
    <a id="25777" class="Symbol">(</a><a id="25778" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="25780" href="lagda.2023-11-21-nbe.html#25760" class="Bound">t</a><a id="25781" class="Symbol">)</a> <a id="25783" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="25785" href="lagda.2023-11-21-nbe.html#25754" class="Bound">σ</a> <a id="25787" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a> <a id="25789" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="25791" href="lagda.2023-11-21-nbe.html#25750" class="Bound">τ</a> <a id="25793" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a>
  <a id="25797" href="Relation.Binary.PropositionalEquality.Core.html#2864" class="Function Operator">≡⟨⟩</a>
    <a id="25805" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="25807" href="lagda.2023-11-21-nbe.html#25760" class="Bound">t</a> <a id="25809" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="25811" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="25816" href="lagda.2023-11-21-nbe.html#25754" class="Bound">σ</a> <a id="25818" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a> <a id="25820" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="25822" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="25827" href="lagda.2023-11-21-nbe.html#25750" class="Bound">τ</a> <a id="25829" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a>
  <a id="25833" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="25836" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="25841" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ_</a> <a id="25844" class="Symbol">(</a><a id="25845" href="lagda.2023-11-21-nbe.html#25552" class="Function">sub-sub</a> <a id="25853" class="Symbol">{</a><a id="25854" class="Argument">τ</a> <a id="25856" class="Symbol">=</a> <a id="25858" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="25863" href="lagda.2023-11-21-nbe.html#25750" class="Bound">τ</a><a id="25864" class="Symbol">}</a> <a id="25866" class="Symbol">{</a><a id="25867" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="25872" href="lagda.2023-11-21-nbe.html#25754" class="Bound">σ</a><a id="25873" class="Symbol">}</a> <a id="25875" class="Symbol">{</a><a id="25876" href="lagda.2023-11-21-nbe.html#25760" class="Bound">t</a><a id="25877" class="Symbol">})</a> <a id="25880" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
    <a id="25886" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="25888" href="lagda.2023-11-21-nbe.html#25760" class="Bound">t</a> <a id="25890" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="25892" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="25897" href="lagda.2023-11-21-nbe.html#25754" class="Bound">σ</a> <a id="25899" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="25901" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="25906" href="lagda.2023-11-21-nbe.html#25750" class="Bound">τ</a> <a id="25908" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a>
  <a id="25912" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="25915" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="25920" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ_</a> <a id="25923" class="Symbol">(</a><a id="25924" href="lagda.2023-11-21-nbe.html#19474" class="Function">cong-sub</a> <a id="25933" class="Symbol">{</a><a id="25934" class="Argument">t</a> <a id="25936" class="Symbol">=</a> <a id="25938" href="lagda.2023-11-21-nbe.html#25760" class="Bound">t</a><a id="25939" class="Symbol">}</a> <a id="25941" href="lagda.2023-11-21-nbe.html#25144" class="Function">exts-seq</a> <a id="25950" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="25954" class="Symbol">)</a> <a id="25956" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
    <a id="25962" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="25964" href="lagda.2023-11-21-nbe.html#25760" class="Bound">t</a> <a id="25966" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="25968" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="25973" class="Symbol">(</a><a id="25974" href="lagda.2023-11-21-nbe.html#25754" class="Bound">σ</a> <a id="25976" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="25978" href="lagda.2023-11-21-nbe.html#25750" class="Bound">τ</a><a id="25979" class="Symbol">)</a> <a id="25981" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a>
  <a id="25985" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>
<a id="25987" href="lagda.2023-11-21-nbe.html#25552" class="Function">sub-sub</a> <a id="25995" class="Symbol">{</a><a id="25996" class="Argument">τ</a> <a id="25998" class="Symbol">=</a> <a id="26000" href="lagda.2023-11-21-nbe.html#26000" class="Bound">τ</a><a id="26001" class="Symbol">}</a> <a id="26003" class="Symbol">{</a><a id="26004" href="lagda.2023-11-21-nbe.html#26004" class="Bound">σ</a><a id="26005" class="Symbol">}</a> <a id="26007" class="Symbol">{</a><a id="26008" href="lagda.2023-11-21-nbe.html#26008" class="Bound">r</a> <a id="26010" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="26012" href="lagda.2023-11-21-nbe.html#26012" class="Bound">s</a><a id="26013" class="Symbol">}</a>
  <a id="26017" class="Keyword">rewrite</a> <a id="26025" href="lagda.2023-11-21-nbe.html#25552" class="Function">sub-sub</a> <a id="26033" class="Symbol">{</a><a id="26034" class="Argument">τ</a> <a id="26036" class="Symbol">=</a> <a id="26038" href="lagda.2023-11-21-nbe.html#26000" class="Bound">τ</a><a id="26039" class="Symbol">}</a> <a id="26041" class="Symbol">{</a><a id="26042" href="lagda.2023-11-21-nbe.html#26004" class="Bound">σ</a><a id="26043" class="Symbol">}</a> <a id="26045" class="Symbol">{</a><a id="26046" href="lagda.2023-11-21-nbe.html#26008" class="Bound">r</a><a id="26047" class="Symbol">}</a> <a id="26049" class="Symbol">|</a> <a id="26051" href="lagda.2023-11-21-nbe.html#25552" class="Function">sub-sub</a> <a id="26059" class="Symbol">{</a><a id="26060" class="Argument">τ</a> <a id="26062" class="Symbol">=</a> <a id="26064" href="lagda.2023-11-21-nbe.html#26000" class="Bound">τ</a><a id="26065" class="Symbol">}</a> <a id="26067" class="Symbol">{</a><a id="26068" href="lagda.2023-11-21-nbe.html#26004" class="Bound">σ</a><a id="26069" class="Symbol">}</a> <a id="26071" class="Symbol">{</a><a id="26072" href="lagda.2023-11-21-nbe.html#26012" class="Bound">s</a><a id="26073" class="Symbol">}</a> <a id="26075" class="Symbol">=</a> <a id="26077" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="sub-assoc"></a><a id="26083" href="lagda.2023-11-21-nbe.html#26083" class="Function">sub-assoc</a> <a id="26093" class="Symbol">:</a> <a id="26095" class="Symbol">∀</a> <a id="26097" class="Symbol">{</a><a id="26098" href="lagda.2023-11-21-nbe.html#26098" class="Bound">Γ</a> <a id="26100" href="lagda.2023-11-21-nbe.html#26100" class="Bound">Δ</a> <a id="26102" href="lagda.2023-11-21-nbe.html#26102" class="Bound">Σ</a> <a id="26104" href="lagda.2023-11-21-nbe.html#26104" class="Bound">Φ</a> <a id="26106" class="Symbol">:</a> <a id="26108" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="26111" class="Symbol">}</a> <a id="26113" class="Symbol">{</a><a id="26114" href="lagda.2023-11-21-nbe.html#26114" class="Bound">σ</a> <a id="26116" class="Symbol">:</a> <a id="26118" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="26122" href="lagda.2023-11-21-nbe.html#26100" class="Bound">Δ</a> <a id="26124" href="lagda.2023-11-21-nbe.html#26098" class="Bound">Γ</a><a id="26125" class="Symbol">}</a> <a id="26127" class="Symbol">{</a><a id="26128" href="lagda.2023-11-21-nbe.html#26128" class="Bound">τ</a> <a id="26130" class="Symbol">:</a> <a id="26132" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="26136" href="lagda.2023-11-21-nbe.html#26102" class="Bound">Σ</a> <a id="26138" href="lagda.2023-11-21-nbe.html#26100" class="Bound">Δ</a><a id="26139" class="Symbol">}</a> <a id="26141" class="Symbol">{</a><a id="26142" href="lagda.2023-11-21-nbe.html#26142" class="Bound">θ</a> <a id="26144" class="Symbol">:</a> <a id="26146" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="26150" href="lagda.2023-11-21-nbe.html#26104" class="Bound">Φ</a> <a id="26152" href="lagda.2023-11-21-nbe.html#26102" class="Bound">Σ</a><a id="26153" class="Symbol">}</a>
          <a id="26165" class="Symbol">→</a> <a id="26167" class="Symbol">∀</a> <a id="26169" class="Symbol">{</a><a id="26170" href="lagda.2023-11-21-nbe.html#26170" class="Bound">T</a> <a id="26172" class="Symbol">:</a> <a id="26174" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="26178" class="Symbol">}</a> <a id="26180" class="Symbol">→</a> <a id="26182" class="Symbol">(</a><a id="26183" href="lagda.2023-11-21-nbe.html#26114" class="Bound">σ</a> <a id="26185" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="26187" href="lagda.2023-11-21-nbe.html#26128" class="Bound">τ</a><a id="26188" class="Symbol">)</a> <a id="26190" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="26192" href="lagda.2023-11-21-nbe.html#26142" class="Bound">θ</a> <a id="26194" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="26196" class="Symbol">(</a><a id="26197" href="lagda.2023-11-21-nbe.html#26114" class="Bound">σ</a> <a id="26199" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="26201" href="lagda.2023-11-21-nbe.html#26128" class="Bound">τ</a> <a id="26203" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="26205" href="lagda.2023-11-21-nbe.html#26142" class="Bound">θ</a><a id="26206" class="Symbol">)</a> <a id="26208" class="Symbol">{</a><a id="26209" href="lagda.2023-11-21-nbe.html#26170" class="Bound">T</a><a id="26210" class="Symbol">}</a>
<a id="26212" href="lagda.2023-11-21-nbe.html#26083" class="Function">sub-assoc</a> <a id="26222" class="Symbol">{</a><a id="26223" href="lagda.2023-11-21-nbe.html#26223" class="Bound">Γ</a><a id="26224" class="Symbol">}</a> <a id="26226" class="Symbol">{</a><a id="26227" class="Argument">σ</a> <a id="26229" class="Symbol">=</a> <a id="26231" href="lagda.2023-11-21-nbe.html#26231" class="Bound">σ</a><a id="26232" class="Symbol">}</a> <a id="26234" class="Symbol">{</a><a id="26235" href="lagda.2023-11-21-nbe.html#26235" class="Bound">τ</a><a id="26236" class="Symbol">}</a> <a id="26238" class="Symbol">{</a><a id="26239" href="lagda.2023-11-21-nbe.html#26239" class="Bound">θ</a><a id="26240" class="Symbol">}</a> <a id="26242" class="Symbol">{</a><a id="26243" href="lagda.2023-11-21-nbe.html#26243" class="Bound">T</a><a id="26244" class="Symbol">}</a> <a id="26246" class="Symbol">=</a> <a id="26248" href="lagda.2023-11-21-nbe.html#2744" class="Postulate">extensionality</a> <a id="26263" href="lagda.2023-11-21-nbe.html#26277" class="Function">lemma</a> <a id="26269" class="Keyword">where</a>
  <a id="26277" href="lagda.2023-11-21-nbe.html#26277" class="Function">lemma</a> <a id="26283" class="Symbol">:</a> <a id="26285" class="Symbol">∀</a> <a id="26287" class="Symbol">(</a><a id="26288" href="lagda.2023-11-21-nbe.html#26288" class="Bound">x</a> <a id="26290" class="Symbol">:</a> <a id="26292" href="lagda.2023-11-21-nbe.html#26223" class="Bound">Γ</a> <a id="26294" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="26296" href="lagda.2023-11-21-nbe.html#26243" class="Bound">T</a><a id="26297" class="Symbol">)</a> <a id="26299" class="Symbol">→</a> <a id="26301" class="Symbol">((</a><a id="26303" href="lagda.2023-11-21-nbe.html#26231" class="Bound">σ</a> <a id="26305" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="26307" href="lagda.2023-11-21-nbe.html#26235" class="Bound">τ</a><a id="26308" class="Symbol">)</a> <a id="26310" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="26312" href="lagda.2023-11-21-nbe.html#26239" class="Bound">θ</a><a id="26313" class="Symbol">)</a> <a id="26315" href="lagda.2023-11-21-nbe.html#26288" class="Bound">x</a> <a id="26317" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="26319" class="Symbol">(</a><a id="26320" href="lagda.2023-11-21-nbe.html#26231" class="Bound">σ</a> <a id="26322" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="26324" href="lagda.2023-11-21-nbe.html#26235" class="Bound">τ</a> <a id="26326" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="26328" href="lagda.2023-11-21-nbe.html#26239" class="Bound">θ</a><a id="26329" class="Symbol">)</a> <a id="26331" href="lagda.2023-11-21-nbe.html#26288" class="Bound">x</a>
  <a id="26335" href="lagda.2023-11-21-nbe.html#26277" class="Function">lemma</a> <a id="26341" href="lagda.2023-11-21-nbe.html#26341" class="Bound">x</a> <a id="26343" class="Keyword">rewrite</a> <a id="26351" href="lagda.2023-11-21-nbe.html#25552" class="Function">sub-sub</a> <a id="26359" class="Symbol">{</a><a id="26360" class="Argument">τ</a> <a id="26362" class="Symbol">=</a> <a id="26364" href="lagda.2023-11-21-nbe.html#26239" class="Bound">θ</a><a id="26365" class="Symbol">}</a> <a id="26367" class="Symbol">{</a><a id="26368" href="lagda.2023-11-21-nbe.html#26235" class="Bound">τ</a><a id="26369" class="Symbol">}</a> <a id="26371" class="Symbol">{</a><a id="26372" class="Argument">t</a> <a id="26374" class="Symbol">=</a> <a id="26376" href="lagda.2023-11-21-nbe.html#26231" class="Bound">σ</a> <a id="26378" href="lagda.2023-11-21-nbe.html#26341" class="Bound">x</a><a id="26379" class="Symbol">}</a> <a id="26381" class="Symbol">=</a> <a id="26383" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="subst-zero-exts-cons"></a><a id="26389" href="lagda.2023-11-21-nbe.html#26389" class="Function">subst-zero-exts-cons</a> <a id="26410" class="Symbol">:</a> <a id="26412" class="Symbol">∀</a> <a id="26414" class="Symbol">{</a><a id="26415" href="lagda.2023-11-21-nbe.html#26415" class="Bound">Γ</a> <a id="26417" href="lagda.2023-11-21-nbe.html#26417" class="Bound">Δ</a> <a id="26419" class="Symbol">:</a> <a id="26421" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="26424" class="Symbol">}</a> <a id="26426" class="Symbol">{</a><a id="26427" href="lagda.2023-11-21-nbe.html#26427" class="Bound">S</a> <a id="26429" href="lagda.2023-11-21-nbe.html#26429" class="Bound">T</a> <a id="26431" class="Symbol">:</a> <a id="26433" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="26437" class="Symbol">}</a> <a id="26439" class="Symbol">{</a><a id="26440" href="lagda.2023-11-21-nbe.html#26440" class="Bound">σ</a> <a id="26442" class="Symbol">:</a> <a id="26444" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="26448" href="lagda.2023-11-21-nbe.html#26415" class="Bound">Γ</a> <a id="26450" href="lagda.2023-11-21-nbe.html#26417" class="Bound">Δ</a><a id="26451" class="Symbol">}</a> <a id="26453" class="Symbol">{</a><a id="26454" href="lagda.2023-11-21-nbe.html#26454" class="Bound">s</a> <a id="26456" class="Symbol">:</a> <a id="26458" href="lagda.2023-11-21-nbe.html#26415" class="Bound">Γ</a> <a id="26460" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="26462" href="lagda.2023-11-21-nbe.html#26427" class="Bound">S</a><a id="26463" class="Symbol">}</a>
                     <a id="26486" class="Symbol">→</a> <a id="26488" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="26493" href="lagda.2023-11-21-nbe.html#26440" class="Bound">σ</a> <a id="26495" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="26497" class="Symbol">(</a><a id="26498" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="26501" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="26503" href="lagda.2023-11-21-nbe.html#26454" class="Bound">s</a><a id="26504" class="Symbol">)</a> <a id="26506" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="26508" class="Symbol">(</a><a id="26509" href="lagda.2023-11-21-nbe.html#26440" class="Bound">σ</a> <a id="26511" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="26513" href="lagda.2023-11-21-nbe.html#26454" class="Bound">s</a><a id="26514" class="Symbol">)</a> <a id="26516" class="Symbol">{</a><a id="26517" href="lagda.2023-11-21-nbe.html#26429" class="Bound">T</a><a id="26518" class="Symbol">}</a>
<a id="26520" href="lagda.2023-11-21-nbe.html#26389" class="Function">subst-zero-exts-cons</a> <a id="26541" class="Symbol">{</a><a id="26542" class="Argument">S</a> <a id="26544" class="Symbol">=</a> <a id="26546" href="lagda.2023-11-21-nbe.html#26546" class="Bound">S</a><a id="26547" class="Symbol">}</a> <a id="26549" class="Symbol">{</a><a id="26550" href="lagda.2023-11-21-nbe.html#26550" class="Bound">T</a><a id="26551" class="Symbol">}</a> <a id="26553" class="Symbol">{</a><a id="26554" href="lagda.2023-11-21-nbe.html#26554" class="Bound">σ</a><a id="26555" class="Symbol">}</a> <a id="26557" class="Symbol">{</a><a id="26558" href="lagda.2023-11-21-nbe.html#26558" class="Bound">s</a><a id="26559" class="Symbol">}</a> <a id="26561" class="Symbol">=</a>
  <a id="26565" href="Relation.Binary.PropositionalEquality.Core.html#2806" class="Function Operator">begin</a>
    <a id="26575" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="26580" href="lagda.2023-11-21-nbe.html#26554" class="Bound">σ</a> <a id="26582" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="26584" class="Symbol">(</a><a id="26585" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="26588" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="26590" href="lagda.2023-11-21-nbe.html#26558" class="Bound">s</a><a id="26591" class="Symbol">)</a>
  <a id="26595" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="26598" href="lagda.2023-11-21-nbe.html#20470" class="Function">cong-seq</a> <a id="26607" href="lagda.2023-11-21-nbe.html#22075" class="Function">exts-cons-shift</a> <a id="26623" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="26628" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
    <a id="26634" class="Symbol">((</a><a id="26636" href="lagda.2023-11-21-nbe.html#26554" class="Bound">σ</a> <a id="26638" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="26640" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a><a id="26641" class="Symbol">)</a> <a id="26643" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="26645" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="26647" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a><a id="26648" class="Symbol">)</a> <a id="26650" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="26652" class="Symbol">(</a><a id="26653" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="26656" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="26658" href="lagda.2023-11-21-nbe.html#26558" class="Bound">s</a><a id="26659" class="Symbol">)</a>
  <a id="26663" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="26666" href="lagda.2023-11-21-nbe.html#17953" class="Function">sub-dist</a> <a id="26675" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
    <a id="26681" class="Symbol">((</a><a id="26683" href="lagda.2023-11-21-nbe.html#26554" class="Bound">σ</a> <a id="26685" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="26687" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a><a id="26688" class="Symbol">)</a> <a id="26690" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="26692" class="Symbol">(</a><a id="26693" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="26696" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="26698" href="lagda.2023-11-21-nbe.html#26558" class="Bound">s</a><a id="26699" class="Symbol">))</a> <a id="26702" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="26704" href="lagda.2023-11-21-nbe.html#26558" class="Bound">s</a>
  <a id="26708" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="26711" href="lagda.2023-11-21-nbe.html#20083" class="Function">cong-cons</a> <a id="26721" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="26726" class="Symbol">(</a><a id="26727" href="lagda.2023-11-21-nbe.html#26083" class="Function">sub-assoc</a> <a id="26737" class="Symbol">{</a><a id="26738" class="Argument">σ</a> <a id="26740" class="Symbol">=</a> <a id="26742" href="lagda.2023-11-21-nbe.html#26554" class="Bound">σ</a><a id="26743" class="Symbol">})</a> <a id="26746" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
    <a id="26752" class="Symbol">(</a><a id="26753" href="lagda.2023-11-21-nbe.html#26554" class="Bound">σ</a> <a id="26755" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="26757" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a> <a id="26759" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="26761" class="Symbol">(</a><a id="26762" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="26765" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="26767" href="lagda.2023-11-21-nbe.html#26558" class="Bound">s</a><a id="26768" class="Symbol">))</a> <a id="26771" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="26773" href="lagda.2023-11-21-nbe.html#26558" class="Bound">s</a>
  <a id="26777" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="26780" href="lagda.2023-11-21-nbe.html#20083" class="Function">cong-cons</a> <a id="26790" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="26795" class="Symbol">(</a><a id="26796" href="lagda.2023-11-21-nbe.html#20470" class="Function">cong-seq</a> <a id="26805" class="Symbol">{</a><a id="26806" class="Argument">σ</a> <a id="26808" class="Symbol">=</a> <a id="26810" href="lagda.2023-11-21-nbe.html#26554" class="Bound">σ</a><a id="26811" class="Symbol">}</a> <a id="26813" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="26818" class="Symbol">(</a><a id="26819" href="lagda.2023-11-21-nbe.html#17835" class="Function">sub-tail</a> <a id="26828" class="Symbol">{</a><a id="26829" class="Argument">s</a> <a id="26831" class="Symbol">=</a> <a id="26833" href="lagda.2023-11-21-nbe.html#26558" class="Bound">s</a><a id="26834" class="Symbol">}</a> <a id="26836" class="Symbol">{</a><a id="26837" class="Argument">σ</a> <a id="26839" class="Symbol">=</a> <a id="26841" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a><a id="26843" class="Symbol">}))</a> <a id="26847" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
    <a id="26853" class="Symbol">(</a><a id="26854" href="lagda.2023-11-21-nbe.html#26554" class="Bound">σ</a> <a id="26856" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="26858" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a><a id="26860" class="Symbol">)</a> <a id="26862" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="26864" href="lagda.2023-11-21-nbe.html#26558" class="Bound">s</a>
  <a id="26868" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="26871" href="lagda.2023-11-21-nbe.html#20083" class="Function">cong-cons</a> <a id="26881" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="26886" class="Symbol">(</a><a id="26887" href="lagda.2023-11-21-nbe.html#23042" class="Function">sub-idR</a> <a id="26895" class="Symbol">{</a><a id="26896" class="Argument">σ</a> <a id="26898" class="Symbol">=</a> <a id="26900" href="lagda.2023-11-21-nbe.html#26554" class="Bound">σ</a><a id="26901" class="Symbol">})</a> <a id="26904" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
    <a id="26910" href="lagda.2023-11-21-nbe.html#26554" class="Bound">σ</a> <a id="26912" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="26914" href="lagda.2023-11-21-nbe.html#26558" class="Bound">s</a>
  <a id="26918" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>
</pre>--->
<h4 id="definitional-equality">Definitional Equality</h4>
<p>There is still one language construct left to define ─ equality. To explain why
an embedding of equality in Agda is needed, we can begin discussing
normalization by evaluation in more detail.</p>
<p>Normalization by evaluation is an algorithm for normalization, the process of
transforming a term into its normal form. The normal form of a term is <em>unique</em>,
being the term with all possible reductions (i.e. “computations”) applied to it.
For any normalization algorithm <code>nf</code> such that <code>nf(t)</code> is the normal form of a
term <code>Γ ⊢ t : T</code>, we would expect the following properties to hold.</p>
<ul>
<li><p><code>Γ ⊢ nf(t) : T</code> (well-typedness of normal form)</p>
<p>A normalization algorithm should still produce a term that is well-typed
under the context <code>Γ</code> (and with the same type)</p></li>
<li><p><code>⟦ nf(t) ⟧ = ⟦ t ⟧</code> (preservation of meaning)</p>
<p>The <code>⟦ t ⟧</code> notation here indicates the <em>denotation</em> of <code>t</code>, which is
equivalent to its meaning (in some meta-language).</p>
<p>We want an algorithm for normalization by evaluation to ensure that the
normal form of a term that is obtained is <em>semantically equal</em> to the
original term. Put simply, this means that the two terms must have the
same meaning.</p></li>
<li><p><code>nf(nf(t)) = nf(t)</code> (idempotency)</p>
<p>This property refers to the “normalization” part of the algorithm ─ it
should actually produce a term that has been fully normalized, i.e. it
cannot undergo any more normalization.</p></li>
</ul>
<p>Equality of functions is undecidable, so the last property is especially tricky
to prove for any algorithm in general. Instead, we will want to use
βη-equivalence, or <em>definitional equality</em>. In STLC, we have that two terms are
definitionally equal if and only if they have the same meaning. By proving that
<code>Γ ⊢ nf(t) = t : T</code>, that the normal form of a term is definitionally equal to
the original term, we will be proving that the normal form of a term preserves
the meaning of the original term.</p>
<p>To actually define βη-equivalence, we need to first define operations for
β-reductions and η-expansions.</p>
<p>A β-reduction will be the application of a substitution <code>t[s/x]</code> that
substitutes the term <code>s</code> for the variable <code>x</code> in the term <code>t</code>. In Agda, this
substitution will be the identity substitution with the term <code>s</code> added as the
first term in the substitution. For convenience, we will use <code>t [ s ]₀</code> (as we
are replacing the zeroth term in the identity substitution).</p>
<pre class="Agda"><a id="_[_]₀"></a><a id="29366" href="lagda.2023-11-21-nbe.html#29366" class="Function Operator">_[_]₀</a> <a id="29372" class="Symbol">:</a> <a id="29374" class="Symbol">∀</a> <a id="29376" class="Symbol">{</a><a id="29377" href="lagda.2023-11-21-nbe.html#29377" class="Bound">Γ</a> <a id="29379" class="Symbol">:</a> <a id="29381" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="29384" class="Symbol">}</a> <a id="29386" class="Symbol">{</a><a id="29387" href="lagda.2023-11-21-nbe.html#29387" class="Bound">S</a> <a id="29389" href="lagda.2023-11-21-nbe.html#29389" class="Bound">T</a> <a id="29391" class="Symbol">:</a> <a id="29393" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="29397" class="Symbol">}</a>
  <a id="29401" class="Symbol">→</a> <a id="29403" href="lagda.2023-11-21-nbe.html#29377" class="Bound">Γ</a> <a id="29405" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="29407" href="lagda.2023-11-21-nbe.html#29387" class="Bound">S</a> <a id="29409" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="29411" href="lagda.2023-11-21-nbe.html#29389" class="Bound">T</a>
  <a id="29415" class="Symbol">→</a> <a id="29417" href="lagda.2023-11-21-nbe.html#29377" class="Bound">Γ</a> <a id="29419" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="29421" href="lagda.2023-11-21-nbe.html#29387" class="Bound">S</a>
    <a id="29427" class="Comment">---------</a>
  <a id="29439" class="Symbol">→</a> <a id="29441" href="lagda.2023-11-21-nbe.html#29377" class="Bound">Γ</a> <a id="29443" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="29445" href="lagda.2023-11-21-nbe.html#29389" class="Bound">T</a>
<a id="29447" href="lagda.2023-11-21-nbe.html#29366" class="Function Operator">_[_]₀</a> <a id="29453" class="Symbol">{</a><a id="29454" href="lagda.2023-11-21-nbe.html#29454" class="Bound">Γ</a><a id="29455" class="Symbol">}</a> <a id="29457" class="Symbol">{</a><a id="29458" href="lagda.2023-11-21-nbe.html#29458" class="Bound">S</a><a id="29459" class="Symbol">}</a> <a id="29461" href="lagda.2023-11-21-nbe.html#29461" class="Bound">t</a> <a id="29463" href="lagda.2023-11-21-nbe.html#29463" class="Bound">s</a> <a id="29465" class="Symbol">=</a> <a id="29467" href="lagda.2023-11-21-nbe.html#29461" class="Bound">t</a> <a id="29469" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="29471" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="29474" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="29476" href="lagda.2023-11-21-nbe.html#29463" class="Bound">s</a> <a id="29478" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a>
</pre>
<!---
<pre class="Agda"><a id="29495" class="Keyword">infix</a> <a id="29501" class="Number">8</a> <a id="29503" href="lagda.2023-11-21-nbe.html#29366" class="Function Operator">_[_]₀</a>
</pre>--->
<p>η-expansion for a functional term <code>Γ ⊢ t : S → T</code> will be an abstraction
<code>Γ ⊢ λx . t x : S → T</code> containing the application of a variable <code>Γ, x:S ⊢ x : S</code> to the term <code>t</code>. The term <code>t</code> needs to have a shifting substitution applied
to it as we are using an intrinsically-typed representation (in changing the
context from <code>Γ</code> to <code>Γ, x:S</code>, the expression <code>t</code> itself also changes).</p>
<pre class="Agda"><a id="η-expand"></a><a id="29906" href="lagda.2023-11-21-nbe.html#29906" class="Function">η-expand</a> <a id="29915" class="Symbol">:</a> <a id="29917" class="Symbol">∀</a> <a id="29919" class="Symbol">{</a><a id="29920" href="lagda.2023-11-21-nbe.html#29920" class="Bound">Γ</a> <a id="29922" class="Symbol">:</a> <a id="29924" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="29927" class="Symbol">}</a> <a id="29929" class="Symbol">{</a><a id="29930" href="lagda.2023-11-21-nbe.html#29930" class="Bound">S</a> <a id="29932" href="lagda.2023-11-21-nbe.html#29932" class="Bound">T</a> <a id="29934" class="Symbol">:</a> <a id="29936" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="29940" class="Symbol">}</a>
         <a id="29951" class="Symbol">→</a> <a id="29953" href="lagda.2023-11-21-nbe.html#29920" class="Bound">Γ</a> <a id="29955" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="29957" href="lagda.2023-11-21-nbe.html#29930" class="Bound">S</a> <a id="29959" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="29961" href="lagda.2023-11-21-nbe.html#29932" class="Bound">T</a>
         <a id="29972" class="Symbol">→</a> <a id="29974" href="lagda.2023-11-21-nbe.html#29920" class="Bound">Γ</a> <a id="29976" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="29978" href="lagda.2023-11-21-nbe.html#29930" class="Bound">S</a> <a id="29980" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="29982" href="lagda.2023-11-21-nbe.html#29932" class="Bound">T</a>
<a id="29984" href="lagda.2023-11-21-nbe.html#29906" class="Function">η-expand</a> <a id="29993" class="Symbol">{</a><a id="29994" class="Argument">S</a> <a id="29996" class="Symbol">=</a> <a id="29998" href="lagda.2023-11-21-nbe.html#29998" class="Bound">S</a><a id="29999" class="Symbol">}</a> <a id="30001" href="lagda.2023-11-21-nbe.html#30001" class="Bound">t</a> <a id="30003" class="Symbol">=</a> <a id="30005" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="30007" class="Symbol">(</a><a id="30008" href="lagda.2023-11-21-nbe.html#29998" class="Bound">S</a> <a id="30010" href="lagda.2023-11-21-nbe.html#17302" class="Function Operator">↥⊢</a> <a id="30013" href="lagda.2023-11-21-nbe.html#30001" class="Bound">t</a><a id="30014" class="Symbol">)</a> <a id="30016" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="30018" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="30020" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>
</pre>
<p>With these defined, we can actually introduce definitional equality in Agda.
We use <code>t == t′</code> in Agda instead of <code>Γ ⊢ t = t′ : T</code>, though we will refer to
two terms that are definitionally equal with the latter.</p>
<pre class="Agda"><a id="30248" class="Keyword">data</a> <a id="_==_"></a><a id="30253" href="lagda.2023-11-21-nbe.html#30253" class="Datatype Operator">_==_</a> <a id="30258" class="Symbol">:</a> <a id="30260" class="Symbol">∀</a> <a id="30262" class="Symbol">{</a><a id="30263" href="lagda.2023-11-21-nbe.html#30263" class="Bound">Γ</a> <a id="30265" class="Symbol">:</a> <a id="30267" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="30270" class="Symbol">}</a> <a id="30272" class="Symbol">{</a><a id="30273" href="lagda.2023-11-21-nbe.html#30273" class="Bound">T</a> <a id="30275" class="Symbol">:</a> <a id="30277" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="30281" class="Symbol">}</a> <a id="30283" class="Symbol">→</a> <a id="30285" href="lagda.2023-11-21-nbe.html#30263" class="Bound">Γ</a> <a id="30287" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="30289" href="lagda.2023-11-21-nbe.html#30273" class="Bound">T</a> <a id="30291" class="Symbol">→</a> <a id="30293" href="lagda.2023-11-21-nbe.html#30263" class="Bound">Γ</a> <a id="30295" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="30297" href="lagda.2023-11-21-nbe.html#30273" class="Bound">T</a> <a id="30299" class="Symbol">→</a> <a id="30301" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="30305" class="Keyword">where</a>
  <a id="30313" class="Comment">-- computation rule: beta reduction</a>
  <a id="_==_.β"></a><a id="30351" href="lagda.2023-11-21-nbe.html#30351" class="InductiveConstructor">β</a> <a id="30353" class="Symbol">:</a> <a id="30355" class="Symbol">∀</a> <a id="30357" class="Symbol">{</a><a id="30358" href="lagda.2023-11-21-nbe.html#30358" class="Bound">Γ</a> <a id="30360" class="Symbol">:</a> <a id="30362" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="30365" class="Symbol">}</a> <a id="30367" class="Symbol">{</a><a id="30368" href="lagda.2023-11-21-nbe.html#30368" class="Bound">S</a> <a id="30370" href="lagda.2023-11-21-nbe.html#30370" class="Bound">T</a> <a id="30372" class="Symbol">:</a> <a id="30374" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="30378" class="Symbol">}</a>
          <a id="30390" class="Symbol">{</a><a id="30391" href="lagda.2023-11-21-nbe.html#30391" class="Bound">t</a> <a id="30393" class="Symbol">:</a> <a id="30395" href="lagda.2023-11-21-nbe.html#30358" class="Bound">Γ</a> <a id="30397" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="30399" href="lagda.2023-11-21-nbe.html#30368" class="Bound">S</a> <a id="30401" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="30403" href="lagda.2023-11-21-nbe.html#30370" class="Bound">T</a><a id="30404" class="Symbol">}</a>
          <a id="30416" class="Symbol">{</a><a id="30417" href="lagda.2023-11-21-nbe.html#30417" class="Bound">s</a> <a id="30419" class="Symbol">:</a> <a id="30421" href="lagda.2023-11-21-nbe.html#30358" class="Bound">Γ</a> <a id="30423" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="30425" href="lagda.2023-11-21-nbe.html#30368" class="Bound">S</a><a id="30426" class="Symbol">}</a>
          <a id="30438" class="Comment">----------------------</a>
        <a id="30469" class="Symbol">→</a> <a id="30471" class="Symbol">(</a><a id="30472" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="30474" href="lagda.2023-11-21-nbe.html#30391" class="Bound">t</a><a id="30475" class="Symbol">)</a> <a id="30477" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="30479" href="lagda.2023-11-21-nbe.html#30417" class="Bound">s</a> <a id="30481" href="lagda.2023-11-21-nbe.html#30253" class="Datatype Operator">==</a> <a id="30484" href="lagda.2023-11-21-nbe.html#30391" class="Bound">t</a> <a id="30486" href="lagda.2023-11-21-nbe.html#29366" class="Function Operator">[</a> <a id="30488" href="lagda.2023-11-21-nbe.html#30417" class="Bound">s</a> <a id="30490" href="lagda.2023-11-21-nbe.html#29366" class="Function Operator">]₀</a>

  <a id="30496" class="Comment">-- η-expansion / function extensionality, i.e. Γ ⊢ t = Γ ⊢ λx. t x : S ⇒ T</a>
  <a id="_==_.η"></a><a id="30573" href="lagda.2023-11-21-nbe.html#30573" class="InductiveConstructor">η</a> <a id="30575" class="Symbol">:</a> <a id="30577" class="Symbol">∀</a> <a id="30579" class="Symbol">{</a><a id="30580" href="lagda.2023-11-21-nbe.html#30580" class="Bound">Γ</a> <a id="30582" class="Symbol">:</a> <a id="30584" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="30587" class="Symbol">}</a> <a id="30589" class="Symbol">{</a><a id="30590" href="lagda.2023-11-21-nbe.html#30590" class="Bound">S</a> <a id="30592" href="lagda.2023-11-21-nbe.html#30592" class="Bound">T</a> <a id="30594" class="Symbol">:</a> <a id="30596" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="30600" class="Symbol">}</a>
        <a id="30610" class="Symbol">{</a><a id="30611" href="lagda.2023-11-21-nbe.html#30611" class="Bound">t</a> <a id="30613" class="Symbol">:</a> <a id="30615" href="lagda.2023-11-21-nbe.html#30580" class="Bound">Γ</a> <a id="30617" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="30619" href="lagda.2023-11-21-nbe.html#30590" class="Bound">S</a> <a id="30621" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="30623" href="lagda.2023-11-21-nbe.html#30592" class="Bound">T</a><a id="30624" class="Symbol">}</a>
        <a id="30634" class="Comment">----------------------</a>
      <a id="30663" class="Symbol">→</a> <a id="30665" href="lagda.2023-11-21-nbe.html#30611" class="Bound">t</a> <a id="30667" href="lagda.2023-11-21-nbe.html#30253" class="Datatype Operator">==</a> <a id="30670" href="lagda.2023-11-21-nbe.html#29906" class="Function">η-expand</a> <a id="30679" href="lagda.2023-11-21-nbe.html#30611" class="Bound">t</a>

  <a id="30684" class="Comment">-- compatibility rules</a>
  <a id="_==_.abs-compatible"></a><a id="30709" href="lagda.2023-11-21-nbe.html#30709" class="InductiveConstructor">abs-compatible</a> <a id="30724" class="Symbol">:</a> <a id="30726" class="Symbol">∀</a> <a id="30728" class="Symbol">{</a><a id="30729" href="lagda.2023-11-21-nbe.html#30729" class="Bound">Γ</a> <a id="30731" class="Symbol">:</a> <a id="30733" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="30736" class="Symbol">}</a> <a id="30738" class="Symbol">{</a><a id="30739" href="lagda.2023-11-21-nbe.html#30739" class="Bound">S</a> <a id="30741" href="lagda.2023-11-21-nbe.html#30741" class="Bound">T</a> <a id="30743" class="Symbol">:</a> <a id="30745" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="30749" class="Symbol">}</a> <a id="30751" class="Symbol">{</a><a id="30752" href="lagda.2023-11-21-nbe.html#30752" class="Bound">t</a> <a id="30754" href="lagda.2023-11-21-nbe.html#30754" class="Bound">t′</a> <a id="30757" class="Symbol">:</a> <a id="30759" href="lagda.2023-11-21-nbe.html#30729" class="Bound">Γ</a> <a id="30761" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="30763" href="lagda.2023-11-21-nbe.html#30739" class="Bound">S</a> <a id="30765" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="30767" href="lagda.2023-11-21-nbe.html#30741" class="Bound">T</a><a id="30768" class="Symbol">}</a>
                   <a id="30789" class="Symbol">→</a> <a id="30791" href="lagda.2023-11-21-nbe.html#30752" class="Bound">t</a> <a id="30793" href="lagda.2023-11-21-nbe.html#30253" class="Datatype Operator">==</a> <a id="30796" href="lagda.2023-11-21-nbe.html#30754" class="Bound">t′</a>
                     <a id="30820" class="Comment">-----------</a>
                   <a id="30851" class="Symbol">→</a> <a id="30853" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="30855" href="lagda.2023-11-21-nbe.html#30752" class="Bound">t</a> <a id="30857" href="lagda.2023-11-21-nbe.html#30253" class="Datatype Operator">==</a> <a id="30860" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="30862" href="lagda.2023-11-21-nbe.html#30754" class="Bound">t′</a>

  <a id="_==_.app-compatible"></a><a id="30868" href="lagda.2023-11-21-nbe.html#30868" class="InductiveConstructor">app-compatible</a> <a id="30883" class="Symbol">:</a> <a id="30885" class="Symbol">∀</a> <a id="30887" class="Symbol">{</a><a id="30888" href="lagda.2023-11-21-nbe.html#30888" class="Bound">Γ</a> <a id="30890" class="Symbol">:</a> <a id="30892" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="30895" class="Symbol">}</a> <a id="30897" class="Symbol">{</a><a id="30898" href="lagda.2023-11-21-nbe.html#30898" class="Bound">S</a> <a id="30900" href="lagda.2023-11-21-nbe.html#30900" class="Bound">T</a> <a id="30902" class="Symbol">:</a> <a id="30904" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="30908" class="Symbol">}</a>
                     <a id="30931" class="Symbol">{</a><a id="30932" href="lagda.2023-11-21-nbe.html#30932" class="Bound">r</a> <a id="30934" href="lagda.2023-11-21-nbe.html#30934" class="Bound">r′</a> <a id="30937" class="Symbol">:</a> <a id="30939" href="lagda.2023-11-21-nbe.html#30888" class="Bound">Γ</a> <a id="30941" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="30943" href="lagda.2023-11-21-nbe.html#30898" class="Bound">S</a> <a id="30945" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="30947" href="lagda.2023-11-21-nbe.html#30900" class="Bound">T</a><a id="30948" class="Symbol">}</a> <a id="30950" class="Symbol">{</a><a id="30951" href="lagda.2023-11-21-nbe.html#30951" class="Bound">s</a> <a id="30953" href="lagda.2023-11-21-nbe.html#30953" class="Bound">s′</a> <a id="30956" class="Symbol">:</a> <a id="30958" href="lagda.2023-11-21-nbe.html#30888" class="Bound">Γ</a> <a id="30960" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="30962" href="lagda.2023-11-21-nbe.html#30898" class="Bound">S</a><a id="30963" class="Symbol">}</a>
                   <a id="30984" class="Symbol">→</a> <a id="30986" href="lagda.2023-11-21-nbe.html#30932" class="Bound">r</a> <a id="30988" href="lagda.2023-11-21-nbe.html#30253" class="Datatype Operator">==</a> <a id="30991" href="lagda.2023-11-21-nbe.html#30934" class="Bound">r′</a>
                   <a id="31013" class="Symbol">→</a> <a id="31015" href="lagda.2023-11-21-nbe.html#30951" class="Bound">s</a> <a id="31017" href="lagda.2023-11-21-nbe.html#30253" class="Datatype Operator">==</a> <a id="31020" href="lagda.2023-11-21-nbe.html#30953" class="Bound">s′</a>
                     <a id="31044" class="Comment">----------------</a>
                   <a id="31080" class="Symbol">→</a> <a id="31082" href="lagda.2023-11-21-nbe.html#30932" class="Bound">r</a> <a id="31084" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="31086" href="lagda.2023-11-21-nbe.html#30951" class="Bound">s</a> <a id="31088" href="lagda.2023-11-21-nbe.html#30253" class="Datatype Operator">==</a> <a id="31091" href="lagda.2023-11-21-nbe.html#30934" class="Bound">r′</a> <a id="31094" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="31096" href="lagda.2023-11-21-nbe.html#30953" class="Bound">s′</a>

  <a id="31102" class="Comment">-- equivalence rules</a>
  <a id="_==_.refl⁼⁼"></a><a id="31125" href="lagda.2023-11-21-nbe.html#31125" class="InductiveConstructor">refl⁼⁼</a> <a id="31132" class="Symbol">:</a> <a id="31134" class="Symbol">∀</a> <a id="31136" class="Symbol">{</a><a id="31137" href="lagda.2023-11-21-nbe.html#31137" class="Bound">Γ</a> <a id="31139" class="Symbol">:</a> <a id="31141" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="31144" class="Symbol">}</a> <a id="31146" class="Symbol">{</a><a id="31147" href="lagda.2023-11-21-nbe.html#31147" class="Bound">T</a> <a id="31149" class="Symbol">:</a> <a id="31151" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="31155" class="Symbol">}</a> <a id="31157" class="Symbol">{</a><a id="31158" href="lagda.2023-11-21-nbe.html#31158" class="Bound">t</a> <a id="31160" class="Symbol">:</a> <a id="31162" href="lagda.2023-11-21-nbe.html#31137" class="Bound">Γ</a> <a id="31164" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="31166" href="lagda.2023-11-21-nbe.html#31147" class="Bound">T</a><a id="31167" class="Symbol">}</a>
           <a id="31180" class="Comment">------</a>
         <a id="31196" class="Symbol">→</a> <a id="31198" href="lagda.2023-11-21-nbe.html#31158" class="Bound">t</a> <a id="31200" href="lagda.2023-11-21-nbe.html#30253" class="Datatype Operator">==</a> <a id="31203" href="lagda.2023-11-21-nbe.html#31158" class="Bound">t</a>

  <a id="_==_.sym⁼⁼"></a><a id="31208" href="lagda.2023-11-21-nbe.html#31208" class="InductiveConstructor">sym⁼⁼</a> <a id="31214" class="Symbol">:</a> <a id="31216" class="Symbol">∀</a> <a id="31218" class="Symbol">{</a><a id="31219" href="lagda.2023-11-21-nbe.html#31219" class="Bound">Γ</a> <a id="31221" class="Symbol">:</a> <a id="31223" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="31226" class="Symbol">}</a> <a id="31228" class="Symbol">{</a><a id="31229" href="lagda.2023-11-21-nbe.html#31229" class="Bound">T</a> <a id="31231" class="Symbol">:</a> <a id="31233" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="31237" class="Symbol">}</a> <a id="31239" class="Symbol">{</a><a id="31240" href="lagda.2023-11-21-nbe.html#31240" class="Bound">t</a> <a id="31242" href="lagda.2023-11-21-nbe.html#31242" class="Bound">t′</a> <a id="31245" class="Symbol">:</a> <a id="31247" href="lagda.2023-11-21-nbe.html#31219" class="Bound">Γ</a> <a id="31249" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="31251" href="lagda.2023-11-21-nbe.html#31229" class="Bound">T</a><a id="31252" class="Symbol">}</a>
        <a id="31262" class="Symbol">→</a> <a id="31264" href="lagda.2023-11-21-nbe.html#31240" class="Bound">t</a> <a id="31266" href="lagda.2023-11-21-nbe.html#30253" class="Datatype Operator">==</a> <a id="31269" href="lagda.2023-11-21-nbe.html#31242" class="Bound">t′</a>
          <a id="31282" class="Comment">-------</a>
        <a id="31298" class="Symbol">→</a> <a id="31300" href="lagda.2023-11-21-nbe.html#31242" class="Bound">t′</a> <a id="31303" href="lagda.2023-11-21-nbe.html#30253" class="Datatype Operator">==</a> <a id="31306" href="lagda.2023-11-21-nbe.html#31240" class="Bound">t</a>

  <a id="_==_.trans⁼⁼"></a><a id="31311" href="lagda.2023-11-21-nbe.html#31311" class="InductiveConstructor">trans⁼⁼</a> <a id="31319" class="Symbol">:</a> <a id="31321" class="Symbol">∀</a> <a id="31323" class="Symbol">{</a><a id="31324" href="lagda.2023-11-21-nbe.html#31324" class="Bound">Γ</a> <a id="31326" class="Symbol">:</a> <a id="31328" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="31331" class="Symbol">}</a> <a id="31333" class="Symbol">{</a><a id="31334" href="lagda.2023-11-21-nbe.html#31334" class="Bound">T</a> <a id="31336" class="Symbol">:</a> <a id="31338" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="31342" class="Symbol">}</a> <a id="31344" class="Symbol">{</a><a id="31345" href="lagda.2023-11-21-nbe.html#31345" class="Bound">t₁</a> <a id="31348" href="lagda.2023-11-21-nbe.html#31348" class="Bound">t₂</a> <a id="31351" href="lagda.2023-11-21-nbe.html#31351" class="Bound">t₃</a> <a id="31354" class="Symbol">:</a> <a id="31356" href="lagda.2023-11-21-nbe.html#31324" class="Bound">Γ</a> <a id="31358" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="31360" href="lagda.2023-11-21-nbe.html#31334" class="Bound">T</a><a id="31361" class="Symbol">}</a>
          <a id="31373" class="Symbol">→</a> <a id="31375" href="lagda.2023-11-21-nbe.html#31345" class="Bound">t₁</a> <a id="31378" href="lagda.2023-11-21-nbe.html#30253" class="Datatype Operator">==</a> <a id="31381" href="lagda.2023-11-21-nbe.html#31348" class="Bound">t₂</a>
          <a id="31394" class="Symbol">→</a> <a id="31396" href="lagda.2023-11-21-nbe.html#31348" class="Bound">t₂</a> <a id="31399" href="lagda.2023-11-21-nbe.html#30253" class="Datatype Operator">==</a> <a id="31402" href="lagda.2023-11-21-nbe.html#31351" class="Bound">t₃</a>
            <a id="31417" class="Comment">--------</a>
          <a id="31436" class="Symbol">→</a> <a id="31438" href="lagda.2023-11-21-nbe.html#31345" class="Bound">t₁</a> <a id="31441" href="lagda.2023-11-21-nbe.html#30253" class="Datatype Operator">==</a> <a id="31444" href="lagda.2023-11-21-nbe.html#31351" class="Bound">t₃</a>
</pre>
<!---
<pre class="Agda"><a id="31462" class="Keyword">infix</a> <a id="31468" class="Number">3</a> <a id="31470" href="lagda.2023-11-21-nbe.html#30253" class="Datatype Operator">_==_</a>
</pre>--->
<p>For the readability of some of the proofs that will follow, it will be helpful
to have equational reasoning defined with respect to definitional equality. Its
definition is almost identical to Agda’s own equational reasoning for
propositional equality, so it is left out in the rendering.</p>
<!---
<pre class="Agda"><a id="31789" class="Keyword">module</a> <a id="==-Reasoning"></a><a id="31796" href="lagda.2023-11-21-nbe.html#31796" class="Module">==-Reasoning</a> <a id="31809" class="Keyword">where</a>

  <a id="31818" class="Keyword">infix</a>  <a id="31825" class="Number">1</a> <a id="31827" href="lagda.2023-11-21-nbe.html#31874" class="Function Operator">begin==_</a>
  <a id="31838" class="Keyword">infixr</a> <a id="31845" class="Number">2</a> <a id="31847" href="lagda.2023-11-21-nbe.html#32007" class="Function Operator">_==⟨_⟩_</a>
  <a id="31857" class="Keyword">infix</a>  <a id="31864" class="Number">3</a> <a id="31866" href="lagda.2023-11-21-nbe.html#32215" class="Function Operator">_==∎</a>

  <a id="==-Reasoning.begin==_"></a><a id="31874" href="lagda.2023-11-21-nbe.html#31874" class="Function Operator">begin==_</a> <a id="31883" class="Symbol">:</a> <a id="31885" class="Symbol">∀</a> <a id="31887" class="Symbol">{</a><a id="31888" href="lagda.2023-11-21-nbe.html#31888" class="Bound">Γ</a> <a id="31890" class="Symbol">:</a> <a id="31892" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="31895" class="Symbol">}</a> <a id="31897" class="Symbol">{</a><a id="31898" href="lagda.2023-11-21-nbe.html#31898" class="Bound">T</a> <a id="31900" class="Symbol">:</a> <a id="31902" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="31906" class="Symbol">}</a> <a id="31908" class="Symbol">{</a><a id="31909" href="lagda.2023-11-21-nbe.html#31909" class="Bound">t</a> <a id="31911" href="lagda.2023-11-21-nbe.html#31911" class="Bound">t′</a> <a id="31914" class="Symbol">:</a> <a id="31916" href="lagda.2023-11-21-nbe.html#31888" class="Bound">Γ</a> <a id="31918" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="31920" href="lagda.2023-11-21-nbe.html#31898" class="Bound">T</a><a id="31921" class="Symbol">}</a>
           <a id="31934" class="Symbol">→</a> <a id="31936" href="lagda.2023-11-21-nbe.html#31909" class="Bound">t</a> <a id="31938" href="lagda.2023-11-21-nbe.html#30253" class="Datatype Operator">==</a> <a id="31941" href="lagda.2023-11-21-nbe.html#31911" class="Bound">t′</a>
             <a id="31957" class="Comment">-------</a>
           <a id="31976" class="Symbol">→</a> <a id="31978" href="lagda.2023-11-21-nbe.html#31909" class="Bound">t</a> <a id="31980" href="lagda.2023-11-21-nbe.html#30253" class="Datatype Operator">==</a> <a id="31983" href="lagda.2023-11-21-nbe.html#31911" class="Bound">t′</a>
  <a id="31988" href="lagda.2023-11-21-nbe.html#31874" class="Function Operator">begin==</a> <a id="31996" href="lagda.2023-11-21-nbe.html#31996" class="Bound">pf</a> <a id="31999" class="Symbol">=</a> <a id="32001" href="lagda.2023-11-21-nbe.html#31996" class="Bound">pf</a>

  <a id="==-Reasoning._==⟨_⟩_"></a><a id="32007" href="lagda.2023-11-21-nbe.html#32007" class="Function Operator">_==⟨_⟩_</a> <a id="32015" class="Symbol">:</a> <a id="32017" class="Symbol">∀</a> <a id="32019" class="Symbol">{</a><a id="32020" href="lagda.2023-11-21-nbe.html#32020" class="Bound">Γ</a> <a id="32022" class="Symbol">:</a> <a id="32024" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="32027" class="Symbol">}</a> <a id="32029" class="Symbol">{</a><a id="32030" href="lagda.2023-11-21-nbe.html#32030" class="Bound">T</a> <a id="32032" class="Symbol">:</a> <a id="32034" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="32038" class="Symbol">}</a> <a id="32040" class="Symbol">{</a><a id="32041" href="lagda.2023-11-21-nbe.html#32041" class="Bound">t₂</a> <a id="32044" href="lagda.2023-11-21-nbe.html#32044" class="Bound">t₃</a> <a id="32047" class="Symbol">:</a> <a id="32049" href="lagda.2023-11-21-nbe.html#32020" class="Bound">Γ</a> <a id="32051" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="32053" href="lagda.2023-11-21-nbe.html#32030" class="Bound">T</a><a id="32054" class="Symbol">}</a>
          <a id="32066" class="Symbol">→</a> <a id="32068" class="Symbol">(</a><a id="32069" href="lagda.2023-11-21-nbe.html#32069" class="Bound">t₁</a> <a id="32072" class="Symbol">:</a> <a id="32074" href="lagda.2023-11-21-nbe.html#32020" class="Bound">Γ</a> <a id="32076" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="32078" href="lagda.2023-11-21-nbe.html#32030" class="Bound">T</a><a id="32079" class="Symbol">)</a>
          <a id="32091" class="Symbol">→</a> <a id="32093" href="lagda.2023-11-21-nbe.html#32069" class="Bound">t₁</a> <a id="32096" href="lagda.2023-11-21-nbe.html#30253" class="Datatype Operator">==</a> <a id="32099" href="lagda.2023-11-21-nbe.html#32041" class="Bound">t₂</a>
          <a id="32112" class="Symbol">→</a> <a id="32114" href="lagda.2023-11-21-nbe.html#32041" class="Bound">t₂</a> <a id="32117" href="lagda.2023-11-21-nbe.html#30253" class="Datatype Operator">==</a> <a id="32120" href="lagda.2023-11-21-nbe.html#32044" class="Bound">t₃</a>
            <a id="32135" class="Comment">--------</a>
          <a id="32154" class="Symbol">→</a> <a id="32156" href="lagda.2023-11-21-nbe.html#32069" class="Bound">t₁</a> <a id="32159" href="lagda.2023-11-21-nbe.html#30253" class="Datatype Operator">==</a> <a id="32162" href="lagda.2023-11-21-nbe.html#32044" class="Bound">t₃</a>
  <a id="32167" href="lagda.2023-11-21-nbe.html#32167" class="Bound">t₁</a> <a id="32170" href="lagda.2023-11-21-nbe.html#32007" class="Function Operator">==⟨</a> <a id="32174" href="lagda.2023-11-21-nbe.html#32174" class="Bound">t₁≡t₂</a> <a id="32180" href="lagda.2023-11-21-nbe.html#32007" class="Function Operator">⟩</a> <a id="32182" href="lagda.2023-11-21-nbe.html#32182" class="Bound">t₂≡t₃</a>  <a id="32189" class="Symbol">=</a>  <a id="32192" href="lagda.2023-11-21-nbe.html#31311" class="InductiveConstructor">trans⁼⁼</a> <a id="32200" href="lagda.2023-11-21-nbe.html#32174" class="Bound">t₁≡t₂</a> <a id="32206" href="lagda.2023-11-21-nbe.html#32182" class="Bound">t₂≡t₃</a>

  <a id="==-Reasoning._==∎"></a><a id="32215" href="lagda.2023-11-21-nbe.html#32215" class="Function Operator">_==∎</a> <a id="32220" class="Symbol">:</a> <a id="32222" class="Symbol">∀</a> <a id="32224" class="Symbol">{</a><a id="32225" href="lagda.2023-11-21-nbe.html#32225" class="Bound">Γ</a> <a id="32227" class="Symbol">:</a> <a id="32229" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="32232" class="Symbol">}</a> <a id="32234" class="Symbol">{</a><a id="32235" href="lagda.2023-11-21-nbe.html#32235" class="Bound">T</a> <a id="32237" class="Symbol">:</a> <a id="32239" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="32243" class="Symbol">}</a> <a id="32245" class="Symbol">→</a> <a id="32247" class="Symbol">(</a><a id="32248" href="lagda.2023-11-21-nbe.html#32248" class="Bound">t</a> <a id="32250" class="Symbol">:</a> <a id="32252" href="lagda.2023-11-21-nbe.html#32225" class="Bound">Γ</a> <a id="32254" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="32256" href="lagda.2023-11-21-nbe.html#32235" class="Bound">T</a><a id="32257" class="Symbol">)</a>
         <a id="32268" class="Comment">------</a>
       <a id="32282" class="Symbol">→</a> <a id="32284" href="lagda.2023-11-21-nbe.html#32248" class="Bound">t</a> <a id="32286" href="lagda.2023-11-21-nbe.html#30253" class="Datatype Operator">==</a> <a id="32289" href="lagda.2023-11-21-nbe.html#32248" class="Bound">t</a>
  <a id="32293" href="lagda.2023-11-21-nbe.html#32293" class="Bound">t</a> <a id="32295" href="lagda.2023-11-21-nbe.html#32215" class="Function Operator">==∎</a>  <a id="32300" class="Symbol">=</a>  <a id="32303" href="lagda.2023-11-21-nbe.html#31125" class="InductiveConstructor">refl⁼⁼</a>
</pre>--->
<pre class="Agda"><a id="32328" class="Keyword">open</a> <a id="32333" href="lagda.2023-11-21-nbe.html#31796" class="Module">==-Reasoning</a> <a id="32346" class="Keyword">public</a>
</pre>
<p>Propositional equality implies definitional equality, a fact that will be
helpful to include here for later use.</p>
<pre class="Agda"><a id="≡→=="></a><a id="32480" href="lagda.2023-11-21-nbe.html#32480" class="Function">≡→==</a> <a id="32485" class="Symbol">:</a> <a id="32487" class="Symbol">∀</a> <a id="32489" class="Symbol">{</a><a id="32490" href="lagda.2023-11-21-nbe.html#32490" class="Bound">Γ</a> <a id="32492" class="Symbol">:</a> <a id="32494" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="32497" class="Symbol">}</a> <a id="32499" class="Symbol">{</a><a id="32500" href="lagda.2023-11-21-nbe.html#32500" class="Bound">T</a> <a id="32502" class="Symbol">:</a> <a id="32504" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="32508" class="Symbol">}</a> <a id="32510" class="Symbol">{</a><a id="32511" href="lagda.2023-11-21-nbe.html#32511" class="Bound">t</a> <a id="32513" href="lagda.2023-11-21-nbe.html#32513" class="Bound">t′</a> <a id="32516" class="Symbol">:</a> <a id="32518" href="lagda.2023-11-21-nbe.html#32490" class="Bound">Γ</a> <a id="32520" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="32522" href="lagda.2023-11-21-nbe.html#32500" class="Bound">T</a><a id="32523" class="Symbol">}</a>
     <a id="32530" class="Symbol">→</a> <a id="32532" href="lagda.2023-11-21-nbe.html#32511" class="Bound">t</a> <a id="32534" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="32536" href="lagda.2023-11-21-nbe.html#32513" class="Bound">t′</a>
       <a id="32546" class="Comment">-------</a>
     <a id="32559" class="Symbol">→</a> <a id="32561" href="lagda.2023-11-21-nbe.html#32511" class="Bound">t</a> <a id="32563" href="lagda.2023-11-21-nbe.html#30253" class="Datatype Operator">==</a> <a id="32566" href="lagda.2023-11-21-nbe.html#32513" class="Bound">t′</a>
<a id="32569" href="lagda.2023-11-21-nbe.html#32480" class="Function">≡→==</a> <a id="32574" href="lagda.2023-11-21-nbe.html#32574" class="Bound">pf</a> <a id="32577" class="Keyword">rewrite</a> <a id="32585" href="lagda.2023-11-21-nbe.html#32574" class="Bound">pf</a> <a id="32588" class="Symbol">=</a> <a id="32590" href="lagda.2023-11-21-nbe.html#31125" class="InductiveConstructor">refl⁼⁼</a>
</pre>
<h3 id="evaluation">Evaluation</h3>
<p>The evaluation, or interpretation, <code>⟦ t ⟧</code> of a well-typed term <code>Γ ⊢ t : T</code>
assigns a meaning to <code>t</code> by equating it to a semantic object in our meta
language, using an interpretation of the context <code>Γ</code> (an <em>environment</em>) under
which the term <code>t</code> is well-typed.</p>
<p>For types, we can interpret <code>𝟙</code> as Agda’s own unit type, <code>⊤</code>, and functions as
Agda functions, with their meaning defined inductively.</p>
<pre><code>⟦ 𝟙 ⟧ = ⊤
⟦ S ⇒ T ⟧ = ⟦ S ⟧ → ⟦ T ⟧</code></pre>
<p>An empty context is interpreted as the unit type (an “empty” environment), and
an extension to a context is defined inductively, with the extension itself
being the interpretation of the type the context is extended with.</p>
<pre><code>⟦ ∅ ⟧ = ⊤
⟦ Γ , S ⟧ = ⟦ Γ ⟧ × ⟦ S ⟧</code></pre>
<p>We will use the lowercase Greek letter of a context to refer to its environment
(e.g. <code>γ</code> is an environment for <code>Γ</code>).</p>
<p>The interpretation of a variable expects an environment, and is essentially a
lookup into the environment for the variable’s value:</p>
<pre><code>⟦ Γ ∋ x:T ⟧ (γ ∈ ⟦ Γ ⟧) ∈ ⟦ T ⟧
⟦ Γ , T ∋ x:T ⟧ (γ , a) = a
⟦ Γ , y:S ∋ x:T ⟧ (γ , _) = ⟦ Γ ∋ x:T ⟧ γ</code></pre>
<p>The interpretation of a typed term expects an environment as well, evaluating
the term by using the environment for the variables that the term is using.</p>
<pre><code>⟦ Γ ⊢ t : T ⟧ (γ ∈ ⟦Γ⟧) ∈ ⟦ T ⟧
⟦ Γ ⊢ unit : 𝟙 ⟧ γ       = tt
⟦ Γ ⊢ x : T ⟧ γ          = ⟦ Γ ∋ x:T ⟧ γ
⟦ Γ ⊢ λx . t : S ⇒ T ⟧ γ = λ a → ⟦ Γ , x:S ⊢ t : T ⟧ (γ , a)
⟦ Γ ⊢ r s : T ⟧ γ        = (⟦ Γ ⊢ r : S ⇒ T ⟧ γ) (⟦ Γ ⊢ s : S ⟧ γ)</code></pre>
<p>Before moving forward, we introduce the record we will use to represent
interpretations of types and contexts. For now, we will only include the
interpretation of a context as an environment, as our interpretation of types
will change subtly to better fit our algorithm for normalization by evaluation ─
this is also why we have only discussed evaluation at a high level.</p>
<pre class="Agda"><a id="34484" class="Keyword">record</a> <a id="Interpretation"></a><a id="34491" href="lagda.2023-11-21-nbe.html#34491" class="Record">Interpretation</a> <a id="34506" class="Symbol">(</a><a id="34507" href="lagda.2023-11-21-nbe.html#34507" class="Bound">D</a> <a id="34509" class="Symbol">:</a> <a id="34511" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="34514" class="Symbol">)</a> <a id="34516" class="Symbol">:</a> <a id="34518" href="Agda.Primitive.html#326" class="Primitive">Set₁</a> <a id="34523" class="Keyword">where</a>
  <a id="34531" class="Keyword">field</a>
    <a id="Interpretation.⟦_⟧"></a><a id="34541" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦_⟧</a> <a id="34545" class="Symbol">:</a> <a id="34547" href="lagda.2023-11-21-nbe.html#34507" class="Bound">D</a> <a id="34549" class="Symbol">→</a> <a id="34551" href="Agda.Primitive.html#326" class="Primitive">Set</a>

<a id="34556" class="Keyword">open</a> <a id="34561" href="lagda.2023-11-21-nbe.html#34491" class="Module">Interpretation</a> <a id="34576" class="Symbol">⦃...⦄</a> <a id="34582" class="Keyword">public</a>

<a id="34590" class="Keyword">instance</a>
    <a id="⟦Γ⟧"></a><a id="34603" href="lagda.2023-11-21-nbe.html#34603" class="Function">⟦Γ⟧</a> <a id="34607" class="Symbol">:</a> <a id="34609" class="Symbol">⦃</a> <a id="34611" href="lagda.2023-11-21-nbe.html#34611" class="Bound">_</a> <a id="34613" class="Symbol">:</a> <a id="34615" href="lagda.2023-11-21-nbe.html#34491" class="Record">Interpretation</a> <a id="34630" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a> <a id="34635" class="Symbol">⦄</a> <a id="34637" class="Symbol">→</a> <a id="34639" href="lagda.2023-11-21-nbe.html#34491" class="Record">Interpretation</a> <a id="34654" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a>
    <a id="34662" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">Interpretation.⟦</a> <a id="34679" href="lagda.2023-11-21-nbe.html#34603" class="Function">⟦Γ⟧</a> <a id="34683" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a> <a id="34685" href="lagda.2023-11-21-nbe.html#3944" class="InductiveConstructor">∅</a> <a id="34687" class="Symbol">=</a> <a id="34689" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
    <a id="34695" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">Interpretation.⟦</a> <a id="34712" href="lagda.2023-11-21-nbe.html#34603" class="Function">⟦Γ⟧</a> <a id="34716" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a> <a id="34718" class="Symbol">(</a><a id="34719" href="lagda.2023-11-21-nbe.html#34719" class="Bound">Γ</a> <a id="34721" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="34723" href="lagda.2023-11-21-nbe.html#34723" class="Bound">T</a><a id="34724" class="Symbol">)</a> <a id="34726" class="Symbol">=</a> <a id="34728" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="34730" href="lagda.2023-11-21-nbe.html#34719" class="Bound">Γ</a> <a id="34732" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a> <a id="34734" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="34736" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="34738" href="lagda.2023-11-21-nbe.html#34723" class="Bound">T</a> <a id="34740" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a>
</pre>
<h3 id="normalization-by-evaluation">Normalization by Evaluation</h3>
<p>The key idea behind normalization by evaluation is that we have inherently
performed some normalization of the term <code>t</code> in its evaluation – if <code>t</code> was an
application <code>r s</code>, we are actually performing that application and reducing the
term. Normalization by evaluation as an algorithm takes advantage of this fact.</p>
<p>An issue with this view is that evaluation is not actually giving us the normal
form of a term, but rather its meaning as a semantic object in our meta
language. An algorithm for normalization by evaluation would need a way to to
convert a semantic object in our meta language back into a term in the object
language.</p>
<p>One way to achieve this is to evaluate (i.e. normalize) the parts of the
expression that actually <em>can</em> be evaluated (such as function application),
while leaving the parts that cannot intact. Under this view, normalization by
evaluation becomes the evaluation of an expression with unknowns
(i.e. variables) to another, possibly simplified, expression with unknowns.</p>
<p>To get this behavior, we make a subtle change to the “meaning” of a term in the meta language – instead of terms of type <code>𝟙</code> mapping to Agda’s unit type, they
will now evaluate to terms in their normal form.</p>
<p>This is a subtle distinction with a significant impact on the algorithm we will
define. We can now easily convert back to the object language, because
<em>technically</em> we never left it to begin with: functions in Agda can be
translated simply abstractions in the STLC, and for terms of type <code>𝟙</code>, we
already have the term!</p>
<p>In Agda, we do not yet have a concept of normal form. We can define terms in
their normal form (normal terms) mutually with terms that are blocked on
evaluation because they are unknown (neutral terms).</p>
<pre class="Agda"><a id="36526" class="Keyword">data</a> <a id="Nf"></a><a id="36531" href="lagda.2023-11-21-nbe.html#36531" class="Datatype">Nf</a> <a id="36534" class="Symbol">:</a> <a id="36536" class="Symbol">(</a><a id="36537" href="lagda.2023-11-21-nbe.html#36537" class="Bound">T</a> <a id="36539" class="Symbol">:</a> <a id="36541" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="36545" class="Symbol">)</a> <a id="36547" class="Symbol">→</a> <a id="36549" class="Symbol">(</a><a id="36550" href="lagda.2023-11-21-nbe.html#36550" class="Bound">Γ</a> <a id="36552" class="Symbol">:</a> <a id="36554" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="36557" class="Symbol">)</a> <a id="36559" class="Symbol">→</a> <a id="36561" href="lagda.2023-11-21-nbe.html#36550" class="Bound">Γ</a> <a id="36563" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="36565" href="lagda.2023-11-21-nbe.html#36537" class="Bound">T</a> <a id="36567" class="Symbol">→</a> <a id="36569" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="36573" class="Comment">-- Normal terms</a>
<a id="36589" class="Keyword">data</a> <a id="Ne"></a><a id="36594" href="lagda.2023-11-21-nbe.html#36594" class="Datatype">Ne</a> <a id="36597" class="Symbol">(</a><a id="36598" href="lagda.2023-11-21-nbe.html#36598" class="Bound">T</a> <a id="36600" class="Symbol">:</a> <a id="36602" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="36606" class="Symbol">)</a> <a id="36608" class="Symbol">(</a><a id="36609" href="lagda.2023-11-21-nbe.html#36609" class="Bound">Γ</a> <a id="36611" class="Symbol">:</a> <a id="36613" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="36616" class="Symbol">)</a> <a id="36618" class="Symbol">:</a> <a id="36620" href="lagda.2023-11-21-nbe.html#36609" class="Bound">Γ</a> <a id="36622" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="36624" href="lagda.2023-11-21-nbe.html#36598" class="Bound">T</a> <a id="36626" class="Symbol">→</a> <a id="36628" href="Agda.Primitive.html#326" class="Primitive">Set</a>     <a id="36636" class="Comment">-- Neutral terms</a>
</pre>
<p>The rules for these will follow shortly ─ but with this definition we can change
the interpretation of a term of type <code>𝟙</code> to what we would want it to be to
define a suitable algorithm for normalization by evaluation:</p>
<pre><code>⟦ 𝟙 ⟧ = Nf 𝟙</code></pre>
<p>Note that our data type for normal terms is indexed both by a type and a
context, yet here the interpretation of a type is only indexed by the type
itself. We will get to this later, but it is for this reason that we have again
not written an implementation out in Agda yet. For now, we can give an initial
sketch of the algorithm, using a <em>reflection</em> function <code>↑ᵀ</code> that maps neutral
terms of type <code>T</code> to semantic objects in <code>⟦ T ⟧</code>, and a <em>reification</em> function
<code>↓ᵀ</code> for mapping a semantic object in <code>⟦ T ⟧</code> to normal forms of type <code>T</code>:</p>
<p>Putting all of these pieces together, we can present (in pseudocode) what an
algorithm for normalization by evaluation would do.</p>
<pre><code>⟦ 𝟙 ⟧ = Nf 𝟙
⟦ S → T ⟧ = ⟦ S ⟧ → ⟦ T ⟧

↑ᵀ ∈ Ne T → ⟦ T ⟧
↑ᵘⁿⁱᵗ 𝓊 = 𝓊
↑ˢ  ⃕ ᵗ 𝓊 (a ∈ ⟦ S ⟧) = ↑ᵀ (𝓊 𝓋) , 𝓋 = ↓ˢ a

↓ᵀ ∈ ⟦ T ⟧ → Nf T
↓ᵘⁿⁱᵗ 𝓋 = 𝓋
↓ˢ  ⃕ ᵗ f = λx. ↓ᵀ (f(a)) , where a = ↑ᵀ x and x is &quot;fresh&quot;

↑ᶜᵗˣ ∈ ⟦ Γ ⟧
↑∅ = tt
↑Γ,x:S = ↑Γ , ↑ᵀ x

nf(t) = ↓ᵀ (⟦ t ⟧ ↑Γ)</code></pre>
<p>In summary, the algorithm proceeds as follows:</p>
<ol type="1">
<li><p>reflect the variables of the context <code>Γ</code> (<code>↑Γ</code>)</p></li>
<li><p>interpret the value of the term using the environment
of reflected variables (<code>⟦ t ⟧ ↑Γ</code>)</p></li>
<li><p>“reify” the interpreted value of the term (<code>↓ᵀ (⟦ t ⟧ ↑Γ)</code>),
returning it to a term in normal form</p></li>
</ol>
<p>The “freshness” condition in this sketch is a key part of why we have not
started defining a more concrete version of the algorithm, but with this sketch
we can see how our new interpretation of the type <code>𝟙</code> has benefitted us: we are
able to evaluate a term while leaving its unknowns “untouched”: reflection of an
unknown term of type <code>𝟙</code> yields the unknown itself, while we always η-expand at
reification to continue evaluation. Once we have finished evaluating the term,
we are easily able to convert it back into our object language.</p>
<p>As an initial step in formally defining this algorithm, we can now introduce the
rules for normal and neutral terms in Agda. Going forward, we will be using <code>𝓊</code>
(for “unknown”) to refer to neutral terms and <code>𝓋</code> (for “value”) to refer to
normal terms.</p>
<p>Neutral terms are normal terms in their blocked form. Variables are the “base
case” for blocked terms, with application of an unknown function to a normal
term also being blocked.</p>
<pre class="Agda"><a id="39187" class="Keyword">data</a> <a id="39192" href="lagda.2023-11-21-nbe.html#36594" class="Datatype">Ne</a> <a id="39195" href="lagda.2023-11-21-nbe.html#39195" class="Bound">T</a> <a id="39197" href="lagda.2023-11-21-nbe.html#39197" class="Bound">Γ</a> <a id="39199" class="Keyword">where</a>
  <a id="Ne.ne-var"></a><a id="39207" href="lagda.2023-11-21-nbe.html#39207" class="InductiveConstructor">ne-var</a> <a id="39214" class="Symbol">:</a> <a id="39216" class="Symbol">(</a><a id="39217" href="lagda.2023-11-21-nbe.html#39217" class="Bound">x</a> <a id="39219" class="Symbol">:</a> <a id="39221" href="lagda.2023-11-21-nbe.html#39197" class="Bound">Γ</a> <a id="39223" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="39225" href="lagda.2023-11-21-nbe.html#39195" class="Bound">T</a><a id="39226" class="Symbol">)</a>
           <a id="39239" class="Comment">------------</a>
         <a id="39261" class="Symbol">→</a> <a id="39263" href="lagda.2023-11-21-nbe.html#36594" class="Datatype">Ne</a> <a id="39266" href="lagda.2023-11-21-nbe.html#39195" class="Bound">T</a> <a id="39268" href="lagda.2023-11-21-nbe.html#39197" class="Bound">Γ</a> <a id="39270" class="Symbol">(</a><a id="39271" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="39273" href="lagda.2023-11-21-nbe.html#39217" class="Bound">x</a><a id="39274" class="Symbol">)</a>

  <a id="Ne.ne-app"></a><a id="39279" href="lagda.2023-11-21-nbe.html#39279" class="InductiveConstructor">ne-app</a> <a id="39286" class="Symbol">:</a> <a id="39288" class="Symbol">∀</a> <a id="39290" class="Symbol">{</a><a id="39291" href="lagda.2023-11-21-nbe.html#39291" class="Bound">S</a> <a id="39293" class="Symbol">:</a> <a id="39295" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="39299" class="Symbol">}</a> <a id="39301" class="Symbol">{</a><a id="39302" href="lagda.2023-11-21-nbe.html#39302" class="Bound">𝓊</a> <a id="39304" class="Symbol">:</a> <a id="39306" href="lagda.2023-11-21-nbe.html#39197" class="Bound">Γ</a> <a id="39308" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="39310" href="lagda.2023-11-21-nbe.html#39291" class="Bound">S</a> <a id="39312" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="39314" href="lagda.2023-11-21-nbe.html#39195" class="Bound">T</a><a id="39315" class="Symbol">}</a> <a id="39317" class="Symbol">{</a><a id="39318" href="lagda.2023-11-21-nbe.html#39318" class="Bound">𝓋</a> <a id="39320" class="Symbol">:</a> <a id="39322" href="lagda.2023-11-21-nbe.html#39197" class="Bound">Γ</a> <a id="39324" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="39326" href="lagda.2023-11-21-nbe.html#39291" class="Bound">S</a><a id="39327" class="Symbol">}</a>
         <a id="39338" class="Symbol">→</a> <a id="39340" href="lagda.2023-11-21-nbe.html#36594" class="Datatype">Ne</a> <a id="39343" class="Symbol">(</a><a id="39344" href="lagda.2023-11-21-nbe.html#39291" class="Bound">S</a> <a id="39346" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="39348" href="lagda.2023-11-21-nbe.html#39195" class="Bound">T</a><a id="39349" class="Symbol">)</a> <a id="39351" href="lagda.2023-11-21-nbe.html#39197" class="Bound">Γ</a> <a id="39353" href="lagda.2023-11-21-nbe.html#39302" class="Bound">𝓊</a>
         <a id="39364" class="Symbol">→</a> <a id="39366" href="lagda.2023-11-21-nbe.html#36531" class="Datatype">Nf</a> <a id="39369" href="lagda.2023-11-21-nbe.html#39291" class="Bound">S</a> <a id="39371" href="lagda.2023-11-21-nbe.html#39197" class="Bound">Γ</a> <a id="39373" href="lagda.2023-11-21-nbe.html#39318" class="Bound">𝓋</a>
           <a id="39386" class="Comment">--------------</a>
         <a id="39410" class="Symbol">→</a> <a id="39412" href="lagda.2023-11-21-nbe.html#36594" class="Datatype">Ne</a> <a id="39415" href="lagda.2023-11-21-nbe.html#39195" class="Bound">T</a> <a id="39417" href="lagda.2023-11-21-nbe.html#39197" class="Bound">Γ</a> <a id="39419" class="Symbol">(</a><a id="39420" href="lagda.2023-11-21-nbe.html#39302" class="Bound">𝓊</a> <a id="39422" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="39424" href="lagda.2023-11-21-nbe.html#39318" class="Bound">𝓋</a><a id="39425" class="Symbol">)</a>
</pre>
<p>Normal terms are terms in their normal form. <code>unit</code> is a normal term, as is an
abstraction whose body is itself normalized. Any neutral term is also a normal
term.</p>
<pre class="Agda"><a id="39605" class="Keyword">data</a> <a id="39610" href="lagda.2023-11-21-nbe.html#36531" class="Datatype">Nf</a> <a id="39613" class="Keyword">where</a>
  <a id="Nf.nf-unit"></a><a id="39621" href="lagda.2023-11-21-nbe.html#39621" class="InductiveConstructor">nf-unit</a> <a id="39629" class="Symbol">:</a> <a id="39631" class="Symbol">∀</a> <a id="39633" class="Symbol">{</a><a id="39634" href="lagda.2023-11-21-nbe.html#39634" class="Bound">Γ</a> <a id="39636" class="Symbol">:</a> <a id="39638" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="39641" class="Symbol">}</a> <a id="39643" class="Symbol">→</a> <a id="39645" href="lagda.2023-11-21-nbe.html#36531" class="Datatype">Nf</a> <a id="39648" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a> <a id="39650" href="lagda.2023-11-21-nbe.html#39634" class="Bound">Γ</a> <a id="39652" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a>

  <a id="Nf.nf-abs"></a><a id="39660" href="lagda.2023-11-21-nbe.html#39660" class="InductiveConstructor">nf-abs</a> <a id="39667" class="Symbol">:</a> <a id="39669" class="Symbol">∀</a> <a id="39671" class="Symbol">{</a><a id="39672" href="lagda.2023-11-21-nbe.html#39672" class="Bound">S</a> <a id="39674" href="lagda.2023-11-21-nbe.html#39674" class="Bound">T</a> <a id="39676" class="Symbol">:</a> <a id="39678" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="39682" class="Symbol">}</a> <a id="39684" class="Symbol">{</a><a id="39685" href="lagda.2023-11-21-nbe.html#39685" class="Bound">Γ</a> <a id="39687" class="Symbol">:</a> <a id="39689" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="39692" class="Symbol">}</a> <a id="39694" class="Symbol">{</a><a id="39695" href="lagda.2023-11-21-nbe.html#39695" class="Bound">𝓋</a> <a id="39697" class="Symbol">:</a> <a id="39699" href="lagda.2023-11-21-nbe.html#39685" class="Bound">Γ</a> <a id="39701" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="39703" href="lagda.2023-11-21-nbe.html#39672" class="Bound">S</a> <a id="39705" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="39707" href="lagda.2023-11-21-nbe.html#39674" class="Bound">T</a><a id="39708" class="Symbol">}</a>
         <a id="39719" class="Symbol">→</a> <a id="39721" href="lagda.2023-11-21-nbe.html#36531" class="Datatype">Nf</a> <a id="39724" href="lagda.2023-11-21-nbe.html#39674" class="Bound">T</a> <a id="39726" class="Symbol">(</a><a id="39727" href="lagda.2023-11-21-nbe.html#39685" class="Bound">Γ</a> <a id="39729" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="39731" href="lagda.2023-11-21-nbe.html#39672" class="Bound">S</a><a id="39732" class="Symbol">)</a> <a id="39734" href="lagda.2023-11-21-nbe.html#39695" class="Bound">𝓋</a>
           <a id="39747" class="Comment">------------------</a>
         <a id="39775" class="Symbol">→</a> <a id="39777" href="lagda.2023-11-21-nbe.html#36531" class="Datatype">Nf</a> <a id="39780" class="Symbol">(</a><a id="39781" href="lagda.2023-11-21-nbe.html#39672" class="Bound">S</a> <a id="39783" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="39785" href="lagda.2023-11-21-nbe.html#39674" class="Bound">T</a><a id="39786" class="Symbol">)</a> <a id="39788" href="lagda.2023-11-21-nbe.html#39685" class="Bound">Γ</a> <a id="39790" class="Symbol">(</a><a id="39791" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="39793" href="lagda.2023-11-21-nbe.html#39695" class="Bound">𝓋</a><a id="39794" class="Symbol">)</a>

  <a id="Nf.nf-neutral"></a><a id="39799" href="lagda.2023-11-21-nbe.html#39799" class="InductiveConstructor">nf-neutral</a> <a id="39810" class="Symbol">:</a> <a id="39812" class="Symbol">∀</a> <a id="39814" class="Symbol">{</a><a id="39815" href="lagda.2023-11-21-nbe.html#39815" class="Bound">T</a> <a id="39817" class="Symbol">:</a> <a id="39819" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="39823" class="Symbol">}</a> <a id="39825" class="Symbol">{</a><a id="39826" href="lagda.2023-11-21-nbe.html#39826" class="Bound">Γ</a> <a id="39828" class="Symbol">:</a> <a id="39830" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="39833" class="Symbol">}</a> <a id="39835" class="Symbol">{</a><a id="39836" href="lagda.2023-11-21-nbe.html#39836" class="Bound">𝓊</a> <a id="39838" class="Symbol">:</a> <a id="39840" href="lagda.2023-11-21-nbe.html#39826" class="Bound">Γ</a> <a id="39842" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="39844" href="lagda.2023-11-21-nbe.html#39815" class="Bound">T</a><a id="39845" class="Symbol">}</a>
             <a id="39860" class="Symbol">→</a> <a id="39862" href="lagda.2023-11-21-nbe.html#36594" class="Datatype">Ne</a> <a id="39865" href="lagda.2023-11-21-nbe.html#39815" class="Bound">T</a> <a id="39867" href="lagda.2023-11-21-nbe.html#39826" class="Bound">Γ</a> <a id="39869" href="lagda.2023-11-21-nbe.html#39836" class="Bound">𝓊</a>
               <a id="39886" class="Comment">--------</a>
             <a id="39908" class="Symbol">→</a> <a id="39910" href="lagda.2023-11-21-nbe.html#36531" class="Datatype">Nf</a> <a id="39913" href="lagda.2023-11-21-nbe.html#39815" class="Bound">T</a> <a id="39915" href="lagda.2023-11-21-nbe.html#39826" class="Bound">Γ</a> <a id="39917" href="lagda.2023-11-21-nbe.html#39836" class="Bound">𝓊</a>
</pre>
<p>Now, we can discuss the issue of the freshness condition used when reifying at
function type. We are using a de Brujin index representation, so “freshness” is
given to us freely by extending the context. However, there is no context
anywhere in our definition of reification, so what context do we extend with the
fresh variable? This is actually an intentional decision for reification,
because of a problem that is more subtle: after we reflect the variable, it may
later be reified in a different context than it was created. Consider the
reification of a semantic object <code>f</code> with type <code>(S → T) → U</code>:</p>
<pre><code>↓⁽ˢ  ⃕ ᵗ⁾  ⃕ ᵘ f = λx. ↓ˢ  ⃕ ᵗ (f(a)) , where a = ↑ᵘ x</code></pre>
<p>The inner reification evaluates further:</p>
<pre><code>↓ˢ  ⃕ ᵗ (f(a)) = λy. ↓ᵗ (f(a)(b)) , where b = ↑ˢ y</code></pre>
<p>This example showcases the problem: when we reflected <code>x</code> into our meta
language, we had to (presumably) use some context <code>Γ</code> to produce the Agda
expression <code>a</code> with the type <code>Nf T Γ</code>. But later, when we reify <code>f(a)(b)</code>, we
will produce a term that is possibly using the variable <code>x</code>, but the term is
now in a different context: <code>Γ, y:S</code>.</p>
<p>This suggests that we need to generalize our reflection of terms in the object
language over all contexts, so that at reification we can use a different
context than the one that was used at reflection.</p>
<p>We introduce <em>liftable</em> normal and neutral terms to address this. These are
normal/neutral terms that are generalized over contexts.</p>
<p>While they will be generalized over contexts, this means that a liftable neutral
or normal term may not be well-typed when lifted to some contexts. It will be
the case that the liftable terms we will use in our algirhtm will only be able
to be lifted at reification to a context that is an extension of the context
used when the liftable term was reflected (and with the example above, the
reason is clear: our algorithm would otherwise never produce a term that is
well-typed).</p>
<p>Because we cannot apply <em>any</em> context to a liftable normal/neutral term, we will
need a placeholder value for some contexts.</p>
<pre class="Agda"><a id="41979" class="Comment">-- Liftable neutral term</a>
<a id="Ne^"></a><a id="42004" href="lagda.2023-11-21-nbe.html#42004" class="Function">Ne^</a> <a id="42008" class="Symbol">:</a> <a id="42010" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a> <a id="42015" class="Symbol">→</a> <a id="42017" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="42021" href="lagda.2023-11-21-nbe.html#42004" class="Function">Ne^</a> <a id="42025" href="lagda.2023-11-21-nbe.html#42025" class="Bound">T</a> <a id="42027" class="Symbol">=</a> <a id="42029" class="Symbol">∀</a> <a id="42031" class="Symbol">(</a><a id="42032" href="lagda.2023-11-21-nbe.html#42032" class="Bound">Γ</a> <a id="42034" class="Symbol">:</a> <a id="42036" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="42039" class="Symbol">)</a> <a id="42041" class="Symbol">→</a> <a id="42043" href="Data.Product.html#1806" class="Function">∃[</a> <a id="42046" href="lagda.2023-11-21-nbe.html#42046" class="Bound">t</a> <a id="42048" href="Data.Product.html#1806" class="Function">]</a> <a id="42050" href="lagda.2023-11-21-nbe.html#36594" class="Datatype">Ne</a> <a id="42053" href="lagda.2023-11-21-nbe.html#42025" class="Bound">T</a> <a id="42055" href="lagda.2023-11-21-nbe.html#42032" class="Bound">Γ</a> <a id="42057" href="lagda.2023-11-21-nbe.html#42046" class="Bound">t</a> <a id="42059" href="Data.Sum.Base.html#734" class="Datatype Operator">⊎</a> <a id="42061" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>

<a id="42064" class="Comment">-- Liftable normal term</a>
<a id="Nf^"></a><a id="42088" href="lagda.2023-11-21-nbe.html#42088" class="Function">Nf^</a> <a id="42092" class="Symbol">:</a> <a id="42094" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a> <a id="42099" class="Symbol">→</a> <a id="42101" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="42105" href="lagda.2023-11-21-nbe.html#42088" class="Function">Nf^</a> <a id="42109" href="lagda.2023-11-21-nbe.html#42109" class="Bound">T</a> <a id="42111" class="Symbol">=</a> <a id="42113" class="Symbol">∀</a> <a id="42115" class="Symbol">(</a><a id="42116" href="lagda.2023-11-21-nbe.html#42116" class="Bound">Γ</a> <a id="42118" class="Symbol">:</a> <a id="42120" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="42123" class="Symbol">)</a> <a id="42125" class="Symbol">→</a> <a id="42127" href="Data.Product.html#1806" class="Function">∃[</a> <a id="42130" href="lagda.2023-11-21-nbe.html#42130" class="Bound">t</a> <a id="42132" href="Data.Product.html#1806" class="Function">]</a> <a id="42134" href="lagda.2023-11-21-nbe.html#36531" class="Datatype">Nf</a> <a id="42137" href="lagda.2023-11-21-nbe.html#42109" class="Bound">T</a> <a id="42139" href="lagda.2023-11-21-nbe.html#42116" class="Bound">Γ</a> <a id="42141" href="lagda.2023-11-21-nbe.html#42130" class="Bound">t</a>
</pre>
<p>For convenience, we only use this placeholder for liftable neutral terms.
This is possible because of how the algorithm for normalization by evaluation
is designed ─ reification always η-expands at function type, so there will only
ever be a need to use a placeholder value at our base type <code>𝟙</code>. In the case of
liftable normals, we can fallback to using <code>unit</code> (which is a valid normal term)
instead of using our placeholder value.</p>
<p>We allow ourselves this convenience because in proving the soundness of
normalization by evaluation, we will be proving that neither the placeholder
value nor the fallback of <code>unit</code> will actually be used.</p>
<p>Going forward, we will use <code>𝓋̂</code> and <code>𝓊̂</code> as the metavariables for liftable normal
terms and neutral terms respectively, and will append the symbol <code>^</code> for the
“liftable” counterpart of a language construct. For example, we define the
overloaded application <code>(𝓊̂ 𝓋̂)(Γ) = 𝓊̂(Γ) 𝓋̂(Γ)</code> of liftable terms as <code>·^</code>.</p>
<pre class="Agda"><a id="_·^_"></a><a id="43107" href="lagda.2023-11-21-nbe.html#43107" class="Function Operator">_·^_</a> <a id="43112" class="Symbol">:</a> <a id="43114" class="Symbol">∀</a> <a id="43116" class="Symbol">{</a><a id="43117" href="lagda.2023-11-21-nbe.html#43117" class="Bound">S</a> <a id="43119" href="lagda.2023-11-21-nbe.html#43119" class="Bound">T</a> <a id="43121" class="Symbol">:</a> <a id="43123" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="43127" class="Symbol">}</a> <a id="43129" class="Symbol">→</a> <a id="43131" href="lagda.2023-11-21-nbe.html#42004" class="Function">Ne^</a> <a id="43135" class="Symbol">(</a><a id="43136" href="lagda.2023-11-21-nbe.html#43117" class="Bound">S</a> <a id="43138" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="43140" href="lagda.2023-11-21-nbe.html#43119" class="Bound">T</a><a id="43141" class="Symbol">)</a> <a id="43143" class="Symbol">→</a> <a id="43145" href="lagda.2023-11-21-nbe.html#42088" class="Function">Nf^</a> <a id="43149" href="lagda.2023-11-21-nbe.html#43117" class="Bound">S</a> <a id="43151" class="Symbol">→</a> <a id="43153" href="lagda.2023-11-21-nbe.html#42004" class="Function">Ne^</a> <a id="43157" href="lagda.2023-11-21-nbe.html#43119" class="Bound">T</a>
<a id="43159" class="Symbol">(</a><a id="43160" href="lagda.2023-11-21-nbe.html#43160" class="Bound">𝓊̂</a> <a id="43163" href="lagda.2023-11-21-nbe.html#43107" class="Function Operator">·^</a> <a id="43166" href="lagda.2023-11-21-nbe.html#43166" class="Bound">𝓋̂</a><a id="43168" class="Symbol">)</a> <a id="43170" href="lagda.2023-11-21-nbe.html#43170" class="Bound">Γ</a> <a id="43172" class="Keyword">with</a> <a id="43177" href="lagda.2023-11-21-nbe.html#43160" class="Bound">𝓊̂</a> <a id="43180" href="lagda.2023-11-21-nbe.html#43170" class="Bound">Γ</a>
<a id="43182" class="Symbol">...</a>           <a id="43196" class="Symbol">|</a> <a id="43198" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="43203" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="43205" href="lagda.2023-11-21-nbe.html#43205" class="Bound">𝓊</a> <a id="43207" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="43209" href="lagda.2023-11-21-nbe.html#43209" class="Bound">pf-𝓊</a> <a id="43214" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a> <a id="43216" class="Symbol">=</a>
  <a id="43220" class="Keyword">let</a> <a id="43224" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="43226" href="lagda.2023-11-21-nbe.html#43226" class="Bound">𝓋</a> <a id="43228" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="43230" href="lagda.2023-11-21-nbe.html#43230" class="Bound">pf-𝓋</a> <a id="43235" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a> <a id="43237" class="Symbol">=</a> <a id="43239" class="Bound">𝓋̂</a> <a id="43242" class="Bound">Γ</a> <a id="43244" class="Keyword">in</a>
  <a id="43249" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="43254" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="43256" href="lagda.2023-11-21-nbe.html#43205" class="Bound">𝓊</a> <a id="43258" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="43260" href="lagda.2023-11-21-nbe.html#43226" class="Bound">𝓋</a> <a id="43262" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="43264" href="lagda.2023-11-21-nbe.html#39279" class="InductiveConstructor">ne-app</a> <a id="43271" href="lagda.2023-11-21-nbe.html#43209" class="Bound">pf-𝓊</a> <a id="43276" href="lagda.2023-11-21-nbe.html#43230" class="Bound">pf-𝓋</a> <a id="43281" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a>
<a id="43283" class="Symbol">...</a>           <a id="43297" class="Symbol">|</a> <a id="43299" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="43304" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>           <a id="43317" class="Symbol">=</a> <a id="43319" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="43324" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>
</pre>
<p>The actual interpretation of the base type <code>𝟙</code> will be an extension to Agda’s
unit type that embeds liftable neutrals: <code>⊤̂</code> (pronounced “top hat”). With it
defined, we can also define the interpretation of types, along with the
evaluation of terms. These are exactly as was shown earlier in pseudocode.</p>
<pre class="Agda"><a id="43644" class="Keyword">data</a> <a id="⊤̂"></a><a id="43649" href="lagda.2023-11-21-nbe.html#43649" class="Datatype">⊤̂</a> <a id="43652" class="Symbol">:</a> <a id="43654" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="43658" class="Keyword">where</a>
  <a id="⊤̂.unit"></a><a id="43666" href="lagda.2023-11-21-nbe.html#43666" class="InductiveConstructor">unit</a> <a id="43671" class="Symbol">:</a> <a id="43673" href="lagda.2023-11-21-nbe.html#43649" class="Datatype">⊤̂</a>
  <a id="⊤̂.ne"></a><a id="43678" href="lagda.2023-11-21-nbe.html#43678" class="InductiveConstructor">ne</a>   <a id="43683" class="Symbol">:</a> <a id="43685" href="lagda.2023-11-21-nbe.html#42004" class="Function">Ne^</a> <a id="43689" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a> <a id="43691" class="Symbol">→</a> <a id="43693" href="lagda.2023-11-21-nbe.html#43649" class="Datatype">⊤̂</a>

<a id="43697" class="Keyword">instance</a>
  <a id="⟦Type⟧"></a><a id="43708" href="lagda.2023-11-21-nbe.html#43708" class="Function">⟦Type⟧</a> <a id="43715" class="Symbol">:</a> <a id="43717" href="lagda.2023-11-21-nbe.html#34491" class="Record">Interpretation</a> <a id="43732" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a>
  <a id="43739" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">Interpretation.⟦</a> <a id="43756" href="lagda.2023-11-21-nbe.html#43708" class="Function">⟦Type⟧</a> <a id="43763" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a> <a id="43765" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a> <a id="43767" class="Symbol">=</a> <a id="43769" href="lagda.2023-11-21-nbe.html#43649" class="Datatype">⊤̂</a>
  <a id="43774" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">Interpretation.⟦</a> <a id="43791" href="lagda.2023-11-21-nbe.html#43708" class="Function">⟦Type⟧</a> <a id="43798" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a> <a id="43800" class="Symbol">(</a><a id="43801" href="lagda.2023-11-21-nbe.html#43801" class="Bound">S</a> <a id="43803" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="43805" href="lagda.2023-11-21-nbe.html#43805" class="Bound">T</a><a id="43806" class="Symbol">)</a> <a id="43808" class="Symbol">=</a> <a id="43810" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="43812" href="lagda.2023-11-21-nbe.html#43801" class="Bound">S</a> <a id="43814" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a> <a id="43816" class="Symbol">→</a> <a id="43818" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="43820" href="lagda.2023-11-21-nbe.html#43805" class="Bound">T</a> <a id="43822" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a>

<a id="env-lookup"></a><a id="43825" href="lagda.2023-11-21-nbe.html#43825" class="Function">env-lookup</a> <a id="43836" class="Symbol">:</a> <a id="43838" class="Symbol">∀</a> <a id="43840" class="Symbol">{</a><a id="43841" href="lagda.2023-11-21-nbe.html#43841" class="Bound">Γ</a> <a id="43843" class="Symbol">:</a> <a id="43845" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="43848" class="Symbol">}</a> <a id="43850" class="Symbol">{</a><a id="43851" href="lagda.2023-11-21-nbe.html#43851" class="Bound">T</a> <a id="43853" class="Symbol">:</a> <a id="43855" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="43859" class="Symbol">}</a> <a id="43861" class="Symbol">→</a> <a id="43863" href="lagda.2023-11-21-nbe.html#43841" class="Bound">Γ</a> <a id="43865" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="43867" href="lagda.2023-11-21-nbe.html#43851" class="Bound">T</a> <a id="43869" class="Symbol">→</a> <a id="43871" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="43873" href="lagda.2023-11-21-nbe.html#43841" class="Bound">Γ</a> <a id="43875" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a> <a id="43877" class="Symbol">→</a> <a id="43879" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="43881" href="lagda.2023-11-21-nbe.html#43851" class="Bound">T</a> <a id="43883" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a>
<a id="43885" href="lagda.2023-11-21-nbe.html#43825" class="Function">env-lookup</a> <a id="43896" class="Symbol">{</a><a id="43897" href="lagda.2023-11-21-nbe.html#43897" class="Bound">Γ</a> <a id="43899" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="43901" href="lagda.2023-11-21-nbe.html#43901" class="Bound">T</a><a id="43902" class="Symbol">}</a> <a id="43904" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>     <a id="43910" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="43912" class="Symbol">_</a> <a id="43914" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="43916" href="lagda.2023-11-21-nbe.html#43916" class="Bound">a</a> <a id="43918" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a> <a id="43920" class="Symbol">=</a> <a id="43922" href="lagda.2023-11-21-nbe.html#43916" class="Bound">a</a>
<a id="43924" href="lagda.2023-11-21-nbe.html#43825" class="Function">env-lookup</a> <a id="43935" class="Symbol">{</a><a id="43936" href="lagda.2023-11-21-nbe.html#43936" class="Bound">Γ</a> <a id="43938" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="43940" href="lagda.2023-11-21-nbe.html#43940" class="Bound">T</a><a id="43941" class="Symbol">}</a> <a id="43943" class="Symbol">(</a><a id="43944" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="43946" href="lagda.2023-11-21-nbe.html#43946" class="Bound">x</a><a id="43947" class="Symbol">)</a> <a id="43949" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="43951" href="lagda.2023-11-21-nbe.html#43951" class="Bound">γ</a> <a id="43953" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="43955" class="Symbol">_</a> <a id="43957" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a> <a id="43959" class="Symbol">=</a> <a id="43961" href="lagda.2023-11-21-nbe.html#43825" class="Function">env-lookup</a> <a id="43972" href="lagda.2023-11-21-nbe.html#43946" class="Bound">x</a> <a id="43974" href="lagda.2023-11-21-nbe.html#43951" class="Bound">γ</a>

<a id="⟦⊢_⟧"></a><a id="43977" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟦⊢_⟧</a> <a id="43982" class="Symbol">:</a> <a id="43984" class="Symbol">∀</a> <a id="43986" class="Symbol">{</a><a id="43987" href="lagda.2023-11-21-nbe.html#43987" class="Bound">Γ</a> <a id="43989" class="Symbol">:</a> <a id="43991" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="43994" class="Symbol">}</a> <a id="43996" class="Symbol">{</a><a id="43997" href="lagda.2023-11-21-nbe.html#43997" class="Bound">T</a> <a id="43999" class="Symbol">:</a> <a id="44001" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="44005" class="Symbol">}</a> <a id="44007" class="Symbol">→</a> <a id="44009" href="lagda.2023-11-21-nbe.html#43987" class="Bound">Γ</a> <a id="44011" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="44013" href="lagda.2023-11-21-nbe.html#43997" class="Bound">T</a> <a id="44015" class="Symbol">→</a> <a id="44017" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="44019" href="lagda.2023-11-21-nbe.html#43987" class="Bound">Γ</a> <a id="44021" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a> <a id="44023" class="Symbol">→</a> <a id="44025" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="44027" href="lagda.2023-11-21-nbe.html#43997" class="Bound">T</a> <a id="44029" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a>
<a id="44031" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟦⊢</a> <a id="44034" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a> <a id="44039" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟧</a> <a id="44041" class="Symbol">_</a>  <a id="44044" class="Symbol">=</a> <a id="44046" href="lagda.2023-11-21-nbe.html#43666" class="InductiveConstructor">unit</a>
<a id="44051" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟦⊢</a> <a id="44054" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="44056" href="lagda.2023-11-21-nbe.html#44056" class="Bound">x</a> <a id="44058" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟧</a> <a id="44060" href="lagda.2023-11-21-nbe.html#44060" class="Bound">γ</a>   <a id="44064" class="Symbol">=</a> <a id="44066" href="lagda.2023-11-21-nbe.html#43825" class="Function">env-lookup</a> <a id="44077" href="lagda.2023-11-21-nbe.html#44056" class="Bound">x</a> <a id="44079" href="lagda.2023-11-21-nbe.html#44060" class="Bound">γ</a>
<a id="44081" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟦⊢</a> <a id="44084" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="44086" href="lagda.2023-11-21-nbe.html#44086" class="Bound">t</a> <a id="44088" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟧</a> <a id="44090" href="lagda.2023-11-21-nbe.html#44090" class="Bound">γ</a> <a id="44092" href="lagda.2023-11-21-nbe.html#44092" class="Bound">a</a> <a id="44094" class="Symbol">=</a> <a id="44096" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟦⊢</a> <a id="44099" href="lagda.2023-11-21-nbe.html#44086" class="Bound">t</a> <a id="44101" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟧</a> <a id="44103" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="44105" href="lagda.2023-11-21-nbe.html#44090" class="Bound">γ</a> <a id="44107" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="44109" href="lagda.2023-11-21-nbe.html#44092" class="Bound">a</a> <a id="44111" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a>
<a id="44113" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟦⊢</a> <a id="44116" href="lagda.2023-11-21-nbe.html#44116" class="Bound">r</a> <a id="44118" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="44120" href="lagda.2023-11-21-nbe.html#44120" class="Bound">s</a> <a id="44122" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟧</a> <a id="44124" href="lagda.2023-11-21-nbe.html#44124" class="Bound">γ</a> <a id="44126" class="Symbol">=</a> <a id="44128" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟦⊢</a> <a id="44131" href="lagda.2023-11-21-nbe.html#44116" class="Bound">r</a> <a id="44133" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟧</a> <a id="44135" href="lagda.2023-11-21-nbe.html#44124" class="Bound">γ</a> <a id="44137" class="Symbol">(</a><a id="44138" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟦⊢</a> <a id="44141" href="lagda.2023-11-21-nbe.html#44120" class="Bound">s</a> <a id="44143" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟧</a>  <a id="44146" href="lagda.2023-11-21-nbe.html#44124" class="Bound">γ</a><a id="44147" class="Symbol">)</a>
</pre>
<p>To reify an Agda expressions of type <code>⊤̂</code>, we will define a function <code>↓⊤̂</code>. It is
here that the fallback to <code>unit</code> happens, when the context that the embedded
liftable neutral is being lifted to results in it being undefined. This case
will be irrelevant and we will prove that it will never actually be used in the
algorithm for normalization by evaluation by proving that the algorithm
preserves the meaning of the original term (such a fallback actually being used
would make this impossible to prove).</p>
<pre class="Agda"><a id="↓⊤̂"></a><a id="44669" href="lagda.2023-11-21-nbe.html#44669" class="Function">↓⊤̂</a> <a id="44673" class="Symbol">:</a> <a id="44675" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="44677" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a> <a id="44679" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a> <a id="44681" class="Symbol">→</a> <a id="44683" href="lagda.2023-11-21-nbe.html#42088" class="Function">Nf^</a> <a id="44687" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a>
<a id="44689" href="lagda.2023-11-21-nbe.html#44669" class="Function">↓⊤̂</a> <a id="44693" href="lagda.2023-11-21-nbe.html#43666" class="InductiveConstructor">unit</a> <a id="44698" class="Symbol">=</a> <a id="44700" href="lagda.2023-11-21-nbe.html#44714" class="Function">unit^</a> <a id="44706" class="Keyword">where</a>
  <a id="44714" href="lagda.2023-11-21-nbe.html#44714" class="Function">unit^</a> <a id="44720" class="Symbol">=</a> <a id="44722" class="Symbol">(λ</a> <a id="44725" href="lagda.2023-11-21-nbe.html#44725" class="Bound">_</a> <a id="44727" class="Symbol">→</a> <a id="44729" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="44731" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a> <a id="44736" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="44738" href="lagda.2023-11-21-nbe.html#39621" class="InductiveConstructor">nf-unit</a> <a id="44746" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a><a id="44747" class="Symbol">)</a>
<a id="44749" href="lagda.2023-11-21-nbe.html#44669" class="Function">↓⊤̂</a> <a id="44753" class="Symbol">(</a><a id="44754" href="lagda.2023-11-21-nbe.html#43678" class="InductiveConstructor">ne</a> <a id="44757" href="lagda.2023-11-21-nbe.html#44757" class="Bound">𝓊̂</a><a id="44759" class="Symbol">)</a> <a id="44761" href="lagda.2023-11-21-nbe.html#44761" class="Bound">Γ</a> <a id="44763" class="Keyword">with</a> <a id="44768" href="lagda.2023-11-21-nbe.html#44757" class="Bound">𝓊̂</a> <a id="44771" href="lagda.2023-11-21-nbe.html#44761" class="Bound">Γ</a>
<a id="44773" class="Symbol">...</a>            <a id="44788" class="Symbol">|</a> <a id="44790" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="44795" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="44797" href="lagda.2023-11-21-nbe.html#44797" class="Bound">𝓊</a> <a id="44799" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="44801" href="lagda.2023-11-21-nbe.html#44801" class="Bound">pf</a> <a id="44804" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a> <a id="44806" class="Symbol">=</a> <a id="44808" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="44810" href="lagda.2023-11-21-nbe.html#44797" class="Bound">𝓊</a> <a id="44812" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="44814" href="lagda.2023-11-21-nbe.html#39799" class="InductiveConstructor">nf-neutral</a> <a id="44825" href="lagda.2023-11-21-nbe.html#44801" class="Bound">pf</a> <a id="44828" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a>
<a id="44830" class="Symbol">...</a>            <a id="44845" class="Symbol">|</a> <a id="44847" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="44852" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>         <a id="44863" class="Symbol">=</a> <a id="44865" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="44867" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a> <a id="44872" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="44874" href="lagda.2023-11-21-nbe.html#39621" class="InductiveConstructor">nf-unit</a> <a id="44882" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a>
</pre>
<p>We are now ready to actually define reflection and reification in Agda. These
are mutually recursive, and will each be defined by induction on the type <code>T</code>.
Their definition is almost the same as the sketch shown in pseudocode, except
that the implicit changing of contexts is now being handled by using liftable
terms instead.</p>
<pre class="Agda">
<a id="45227" class="Keyword">mutual</a>
  <a id="↑ᵀ"></a><a id="45236" href="lagda.2023-11-21-nbe.html#45236" class="Function">↑ᵀ</a> <a id="45239" class="Symbol">:</a> <a id="45241" class="Symbol">{</a><a id="45242" href="lagda.2023-11-21-nbe.html#45242" class="Bound">T</a> <a id="45244" class="Symbol">:</a> <a id="45246" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="45250" class="Symbol">}</a> <a id="45252" class="Symbol">→</a> <a id="45254" href="lagda.2023-11-21-nbe.html#42004" class="Function">Ne^</a> <a id="45258" href="lagda.2023-11-21-nbe.html#45242" class="Bound">T</a> <a id="45260" class="Symbol">→</a> <a id="45262" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="45264" href="lagda.2023-11-21-nbe.html#45242" class="Bound">T</a> <a id="45266" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a>
  <a id="45270" href="lagda.2023-11-21-nbe.html#45236" class="Function">↑ᵀ</a> <a id="45273" class="Symbol">{</a><a id="45274" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a><a id="45275" class="Symbol">}</a> <a id="45277" href="lagda.2023-11-21-nbe.html#45277" class="Bound">𝓊̂</a> <a id="45280" class="Symbol">=</a> <a id="45282" href="lagda.2023-11-21-nbe.html#43678" class="InductiveConstructor">ne</a> <a id="45285" href="lagda.2023-11-21-nbe.html#45277" class="Bound">𝓊̂</a>
  <a id="45290" href="lagda.2023-11-21-nbe.html#45236" class="Function">↑ᵀ</a> <a id="45293" class="Symbol">{</a><a id="45294" href="lagda.2023-11-21-nbe.html#45294" class="Bound">S</a> <a id="45296" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="45298" href="lagda.2023-11-21-nbe.html#45298" class="Bound">T</a><a id="45299" class="Symbol">}</a> <a id="45301" href="lagda.2023-11-21-nbe.html#45301" class="Bound">𝓊̂</a> <a id="45304" href="lagda.2023-11-21-nbe.html#45304" class="Bound">a</a> <a id="45306" class="Symbol">=</a> <a id="45308" href="lagda.2023-11-21-nbe.html#45236" class="Function">↑ᵀ</a> <a id="45311" class="Symbol">(</a><a id="45312" href="lagda.2023-11-21-nbe.html#45301" class="Bound">𝓊̂</a> <a id="45315" href="lagda.2023-11-21-nbe.html#43107" class="Function Operator">·^</a> <a id="45318" href="lagda.2023-11-21-nbe.html#45328" class="Function">𝓋̂</a><a id="45320" class="Symbol">)</a> <a id="45322" class="Keyword">where</a> <a id="45328" href="lagda.2023-11-21-nbe.html#45328" class="Function">𝓋̂</a> <a id="45331" class="Symbol">=</a> <a id="45333" href="lagda.2023-11-21-nbe.html#45341" class="Function">↓ᵀ</a> <a id="45336" href="lagda.2023-11-21-nbe.html#45304" class="Bound">a</a>

  <a id="↓ᵀ"></a><a id="45341" href="lagda.2023-11-21-nbe.html#45341" class="Function">↓ᵀ</a> <a id="45344" class="Symbol">:</a> <a id="45346" class="Symbol">{</a><a id="45347" href="lagda.2023-11-21-nbe.html#45347" class="Bound">T</a> <a id="45349" class="Symbol">:</a> <a id="45351" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="45355" class="Symbol">}</a> <a id="45357" class="Symbol">→</a> <a id="45359" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="45361" href="lagda.2023-11-21-nbe.html#45347" class="Bound">T</a> <a id="45363" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a> <a id="45365" class="Symbol">→</a> <a id="45367" href="lagda.2023-11-21-nbe.html#42088" class="Function">Nf^</a> <a id="45371" href="lagda.2023-11-21-nbe.html#45347" class="Bound">T</a>
  <a id="45375" href="lagda.2023-11-21-nbe.html#45341" class="Function">↓ᵀ</a> <a id="45378" class="Symbol">{</a><a id="45379" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a><a id="45380" class="Symbol">}</a> <a id="45382" class="Symbol">=</a> <a id="45384" href="lagda.2023-11-21-nbe.html#44669" class="Function">↓⊤̂</a>
  <a id="45390" href="lagda.2023-11-21-nbe.html#45341" class="Function">↓ᵀ</a> <a id="45393" class="Symbol">{</a><a id="45394" href="lagda.2023-11-21-nbe.html#45394" class="Bound">S</a> <a id="45396" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="45398" href="lagda.2023-11-21-nbe.html#45398" class="Bound">T</a><a id="45399" class="Symbol">}</a> <a id="45401" href="lagda.2023-11-21-nbe.html#45401" class="Bound">f</a> <a id="45403" href="lagda.2023-11-21-nbe.html#45403" class="Bound">Γ</a> <a id="45405" class="Symbol">=</a>
    <a id="45411" class="Keyword">let</a> <a id="45415" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="45417" href="lagda.2023-11-21-nbe.html#45417" class="Bound">𝓋</a> <a id="45419" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="45421" href="lagda.2023-11-21-nbe.html#45421" class="Bound">pf</a> <a id="45424" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a> <a id="45426" class="Symbol">=</a> <a id="45428" href="lagda.2023-11-21-nbe.html#45341" class="Function">↓ᵀ</a> <a id="45431" class="Symbol">(</a><a id="45432" href="lagda.2023-11-21-nbe.html#45401" class="Bound">f</a> <a id="45434" href="lagda.2023-11-21-nbe.html#45482" class="Function">a</a><a id="45435" class="Symbol">)</a> <a id="45437" class="Symbol">(</a><a id="45438" href="lagda.2023-11-21-nbe.html#45403" class="Bound">Γ</a> <a id="45440" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="45442" href="lagda.2023-11-21-nbe.html#45394" class="Bound">S</a><a id="45443" class="Symbol">)</a> <a id="45445" class="Keyword">in</a>
    <a id="45452" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="45454" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="45456" href="lagda.2023-11-21-nbe.html#45417" class="Bound">𝓋</a> <a id="45458" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="45460" href="lagda.2023-11-21-nbe.html#39660" class="InductiveConstructor">nf-abs</a> <a id="45467" href="lagda.2023-11-21-nbe.html#45421" class="Bound">pf</a> <a id="45470" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a>
    <a id="45476" class="Keyword">where</a> <a id="45482" href="lagda.2023-11-21-nbe.html#45482" class="Function">a</a> <a id="45484" class="Symbol">=</a> <a id="45486" href="lagda.2023-11-21-nbe.html#45236" class="Function">↑ᵀ</a> <a id="45489" class="Symbol">(</a><a id="45490" href="lagda.2023-11-21-nbe.html#46066" class="Function">𝓍̂</a> <a id="45493" href="lagda.2023-11-21-nbe.html#45394" class="Bound">S</a> <a id="45495" href="lagda.2023-11-21-nbe.html#45403" class="Bound">Γ</a><a id="45496" class="Symbol">)</a>
</pre>
<p>Freshness is given to us almost for free as we are using a de Brujin
representation, so a fresh variable would just be the de Brujin index <code>𝑍</code>. This
variable will be used in a different context from the one in which it was
created, so it will need to be renamed.</p>
<p>For this purpose we use <code>𝓍̂ S Γ</code>, a liftable variable of type <code>S</code> that can only
be lifted to extensions of the context <code>Γ, x:S</code>. When lifted to an extension
<code>Γ′</code> of <code>Γ, x:S</code> we apply the extension renaming to the de Brujin index <code>𝑍</code> to
obtain its corresponding index in the extended context.</p>
<pre class="Agda">  <a id="𝓍̂"></a><a id="46066" href="lagda.2023-11-21-nbe.html#46066" class="Function">𝓍̂</a> <a id="46069" class="Symbol">:</a> <a id="46071" class="Symbol">(</a><a id="46072" href="lagda.2023-11-21-nbe.html#46072" class="Bound">S</a> <a id="46074" class="Symbol">:</a> <a id="46076" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="46080" class="Symbol">)</a> <a id="46082" class="Symbol">→</a> <a id="46084" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a> <a id="46088" class="Symbol">→</a> <a id="46090" href="lagda.2023-11-21-nbe.html#42004" class="Function">Ne^</a> <a id="46094" href="lagda.2023-11-21-nbe.html#46072" class="Bound">S</a>
  <a id="46098" href="lagda.2023-11-21-nbe.html#46066" class="Function">𝓍̂</a> <a id="46101" href="lagda.2023-11-21-nbe.html#46101" class="Bound">S</a> <a id="46103" href="lagda.2023-11-21-nbe.html#46103" class="Bound">Γ</a> <a id="46105" href="lagda.2023-11-21-nbe.html#46105" class="Bound">Γ′</a>
    <a id="46112" class="Keyword">with</a> <a id="46117" href="lagda.2023-11-21-nbe.html#46105" class="Bound">Γ′</a> <a id="46120" href="lagda.2023-11-21-nbe.html#10889" class="Function Operator">≤?</a> <a id="46123" class="Symbol">(</a><a id="46124" href="lagda.2023-11-21-nbe.html#46103" class="Bound">Γ</a> <a id="46126" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="46128" href="lagda.2023-11-21-nbe.html#46101" class="Bound">S</a><a id="46129" class="Symbol">)</a>
  <a id="46133" class="Symbol">...</a>  <a id="46138" class="Symbol">|</a> <a id="46140" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="46143" class="Symbol">_</a>          <a id="46154" class="Symbol">=</a> <a id="46156" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="46161" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>
  <a id="46166" class="Symbol">...</a>  <a id="46171" class="Symbol">|</a> <a id="46173" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="46177" href="lagda.2023-11-21-nbe.html#46177" class="Bound">pf</a>        <a id="46187" class="Symbol">=</a> <a id="46189" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="46194" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="46196" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="46198" href="lagda.2023-11-21-nbe.html#46219" class="Function">x</a> <a id="46200" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="46202" href="lagda.2023-11-21-nbe.html#39207" class="InductiveConstructor">ne-var</a> <a id="46209" href="lagda.2023-11-21-nbe.html#46219" class="Function">x</a> <a id="46211" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a> <a id="46213" class="Keyword">where</a> <a id="46219" href="lagda.2023-11-21-nbe.html#46219" class="Function">x</a> <a id="46221" class="Symbol">=</a> <a id="46223" href="lagda.2023-11-21-nbe.html#13819" class="Function">ρ-≤</a> <a id="46227" href="lagda.2023-11-21-nbe.html#46177" class="Bound">pf</a> <a id="46230" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>
</pre>
<p>We can also define the reflection of a context <code>Γ</code> into an environment, which
will be the reflected environment over which a typed term in the context <code>Γ</code>
will be evaluated.</p>
<pre class="Agda"><a id="↑ᶜᵗˣ"></a><a id="46420" href="lagda.2023-11-21-nbe.html#46420" class="Function">↑ᶜᵗˣ</a> <a id="46425" class="Symbol">:</a> <a id="46427" class="Symbol">∀</a> <a id="46429" class="Symbol">(</a><a id="46430" href="lagda.2023-11-21-nbe.html#46430" class="Bound">Γ</a> <a id="46432" class="Symbol">:</a> <a id="46434" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="46437" class="Symbol">)</a> <a id="46439" class="Symbol">→</a> <a id="46441" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="46443" href="lagda.2023-11-21-nbe.html#46430" class="Bound">Γ</a> <a id="46445" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a>
<a id="46447" href="lagda.2023-11-21-nbe.html#46420" class="Function">↑ᶜᵗˣ</a> <a id="46452" href="lagda.2023-11-21-nbe.html#3944" class="InductiveConstructor">∅</a>       <a id="46460" class="Symbol">=</a> <a id="46462" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>
<a id="46465" href="lagda.2023-11-21-nbe.html#46420" class="Function">↑ᶜᵗˣ</a> <a id="46470" class="Symbol">(</a><a id="46471" href="lagda.2023-11-21-nbe.html#46471" class="Bound">Γ</a> <a id="46473" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="46475" href="lagda.2023-11-21-nbe.html#46475" class="Bound">T</a><a id="46476" class="Symbol">)</a> <a id="46478" class="Symbol">=</a> <a id="46480" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="46482" href="lagda.2023-11-21-nbe.html#46420" class="Function">↑ᶜᵗˣ</a> <a id="46487" href="lagda.2023-11-21-nbe.html#46471" class="Bound">Γ</a>  <a id="46490" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="46492" href="lagda.2023-11-21-nbe.html#45236" class="Function">↑ᵀ</a> <a id="46495" class="Symbol">(</a><a id="46496" href="lagda.2023-11-21-nbe.html#46066" class="Function">𝓍̂</a> <a id="46499" href="lagda.2023-11-21-nbe.html#46475" class="Bound">T</a> <a id="46501" href="lagda.2023-11-21-nbe.html#46471" class="Bound">Γ</a><a id="46502" class="Symbol">)</a> <a id="46504" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a>
</pre>
<p>Finally, the algorithm for normalization by evaluation can be written in Agda.
Its definition is again almost exactly the same as the sketch in pseudocode,
except that we now lift the reified normal term to the original context <code>Γ</code>.</p>
<pre class="Agda"><a id="nbe"></a><a id="46753" href="lagda.2023-11-21-nbe.html#46753" class="Function">nbe</a> <a id="46757" class="Symbol">:</a> <a id="46759" class="Symbol">∀</a> <a id="46761" class="Symbol">{</a><a id="46762" href="lagda.2023-11-21-nbe.html#46762" class="Bound">Γ</a> <a id="46764" class="Symbol">:</a> <a id="46766" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="46769" class="Symbol">}</a> <a id="46771" class="Symbol">{</a><a id="46772" href="lagda.2023-11-21-nbe.html#46772" class="Bound">T</a> <a id="46774" class="Symbol">:</a> <a id="46776" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="46780" class="Symbol">}</a> <a id="46782" class="Symbol">→</a> <a id="46784" href="lagda.2023-11-21-nbe.html#46762" class="Bound">Γ</a> <a id="46786" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="46788" href="lagda.2023-11-21-nbe.html#46772" class="Bound">T</a> <a id="46790" class="Symbol">→</a> <a id="46792" href="Data.Product.html#1806" class="Function">∃[</a> <a id="46795" href="lagda.2023-11-21-nbe.html#46795" class="Bound">t</a> <a id="46797" href="Data.Product.html#1806" class="Function">]</a> <a id="46799" href="lagda.2023-11-21-nbe.html#36531" class="Datatype">Nf</a> <a id="46802" href="lagda.2023-11-21-nbe.html#46772" class="Bound">T</a> <a id="46804" href="lagda.2023-11-21-nbe.html#46762" class="Bound">Γ</a> <a id="46806" href="lagda.2023-11-21-nbe.html#46795" class="Bound">t</a>
<a id="46808" href="lagda.2023-11-21-nbe.html#46753" class="Function">nbe</a> <a id="46812" class="Symbol">{</a><a id="46813" href="lagda.2023-11-21-nbe.html#46813" class="Bound">Γ</a><a id="46814" class="Symbol">}</a> <a id="46816" href="lagda.2023-11-21-nbe.html#46816" class="Bound">t</a> <a id="46818" class="Symbol">=</a> <a id="46820" href="lagda.2023-11-21-nbe.html#45341" class="Function">↓ᵀ</a> <a id="46823" class="Symbol">(</a><a id="46824" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟦⊢</a> <a id="46827" href="lagda.2023-11-21-nbe.html#46816" class="Bound">t</a> <a id="46829" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟧</a> <a id="46831" class="Symbol">(</a><a id="46832" href="lagda.2023-11-21-nbe.html#46420" class="Function">↑ᶜᵗˣ</a> <a id="46837" href="lagda.2023-11-21-nbe.html#46813" class="Bound">Γ</a><a id="46838" class="Symbol">))</a> <a id="46841" href="lagda.2023-11-21-nbe.html#46813" class="Bound">Γ</a>

<a id="nf"></a><a id="46844" href="lagda.2023-11-21-nbe.html#46844" class="Function">nf</a> <a id="46847" class="Symbol">:</a> <a id="46849" class="Symbol">∀</a> <a id="46851" class="Symbol">{</a><a id="46852" href="lagda.2023-11-21-nbe.html#46852" class="Bound">Γ</a> <a id="46854" class="Symbol">:</a> <a id="46856" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="46859" class="Symbol">}</a> <a id="46861" class="Symbol">{</a><a id="46862" href="lagda.2023-11-21-nbe.html#46862" class="Bound">T</a> <a id="46864" class="Symbol">:</a> <a id="46866" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="46870" class="Symbol">}</a> <a id="46872" class="Symbol">→</a> <a id="46874" href="lagda.2023-11-21-nbe.html#46852" class="Bound">Γ</a> <a id="46876" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="46878" href="lagda.2023-11-21-nbe.html#46862" class="Bound">T</a> <a id="46880" class="Symbol">→</a> <a id="46882" href="lagda.2023-11-21-nbe.html#46852" class="Bound">Γ</a> <a id="46884" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="46886" href="lagda.2023-11-21-nbe.html#46862" class="Bound">T</a>
<a id="46888" href="lagda.2023-11-21-nbe.html#46844" class="Function">nf</a> <a id="46891" href="lagda.2023-11-21-nbe.html#46891" class="Bound">t</a> <a id="46893" class="Symbol">=</a> <a id="46895" class="Keyword">let</a> <a id="46899" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="46901" href="lagda.2023-11-21-nbe.html#46901" class="Bound">t′</a> <a id="46904" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="46906" class="Symbol">_</a> <a id="46908" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a> <a id="46910" class="Symbol">=</a> <a id="46912" href="lagda.2023-11-21-nbe.html#46753" class="Function">nbe</a> <a id="46916" href="lagda.2023-11-21-nbe.html#46891" class="Bound">t</a> <a id="46918" class="Keyword">in</a> <a id="46921" href="lagda.2023-11-21-nbe.html#46901" class="Bound">t′</a>
</pre>
<p>And here is an example of the algorithm in action:</p>
<pre class="Agda"><a id="46989" class="Keyword">module</a> <a id="AlgorithmExample"></a><a id="46996" href="lagda.2023-11-21-nbe.html#46996" class="Module">AlgorithmExample</a> <a id="47013" class="Keyword">where</a>
  <a id="47021" class="Comment">-- (λx. (λy. y) x) unit</a>
  <a id="AlgorithmExample.ex"></a><a id="47047" href="lagda.2023-11-21-nbe.html#47047" class="Function">ex</a> <a id="47050" class="Symbol">:</a> <a id="47052" href="lagda.2023-11-21-nbe.html#3944" class="InductiveConstructor">∅</a> <a id="47054" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="47056" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a>
  <a id="47060" href="lagda.2023-11-21-nbe.html#47047" class="Function">ex</a> <a id="47063" class="Symbol">=</a> <a id="47065" class="Symbol">(</a><a id="47066" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="47068" class="Symbol">(</a><a id="47069" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="47071" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="47073" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a><a id="47074" class="Symbol">)</a> <a id="47076" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="47078" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="47080" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a><a id="47081" class="Symbol">)</a> <a id="47083" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="47085" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a>

  <a id="47093" class="Comment">-- normal form is unit</a>
  <a id="AlgorithmExample.nf-ex"></a><a id="47118" href="lagda.2023-11-21-nbe.html#47118" class="Function">nf-ex</a> <a id="47124" class="Symbol">:</a> <a id="47126" href="lagda.2023-11-21-nbe.html#46844" class="Function">nf</a> <a id="47129" href="lagda.2023-11-21-nbe.html#47047" class="Function">ex</a> <a id="47132" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="47134" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a>
  <a id="47141" href="lagda.2023-11-21-nbe.html#47118" class="Function">nf-ex</a> <a id="47147" class="Keyword">with</a> <a id="47152" href="lagda.2023-11-21-nbe.html#47047" class="Function">ex</a>
  <a id="47157" href="lagda.2023-11-21-nbe.html#47118" class="Function">...</a>      <a id="47166" class="Symbol">|</a> <a id="47168" class="Symbol">_</a>  <a id="47171" class="Symbol">=</a> <a id="47173" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
</pre>
<h3 id="correctness">Correctness</h3>
<p>We wish for our algorithm for normalization by evaluation to be both complete
and sound. First, we need to prove the property that if two terms are
definitionally equal, then they must have the same interpretation. This proof
is omitted in the rendering as well ─ it is an adaptation of the proof of
soundness of reduction with respect to denotational semantics in PLFA seen
in <a href="https://plfa.github.io/Soundness/">this</a> chapter.</p>
<!---

A renaming `Γ ⊢ ρ : Δ` relates an environment `γ ∈ ⟦ Γ ⟧` to an environment
`δ ∈ ⟦ Δ ⟧` iff the semantic object in `γ` for `ρ x` is equivalent to the
semantic object in `δ` for `x` for any variable `x` in the context `Δ`:

    γ ⊩ ρ ~ δ ⇔ ∀ x. ⟦ Γ ∋ (ρ x):T ⟧ γ ≡ ⟦ Δ ∋ x:T ⟧ δ

<pre class="Agda"><a id="_⊩ʳ_~_"></a><a id="47924" href="lagda.2023-11-21-nbe.html#47924" class="Function Operator">_⊩ʳ_~_</a> <a id="47931" class="Symbol">:</a> <a id="47933" class="Symbol">∀</a> <a id="47935" class="Symbol">{</a><a id="47936" href="lagda.2023-11-21-nbe.html#47936" class="Bound">Γ</a> <a id="47938" href="lagda.2023-11-21-nbe.html#47938" class="Bound">Δ</a> <a id="47940" class="Symbol">:</a> <a id="47942" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="47945" class="Symbol">}</a> <a id="47947" class="Symbol">→</a> <a id="47949" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="47951" href="lagda.2023-11-21-nbe.html#47936" class="Bound">Γ</a> <a id="47953" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a> <a id="47955" class="Symbol">→</a> <a id="47957" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="47961" href="lagda.2023-11-21-nbe.html#47936" class="Bound">Γ</a> <a id="47963" href="lagda.2023-11-21-nbe.html#47938" class="Bound">Δ</a> <a id="47965" class="Symbol">→</a> <a id="47967" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="47969" href="lagda.2023-11-21-nbe.html#47938" class="Bound">Δ</a> <a id="47971" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a> <a id="47973" class="Symbol">→</a> <a id="47975" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="47979" href="lagda.2023-11-21-nbe.html#47924" class="Function Operator">_⊩ʳ_~_</a> <a id="47986" class="Symbol">{</a><a id="47987" class="Argument">Δ</a> <a id="47989" class="Symbol">=</a> <a id="47991" href="lagda.2023-11-21-nbe.html#47991" class="Bound">Δ</a><a id="47992" class="Symbol">}</a> <a id="47994" href="lagda.2023-11-21-nbe.html#47994" class="Bound">γ</a> <a id="47996" href="lagda.2023-11-21-nbe.html#47996" class="Bound">ρ</a> <a id="47998" href="lagda.2023-11-21-nbe.html#47998" class="Bound">δ</a> <a id="48000" class="Symbol">=</a>
  <a id="48004" class="Symbol">∀</a> <a id="48006" class="Symbol">{</a><a id="48007" href="lagda.2023-11-21-nbe.html#48007" class="Bound">T</a> <a id="48009" class="Symbol">:</a> <a id="48011" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="48015" class="Symbol">}</a> <a id="48017" class="Symbol">(</a><a id="48018" href="lagda.2023-11-21-nbe.html#48018" class="Bound">x</a> <a id="48020" class="Symbol">:</a> <a id="48022" href="lagda.2023-11-21-nbe.html#47991" class="Bound">Δ</a> <a id="48024" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="48026" href="lagda.2023-11-21-nbe.html#48007" class="Bound">T</a><a id="48027" class="Symbol">)</a> <a id="48029" class="Symbol">→</a> <a id="48031" href="lagda.2023-11-21-nbe.html#43825" class="Function">env-lookup</a> <a id="48042" class="Symbol">(</a><a id="48043" href="lagda.2023-11-21-nbe.html#47996" class="Bound">ρ</a> <a id="48045" href="lagda.2023-11-21-nbe.html#48018" class="Bound">x</a><a id="48046" class="Symbol">)</a> <a id="48048" href="lagda.2023-11-21-nbe.html#47994" class="Bound">γ</a> <a id="48050" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="48052" href="lagda.2023-11-21-nbe.html#43825" class="Function">env-lookup</a> <a id="48063" href="lagda.2023-11-21-nbe.html#48018" class="Bound">x</a> <a id="48065" href="lagda.2023-11-21-nbe.html#47998" class="Bound">δ</a>
</pre>
Any renaming that satisfies this relation preserves meaning between
environments.

<pre class="Agda"><a id="rename-preserves-meaning"></a><a id="48163" href="lagda.2023-11-21-nbe.html#48163" class="Function">rename-preserves-meaning</a> <a id="48188" class="Symbol">:</a> <a id="48190" class="Symbol">∀</a> <a id="48192" class="Symbol">{</a><a id="48193" href="lagda.2023-11-21-nbe.html#48193" class="Bound">Γ</a> <a id="48195" href="lagda.2023-11-21-nbe.html#48195" class="Bound">Δ</a> <a id="48197" class="Symbol">:</a> <a id="48199" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="48202" class="Symbol">}</a> <a id="48204" class="Symbol">{</a><a id="48205" href="lagda.2023-11-21-nbe.html#48205" class="Bound">T</a> <a id="48207" class="Symbol">:</a> <a id="48209" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="48213" class="Symbol">}</a> <a id="48215" class="Symbol">{</a><a id="48216" href="lagda.2023-11-21-nbe.html#48216" class="Bound">γ</a> <a id="48218" class="Symbol">:</a> <a id="48220" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="48222" href="lagda.2023-11-21-nbe.html#48193" class="Bound">Γ</a> <a id="48224" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a><a id="48225" class="Symbol">}</a> <a id="48227" class="Symbol">{</a><a id="48228" href="lagda.2023-11-21-nbe.html#48228" class="Bound">δ</a> <a id="48230" class="Symbol">:</a> <a id="48232" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="48234" href="lagda.2023-11-21-nbe.html#48195" class="Bound">Δ</a> <a id="48236" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a><a id="48237" class="Symbol">}</a>
                             <a id="48268" class="Symbol">{</a><a id="48269" href="lagda.2023-11-21-nbe.html#48269" class="Bound">t</a> <a id="48271" class="Symbol">:</a> <a id="48273" href="lagda.2023-11-21-nbe.html#48195" class="Bound">Δ</a> <a id="48275" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="48277" href="lagda.2023-11-21-nbe.html#48205" class="Bound">T</a><a id="48278" class="Symbol">}</a> <a id="48280" class="Symbol">{</a><a id="48281" href="lagda.2023-11-21-nbe.html#48281" class="Bound">ρ</a> <a id="48283" class="Symbol">:</a> <a id="48285" href="lagda.2023-11-21-nbe.html#12625" class="Function">Ren</a> <a id="48289" href="lagda.2023-11-21-nbe.html#48193" class="Bound">Γ</a> <a id="48291" href="lagda.2023-11-21-nbe.html#48195" class="Bound">Δ</a><a id="48292" class="Symbol">}</a>
                         <a id="48319" class="Symbol">→</a> <a id="48321" href="lagda.2023-11-21-nbe.html#48216" class="Bound">γ</a> <a id="48323" href="lagda.2023-11-21-nbe.html#47924" class="Function Operator">⊩ʳ</a> <a id="48326" href="lagda.2023-11-21-nbe.html#48281" class="Bound">ρ</a> <a id="48328" href="lagda.2023-11-21-nbe.html#47924" class="Function Operator">~</a> <a id="48330" href="lagda.2023-11-21-nbe.html#48228" class="Bound">δ</a>
                         <a id="48357" class="Symbol">→</a> <a id="48359" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟦⊢</a> <a id="48362" href="lagda.2023-11-21-nbe.html#48269" class="Bound">t</a> <a id="48364" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">[</a> <a id="48366" href="lagda.2023-11-21-nbe.html#48281" class="Bound">ρ</a> <a id="48368" href="lagda.2023-11-21-nbe.html#14437" class="Function Operator">]ʳ</a> <a id="48371" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟧</a> <a id="48373" href="lagda.2023-11-21-nbe.html#48216" class="Bound">γ</a> <a id="48375" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="48377" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟦⊢</a> <a id="48380" href="lagda.2023-11-21-nbe.html#48269" class="Bound">t</a> <a id="48382" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟧</a> <a id="48384" href="lagda.2023-11-21-nbe.html#48228" class="Bound">δ</a>
<a id="48386" href="lagda.2023-11-21-nbe.html#48163" class="Function">rename-preserves-meaning</a> <a id="48411" class="Symbol">{</a><a id="48412" class="Argument">t</a> <a id="48414" class="Symbol">=</a> <a id="48416" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a><a id="48420" class="Symbol">}</a> <a id="48422" href="lagda.2023-11-21-nbe.html#48422" class="Bound">pf</a> <a id="48425" class="Symbol">=</a> <a id="48427" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="48432" href="lagda.2023-11-21-nbe.html#48163" class="Function">rename-preserves-meaning</a> <a id="48457" class="Symbol">{</a><a id="48458" class="Argument">t</a> <a id="48460" class="Symbol">=</a> <a id="48462" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="48464" href="lagda.2023-11-21-nbe.html#48464" class="Bound">x</a><a id="48465" class="Symbol">}</a> <a id="48467" href="lagda.2023-11-21-nbe.html#48467" class="Bound">pf</a> <a id="48470" class="Symbol">=</a> <a id="48472" href="lagda.2023-11-21-nbe.html#48467" class="Bound">pf</a> <a id="48475" href="lagda.2023-11-21-nbe.html#48464" class="Bound">x</a>
<a id="48477" href="lagda.2023-11-21-nbe.html#48163" class="Function">rename-preserves-meaning</a> <a id="48502" class="Symbol">{</a><a id="48503" class="Argument">Δ</a> <a id="48505" class="Symbol">=</a> <a id="48507" href="lagda.2023-11-21-nbe.html#48507" class="Bound">Δ</a><a id="48508" class="Symbol">}</a> <a id="48510" class="Symbol">{</a><a id="48511" href="lagda.2023-11-21-nbe.html#48511" class="Bound">S</a> <a id="48513" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="48515" class="Symbol">_}</a> <a id="48518" class="Symbol">{</a><a id="48519" href="lagda.2023-11-21-nbe.html#48519" class="Bound">γ</a><a id="48520" class="Symbol">}</a> <a id="48522" class="Symbol">{</a><a id="48523" href="lagda.2023-11-21-nbe.html#48523" class="Bound">δ</a><a id="48524" class="Symbol">}</a> <a id="48526" class="Symbol">{</a><a id="48527" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="48529" href="lagda.2023-11-21-nbe.html#48529" class="Bound">t</a><a id="48530" class="Symbol">}</a> <a id="48532" class="Symbol">{</a><a id="48533" href="lagda.2023-11-21-nbe.html#48533" class="Bound">ρ</a><a id="48534" class="Symbol">}</a> <a id="48536" href="lagda.2023-11-21-nbe.html#48536" class="Bound">pf</a> <a id="48539" class="Symbol">=</a>
  <a id="48543" href="lagda.2023-11-21-nbe.html#2744" class="Postulate">extensionality</a> <a id="48558" class="Symbol">λ{</a><a id="48560" href="lagda.2023-11-21-nbe.html#48560" class="Bound">a</a> <a id="48562" class="Symbol">→</a> <a id="48564" href="lagda.2023-11-21-nbe.html#48163" class="Function">rename-preserves-meaning</a> <a id="48589" class="Symbol">{</a><a id="48590" class="Argument">t</a> <a id="48592" class="Symbol">=</a> <a id="48594" href="lagda.2023-11-21-nbe.html#48529" class="Bound">t</a><a id="48595" class="Symbol">}</a> <a id="48597" class="Symbol">{</a><a id="48598" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="48602" href="lagda.2023-11-21-nbe.html#48533" class="Bound">ρ</a><a id="48603" class="Symbol">}</a> <a id="48605" class="Symbol">(</a><a id="48606" href="lagda.2023-11-21-nbe.html#48630" class="Function">lemma</a> <a id="48612" class="Symbol">{</a><a id="48613" href="lagda.2023-11-21-nbe.html#48560" class="Bound">a</a><a id="48614" class="Symbol">})}</a>
  <a id="48620" class="Keyword">where</a>
    <a id="48630" href="lagda.2023-11-21-nbe.html#48630" class="Function">lemma</a> <a id="48636" class="Symbol">:</a> <a id="48638" class="Symbol">∀</a> <a id="48640" class="Symbol">{</a><a id="48641" href="lagda.2023-11-21-nbe.html#48641" class="Bound">a</a> <a id="48643" class="Symbol">:</a> <a id="48645" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="48647" href="lagda.2023-11-21-nbe.html#48511" class="Bound">S</a> <a id="48649" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a><a id="48650" class="Symbol">}</a> <a id="48652" class="Symbol">{</a><a id="48653" href="lagda.2023-11-21-nbe.html#48653" class="Bound">T</a> <a id="48655" class="Symbol">:</a> <a id="48657" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="48661" class="Symbol">}</a> <a id="48663" class="Symbol">(</a><a id="48664" href="lagda.2023-11-21-nbe.html#48664" class="Bound">x</a> <a id="48666" class="Symbol">:</a> <a id="48668" href="lagda.2023-11-21-nbe.html#48507" class="Bound">Δ</a> <a id="48670" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="48672" href="lagda.2023-11-21-nbe.html#48511" class="Bound">S</a> <a id="48674" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="48676" href="lagda.2023-11-21-nbe.html#48653" class="Bound">T</a><a id="48677" class="Symbol">)</a>
          <a id="48689" class="Symbol">→</a> <a id="48691" href="lagda.2023-11-21-nbe.html#43825" class="Function">env-lookup</a> <a id="48702" class="Symbol">(</a><a id="48703" href="lagda.2023-11-21-nbe.html#14333" class="Function">ext</a> <a id="48707" href="lagda.2023-11-21-nbe.html#48533" class="Bound">ρ</a> <a id="48709" href="lagda.2023-11-21-nbe.html#48664" class="Bound">x</a><a id="48710" class="Symbol">)</a> <a id="48712" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="48714" href="lagda.2023-11-21-nbe.html#48519" class="Bound">γ</a> <a id="48716" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="48718" href="lagda.2023-11-21-nbe.html#48641" class="Bound">a</a> <a id="48720" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a> <a id="48722" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="48724" href="lagda.2023-11-21-nbe.html#43825" class="Function">env-lookup</a> <a id="48735" href="lagda.2023-11-21-nbe.html#48664" class="Bound">x</a> <a id="48737" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="48739" href="lagda.2023-11-21-nbe.html#48523" class="Bound">δ</a> <a id="48741" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="48743" href="lagda.2023-11-21-nbe.html#48641" class="Bound">a</a> <a id="48745" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a>
    <a id="48751" href="lagda.2023-11-21-nbe.html#48630" class="Function">lemma</a> <a id="48757" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>     <a id="48763" class="Symbol">=</a> <a id="48765" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
    <a id="48774" href="lagda.2023-11-21-nbe.html#48630" class="Function">lemma</a> <a id="48780" class="Symbol">(</a><a id="48781" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="48783" href="lagda.2023-11-21-nbe.html#48783" class="Bound">x</a><a id="48784" class="Symbol">)</a> <a id="48786" class="Symbol">=</a> <a id="48788" href="lagda.2023-11-21-nbe.html#48536" class="Bound">pf</a> <a id="48791" href="lagda.2023-11-21-nbe.html#48783" class="Bound">x</a>
<a id="48793" href="lagda.2023-11-21-nbe.html#48163" class="Function">rename-preserves-meaning</a> <a id="48818" class="Symbol">{</a><a id="48819" class="Argument">t</a> <a id="48821" class="Symbol">=</a> <a id="48823" href="lagda.2023-11-21-nbe.html#48823" class="Bound">r</a> <a id="48825" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="48827" href="lagda.2023-11-21-nbe.html#48827" class="Bound">s</a><a id="48828" class="Symbol">}</a> <a id="48830" class="Symbol">{</a><a id="48831" href="lagda.2023-11-21-nbe.html#48831" class="Bound">ρ</a><a id="48832" class="Symbol">}</a> <a id="48834" href="lagda.2023-11-21-nbe.html#48834" class="Bound">pf</a>
  <a id="48839" class="Keyword">rewrite</a> <a id="48847" href="lagda.2023-11-21-nbe.html#48163" class="Function">rename-preserves-meaning</a> <a id="48872" class="Symbol">{</a><a id="48873" class="Argument">t</a> <a id="48875" class="Symbol">=</a> <a id="48877" href="lagda.2023-11-21-nbe.html#48823" class="Bound">r</a><a id="48878" class="Symbol">}</a> <a id="48880" class="Symbol">{</a><a id="48881" href="lagda.2023-11-21-nbe.html#48831" class="Bound">ρ</a><a id="48882" class="Symbol">}</a> <a id="48884" href="lagda.2023-11-21-nbe.html#48834" class="Bound">pf</a>
        <a id="48895" class="Symbol">|</a> <a id="48897" href="lagda.2023-11-21-nbe.html#48163" class="Function">rename-preserves-meaning</a> <a id="48922" class="Symbol">{</a><a id="48923" class="Argument">t</a> <a id="48925" class="Symbol">=</a> <a id="48927" href="lagda.2023-11-21-nbe.html#48827" class="Bound">s</a><a id="48928" class="Symbol">}</a> <a id="48930" class="Symbol">{</a><a id="48931" href="lagda.2023-11-21-nbe.html#48831" class="Bound">ρ</a><a id="48932" class="Symbol">}</a> <a id="48934" href="lagda.2023-11-21-nbe.html#48834" class="Bound">pf</a> <a id="48937" class="Symbol">=</a> <a id="48939" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
</pre>
A substitution `Γ ⊢ σ : Δ` relates an environment `γ ∈ ⟦ Γ ⟧` to an environment
`δ ∈ ⟦ Δ ⟧` iff for every variable `x` in the context `Δ`, the evaluation of
`σ x` under the environment `γ` is equivalent to the semantic object in `δ`
corresponding to the variable `x`:

    γ ⊩ σ ~ δ ⇔ ∀ x. ⟦⊢ σ x ⟧ γ ≡ ⟦⊢ Δ ∋ x:T ⟧ δ

<pre class="Agda"><a id="_⊩_~_"></a><a id="49276" href="lagda.2023-11-21-nbe.html#49276" class="Function Operator">_⊩_~_</a> <a id="49282" class="Symbol">:</a> <a id="49284" class="Symbol">∀</a> <a id="49286" class="Symbol">{</a><a id="49287" href="lagda.2023-11-21-nbe.html#49287" class="Bound">Γ</a> <a id="49289" href="lagda.2023-11-21-nbe.html#49289" class="Bound">Δ</a> <a id="49291" class="Symbol">:</a> <a id="49293" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="49296" class="Symbol">}</a> <a id="49298" class="Symbol">→</a> <a id="49300" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="49302" href="lagda.2023-11-21-nbe.html#49287" class="Bound">Γ</a> <a id="49304" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a> <a id="49306" class="Symbol">→</a> <a id="49308" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="49312" href="lagda.2023-11-21-nbe.html#49287" class="Bound">Γ</a> <a id="49314" href="lagda.2023-11-21-nbe.html#49289" class="Bound">Δ</a> <a id="49316" class="Symbol">→</a> <a id="49318" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="49320" href="lagda.2023-11-21-nbe.html#49289" class="Bound">Δ</a> <a id="49322" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a> <a id="49324" class="Symbol">→</a> <a id="49326" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="49330" href="lagda.2023-11-21-nbe.html#49276" class="Function Operator">_⊩_~_</a> <a id="49336" class="Symbol">{</a><a id="49337" class="Argument">Δ</a> <a id="49339" class="Symbol">=</a> <a id="49341" href="lagda.2023-11-21-nbe.html#49341" class="Bound">Δ</a><a id="49342" class="Symbol">}</a> <a id="49344" href="lagda.2023-11-21-nbe.html#49344" class="Bound">γ</a> <a id="49346" href="lagda.2023-11-21-nbe.html#49346" class="Bound">σ</a> <a id="49348" href="lagda.2023-11-21-nbe.html#49348" class="Bound">δ</a> <a id="49350" class="Symbol">=</a> <a id="49352" class="Symbol">∀</a> <a id="49354" class="Symbol">{</a><a id="49355" href="lagda.2023-11-21-nbe.html#49355" class="Bound">T</a> <a id="49357" class="Symbol">:</a> <a id="49359" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="49363" class="Symbol">}</a> <a id="49365" class="Symbol">(</a><a id="49366" href="lagda.2023-11-21-nbe.html#49366" class="Bound">x</a> <a id="49368" class="Symbol">:</a> <a id="49370" href="lagda.2023-11-21-nbe.html#49341" class="Bound">Δ</a> <a id="49372" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="49374" href="lagda.2023-11-21-nbe.html#49355" class="Bound">T</a><a id="49375" class="Symbol">)</a> <a id="49377" class="Symbol">→</a> <a id="49379" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟦⊢</a> <a id="49382" href="lagda.2023-11-21-nbe.html#49346" class="Bound">σ</a> <a id="49384" href="lagda.2023-11-21-nbe.html#49366" class="Bound">x</a> <a id="49386" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟧</a> <a id="49388" href="lagda.2023-11-21-nbe.html#49344" class="Bound">γ</a> <a id="49390" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="49392" href="lagda.2023-11-21-nbe.html#43825" class="Function">env-lookup</a> <a id="49403" href="lagda.2023-11-21-nbe.html#49366" class="Bound">x</a> <a id="49405" href="lagda.2023-11-21-nbe.html#49348" class="Bound">δ</a>
</pre>
This relation allows for proving that substitutions preserve meaning, using a
lemma that the relation is closed under substitution extension.

<pre class="Agda"><a id="subst-exts"></a><a id="49563" href="lagda.2023-11-21-nbe.html#49563" class="Function">subst-exts</a> <a id="49574" class="Symbol">:</a> <a id="49576" class="Symbol">∀</a> <a id="49578" class="Symbol">{</a><a id="49579" href="lagda.2023-11-21-nbe.html#49579" class="Bound">Γ</a> <a id="49581" href="lagda.2023-11-21-nbe.html#49581" class="Bound">Δ</a> <a id="49583" class="Symbol">:</a> <a id="49585" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="49588" class="Symbol">}</a> <a id="49590" class="Symbol">{</a><a id="49591" href="lagda.2023-11-21-nbe.html#49591" class="Bound">S</a> <a id="49593" class="Symbol">:</a> <a id="49595" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="49599" class="Symbol">}</a> <a id="49601" class="Symbol">{</a><a id="49602" href="lagda.2023-11-21-nbe.html#49602" class="Bound">γ</a> <a id="49604" class="Symbol">:</a> <a id="49606" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="49608" href="lagda.2023-11-21-nbe.html#49579" class="Bound">Γ</a> <a id="49610" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a><a id="49611" class="Symbol">}</a> <a id="49613" class="Symbol">{</a><a id="49614" href="lagda.2023-11-21-nbe.html#49614" class="Bound">a</a> <a id="49616" class="Symbol">:</a> <a id="49618" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="49620" href="lagda.2023-11-21-nbe.html#49591" class="Bound">S</a> <a id="49622" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a><a id="49623" class="Symbol">}</a> <a id="49625" class="Symbol">{</a><a id="49626" href="lagda.2023-11-21-nbe.html#49626" class="Bound">σ</a> <a id="49628" class="Symbol">:</a> <a id="49630" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="49634" href="lagda.2023-11-21-nbe.html#49579" class="Bound">Γ</a> <a id="49636" href="lagda.2023-11-21-nbe.html#49581" class="Bound">Δ</a><a id="49637" class="Symbol">}</a>
               <a id="49654" class="Symbol">{</a><a id="49655" href="lagda.2023-11-21-nbe.html#49655" class="Bound">δ</a> <a id="49657" class="Symbol">:</a> <a id="49659" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="49661" href="lagda.2023-11-21-nbe.html#49581" class="Bound">Δ</a> <a id="49663" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a><a id="49664" class="Symbol">}</a>
           <a id="49677" class="Symbol">→</a> <a id="49679" href="lagda.2023-11-21-nbe.html#49602" class="Bound">γ</a> <a id="49681" href="lagda.2023-11-21-nbe.html#49276" class="Function Operator">⊩</a> <a id="49683" href="lagda.2023-11-21-nbe.html#49626" class="Bound">σ</a> <a id="49685" href="lagda.2023-11-21-nbe.html#49276" class="Function Operator">~</a> <a id="49687" href="lagda.2023-11-21-nbe.html#49655" class="Bound">δ</a>
           <a id="49700" class="Symbol">→</a> <a id="49702" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="49704" href="lagda.2023-11-21-nbe.html#49602" class="Bound">γ</a> <a id="49706" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="49708" href="lagda.2023-11-21-nbe.html#49614" class="Bound">a</a> <a id="49710" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a> <a id="49712" href="lagda.2023-11-21-nbe.html#49276" class="Function Operator">⊩</a> <a id="49714" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="49719" href="lagda.2023-11-21-nbe.html#49626" class="Bound">σ</a> <a id="49721" href="lagda.2023-11-21-nbe.html#49276" class="Function Operator">~</a> <a id="49723" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="49725" href="lagda.2023-11-21-nbe.html#49655" class="Bound">δ</a> <a id="49727" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="49729" href="lagda.2023-11-21-nbe.html#49614" class="Bound">a</a> <a id="49731" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a>
<a id="49733" href="lagda.2023-11-21-nbe.html#49563" class="Function">subst-exts</a> <a id="49744" class="Symbol">_</a> <a id="49746" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a> <a id="49748" class="Symbol">=</a> <a id="49750" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="49755" href="lagda.2023-11-21-nbe.html#49563" class="Function">subst-exts</a> <a id="49766" class="Symbol">{</a><a id="49767" class="Argument">σ</a> <a id="49769" class="Symbol">=</a> <a id="49771" href="lagda.2023-11-21-nbe.html#49771" class="Bound">σ</a><a id="49772" class="Symbol">}</a> <a id="49774" href="lagda.2023-11-21-nbe.html#49774" class="Bound">pf</a> <a id="49777" class="Symbol">(</a><a id="49778" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="49780" href="lagda.2023-11-21-nbe.html#49780" class="Bound">x</a><a id="49781" class="Symbol">)</a> <a id="49783" class="Keyword">rewrite</a> <a id="49791" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="49795" class="Symbol">(</a><a id="49796" href="lagda.2023-11-21-nbe.html#49774" class="Bound">pf</a> <a id="49799" href="lagda.2023-11-21-nbe.html#49780" class="Bound">x</a><a id="49800" class="Symbol">)</a> <a id="49802" class="Symbol">=</a>
  <a id="49806" href="lagda.2023-11-21-nbe.html#48163" class="Function">rename-preserves-meaning</a> <a id="49831" class="Symbol">{</a><a id="49832" class="Argument">t</a> <a id="49834" class="Symbol">=</a> <a id="49836" href="lagda.2023-11-21-nbe.html#49771" class="Bound">σ</a> <a id="49838" href="lagda.2023-11-21-nbe.html#49780" class="Bound">x</a><a id="49839" class="Symbol">}</a> <a id="49841" class="Symbol">{</a><a id="49842" href="lagda.2023-11-21-nbe.html#13230" class="Function">↥ʳ</a><a id="49844" class="Symbol">}</a> <a id="49846" class="Symbol">λ</a> <a id="49848" href="lagda.2023-11-21-nbe.html#49848" class="Bound">_</a> <a id="49850" class="Symbol">→</a> <a id="49852" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="subst-preserves-meaning"></a><a id="49858" href="lagda.2023-11-21-nbe.html#49858" class="Function">subst-preserves-meaning</a> <a id="49882" class="Symbol">:</a> <a id="49884" class="Symbol">∀</a> <a id="49886" class="Symbol">{</a><a id="49887" href="lagda.2023-11-21-nbe.html#49887" class="Bound">Γ</a> <a id="49889" href="lagda.2023-11-21-nbe.html#49889" class="Bound">Δ</a> <a id="49891" class="Symbol">:</a> <a id="49893" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="49896" class="Symbol">}</a> <a id="49898" class="Symbol">{</a><a id="49899" href="lagda.2023-11-21-nbe.html#49899" class="Bound">T</a> <a id="49901" class="Symbol">:</a> <a id="49903" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="49907" class="Symbol">}</a> <a id="49909" class="Symbol">{</a><a id="49910" href="lagda.2023-11-21-nbe.html#49910" class="Bound">γ</a> <a id="49912" class="Symbol">:</a> <a id="49914" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="49916" href="lagda.2023-11-21-nbe.html#49887" class="Bound">Γ</a> <a id="49918" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a><a id="49919" class="Symbol">}</a> <a id="49921" class="Symbol">{</a><a id="49922" href="lagda.2023-11-21-nbe.html#49922" class="Bound">δ</a> <a id="49924" class="Symbol">:</a> <a id="49926" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="49928" href="lagda.2023-11-21-nbe.html#49889" class="Bound">Δ</a> <a id="49930" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a><a id="49931" class="Symbol">}</a>
                            <a id="49961" class="Symbol">{</a><a id="49962" href="lagda.2023-11-21-nbe.html#49962" class="Bound">σ</a> <a id="49964" class="Symbol">:</a> <a id="49966" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="49970" href="lagda.2023-11-21-nbe.html#49887" class="Bound">Γ</a> <a id="49972" href="lagda.2023-11-21-nbe.html#49889" class="Bound">Δ</a><a id="49973" class="Symbol">}</a> <a id="49975" class="Symbol">{</a><a id="49976" href="lagda.2023-11-21-nbe.html#49976" class="Bound">t</a> <a id="49978" class="Symbol">:</a> <a id="49980" href="lagda.2023-11-21-nbe.html#49889" class="Bound">Δ</a> <a id="49982" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="49984" href="lagda.2023-11-21-nbe.html#49899" class="Bound">T</a><a id="49985" class="Symbol">}</a>
                        <a id="50011" class="Symbol">→</a> <a id="50013" href="lagda.2023-11-21-nbe.html#49910" class="Bound">γ</a> <a id="50015" href="lagda.2023-11-21-nbe.html#49276" class="Function Operator">⊩</a> <a id="50017" href="lagda.2023-11-21-nbe.html#49962" class="Bound">σ</a> <a id="50019" href="lagda.2023-11-21-nbe.html#49276" class="Function Operator">~</a> <a id="50021" href="lagda.2023-11-21-nbe.html#49922" class="Bound">δ</a>
                        <a id="50047" class="Symbol">→</a> <a id="50049" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟦⊢</a> <a id="50052" href="lagda.2023-11-21-nbe.html#49976" class="Bound">t</a> <a id="50054" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="50056" href="lagda.2023-11-21-nbe.html#49962" class="Bound">σ</a> <a id="50058" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a> <a id="50060" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟧</a> <a id="50062" href="lagda.2023-11-21-nbe.html#49910" class="Bound">γ</a> <a id="50064" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="50066" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟦⊢</a> <a id="50069" href="lagda.2023-11-21-nbe.html#49976" class="Bound">t</a> <a id="50071" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟧</a> <a id="50073" href="lagda.2023-11-21-nbe.html#49922" class="Bound">δ</a>
<a id="50075" href="lagda.2023-11-21-nbe.html#49858" class="Function">subst-preserves-meaning</a> <a id="50099" class="Symbol">{</a><a id="50100" class="Argument">t</a> <a id="50102" class="Symbol">=</a> <a id="50104" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a><a id="50108" class="Symbol">}</a> <a id="50110" href="lagda.2023-11-21-nbe.html#50110" class="Bound">x</a> <a id="50112" class="Symbol">=</a> <a id="50114" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="50119" href="lagda.2023-11-21-nbe.html#49858" class="Function">subst-preserves-meaning</a> <a id="50143" class="Symbol">{</a><a id="50144" class="Argument">t</a> <a id="50146" class="Symbol">=</a> <a id="50148" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="50150" href="lagda.2023-11-21-nbe.html#50150" class="Bound">x</a><a id="50151" class="Symbol">}</a> <a id="50153" href="lagda.2023-11-21-nbe.html#50153" class="Bound">pf</a> <a id="50156" class="Symbol">=</a> <a id="50158" href="lagda.2023-11-21-nbe.html#50153" class="Bound">pf</a> <a id="50161" href="lagda.2023-11-21-nbe.html#50150" class="Bound">x</a>
<a id="50163" href="lagda.2023-11-21-nbe.html#49858" class="Function">subst-preserves-meaning</a> <a id="50187" class="Symbol">{</a><a id="50188" class="Argument">T</a> <a id="50190" class="Symbol">=</a> <a id="50192" href="lagda.2023-11-21-nbe.html#50192" class="Bound">S</a> <a id="50194" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="50196" href="lagda.2023-11-21-nbe.html#50196" class="Bound">T</a><a id="50197" class="Symbol">}</a> <a id="50199" class="Symbol">{</a><a id="50200" href="lagda.2023-11-21-nbe.html#50200" class="Bound">γ</a><a id="50201" class="Symbol">}</a> <a id="50203" class="Symbol">{</a><a id="50204" href="lagda.2023-11-21-nbe.html#50204" class="Bound">δ</a><a id="50205" class="Symbol">}</a> <a id="50207" class="Symbol">{</a><a id="50208" href="lagda.2023-11-21-nbe.html#50208" class="Bound">σ</a><a id="50209" class="Symbol">}</a> <a id="50211" class="Symbol">{</a><a id="50212" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="50214" href="lagda.2023-11-21-nbe.html#50214" class="Bound">t</a><a id="50215" class="Symbol">}</a> <a id="50217" href="lagda.2023-11-21-nbe.html#50217" class="Bound">pf</a> <a id="50220" class="Symbol">=</a> <a id="50222" href="lagda.2023-11-21-nbe.html#2744" class="Postulate">extensionality</a> <a id="50237" href="lagda.2023-11-21-nbe.html#50253" class="Function">lemma</a>
  <a id="50245" class="Keyword">where</a>
  <a id="50253" href="lagda.2023-11-21-nbe.html#50253" class="Function">lemma</a> <a id="50259" class="Symbol">:</a> <a id="50261" class="Symbol">∀</a> <a id="50263" class="Symbol">(</a><a id="50264" href="lagda.2023-11-21-nbe.html#50264" class="Bound">a</a> <a id="50266" class="Symbol">:</a> <a id="50268" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="50270" href="lagda.2023-11-21-nbe.html#50192" class="Bound">S</a> <a id="50272" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a><a id="50273" class="Symbol">)</a> <a id="50275" class="Symbol">→</a> <a id="50277" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟦⊢</a> <a id="50280" href="lagda.2023-11-21-nbe.html#50214" class="Bound">t</a> <a id="50282" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="50284" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="50289" href="lagda.2023-11-21-nbe.html#50208" class="Bound">σ</a> <a id="50291" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a> <a id="50293" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟧</a> <a id="50295" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="50297" href="lagda.2023-11-21-nbe.html#50200" class="Bound">γ</a> <a id="50299" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="50301" href="lagda.2023-11-21-nbe.html#50264" class="Bound">a</a> <a id="50303" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a> <a id="50305" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="50307" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟦⊢</a> <a id="50310" href="lagda.2023-11-21-nbe.html#50214" class="Bound">t</a> <a id="50312" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟧</a> <a id="50314" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="50316" href="lagda.2023-11-21-nbe.html#50204" class="Bound">δ</a> <a id="50318" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="50320" href="lagda.2023-11-21-nbe.html#50264" class="Bound">a</a> <a id="50322" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a>
  <a id="50326" href="lagda.2023-11-21-nbe.html#50253" class="Function">lemma</a> <a id="50332" href="lagda.2023-11-21-nbe.html#50332" class="Bound">a</a> <a id="50334" class="Symbol">=</a> <a id="50336" href="lagda.2023-11-21-nbe.html#49858" class="Function">subst-preserves-meaning</a> <a id="50360" class="Symbol">{</a><a id="50361" class="Argument">σ</a> <a id="50363" class="Symbol">=</a> <a id="50365" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="50370" href="lagda.2023-11-21-nbe.html#50208" class="Bound">σ</a><a id="50371" class="Symbol">}</a> <a id="50373" class="Symbol">{</a><a id="50374" class="Argument">t</a> <a id="50376" class="Symbol">=</a> <a id="50378" href="lagda.2023-11-21-nbe.html#50214" class="Bound">t</a><a id="50379" class="Symbol">}</a> <a id="50381" class="Symbol">(</a><a id="50382" href="lagda.2023-11-21-nbe.html#49563" class="Function">subst-exts</a> <a id="50393" href="lagda.2023-11-21-nbe.html#50217" class="Bound">pf</a><a id="50395" class="Symbol">)</a>
<a id="50397" href="lagda.2023-11-21-nbe.html#49858" class="Function">subst-preserves-meaning</a> <a id="50421" class="Symbol">{</a><a id="50422" class="Argument">σ</a> <a id="50424" class="Symbol">=</a> <a id="50426" href="lagda.2023-11-21-nbe.html#50426" class="Bound">σ</a><a id="50427" class="Symbol">}</a> <a id="50429" class="Symbol">{</a><a id="50430" href="lagda.2023-11-21-nbe.html#50430" class="Bound">r</a> <a id="50432" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="50434" href="lagda.2023-11-21-nbe.html#50434" class="Bound">s</a><a id="50435" class="Symbol">}</a> <a id="50437" href="lagda.2023-11-21-nbe.html#50437" class="Bound">pf</a>
  <a id="50442" class="Keyword">rewrite</a> <a id="50450" href="lagda.2023-11-21-nbe.html#49858" class="Function">subst-preserves-meaning</a> <a id="50474" class="Symbol">{</a><a id="50475" class="Argument">σ</a> <a id="50477" class="Symbol">=</a> <a id="50479" href="lagda.2023-11-21-nbe.html#50426" class="Bound">σ</a><a id="50480" class="Symbol">}</a> <a id="50482" class="Symbol">{</a><a id="50483" href="lagda.2023-11-21-nbe.html#50430" class="Bound">r</a><a id="50484" class="Symbol">}</a> <a id="50486" href="lagda.2023-11-21-nbe.html#50437" class="Bound">pf</a>
        <a id="50497" class="Symbol">|</a> <a id="50499" href="lagda.2023-11-21-nbe.html#49858" class="Function">subst-preserves-meaning</a> <a id="50523" class="Symbol">{</a><a id="50524" class="Argument">σ</a> <a id="50526" class="Symbol">=</a> <a id="50528" href="lagda.2023-11-21-nbe.html#50426" class="Bound">σ</a><a id="50529" class="Symbol">}</a> <a id="50531" class="Symbol">{</a><a id="50532" href="lagda.2023-11-21-nbe.html#50434" class="Bound">s</a><a id="50533" class="Symbol">}</a> <a id="50535" href="lagda.2023-11-21-nbe.html#50437" class="Bound">pf</a> <a id="50538" class="Symbol">=</a> <a id="50540" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
</pre>
A corollary of this is that β-reductions preserve meaning:

<pre class="Agda"><a id="β-preserves-meaning"></a><a id="50618" href="lagda.2023-11-21-nbe.html#50618" class="Function">β-preserves-meaning</a> <a id="50638" class="Symbol">:</a> <a id="50640" class="Symbol">∀</a> <a id="50642" class="Symbol">{</a><a id="50643" href="lagda.2023-11-21-nbe.html#50643" class="Bound">Γ</a> <a id="50645" class="Symbol">:</a> <a id="50647" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="50650" class="Symbol">}</a> <a id="50652" class="Symbol">{</a><a id="50653" href="lagda.2023-11-21-nbe.html#50653" class="Bound">S</a> <a id="50655" href="lagda.2023-11-21-nbe.html#50655" class="Bound">T</a> <a id="50657" class="Symbol">:</a> <a id="50659" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="50663" class="Symbol">}</a> <a id="50665" class="Symbol">{</a><a id="50666" href="lagda.2023-11-21-nbe.html#50666" class="Bound">γ</a> <a id="50668" class="Symbol">:</a> <a id="50670" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="50672" href="lagda.2023-11-21-nbe.html#50643" class="Bound">Γ</a> <a id="50674" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a><a id="50675" class="Symbol">}</a> <a id="50677" class="Symbol">{</a><a id="50678" href="lagda.2023-11-21-nbe.html#50678" class="Bound">s</a> <a id="50680" class="Symbol">:</a> <a id="50682" href="lagda.2023-11-21-nbe.html#50643" class="Bound">Γ</a> <a id="50684" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="50686" href="lagda.2023-11-21-nbe.html#50653" class="Bound">S</a><a id="50687" class="Symbol">}</a>
                        <a id="50713" class="Symbol">{</a><a id="50714" href="lagda.2023-11-21-nbe.html#50714" class="Bound">t</a> <a id="50716" class="Symbol">:</a> <a id="50718" href="lagda.2023-11-21-nbe.html#50643" class="Bound">Γ</a> <a id="50720" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="50722" href="lagda.2023-11-21-nbe.html#50653" class="Bound">S</a> <a id="50724" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="50726" href="lagda.2023-11-21-nbe.html#50655" class="Bound">T</a><a id="50727" class="Symbol">}</a>
                    <a id="50749" class="Symbol">→</a> <a id="50751" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟦⊢</a> <a id="50754" href="lagda.2023-11-21-nbe.html#50714" class="Bound">t</a> <a id="50756" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟧</a> <a id="50758" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="50760" href="lagda.2023-11-21-nbe.html#50666" class="Bound">γ</a> <a id="50762" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="50764" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟦⊢</a> <a id="50767" href="lagda.2023-11-21-nbe.html#50678" class="Bound">s</a> <a id="50769" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟧</a> <a id="50771" href="lagda.2023-11-21-nbe.html#50666" class="Bound">γ</a> <a id="50773" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a> <a id="50775" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="50777" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟦⊢</a> <a id="50780" href="lagda.2023-11-21-nbe.html#50714" class="Bound">t</a> <a id="50782" href="lagda.2023-11-21-nbe.html#29366" class="Function Operator">[</a> <a id="50784" href="lagda.2023-11-21-nbe.html#50678" class="Bound">s</a> <a id="50786" href="lagda.2023-11-21-nbe.html#29366" class="Function Operator">]₀</a> <a id="50789" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟧</a> <a id="50791" href="lagda.2023-11-21-nbe.html#50666" class="Bound">γ</a>
<a id="50793" href="lagda.2023-11-21-nbe.html#50618" class="Function">β-preserves-meaning</a> <a id="50813" class="Symbol">{</a><a id="50814" href="lagda.2023-11-21-nbe.html#50814" class="Bound">Γ</a><a id="50815" class="Symbol">}</a> <a id="50817" class="Symbol">{</a><a id="50818" href="lagda.2023-11-21-nbe.html#50818" class="Bound">S</a><a id="50819" class="Symbol">}</a> <a id="50821" class="Symbol">{</a><a id="50822" class="Argument">γ</a> <a id="50824" class="Symbol">=</a> <a id="50826" href="lagda.2023-11-21-nbe.html#50826" class="Bound">γ</a><a id="50827" class="Symbol">}</a> <a id="50829" class="Symbol">{</a><a id="50830" href="lagda.2023-11-21-nbe.html#50830" class="Bound">s</a><a id="50831" class="Symbol">}</a> <a id="50833" class="Symbol">{</a><a id="50834" href="lagda.2023-11-21-nbe.html#50834" class="Bound">t</a><a id="50835" class="Symbol">}</a> <a id="50837" class="Symbol">=</a>
  <a id="50841" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="50845" class="Symbol">(</a><a id="50846" href="lagda.2023-11-21-nbe.html#49858" class="Function">subst-preserves-meaning</a> <a id="50870" class="Symbol">{</a><a id="50871" class="Argument">γ</a> <a id="50873" class="Symbol">=</a> <a id="50875" href="lagda.2023-11-21-nbe.html#50826" class="Bound">γ</a><a id="50876" class="Symbol">}</a> <a id="50878" class="Symbol">{</a><a id="50879" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="50881" href="lagda.2023-11-21-nbe.html#50826" class="Bound">γ</a> <a id="50883" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="50885" href="lagda.2023-11-21-nbe.html#50920" class="Function">a</a> <a id="50887" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a><a id="50888" class="Symbol">}</a> <a id="50890" class="Symbol">{</a><a id="50891" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="50894" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="50896" href="lagda.2023-11-21-nbe.html#50830" class="Bound">s</a><a id="50897" class="Symbol">}</a> <a id="50899" class="Symbol">{</a><a id="50900" href="lagda.2023-11-21-nbe.html#50834" class="Bound">t</a><a id="50901" class="Symbol">}</a> <a id="50903" href="lagda.2023-11-21-nbe.html#50935" class="Function">lemma</a><a id="50908" class="Symbol">)</a>
  <a id="50912" class="Keyword">where</a>
  <a id="50920" href="lagda.2023-11-21-nbe.html#50920" class="Function">a</a> <a id="50922" class="Symbol">=</a> <a id="50924" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟦⊢</a> <a id="50927" href="lagda.2023-11-21-nbe.html#50830" class="Bound">s</a> <a id="50929" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟧</a> <a id="50931" href="lagda.2023-11-21-nbe.html#50826" class="Bound">γ</a>
  <a id="50935" href="lagda.2023-11-21-nbe.html#50935" class="Function">lemma</a> <a id="50941" class="Symbol">:</a> <a id="50943" class="Symbol">∀</a> <a id="50945" class="Symbol">{</a><a id="50946" href="lagda.2023-11-21-nbe.html#50946" class="Bound">T</a> <a id="50948" class="Symbol">:</a> <a id="50950" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="50954" class="Symbol">}</a>
        <a id="50964" class="Symbol">→</a> <a id="50966" class="Symbol">(</a><a id="50967" href="lagda.2023-11-21-nbe.html#50967" class="Bound">x</a> <a id="50969" class="Symbol">:</a> <a id="50971" href="lagda.2023-11-21-nbe.html#50814" class="Bound">Γ</a> <a id="50973" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="50975" href="lagda.2023-11-21-nbe.html#50818" class="Bound">S</a> <a id="50977" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="50979" href="lagda.2023-11-21-nbe.html#50946" class="Bound">T</a><a id="50980" class="Symbol">)</a>
        <a id="50990" class="Symbol">→</a> <a id="50992" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟦⊢</a> <a id="50995" class="Symbol">(</a><a id="50996" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="50999" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="51001" href="lagda.2023-11-21-nbe.html#50830" class="Bound">s</a><a id="51002" class="Symbol">)</a> <a id="51004" href="lagda.2023-11-21-nbe.html#50967" class="Bound">x</a> <a id="51006" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟧</a> <a id="51008" href="lagda.2023-11-21-nbe.html#50826" class="Bound">γ</a> <a id="51010" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="51012" href="lagda.2023-11-21-nbe.html#43825" class="Function">env-lookup</a> <a id="51023" href="lagda.2023-11-21-nbe.html#50967" class="Bound">x</a> <a id="51025" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="51027" href="lagda.2023-11-21-nbe.html#50826" class="Bound">γ</a> <a id="51029" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="51031" href="lagda.2023-11-21-nbe.html#50920" class="Function">a</a> <a id="51033" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a>
  <a id="51037" href="lagda.2023-11-21-nbe.html#50935" class="Function">lemma</a> <a id="51043" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>     <a id="51049" class="Symbol">=</a> <a id="51051" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="51058" href="lagda.2023-11-21-nbe.html#50935" class="Function">lemma</a> <a id="51064" class="Symbol">(</a><a id="51065" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="51067" href="lagda.2023-11-21-nbe.html#51067" class="Bound">x</a><a id="51068" class="Symbol">)</a> <a id="51070" class="Symbol">=</a> <a id="51072" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
</pre>
Another corollary is that the shifting substitution preserves meaning on an
extended environment.

<pre class="Agda"><a id="↥-preserves-meaning"></a><a id="51189" href="lagda.2023-11-21-nbe.html#51189" class="Function">↥-preserves-meaning</a> <a id="51209" class="Symbol">:</a> <a id="51211" class="Symbol">∀</a> <a id="51213" class="Symbol">{</a><a id="51214" href="lagda.2023-11-21-nbe.html#51214" class="Bound">Γ</a> <a id="51216" class="Symbol">:</a> <a id="51218" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="51221" class="Symbol">}</a> <a id="51223" class="Symbol">{</a><a id="51224" href="lagda.2023-11-21-nbe.html#51224" class="Bound">S</a> <a id="51226" href="lagda.2023-11-21-nbe.html#51226" class="Bound">T</a> <a id="51228" class="Symbol">:</a> <a id="51230" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="51234" class="Symbol">}</a> <a id="51236" class="Symbol">{</a><a id="51237" href="lagda.2023-11-21-nbe.html#51237" class="Bound">t</a> <a id="51239" class="Symbol">:</a> <a id="51241" href="lagda.2023-11-21-nbe.html#51214" class="Bound">Γ</a> <a id="51243" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="51245" href="lagda.2023-11-21-nbe.html#51226" class="Bound">T</a><a id="51246" class="Symbol">}</a> <a id="51248" class="Symbol">{</a><a id="51249" href="lagda.2023-11-21-nbe.html#51249" class="Bound">γ</a> <a id="51251" class="Symbol">:</a> <a id="51253" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="51255" href="lagda.2023-11-21-nbe.html#51214" class="Bound">Γ</a> <a id="51257" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a><a id="51258" class="Symbol">}</a>
                        <a id="51284" class="Symbol">{</a><a id="51285" href="lagda.2023-11-21-nbe.html#51285" class="Bound">a</a> <a id="51287" class="Symbol">:</a> <a id="51289" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="51291" href="lagda.2023-11-21-nbe.html#51224" class="Bound">S</a> <a id="51293" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a><a id="51294" class="Symbol">}</a>
                    <a id="51316" class="Symbol">→</a> <a id="51318" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟦⊢</a> <a id="51321" href="lagda.2023-11-21-nbe.html#51237" class="Bound">t</a> <a id="51323" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟧</a> <a id="51325" href="lagda.2023-11-21-nbe.html#51249" class="Bound">γ</a> <a id="51327" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="51329" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟦⊢</a> <a id="51332" href="lagda.2023-11-21-nbe.html#51237" class="Bound">t</a> <a id="51334" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="51336" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a> <a id="51338" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a> <a id="51340" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟧</a> <a id="51342" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="51344" href="lagda.2023-11-21-nbe.html#51249" class="Bound">γ</a> <a id="51346" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="51348" href="lagda.2023-11-21-nbe.html#51285" class="Bound">a</a> <a id="51350" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a>
<a id="51352" href="lagda.2023-11-21-nbe.html#51189" class="Function">↥-preserves-meaning</a> <a id="51372" class="Symbol">{</a><a id="51373" class="Argument">t</a> <a id="51375" class="Symbol">=</a> <a id="51377" href="lagda.2023-11-21-nbe.html#51377" class="Bound">t</a><a id="51378" class="Symbol">}</a> <a id="51380" class="Symbol">{</a><a id="51381" href="lagda.2023-11-21-nbe.html#51381" class="Bound">γ</a><a id="51382" class="Symbol">}</a> <a id="51384" class="Symbol">{</a><a id="51385" href="lagda.2023-11-21-nbe.html#51385" class="Bound">a</a><a id="51386" class="Symbol">}</a> <a id="51388" class="Symbol">=</a>
  <a id="51392" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="51396" class="Symbol">(</a><a id="51397" href="lagda.2023-11-21-nbe.html#49858" class="Function">subst-preserves-meaning</a> <a id="51421" class="Symbol">{</a><a id="51422" class="Argument">γ</a> <a id="51424" class="Symbol">=</a> <a id="51426" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="51428" href="lagda.2023-11-21-nbe.html#51381" class="Bound">γ</a> <a id="51430" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="51432" href="lagda.2023-11-21-nbe.html#51385" class="Bound">a</a> <a id="51434" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a><a id="51435" class="Symbol">}</a> <a id="51437" class="Symbol">{</a><a id="51438" href="lagda.2023-11-21-nbe.html#51381" class="Bound">γ</a><a id="51439" class="Symbol">}</a> <a id="51441" class="Symbol">{</a><a id="51442" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a><a id="51443" class="Symbol">}</a> <a id="51445" class="Symbol">{</a><a id="51446" href="lagda.2023-11-21-nbe.html#51377" class="Bound">t</a><a id="51447" class="Symbol">}</a> <a id="51449" class="Symbol">λ{_</a> <a id="51453" class="Symbol">→</a> <a id="51455" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="51459" class="Symbol">})</a>
</pre>
With these lemmas, it is possible to prove that definitional equality implies
semantic equality.
--->
<pre class="Agda"><a id="==→⟦≡⟧"></a><a id="51577" href="lagda.2023-11-21-nbe.html#51577" class="Function">==→⟦≡⟧</a> <a id="51584" class="Symbol">:</a> <a id="51586" class="Symbol">∀</a> <a id="51588" class="Symbol">{</a><a id="51589" href="lagda.2023-11-21-nbe.html#51589" class="Bound">Γ</a> <a id="51591" class="Symbol">:</a> <a id="51593" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="51596" class="Symbol">}</a> <a id="51598" class="Symbol">{</a><a id="51599" href="lagda.2023-11-21-nbe.html#51599" class="Bound">T</a> <a id="51601" class="Symbol">:</a> <a id="51603" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="51607" class="Symbol">}</a> <a id="51609" class="Symbol">{</a><a id="51610" href="lagda.2023-11-21-nbe.html#51610" class="Bound">t</a> <a id="51612" href="lagda.2023-11-21-nbe.html#51612" class="Bound">t′</a> <a id="51615" class="Symbol">:</a> <a id="51617" href="lagda.2023-11-21-nbe.html#51589" class="Bound">Γ</a> <a id="51619" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="51621" href="lagda.2023-11-21-nbe.html#51599" class="Bound">T</a><a id="51622" class="Symbol">}</a> <a id="51624" class="Symbol">{</a><a id="51625" href="lagda.2023-11-21-nbe.html#51625" class="Bound">γ</a> <a id="51627" class="Symbol">:</a> <a id="51629" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="51631" href="lagda.2023-11-21-nbe.html#51589" class="Bound">Γ</a> <a id="51633" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a><a id="51634" class="Symbol">}</a>
       <a id="51643" class="Symbol">→</a> <a id="51645" href="lagda.2023-11-21-nbe.html#51610" class="Bound">t</a> <a id="51647" href="lagda.2023-11-21-nbe.html#30253" class="Datatype Operator">==</a> <a id="51650" href="lagda.2023-11-21-nbe.html#51612" class="Bound">t′</a>
       <a id="51660" class="Symbol">→</a> <a id="51662" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟦⊢</a> <a id="51665" href="lagda.2023-11-21-nbe.html#51610" class="Bound">t</a> <a id="51667" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟧</a> <a id="51669" href="lagda.2023-11-21-nbe.html#51625" class="Bound">γ</a> <a id="51671" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="51673" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟦⊢</a> <a id="51676" href="lagda.2023-11-21-nbe.html#51612" class="Bound">t′</a> <a id="51679" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟧</a> <a id="51681" href="lagda.2023-11-21-nbe.html#51625" class="Bound">γ</a>
</pre>
<!---
<pre class="Agda"><a id="51697" href="lagda.2023-11-21-nbe.html#51577" class="Function">==→⟦≡⟧</a> <a id="51704" class="Symbol">{</a><a id="51705" class="Argument">γ</a> <a id="51707" class="Symbol">=</a> <a id="51709" href="lagda.2023-11-21-nbe.html#51709" class="Bound">γ</a><a id="51710" class="Symbol">}</a> <a id="51712" class="Symbol">(</a><a id="51713" href="lagda.2023-11-21-nbe.html#30351" class="InductiveConstructor">β</a> <a id="51715" class="Symbol">{</a><a id="51716" class="Argument">t</a> <a id="51718" class="Symbol">=</a> <a id="51720" href="lagda.2023-11-21-nbe.html#51720" class="Bound">t</a><a id="51721" class="Symbol">}</a> <a id="51723" class="Symbol">{</a><a id="51724" class="Argument">s</a> <a id="51726" class="Symbol">=</a> <a id="51728" href="lagda.2023-11-21-nbe.html#51728" class="Bound">s</a><a id="51729" class="Symbol">})</a> <a id="51732" class="Symbol">=</a> <a id="51734" href="lagda.2023-11-21-nbe.html#50618" class="Function">β-preserves-meaning</a> <a id="51754" class="Symbol">{</a><a id="51755" class="Argument">γ</a> <a id="51757" class="Symbol">=</a> <a id="51759" href="lagda.2023-11-21-nbe.html#51709" class="Bound">γ</a><a id="51760" class="Symbol">}</a> <a id="51762" class="Symbol">{</a><a id="51763" href="lagda.2023-11-21-nbe.html#51728" class="Bound">s</a><a id="51764" class="Symbol">}</a> <a id="51766" class="Symbol">{</a><a id="51767" href="lagda.2023-11-21-nbe.html#51720" class="Bound">t</a><a id="51768" class="Symbol">}</a>
<a id="51770" href="lagda.2023-11-21-nbe.html#51577" class="Function">==→⟦≡⟧</a> <a id="51777" class="Symbol">{</a><a id="51778" class="Argument">T</a> <a id="51780" class="Symbol">=</a> <a id="51782" href="lagda.2023-11-21-nbe.html#51782" class="Bound">S</a> <a id="51784" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="51786" class="Symbol">_}</a> <a id="51789" class="Symbol">{</a><a id="51790" class="Argument">t</a> <a id="51792" class="Symbol">=</a> <a id="51794" href="lagda.2023-11-21-nbe.html#51794" class="Bound">t</a><a id="51795" class="Symbol">}</a> <a id="51797" class="Symbol">{</a><a id="51798" class="Argument">γ</a> <a id="51800" class="Symbol">=</a> <a id="51802" href="lagda.2023-11-21-nbe.html#51802" class="Bound">γ</a><a id="51803" class="Symbol">}</a> <a id="51805" href="lagda.2023-11-21-nbe.html#30573" class="InductiveConstructor">η</a> <a id="51807" class="Symbol">=</a> <a id="51809" href="lagda.2023-11-21-nbe.html#2744" class="Postulate">extensionality</a> <a id="51824" href="lagda.2023-11-21-nbe.html#51838" class="Function">lemma</a> <a id="51830" class="Keyword">where</a>
  <a id="51838" href="lagda.2023-11-21-nbe.html#51838" class="Function">lemma</a> <a id="51844" class="Symbol">:</a> <a id="51846" class="Symbol">∀</a> <a id="51848" class="Symbol">(</a><a id="51849" href="lagda.2023-11-21-nbe.html#51849" class="Bound">a</a> <a id="51851" class="Symbol">:</a> <a id="51853" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="51855" href="lagda.2023-11-21-nbe.html#51782" class="Bound">S</a> <a id="51857" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a><a id="51858" class="Symbol">)</a> <a id="51860" class="Symbol">→</a> <a id="51862" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟦⊢</a> <a id="51865" href="lagda.2023-11-21-nbe.html#51794" class="Bound">t</a> <a id="51867" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟧</a> <a id="51869" href="lagda.2023-11-21-nbe.html#51802" class="Bound">γ</a> <a id="51871" href="lagda.2023-11-21-nbe.html#51849" class="Bound">a</a> <a id="51873" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="51875" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟦⊢</a> <a id="51878" href="lagda.2023-11-21-nbe.html#51794" class="Bound">t</a> <a id="51880" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="51882" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a> <a id="51884" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a> <a id="51886" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟧</a> <a id="51888" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="51890" href="lagda.2023-11-21-nbe.html#51802" class="Bound">γ</a> <a id="51892" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="51894" href="lagda.2023-11-21-nbe.html#51849" class="Bound">a</a> <a id="51896" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a> <a id="51898" href="lagda.2023-11-21-nbe.html#51849" class="Bound">a</a>
  <a id="51902" href="lagda.2023-11-21-nbe.html#51838" class="Function">lemma</a> <a id="51908" href="lagda.2023-11-21-nbe.html#51908" class="Bound">a</a> <a id="51910" class="Keyword">rewrite</a> <a id="51918" href="lagda.2023-11-21-nbe.html#51189" class="Function">↥-preserves-meaning</a> <a id="51938" class="Symbol">{</a><a id="51939" class="Argument">t</a> <a id="51941" class="Symbol">=</a> <a id="51943" href="lagda.2023-11-21-nbe.html#51794" class="Bound">t</a><a id="51944" class="Symbol">}</a> <a id="51946" class="Symbol">{</a><a id="51947" href="lagda.2023-11-21-nbe.html#51802" class="Bound">γ</a><a id="51948" class="Symbol">}</a> <a id="51950" class="Symbol">{</a><a id="51951" href="lagda.2023-11-21-nbe.html#51908" class="Bound">a</a><a id="51952" class="Symbol">}</a> <a id="51954" class="Symbol">=</a> <a id="51956" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="51961" href="lagda.2023-11-21-nbe.html#51577" class="Function">==→⟦≡⟧</a> <a id="51968" class="Symbol">{</a><a id="51969" class="Argument">γ</a> <a id="51971" class="Symbol">=</a> <a id="51973" href="lagda.2023-11-21-nbe.html#51973" class="Bound">γ</a><a id="51974" class="Symbol">}</a> <a id="51976" class="Symbol">(</a><a id="51977" href="lagda.2023-11-21-nbe.html#30709" class="InductiveConstructor">abs-compatible</a> <a id="51992" href="lagda.2023-11-21-nbe.html#51992" class="Bound">t==t′</a><a id="51997" class="Symbol">)</a> <a id="51999" class="Symbol">=</a>
  <a id="52003" href="lagda.2023-11-21-nbe.html#2744" class="Postulate">extensionality</a> <a id="52018" class="Symbol">(λ</a> <a id="52021" href="lagda.2023-11-21-nbe.html#52021" class="Bound">a</a> <a id="52023" class="Symbol">→</a> <a id="52025" href="lagda.2023-11-21-nbe.html#51577" class="Function">==→⟦≡⟧</a> <a id="52032" class="Symbol">{</a><a id="52033" class="Argument">γ</a> <a id="52035" class="Symbol">=</a> <a id="52037" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="52039" href="lagda.2023-11-21-nbe.html#51973" class="Bound">γ</a> <a id="52041" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="52043" href="lagda.2023-11-21-nbe.html#52021" class="Bound">a</a> <a id="52045" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a><a id="52046" class="Symbol">}</a> <a id="52048" href="lagda.2023-11-21-nbe.html#51992" class="Bound">t==t′</a><a id="52053" class="Symbol">)</a>
<a id="52055" href="lagda.2023-11-21-nbe.html#51577" class="Function">==→⟦≡⟧</a> <a id="52062" class="Symbol">{</a><a id="52063" class="Argument">γ</a> <a id="52065" class="Symbol">=</a> <a id="52067" href="lagda.2023-11-21-nbe.html#52067" class="Bound">γ</a><a id="52068" class="Symbol">}</a> <a id="52070" class="Symbol">(</a><a id="52071" href="lagda.2023-11-21-nbe.html#30868" class="InductiveConstructor">app-compatible</a> <a id="52086" href="lagda.2023-11-21-nbe.html#52086" class="Bound">r==r′</a> <a id="52092" href="lagda.2023-11-21-nbe.html#52092" class="Bound">s==s′</a><a id="52097" class="Symbol">)</a>
  <a id="52101" class="Keyword">rewrite</a> <a id="52109" href="lagda.2023-11-21-nbe.html#51577" class="Function">==→⟦≡⟧</a> <a id="52116" class="Symbol">{</a><a id="52117" class="Argument">γ</a> <a id="52119" class="Symbol">=</a> <a id="52121" href="lagda.2023-11-21-nbe.html#52067" class="Bound">γ</a><a id="52122" class="Symbol">}</a> <a id="52124" href="lagda.2023-11-21-nbe.html#52086" class="Bound">r==r′</a> <a id="52130" class="Symbol">|</a> <a id="52132" href="lagda.2023-11-21-nbe.html#51577" class="Function">==→⟦≡⟧</a> <a id="52139" class="Symbol">{</a><a id="52140" class="Argument">γ</a> <a id="52142" class="Symbol">=</a> <a id="52144" href="lagda.2023-11-21-nbe.html#52067" class="Bound">γ</a><a id="52145" class="Symbol">}</a> <a id="52147" href="lagda.2023-11-21-nbe.html#52092" class="Bound">s==s′</a> <a id="52153" class="Symbol">=</a> <a id="52155" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="52160" href="lagda.2023-11-21-nbe.html#51577" class="Function">==→⟦≡⟧</a> <a id="52167" href="lagda.2023-11-21-nbe.html#31125" class="InductiveConstructor">refl⁼⁼</a> <a id="52174" class="Symbol">=</a> <a id="52176" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="52181" href="lagda.2023-11-21-nbe.html#51577" class="Function">==→⟦≡⟧</a> <a id="52188" class="Symbol">(</a><a id="52189" href="lagda.2023-11-21-nbe.html#31208" class="InductiveConstructor">sym⁼⁼</a> <a id="52195" href="lagda.2023-11-21-nbe.html#52195" class="Bound">t′==t</a><a id="52200" class="Symbol">)</a> <a id="52202" class="Symbol">=</a> <a id="52204" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="52208" class="Symbol">(</a><a id="52209" href="lagda.2023-11-21-nbe.html#51577" class="Function">==→⟦≡⟧</a> <a id="52216" href="lagda.2023-11-21-nbe.html#52195" class="Bound">t′==t</a><a id="52221" class="Symbol">)</a>
<a id="52223" href="lagda.2023-11-21-nbe.html#51577" class="Function">==→⟦≡⟧</a> <a id="52230" class="Symbol">(</a><a id="52231" href="lagda.2023-11-21-nbe.html#31311" class="InductiveConstructor">trans⁼⁼</a> <a id="52239" href="lagda.2023-11-21-nbe.html#52239" class="Bound">t₁==t₂</a> <a id="52246" href="lagda.2023-11-21-nbe.html#52246" class="Bound">t₂==t₃</a><a id="52252" class="Symbol">)</a> <a id="52254" class="Symbol">=</a> <a id="52256" href="Relation.Binary.PropositionalEquality.Core.html#1729" class="Function">trans</a> <a id="52262" class="Symbol">(</a><a id="52263" href="lagda.2023-11-21-nbe.html#51577" class="Function">==→⟦≡⟧</a> <a id="52270" href="lagda.2023-11-21-nbe.html#52239" class="Bound">t₁==t₂</a><a id="52276" class="Symbol">)</a> <a id="52278" class="Symbol">(</a><a id="52279" href="lagda.2023-11-21-nbe.html#51577" class="Function">==→⟦≡⟧</a> <a id="52286" href="lagda.2023-11-21-nbe.html#52246" class="Bound">t₂==t₃</a><a id="52292" class="Symbol">)</a>
</pre>--->
<p>We consider our algorithm for normalization by evaluation complete if two terms
that are definitionally equal (and thus have the same meaning) have the same
normal form:</p>
<pre><code>Γ ⊢ t = t′ : T implies nf(t) = nf(t′)</code></pre>
<p>Expanding out <code>nf</code> here gives us the following theorem:</p>
<pre><code>Γ ⊢ t = t′ : T ⇒ ↓ᵀ (⟦ t ⟧ ↑Γ) Γ = ↓ᵀ (⟦ t′ ⟧ ↑Γ) Γ</code></pre>
<p>This follows directly from <code>Γ ⊢ t = t′ : T</code> implying that <code>⟦ t ⟧ = ⟦ t′ ⟧</code>.</p>
<pre class="Agda"><a id="completeness"></a><a id="52717" href="lagda.2023-11-21-nbe.html#52717" class="Function">completeness</a> <a id="52730" class="Symbol">:</a> <a id="52732" class="Symbol">∀</a> <a id="52734" class="Symbol">{</a><a id="52735" href="lagda.2023-11-21-nbe.html#52735" class="Bound">Γ</a> <a id="52737" class="Symbol">:</a> <a id="52739" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="52742" class="Symbol">}</a> <a id="52744" class="Symbol">{</a><a id="52745" href="lagda.2023-11-21-nbe.html#52745" class="Bound">T</a> <a id="52747" class="Symbol">:</a> <a id="52749" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="52753" class="Symbol">}</a> <a id="52755" class="Symbol">{</a><a id="52756" href="lagda.2023-11-21-nbe.html#52756" class="Bound">t</a> <a id="52758" href="lagda.2023-11-21-nbe.html#52758" class="Bound">t′</a> <a id="52761" class="Symbol">:</a> <a id="52763" href="lagda.2023-11-21-nbe.html#52735" class="Bound">Γ</a> <a id="52765" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="52767" href="lagda.2023-11-21-nbe.html#52745" class="Bound">T</a><a id="52768" class="Symbol">}</a>
             <a id="52783" class="Symbol">→</a> <a id="52785" href="lagda.2023-11-21-nbe.html#52756" class="Bound">t</a> <a id="52787" href="lagda.2023-11-21-nbe.html#30253" class="Datatype Operator">==</a> <a id="52790" href="lagda.2023-11-21-nbe.html#52758" class="Bound">t′</a>
             <a id="52806" class="Symbol">→</a> <a id="52808" href="lagda.2023-11-21-nbe.html#46844" class="Function">nf</a> <a id="52811" href="lagda.2023-11-21-nbe.html#52756" class="Bound">t</a> <a id="52813" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="52815" href="lagda.2023-11-21-nbe.html#46844" class="Function">nf</a> <a id="52818" href="lagda.2023-11-21-nbe.html#52758" class="Bound">t′</a>
<a id="52821" href="lagda.2023-11-21-nbe.html#52717" class="Function">completeness</a> <a id="52834" class="Symbol">{</a><a id="52835" href="lagda.2023-11-21-nbe.html#52835" class="Bound">Γ</a><a id="52836" class="Symbol">}</a> <a id="52838" href="lagda.2023-11-21-nbe.html#52838" class="Bound">t==t′</a> <a id="52844" class="Keyword">rewrite</a> <a id="52852" href="lagda.2023-11-21-nbe.html#51577" class="Function">==→⟦≡⟧</a> <a id="52859" class="Symbol">{</a><a id="52860" class="Argument">γ</a> <a id="52862" class="Symbol">=</a> <a id="52864" href="lagda.2023-11-21-nbe.html#46420" class="Function">↑ᶜᵗˣ</a> <a id="52869" href="lagda.2023-11-21-nbe.html#52835" class="Bound">Γ</a><a id="52870" class="Symbol">}</a> <a id="52872" href="lagda.2023-11-21-nbe.html#52838" class="Bound">t==t′</a> <a id="52878" class="Symbol">=</a> <a id="52880" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
</pre>
<p>As for the soundness properties that we wanted from the algorithm:</p>
<ul>
<li><p><code>Γ ⊢ nf(t) : T</code> (well-typedness of normal form)</p>
<p>We are using an intrinsically typed representation of terms, so this
property is given to us automatically</p></li>
<li><p><code>⟦ nf(t) ⟧ = ⟦ t ⟧</code> (preservation of meaning)</p>
<p>As discussed, equality of functional terms in Agda is undecidable, for
which we have introduced definitional equality. Even proving that
<code>Γ ⊢ nf(t) = t : T</code> is difficult, and we will have to use a
logical relation to prove it in the following section</p></li>
<li><p><code>nf(nf(t)) = nf(t)</code> (idempotency)</p>
<p>This follows directly from the preservation of
meaning and completeness properties of the algorithm:</p>
<p>By the soundness property of preservation of meaning,
we will have <code>Γ ⊢ nf t = t : T</code>, which will in turn imply
<code>nf (nf t) = nf(t)</code> by the algorithm’s completeness</p></li>
</ul>
<h4 id="soundness">Soundness</h4>
<p>To prove that the algorithm for normalization by evaluation implemented
preserves the meaning of a program, we will prove that a term is definitionally
equal to its normal form:</p>
<p>Γ ⊢ t = nf(t) : T</p>
<p>In proving that a term is definitionally equal to its normal form, we will have
that <code>⟦ nf (t) ⟧ = ⟦ t ⟧</code>, as definitional equality implies semantic equality.
This new property we wish to prove expands to:</p>
<pre><code>Γ ⊢ t = ↓ᵀ a Γ, where a = ⟦ t ⟧ ↑Γ</code></pre>
<p>To prove this, we will establish a logical relation <code>Γ ⊢ t : T Ⓡ a</code> between a
well-typed term <code>Γ ⊢ t : T</code> and a semantic object in our meta language
<code>a ∈ ⟦ T ⟧</code> such that it implies <code>Γ ⊢ t = ↓ᵀ a Γ : T</code>. Later, we will prove that
<code>Γ ⊢ t : T Ⓡ ⟦ t ⟧ ↑Γ</code> (which will then finish our proof), but we will focus on
the logical relation itself for now.</p>
<p>For defining the relation in Agda, we will need to first define another relation
that “lifts” definitional equality to include liftable neutrals. If the liftable
neutral can be lifted to the context <code>Γ</code>, this is just definitional equality.
Otherwise, the relation can never hold, as there is no lifted term in the
context to compare to.</p>
<pre class="Agda"><a id="_==^_"></a><a id="54952" href="lagda.2023-11-21-nbe.html#54952" class="Function Operator">_==^_</a> <a id="54958" class="Symbol">:</a> <a id="54960" class="Symbol">{</a><a id="54961" href="lagda.2023-11-21-nbe.html#54961" class="Bound">Γ</a> <a id="54963" class="Symbol">:</a> <a id="54965" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="54968" class="Symbol">}</a> <a id="54970" class="Symbol">{</a><a id="54971" href="lagda.2023-11-21-nbe.html#54971" class="Bound">T</a> <a id="54973" class="Symbol">:</a> <a id="54975" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="54979" class="Symbol">}</a> <a id="54981" class="Symbol">→</a> <a id="54983" href="lagda.2023-11-21-nbe.html#54961" class="Bound">Γ</a> <a id="54985" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="54987" href="lagda.2023-11-21-nbe.html#54971" class="Bound">T</a> <a id="54989" class="Symbol">→</a> <a id="54991" href="lagda.2023-11-21-nbe.html#42004" class="Function">Ne^</a> <a id="54995" href="lagda.2023-11-21-nbe.html#54971" class="Bound">T</a> <a id="54997" class="Symbol">→</a> <a id="54999" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="55003" href="lagda.2023-11-21-nbe.html#54952" class="Function Operator">_==^_</a> <a id="55009" class="Symbol">{</a><a id="55010" href="lagda.2023-11-21-nbe.html#55010" class="Bound">Γ</a><a id="55011" class="Symbol">}</a> <a id="55013" href="lagda.2023-11-21-nbe.html#55013" class="Bound">t</a> <a id="55015" href="lagda.2023-11-21-nbe.html#55015" class="Bound">𝓊̂</a> <a id="55018" class="Keyword">with</a> <a id="55023" href="lagda.2023-11-21-nbe.html#55015" class="Bound">𝓊̂</a> <a id="55026" href="lagda.2023-11-21-nbe.html#55010" class="Bound">Γ</a>
<a id="55028" class="Symbol">...</a> <a id="55032" class="Symbol">|</a> <a id="55034" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="55039" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="55041" href="lagda.2023-11-21-nbe.html#55041" class="Bound">𝓊</a> <a id="55043" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="55045" class="Symbol">_</a> <a id="55047" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a>   <a id="55051" class="Symbol">=</a> <a id="55053" class="Bound">t</a> <a id="55055" href="lagda.2023-11-21-nbe.html#30253" class="Datatype Operator">==</a> <a id="55058" href="lagda.2023-11-21-nbe.html#55041" class="Bound">𝓊</a>
<a id="55060" class="Symbol">...</a> <a id="55064" class="Symbol">|</a> <a id="55066" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="55071" class="Symbol">_</a>           <a id="55083" class="Symbol">=</a> <a id="55085" href="Data.Empty.html#526" class="Datatype">⊥</a>
</pre>
<!---
<pre class="Agda"><a id="55102" class="Keyword">infix</a> <a id="55108" class="Number">3</a> <a id="55110" href="lagda.2023-11-21-nbe.html#54952" class="Function Operator">_==^_</a>
</pre>--->
<p>Formally, this relation represents the condition <code>Γ ⊢ 𝓊 = 𝓊̂(Γ) : T</code>, meaning
that a term <code>𝓊</code> is definitionally equal to the liftable neutral <code>𝓊̂</code> lifted to
the context <code>Γ</code>.</p>
<p>We also need to define a relation lifting definitional equality to the unit type
with embedded liftable neutrals. If the expression is unit, then this is just
regular definitional equality, and otherwise we reuse definitional equality for
liftable neutrals.</p>
<pre class="Agda"><a id="_==⊤̂_"></a><a id="55568" href="lagda.2023-11-21-nbe.html#55568" class="Function Operator">_==⊤̂_</a> <a id="55575" class="Symbol">:</a> <a id="55577" class="Symbol">∀</a> <a id="55579" class="Symbol">{</a><a id="55580" href="lagda.2023-11-21-nbe.html#55580" class="Bound">Γ</a> <a id="55582" class="Symbol">:</a> <a id="55584" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="55587" class="Symbol">}</a> <a id="55589" class="Symbol">→</a> <a id="55591" href="lagda.2023-11-21-nbe.html#55580" class="Bound">Γ</a> <a id="55593" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="55595" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a> <a id="55597" class="Symbol">→</a> <a id="55599" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="55601" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a> <a id="55603" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a> <a id="55605" class="Symbol">→</a> <a id="55607" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="55611" href="lagda.2023-11-21-nbe.html#55568" class="Function Operator">_==⊤̂_</a> <a id="55618" class="Symbol">{</a><a id="55619" href="lagda.2023-11-21-nbe.html#55619" class="Bound">Γ</a><a id="55620" class="Symbol">}</a> <a id="55622" href="lagda.2023-11-21-nbe.html#55622" class="Bound">t</a> <a id="55624" href="lagda.2023-11-21-nbe.html#43666" class="InductiveConstructor">unit</a>   <a id="55631" class="Symbol">=</a> <a id="55633" href="lagda.2023-11-21-nbe.html#55622" class="Bound">t</a> <a id="55635" href="lagda.2023-11-21-nbe.html#30253" class="Datatype Operator">==</a> <a id="55638" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a>
<a id="55643" href="lagda.2023-11-21-nbe.html#55568" class="Function Operator">_==⊤̂_</a> <a id="55650" class="Symbol">{</a><a id="55651" href="lagda.2023-11-21-nbe.html#55651" class="Bound">Γ</a><a id="55652" class="Symbol">}</a> <a id="55654" href="lagda.2023-11-21-nbe.html#55654" class="Bound">t</a> <a id="55656" class="Symbol">(</a><a id="55657" href="lagda.2023-11-21-nbe.html#43678" class="InductiveConstructor">ne</a> <a id="55660" href="lagda.2023-11-21-nbe.html#55660" class="Bound">𝓊̂</a><a id="55662" class="Symbol">)</a> <a id="55664" class="Symbol">=</a> <a id="55666" href="lagda.2023-11-21-nbe.html#55654" class="Bound">t</a> <a id="55668" href="lagda.2023-11-21-nbe.html#54952" class="Function Operator">==^</a> <a id="55672" href="lagda.2023-11-21-nbe.html#55660" class="Bound">𝓊̂</a>
</pre>
<!---
<pre class="Agda"><a id="55690" class="Keyword">infix</a> <a id="55696" class="Number">3</a> <a id="55698" href="lagda.2023-11-21-nbe.html#55568" class="Function Operator">_==⊤̂_</a>
</pre>--->
<p>This will represent the condition <code>Γ ⊢ t = 𝓋̂(Γ) : 𝟙</code> that we will now see, as we
are ready to begin defining the logical relation <code>Γ ⊢ t : T Ⓡ a</code> inductively on
types. At type <code>𝟙</code>, the relation is defined as:</p>
<pre><code>  Γ ⊢ t : 𝟙 Ⓡ 𝓋̂ ⇔ ∀ Γ′ ≤ Γ. Γ′ ⊢ t = 𝓋̂(Γ′) : 𝟙</code></pre>
<p>In other words, <code>t</code> is logically related to a semantic object <code>𝓋̂ ∈ ⊤̂</code> if and
only if the term is definitionally equal to <code>𝓋̂</code> when lifted to any context <code>Γ′</code>
that is an extension of <code>Γ</code>.</p>
<p>For function types, the relation is defined as:</p>
<pre><code>Γ ⊢ r : S → T Ⓡ f ⇔ ∀ Γ′ ≤ Γ. Γ′ ⊢ s : S Ⓡ a ⇒ Γ′ ⊢ r s : T Ⓡ f(a)</code></pre>
<p>The relation is written so that it sort of expands functions, reducing our proof
that a functional term in STLC is logically related to a function in Agda to
only having to prove that given related arguments, the functional term and the
function in Agda both produce related results. Again, this is generalized over
all extensions of the context <code>Γ</code>. While our final results will only be
concerned with the context <code>Γ</code>, to prove these results we will need the relation
to be strengthened in this way.</p>
<pre class="Agda"><a id="_Ⓡ_"></a><a id="56802" href="lagda.2023-11-21-nbe.html#56802" class="Function Operator">_Ⓡ_</a> <a id="56806" class="Symbol">:</a> <a id="56808" class="Symbol">∀</a> <a id="56810" class="Symbol">{</a><a id="56811" href="lagda.2023-11-21-nbe.html#56811" class="Bound">Γ</a> <a id="56813" class="Symbol">:</a> <a id="56815" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="56818" class="Symbol">}</a> <a id="56820" class="Symbol">{</a><a id="56821" href="lagda.2023-11-21-nbe.html#56821" class="Bound">T</a> <a id="56823" class="Symbol">:</a> <a id="56825" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="56829" class="Symbol">}</a> <a id="56831" class="Symbol">→</a> <a id="56833" href="lagda.2023-11-21-nbe.html#56811" class="Bound">Γ</a> <a id="56835" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="56837" href="lagda.2023-11-21-nbe.html#56821" class="Bound">T</a> <a id="56839" class="Symbol">→</a> <a id="56841" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="56843" href="lagda.2023-11-21-nbe.html#56821" class="Bound">T</a> <a id="56845" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a> <a id="56847" class="Symbol">→</a> <a id="56849" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="56853" href="lagda.2023-11-21-nbe.html#56802" class="Function Operator">_Ⓡ_</a> <a id="56857" class="Symbol">{</a><a id="56858" href="lagda.2023-11-21-nbe.html#56858" class="Bound">Γ</a><a id="56859" class="Symbol">}</a> <a id="56861" class="Symbol">{</a><a id="56862" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a><a id="56863" class="Symbol">}</a> <a id="56865" href="lagda.2023-11-21-nbe.html#56865" class="Bound">t</a> <a id="56867" href="lagda.2023-11-21-nbe.html#56867" class="Bound">𝓋̂</a> <a id="56870" class="Symbol">=</a> <a id="56872" class="Symbol">∀</a> <a id="56874" class="Symbol">{</a><a id="56875" href="lagda.2023-11-21-nbe.html#56875" class="Bound">Γ′</a> <a id="56878" class="Symbol">:</a> <a id="56880" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="56883" class="Symbol">}</a> <a id="56885" class="Symbol">→</a> <a id="56887" class="Symbol">(</a><a id="56888" href="lagda.2023-11-21-nbe.html#56888" class="Bound">Γ′≤Γ</a> <a id="56893" class="Symbol">:</a> <a id="56895" href="lagda.2023-11-21-nbe.html#56875" class="Bound">Γ′</a> <a id="56898" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="56900" href="lagda.2023-11-21-nbe.html#56858" class="Bound">Γ</a><a id="56901" class="Symbol">)</a> <a id="56903" class="Symbol">→</a> <a id="56905" href="lagda.2023-11-21-nbe.html#56888" class="Bound">Γ′≤Γ</a> <a id="56910" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="56913" href="lagda.2023-11-21-nbe.html#56865" class="Bound">t</a> <a id="56915" href="lagda.2023-11-21-nbe.html#55568" class="Function Operator">==⊤̂</a> <a id="56920" href="lagda.2023-11-21-nbe.html#56867" class="Bound">𝓋̂</a>
<a id="56923" href="lagda.2023-11-21-nbe.html#56802" class="Function Operator">_Ⓡ_</a> <a id="56927" class="Symbol">{</a><a id="56928" href="lagda.2023-11-21-nbe.html#56928" class="Bound">Γ</a><a id="56929" class="Symbol">}</a> <a id="56931" class="Symbol">{</a><a id="56932" href="lagda.2023-11-21-nbe.html#56932" class="Bound">S</a> <a id="56934" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="56936" href="lagda.2023-11-21-nbe.html#56936" class="Bound">T</a><a id="56937" class="Symbol">}</a> <a id="56939" href="lagda.2023-11-21-nbe.html#56939" class="Bound">r</a> <a id="56941" href="lagda.2023-11-21-nbe.html#56941" class="Bound">f</a> <a id="56943" class="Symbol">=</a>
    <a id="56949" class="Symbol">∀</a> <a id="56951" class="Symbol">{</a><a id="56952" href="lagda.2023-11-21-nbe.html#56952" class="Bound">Γ′</a> <a id="56955" class="Symbol">:</a> <a id="56957" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="56960" class="Symbol">}</a>
    <a id="56966" class="Symbol">→</a> <a id="56968" class="Symbol">(</a><a id="56969" href="lagda.2023-11-21-nbe.html#56969" class="Bound">Γ′≤Γ</a> <a id="56974" class="Symbol">:</a> <a id="56976" href="lagda.2023-11-21-nbe.html#56952" class="Bound">Γ′</a> <a id="56979" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="56981" href="lagda.2023-11-21-nbe.html#56928" class="Bound">Γ</a><a id="56982" class="Symbol">)</a>
    <a id="56988" class="Symbol">→</a> <a id="56990" class="Symbol">∀</a> <a id="56992" class="Symbol">{</a><a id="56993" href="lagda.2023-11-21-nbe.html#56993" class="Bound">s</a> <a id="56995" class="Symbol">:</a> <a id="56997" href="lagda.2023-11-21-nbe.html#56952" class="Bound">Γ′</a> <a id="57000" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="57002" href="lagda.2023-11-21-nbe.html#56932" class="Bound">S</a><a id="57003" class="Symbol">}</a> <a id="57005" class="Symbol">{</a><a id="57006" href="lagda.2023-11-21-nbe.html#57006" class="Bound">a</a> <a id="57008" class="Symbol">:</a> <a id="57010" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="57012" href="lagda.2023-11-21-nbe.html#56932" class="Bound">S</a> <a id="57014" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a><a id="57015" class="Symbol">}</a>
    <a id="57021" class="Symbol">→</a> <a id="57023" href="lagda.2023-11-21-nbe.html#56993" class="Bound">s</a> <a id="57025" href="lagda.2023-11-21-nbe.html#56802" class="Function Operator">Ⓡ</a> <a id="57027" href="lagda.2023-11-21-nbe.html#57006" class="Bound">a</a>
      <a id="57035" class="Comment">-------------------------</a>
    <a id="57065" class="Symbol">→</a> <a id="57067" class="Symbol">(</a><a id="57068" href="lagda.2023-11-21-nbe.html#56969" class="Bound">Γ′≤Γ</a> <a id="57073" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="57076" href="lagda.2023-11-21-nbe.html#56939" class="Bound">r</a><a id="57077" class="Symbol">)</a> <a id="57079" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="57081" href="lagda.2023-11-21-nbe.html#56993" class="Bound">s</a> <a id="57083" href="lagda.2023-11-21-nbe.html#56802" class="Function Operator">Ⓡ</a> <a id="57085" href="lagda.2023-11-21-nbe.html#56941" class="Bound">f</a> <a id="57087" href="lagda.2023-11-21-nbe.html#57006" class="Bound">a</a>
</pre>
<!---
<pre class="Agda"><a id="57104" class="Keyword">infix</a> <a id="57110" class="Number">4</a> <a id="57112" href="lagda.2023-11-21-nbe.html#56802" class="Function Operator">_Ⓡ_</a>
</pre>--->
<p>As the logical relation between terms and semantic objects is defined using
definitional equality, it is transitive with respect to definitional equality.
This is the first lemma we will prove using equational reasoning for
definitional equality. As for most proofs related to the logical relation <code>Ⓡ</code>
between terms and semantic objects, we prove it by induction on types, and do a
case analysis at type <code>𝟙</code> on the semantic object <code>a ∈ ⊤̂</code>. The proof makes use of
a lemma whose proof has been omitted, <code>cong⁼⁼-sub</code>: if two terms are
definitionally equal , the terms with the same substitution applied are still
definitionally equal.</p>
<pre class="Agda"><a id="cong⁼⁼-sub"></a><a id="57768" href="lagda.2023-11-21-nbe.html#57768" class="Function">cong⁼⁼-sub</a> <a id="57779" class="Symbol">:</a> <a id="57781" class="Symbol">∀</a> <a id="57783" class="Symbol">{</a><a id="57784" href="lagda.2023-11-21-nbe.html#57784" class="Bound">Γ</a> <a id="57786" href="lagda.2023-11-21-nbe.html#57786" class="Bound">Δ</a> <a id="57788" class="Symbol">:</a> <a id="57790" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="57793" class="Symbol">}</a> <a id="57795" class="Symbol">{</a><a id="57796" href="lagda.2023-11-21-nbe.html#57796" class="Bound">T</a> <a id="57798" class="Symbol">:</a> <a id="57800" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="57804" class="Symbol">}</a> <a id="57806" class="Symbol">{</a><a id="57807" href="lagda.2023-11-21-nbe.html#57807" class="Bound">t</a> <a id="57809" href="lagda.2023-11-21-nbe.html#57809" class="Bound">t′</a> <a id="57812" class="Symbol">:</a> <a id="57814" href="lagda.2023-11-21-nbe.html#57784" class="Bound">Γ</a> <a id="57816" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="57818" href="lagda.2023-11-21-nbe.html#57796" class="Bound">T</a><a id="57819" class="Symbol">}</a> <a id="57821" class="Symbol">{</a><a id="57822" href="lagda.2023-11-21-nbe.html#57822" class="Bound">σ</a> <a id="57824" class="Symbol">:</a> <a id="57826" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="57830" href="lagda.2023-11-21-nbe.html#57786" class="Bound">Δ</a> <a id="57832" href="lagda.2023-11-21-nbe.html#57784" class="Bound">Γ</a><a id="57833" class="Symbol">}</a>
          <a id="57845" class="Symbol">→</a> <a id="57847" href="lagda.2023-11-21-nbe.html#57807" class="Bound">t</a> <a id="57849" href="lagda.2023-11-21-nbe.html#30253" class="Datatype Operator">==</a> <a id="57852" href="lagda.2023-11-21-nbe.html#57809" class="Bound">t′</a>
          <a id="57865" class="Symbol">→</a> <a id="57867" href="lagda.2023-11-21-nbe.html#57807" class="Bound">t</a> <a id="57869" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="57871" href="lagda.2023-11-21-nbe.html#57822" class="Bound">σ</a> <a id="57873" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a> <a id="57875" href="lagda.2023-11-21-nbe.html#30253" class="Datatype Operator">==</a> <a id="57878" href="lagda.2023-11-21-nbe.html#57809" class="Bound">t′</a> <a id="57881" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="57883" href="lagda.2023-11-21-nbe.html#57822" class="Bound">σ</a> <a id="57885" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a>
</pre>
<!---
<pre class="Agda">
<a id="57907" href="lagda.2023-11-21-nbe.html#57768" class="Function">cong⁼⁼-sub</a> <a id="57918" class="Symbol">{</a><a id="57919" class="Argument">σ</a> <a id="57921" class="Symbol">=</a> <a id="57923" href="lagda.2023-11-21-nbe.html#57923" class="Bound">σ</a><a id="57924" class="Symbol">}</a> <a id="57926" class="Symbol">(</a><a id="57927" href="lagda.2023-11-21-nbe.html#30351" class="InductiveConstructor">β</a> <a id="57929" class="Symbol">{</a><a id="57930" class="Argument">t</a> <a id="57932" class="Symbol">=</a> <a id="57934" href="lagda.2023-11-21-nbe.html#57934" class="Bound">t</a><a id="57935" class="Symbol">}</a> <a id="57937" class="Symbol">{</a><a id="57938" href="lagda.2023-11-21-nbe.html#57938" class="Bound">s</a><a id="57939" class="Symbol">})</a>
  <a id="57944" class="Keyword">rewrite</a> <a id="57952" href="lagda.2023-11-21-nbe.html#25552" class="Function">sub-sub</a> <a id="57960" class="Symbol">{</a><a id="57961" class="Argument">τ</a> <a id="57963" class="Symbol">=</a> <a id="57965" href="lagda.2023-11-21-nbe.html#57923" class="Bound">σ</a><a id="57966" class="Symbol">}</a> <a id="57968" class="Symbol">{</a><a id="57969" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="57972" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="57974" href="lagda.2023-11-21-nbe.html#57938" class="Bound">s</a><a id="57975" class="Symbol">}</a> <a id="57977" class="Symbol">{</a><a id="57978" href="lagda.2023-11-21-nbe.html#57934" class="Bound">t</a><a id="57979" class="Symbol">}</a> <a id="57981" class="Symbol">=</a>
  <a id="57985" href="lagda.2023-11-21-nbe.html#31311" class="InductiveConstructor">trans⁼⁼</a>
    <a id="57997" href="lagda.2023-11-21-nbe.html#30351" class="InductiveConstructor">β</a>
    <a id="58003" class="Symbol">(</a><a id="58004" href="lagda.2023-11-21-nbe.html#32480" class="Function">≡→==</a>
      <a id="58015" class="Symbol">(</a><a id="58016" href="Relation.Binary.PropositionalEquality.Core.html#1729" class="Function">trans</a>
        <a id="58030" class="Symbol">(</a><a id="58031" href="lagda.2023-11-21-nbe.html#25552" class="Function">sub-sub</a> <a id="58039" class="Symbol">{</a><a id="58040" class="Argument">t</a> <a id="58042" class="Symbol">=</a> <a id="58044" href="lagda.2023-11-21-nbe.html#57934" class="Bound">t</a><a id="58045" class="Symbol">})</a>
        <a id="58056" class="Symbol">(</a><a id="58057" href="lagda.2023-11-21-nbe.html#19474" class="Function">cong-sub</a> <a id="58066" class="Symbol">{</a><a id="58067" class="Argument">t</a> <a id="58069" class="Symbol">=</a> <a id="58071" href="lagda.2023-11-21-nbe.html#57934" class="Bound">t</a><a id="58072" class="Symbol">}</a>
          <a id="58084" class="Symbol">(</a><a id="58085" href="Relation.Binary.PropositionalEquality.Core.html#1729" class="Function">trans</a>
            <a id="58103" href="lagda.2023-11-21-nbe.html#26389" class="Function">subst-zero-exts-cons</a>
            <a id="58136" class="Symbol">(</a><a id="58137" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="58141" href="lagda.2023-11-21-nbe.html#17953" class="Function">sub-dist</a><a id="58149" class="Symbol">))</a>
          <a id="58162" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="58166" class="Symbol">)))</a>
<a id="58170" href="lagda.2023-11-21-nbe.html#57768" class="Function">cong⁼⁼-sub</a> <a id="58181" class="Symbol">{</a><a id="58182" href="lagda.2023-11-21-nbe.html#58182" class="Bound">Γ</a><a id="58183" class="Symbol">}</a> <a id="58185" class="Symbol">{</a><a id="58186" class="Argument">T</a> <a id="58188" class="Symbol">=</a> <a id="58190" href="lagda.2023-11-21-nbe.html#58190" class="Bound">S</a> <a id="58192" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="58194" href="lagda.2023-11-21-nbe.html#58194" class="Bound">T</a><a id="58195" class="Symbol">}</a> <a id="58197" class="Symbol">{</a><a id="58198" href="lagda.2023-11-21-nbe.html#58198" class="Bound">t</a><a id="58199" class="Symbol">}</a> <a id="58201" class="Symbol">{</a><a id="58202" class="Argument">σ</a> <a id="58204" class="Symbol">=</a> <a id="58206" href="lagda.2023-11-21-nbe.html#58206" class="Bound">σ</a><a id="58207" class="Symbol">}</a> <a id="58209" href="lagda.2023-11-21-nbe.html#30573" class="InductiveConstructor">η</a>
  <a id="58213" class="Keyword">rewrite</a> <a id="58221" href="lagda.2023-11-21-nbe.html#25552" class="Function">sub-sub</a> <a id="58229" class="Symbol">{</a><a id="58230" class="Argument">τ</a> <a id="58232" class="Symbol">=</a> <a id="58234" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="58239" href="lagda.2023-11-21-nbe.html#58206" class="Bound">σ</a><a id="58240" class="Symbol">}</a> <a id="58242" class="Symbol">{</a><a id="58243" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a> <a id="58245" class="Symbol">{</a><a id="58246" class="Argument">T</a> <a id="58248" class="Symbol">=</a> <a id="58250" href="lagda.2023-11-21-nbe.html#58190" class="Bound">S</a><a id="58251" class="Symbol">}}</a> <a id="58254" class="Symbol">{</a><a id="58255" href="lagda.2023-11-21-nbe.html#58198" class="Bound">t</a><a id="58256" class="Symbol">}</a> <a id="58258" class="Symbol">=</a>
  <a id="58262" href="lagda.2023-11-21-nbe.html#31311" class="InductiveConstructor">trans⁼⁼</a>
    <a id="58274" href="lagda.2023-11-21-nbe.html#30573" class="InductiveConstructor">η</a>
    <a id="58280" class="Symbol">(</a><a id="58281" href="lagda.2023-11-21-nbe.html#30709" class="InductiveConstructor">abs-compatible</a>
      <a id="58302" class="Symbol">(</a><a id="58303" href="lagda.2023-11-21-nbe.html#30868" class="InductiveConstructor">app-compatible</a>
        <a id="58326" class="Symbol">(</a><a id="58327" href="lagda.2023-11-21-nbe.html#32480" class="Function">≡→==</a>
          <a id="58342" class="Symbol">(</a><a id="58343" href="Relation.Binary.PropositionalEquality.Core.html#1729" class="Function">trans</a>
            <a id="58361" class="Symbol">(</a><a id="58362" href="lagda.2023-11-21-nbe.html#25552" class="Function">sub-sub</a> <a id="58370" class="Symbol">{</a><a id="58371" class="Argument">τ</a> <a id="58373" class="Symbol">=</a> <a id="58375" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a><a id="58376" class="Symbol">}</a> <a id="58378" class="Symbol">{</a><a id="58379" href="lagda.2023-11-21-nbe.html#58206" class="Bound">σ</a><a id="58380" class="Symbol">}</a> <a id="58382" class="Symbol">{</a><a id="58383" href="lagda.2023-11-21-nbe.html#58198" class="Bound">t</a><a id="58384" class="Symbol">})</a>
            <a id="58399" class="Symbol">(</a><a id="58400" href="lagda.2023-11-21-nbe.html#19474" class="Function">cong-sub</a> <a id="58409" class="Symbol">{</a><a id="58410" class="Argument">t</a> <a id="58412" class="Symbol">=</a> <a id="58414" href="lagda.2023-11-21-nbe.html#58198" class="Bound">t</a><a id="58415" class="Symbol">}</a> <a id="58417" class="Symbol">(</a><a id="58418" href="lagda.2023-11-21-nbe.html#2744" class="Postulate">extensionality</a> <a id="58433" class="Symbol">λ{_</a> <a id="58437" class="Symbol">→</a> <a id="58439" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="58443" href="lagda.2023-11-21-nbe.html#21848" class="Function">rename-shift</a><a id="58455" class="Symbol">})</a> <a id="58458" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="58462" class="Symbol">)))</a>
        <a id="58474" href="lagda.2023-11-21-nbe.html#31125" class="InductiveConstructor">refl⁼⁼</a><a id="58480" class="Symbol">))</a>
<a id="58483" href="lagda.2023-11-21-nbe.html#57768" class="Function">cong⁼⁼-sub</a> <a id="58494" class="Symbol">(</a><a id="58495" href="lagda.2023-11-21-nbe.html#30709" class="InductiveConstructor">abs-compatible</a> <a id="58510" href="lagda.2023-11-21-nbe.html#58510" class="Bound">t==t′</a><a id="58515" class="Symbol">)</a> <a id="58517" class="Symbol">=</a> <a id="58519" href="lagda.2023-11-21-nbe.html#30709" class="InductiveConstructor">abs-compatible</a> <a id="58534" class="Symbol">(</a><a id="58535" href="lagda.2023-11-21-nbe.html#57768" class="Function">cong⁼⁼-sub</a> <a id="58546" href="lagda.2023-11-21-nbe.html#58510" class="Bound">t==t′</a><a id="58551" class="Symbol">)</a>
<a id="58553" href="lagda.2023-11-21-nbe.html#57768" class="Function">cong⁼⁼-sub</a> <a id="58564" class="Symbol">(</a><a id="58565" href="lagda.2023-11-21-nbe.html#30868" class="InductiveConstructor">app-compatible</a> <a id="58580" href="lagda.2023-11-21-nbe.html#58580" class="Bound">r==r′</a> <a id="58586" href="lagda.2023-11-21-nbe.html#58586" class="Bound">s==s′</a><a id="58591" class="Symbol">)</a> <a id="58593" class="Symbol">=</a>
  <a id="58597" href="lagda.2023-11-21-nbe.html#30868" class="InductiveConstructor">app-compatible</a> <a id="58612" class="Symbol">(</a><a id="58613" href="lagda.2023-11-21-nbe.html#57768" class="Function">cong⁼⁼-sub</a> <a id="58624" href="lagda.2023-11-21-nbe.html#58580" class="Bound">r==r′</a><a id="58629" class="Symbol">)</a> <a id="58631" class="Symbol">(</a><a id="58632" href="lagda.2023-11-21-nbe.html#57768" class="Function">cong⁼⁼-sub</a> <a id="58643" href="lagda.2023-11-21-nbe.html#58586" class="Bound">s==s′</a><a id="58648" class="Symbol">)</a>
<a id="58650" href="lagda.2023-11-21-nbe.html#57768" class="Function">cong⁼⁼-sub</a> <a id="58661" href="lagda.2023-11-21-nbe.html#31125" class="InductiveConstructor">refl⁼⁼</a> <a id="58668" class="Symbol">=</a> <a id="58670" href="lagda.2023-11-21-nbe.html#31125" class="InductiveConstructor">refl⁼⁼</a>
<a id="58677" href="lagda.2023-11-21-nbe.html#57768" class="Function">cong⁼⁼-sub</a> <a id="58688" class="Symbol">(</a><a id="58689" href="lagda.2023-11-21-nbe.html#31208" class="InductiveConstructor">sym⁼⁼</a> <a id="58695" href="lagda.2023-11-21-nbe.html#58695" class="Bound">t==t′</a><a id="58700" class="Symbol">)</a> <a id="58702" class="Symbol">=</a> <a id="58704" href="lagda.2023-11-21-nbe.html#31208" class="InductiveConstructor">sym⁼⁼</a> <a id="58710" class="Symbol">(</a><a id="58711" href="lagda.2023-11-21-nbe.html#57768" class="Function">cong⁼⁼-sub</a> <a id="58722" href="lagda.2023-11-21-nbe.html#58695" class="Bound">t==t′</a><a id="58727" class="Symbol">)</a>
<a id="58729" href="lagda.2023-11-21-nbe.html#57768" class="Function">cong⁼⁼-sub</a> <a id="58740" class="Symbol">(</a><a id="58741" href="lagda.2023-11-21-nbe.html#31311" class="InductiveConstructor">trans⁼⁼</a> <a id="58749" href="lagda.2023-11-21-nbe.html#58749" class="Bound">t₁==t₂</a> <a id="58756" href="lagda.2023-11-21-nbe.html#58756" class="Bound">t₂==t₃</a><a id="58762" class="Symbol">)</a> <a id="58764" class="Symbol">=</a> <a id="58766" href="lagda.2023-11-21-nbe.html#31311" class="InductiveConstructor">trans⁼⁼</a> <a id="58774" class="Symbol">(</a><a id="58775" href="lagda.2023-11-21-nbe.html#57768" class="Function">cong⁼⁼-sub</a> <a id="58786" href="lagda.2023-11-21-nbe.html#58749" class="Bound">t₁==t₂</a><a id="58792" class="Symbol">)</a> <a id="58794" class="Symbol">(</a><a id="58795" href="lagda.2023-11-21-nbe.html#57768" class="Function">cong⁼⁼-sub</a> <a id="58806" href="lagda.2023-11-21-nbe.html#58756" class="Bound">t₂==t₃</a><a id="58812" class="Symbol">)</a>
</pre>--->
<pre class="Agda"><a id="==-Ⓡ-trans"></a><a id="58832" href="lagda.2023-11-21-nbe.html#58832" class="Function">==-Ⓡ-trans</a> <a id="58843" class="Symbol">:</a> <a id="58845" class="Symbol">∀</a> <a id="58847" class="Symbol">{</a><a id="58848" href="lagda.2023-11-21-nbe.html#58848" class="Bound">Γ</a> <a id="58850" class="Symbol">:</a> <a id="58852" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="58855" class="Symbol">}</a> <a id="58857" class="Symbol">{</a><a id="58858" href="lagda.2023-11-21-nbe.html#58858" class="Bound">T</a> <a id="58860" class="Symbol">:</a> <a id="58862" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="58866" class="Symbol">}</a> <a id="58868" class="Symbol">{</a><a id="58869" href="lagda.2023-11-21-nbe.html#58869" class="Bound">t</a> <a id="58871" href="lagda.2023-11-21-nbe.html#58871" class="Bound">t′</a> <a id="58874" class="Symbol">:</a> <a id="58876" href="lagda.2023-11-21-nbe.html#58848" class="Bound">Γ</a> <a id="58878" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="58880" href="lagda.2023-11-21-nbe.html#58858" class="Bound">T</a><a id="58881" class="Symbol">}</a> <a id="58883" class="Symbol">{</a><a id="58884" href="lagda.2023-11-21-nbe.html#58884" class="Bound">a</a> <a id="58886" class="Symbol">:</a> <a id="58888" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="58890" href="lagda.2023-11-21-nbe.html#58858" class="Bound">T</a> <a id="58892" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a><a id="58893" class="Symbol">}</a>
           <a id="58906" class="Symbol">→</a> <a id="58908" href="lagda.2023-11-21-nbe.html#58869" class="Bound">t</a> <a id="58910" href="lagda.2023-11-21-nbe.html#30253" class="Datatype Operator">==</a> <a id="58913" href="lagda.2023-11-21-nbe.html#58871" class="Bound">t′</a>
           <a id="58927" class="Symbol">→</a> <a id="58929" href="lagda.2023-11-21-nbe.html#58869" class="Bound">t</a> <a id="58931" href="lagda.2023-11-21-nbe.html#56802" class="Function Operator">Ⓡ</a> <a id="58933" href="lagda.2023-11-21-nbe.html#58884" class="Bound">a</a>
             <a id="58948" class="Comment">-------</a>
           <a id="58967" class="Symbol">→</a> <a id="58969" href="lagda.2023-11-21-nbe.html#58871" class="Bound">t′</a> <a id="58972" href="lagda.2023-11-21-nbe.html#56802" class="Function Operator">Ⓡ</a> <a id="58974" href="lagda.2023-11-21-nbe.html#58884" class="Bound">a</a>
<a id="58976" href="lagda.2023-11-21-nbe.html#58832" class="Function">==-Ⓡ-trans</a> <a id="58987" class="Symbol">{</a><a id="58988" class="Argument">T</a> <a id="58990" class="Symbol">=</a> <a id="58992" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a><a id="58993" class="Symbol">}</a> <a id="58995" class="Symbol">{</a><a id="58996" href="lagda.2023-11-21-nbe.html#58996" class="Bound">t</a><a id="58997" class="Symbol">}</a> <a id="58999" class="Symbol">{</a><a id="59000" href="lagda.2023-11-21-nbe.html#59000" class="Bound">t′</a><a id="59002" class="Symbol">}</a> <a id="59004" class="Symbol">{</a><a id="59005" href="lagda.2023-11-21-nbe.html#43666" class="InductiveConstructor">unit</a><a id="59009" class="Symbol">}</a> <a id="59011" href="lagda.2023-11-21-nbe.html#59011" class="Bound">t==t′</a> <a id="59017" href="lagda.2023-11-21-nbe.html#59017" class="Bound">pf</a> <a id="59020" href="lagda.2023-11-21-nbe.html#59020" class="Bound">Γ′≤Γ</a> <a id="59025" class="Symbol">=</a>
  <a id="59029" href="lagda.2023-11-21-nbe.html#31874" class="Function Operator">begin==</a>
    <a id="59041" href="lagda.2023-11-21-nbe.html#59020" class="Bound">Γ′≤Γ</a> <a id="59046" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="59049" href="lagda.2023-11-21-nbe.html#59000" class="Bound">t′</a>
  <a id="59054" href="lagda.2023-11-21-nbe.html#32007" class="Function Operator">==⟨</a> <a id="59058" href="lagda.2023-11-21-nbe.html#31208" class="InductiveConstructor">sym⁼⁼</a> <a id="59064" class="Symbol">(</a><a id="59065" href="lagda.2023-11-21-nbe.html#57768" class="Function">cong⁼⁼-sub</a> <a id="59076" href="lagda.2023-11-21-nbe.html#59011" class="Bound">t==t′</a><a id="59081" class="Symbol">)</a> <a id="59083" href="lagda.2023-11-21-nbe.html#32007" class="Function Operator">⟩</a>
    <a id="59089" href="lagda.2023-11-21-nbe.html#59020" class="Bound">Γ′≤Γ</a> <a id="59094" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="59097" href="lagda.2023-11-21-nbe.html#58996" class="Bound">t</a>
  <a id="59101" href="lagda.2023-11-21-nbe.html#32007" class="Function Operator">==⟨</a> <a id="59105" href="lagda.2023-11-21-nbe.html#59017" class="Bound">pf</a> <a id="59108" href="lagda.2023-11-21-nbe.html#59020" class="Bound">Γ′≤Γ</a> <a id="59113" href="lagda.2023-11-21-nbe.html#32007" class="Function Operator">⟩</a>
    <a id="59119" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a>
  <a id="59126" href="lagda.2023-11-21-nbe.html#32215" class="Function Operator">==∎</a>
<a id="59130" href="lagda.2023-11-21-nbe.html#58832" class="Function">==-Ⓡ-trans</a> <a id="59141" class="Symbol">{</a><a id="59142" class="Argument">T</a> <a id="59144" class="Symbol">=</a> <a id="59146" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a><a id="59147" class="Symbol">}</a> <a id="59149" class="Symbol">{</a><a id="59150" href="lagda.2023-11-21-nbe.html#59150" class="Bound">t</a><a id="59151" class="Symbol">}</a> <a id="59153" class="Symbol">{</a><a id="59154" href="lagda.2023-11-21-nbe.html#59154" class="Bound">t′</a><a id="59156" class="Symbol">}</a> <a id="59158" class="Symbol">{</a><a id="59159" href="lagda.2023-11-21-nbe.html#43678" class="InductiveConstructor">ne</a> <a id="59162" href="lagda.2023-11-21-nbe.html#59162" class="Bound">𝓊̂</a><a id="59164" class="Symbol">}</a> <a id="59166" href="lagda.2023-11-21-nbe.html#59166" class="Bound">t==t′</a> <a id="59172" href="lagda.2023-11-21-nbe.html#59172" class="Bound">pf</a> <a id="59175" class="Symbol">{</a><a id="59176" href="lagda.2023-11-21-nbe.html#59176" class="Bound">Γ′</a><a id="59178" class="Symbol">}</a> <a id="59180" href="lagda.2023-11-21-nbe.html#59180" class="Bound">Γ′≤Γ</a>
  <a id="59187" class="Keyword">with</a> <a id="59192" href="lagda.2023-11-21-nbe.html#59162" class="Bound">𝓊̂</a> <a id="59195" href="lagda.2023-11-21-nbe.html#59176" class="Bound">Γ′</a>          <a id="59207" class="Symbol">|</a> <a id="59209" href="lagda.2023-11-21-nbe.html#59172" class="Bound">pf</a> <a id="59212" href="lagda.2023-11-21-nbe.html#59180" class="Bound">Γ′≤Γ</a>
<a id="59217" class="Symbol">...</a> <a id="59221" class="Symbol">|</a> <a id="59223" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="59228" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="59230" href="lagda.2023-11-21-nbe.html#59230" class="Bound">𝓊</a> <a id="59232" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="59234" class="Symbol">_</a> <a id="59236" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a> <a id="59238" class="Symbol">|</a> <a id="59240" href="lagda.2023-11-21-nbe.html#59240" class="Bound">t==𝓊</a>    <a id="59248" class="Symbol">=</a>
  <a id="59252" href="lagda.2023-11-21-nbe.html#31874" class="Function Operator">begin==</a>
    <a id="59264" class="Bound">Γ′≤Γ</a> <a id="59269" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="59272" class="Bound">t′</a>
  <a id="59277" href="lagda.2023-11-21-nbe.html#32007" class="Function Operator">==⟨</a> <a id="59281" href="lagda.2023-11-21-nbe.html#31208" class="InductiveConstructor">sym⁼⁼</a> <a id="59287" class="Symbol">(</a><a id="59288" href="lagda.2023-11-21-nbe.html#57768" class="Function">cong⁼⁼-sub</a> <a id="59299" class="Bound">t==t′</a><a id="59304" class="Symbol">)</a> <a id="59306" href="lagda.2023-11-21-nbe.html#32007" class="Function Operator">⟩</a>
    <a id="59312" class="Bound">Γ′≤Γ</a> <a id="59317" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="59320" class="Bound">t</a>
  <a id="59324" href="lagda.2023-11-21-nbe.html#32007" class="Function Operator">==⟨</a> <a id="59328" href="lagda.2023-11-21-nbe.html#59240" class="Bound">t==𝓊</a> <a id="59333" href="lagda.2023-11-21-nbe.html#32007" class="Function Operator">⟩</a>
    <a id="59339" href="lagda.2023-11-21-nbe.html#59230" class="Bound">𝓊</a>
  <a id="59343" href="lagda.2023-11-21-nbe.html#32215" class="Function Operator">==∎</a>
<a id="59347" href="lagda.2023-11-21-nbe.html#58832" class="Function">==-Ⓡ-trans</a> <a id="59358" class="Symbol">{</a><a id="59359" class="Argument">T</a> <a id="59361" class="Symbol">=</a> <a id="59363" href="lagda.2023-11-21-nbe.html#59363" class="Bound">S</a> <a id="59365" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="59367" href="lagda.2023-11-21-nbe.html#59367" class="Bound">T</a><a id="59368" class="Symbol">}</a> <a id="59370" class="Symbol">{</a><a id="59371" href="lagda.2023-11-21-nbe.html#59371" class="Bound">r</a><a id="59372" class="Symbol">}</a> <a id="59374" class="Symbol">{</a><a id="59375" href="lagda.2023-11-21-nbe.html#59375" class="Bound">r′</a><a id="59377" class="Symbol">}</a> <a id="59379" href="lagda.2023-11-21-nbe.html#59379" class="Bound">r==r′</a> <a id="59385" href="lagda.2023-11-21-nbe.html#59385" class="Bound">pf</a> <a id="59388" href="lagda.2023-11-21-nbe.html#59388" class="Bound">Γ′≤Γ</a> <a id="59393" href="lagda.2023-11-21-nbe.html#59393" class="Bound">sⓇa</a> <a id="59397" class="Symbol">=</a>
  <a id="59401" href="lagda.2023-11-21-nbe.html#58832" class="Function">==-Ⓡ-trans</a> <a id="59412" href="lagda.2023-11-21-nbe.html#59441" class="Function">r·s==r′·s</a> <a id="59422" href="lagda.2023-11-21-nbe.html#59498" class="Function">r·sⓇfa</a>
  <a id="59431" class="Keyword">where</a>
    <a id="59441" href="lagda.2023-11-21-nbe.html#59441" class="Function">r·s==r′·s</a> <a id="59451" class="Symbol">=</a> <a id="59453" href="lagda.2023-11-21-nbe.html#30868" class="InductiveConstructor">app-compatible</a> <a id="59468" class="Symbol">(</a><a id="59469" href="lagda.2023-11-21-nbe.html#57768" class="Function">cong⁼⁼-sub</a> <a id="59480" href="lagda.2023-11-21-nbe.html#59379" class="Bound">r==r′</a><a id="59485" class="Symbol">)</a> <a id="59487" href="lagda.2023-11-21-nbe.html#31125" class="InductiveConstructor">refl⁼⁼</a>
    <a id="59498" href="lagda.2023-11-21-nbe.html#59498" class="Function">r·sⓇfa</a> <a id="59505" class="Symbol">=</a> <a id="59507" href="lagda.2023-11-21-nbe.html#59385" class="Bound">pf</a> <a id="59510" href="lagda.2023-11-21-nbe.html#59388" class="Bound">Γ′≤Γ</a> <a id="59515" href="lagda.2023-11-21-nbe.html#59393" class="Bound">sⓇa</a>
</pre>
<p>Additionally, because we have defined the relation so that its implication holds
for all extensions of a context, we can “weaken” the logical relation
<code>Γ ⊢ t : T Ⓡ a</code> for all <code>Γ′ ≤ Γ</code>, having that <code>Γ′ ⊢ t : T Ⓡ a</code> holds as well.
For this proof, we use another lemma whose proof has also been omitted,
<code>compose-weaken</code>: weakening a term <code>t</code> twice is equivalent to weakening it once
with a composed weakening substitution.</p>
<!---
<pre class="Agda"><a id="compose-ρ-≤"></a><a id="59960" href="lagda.2023-11-21-nbe.html#59960" class="Function">compose-ρ-≤</a> <a id="59972" class="Symbol">:</a> <a id="59974" class="Symbol">∀</a> <a id="59976" class="Symbol">{</a><a id="59977" href="lagda.2023-11-21-nbe.html#59977" class="Bound">Γ″</a> <a id="59980" href="lagda.2023-11-21-nbe.html#59980" class="Bound">Γ′</a> <a id="59983" href="lagda.2023-11-21-nbe.html#59983" class="Bound">Γ</a> <a id="59985" class="Symbol">:</a> <a id="59987" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="59990" class="Symbol">}</a> <a id="59992" class="Symbol">{</a><a id="59993" href="lagda.2023-11-21-nbe.html#59993" class="Bound">T</a> <a id="59995" class="Symbol">:</a> <a id="59997" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="60001" class="Symbol">}</a>
            <a id="60015" class="Symbol">→</a> <a id="60017" class="Symbol">(</a><a id="60018" href="lagda.2023-11-21-nbe.html#60018" class="Bound">Γ″≤Γ′</a> <a id="60024" class="Symbol">:</a> <a id="60026" href="lagda.2023-11-21-nbe.html#59977" class="Bound">Γ″</a> <a id="60029" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="60031" href="lagda.2023-11-21-nbe.html#59980" class="Bound">Γ′</a><a id="60033" class="Symbol">)</a>
            <a id="60047" class="Symbol">→</a> <a id="60049" class="Symbol">(</a><a id="60050" href="lagda.2023-11-21-nbe.html#60050" class="Bound">Γ′≤Γ</a> <a id="60055" class="Symbol">:</a> <a id="60057" href="lagda.2023-11-21-nbe.html#59980" class="Bound">Γ′</a> <a id="60060" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="60062" href="lagda.2023-11-21-nbe.html#59983" class="Bound">Γ</a><a id="60063" class="Symbol">)</a>
            <a id="60077" class="Symbol">→</a> <a id="60079" class="Symbol">(</a><a id="60080" href="lagda.2023-11-21-nbe.html#60080" class="Bound">x</a> <a id="60082" class="Symbol">:</a> <a id="60084" href="lagda.2023-11-21-nbe.html#59983" class="Bound">Γ</a> <a id="60086" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="60088" href="lagda.2023-11-21-nbe.html#59993" class="Bound">T</a><a id="60089" class="Symbol">)</a>
            <a id="60103" class="Symbol">→</a> <a id="60105" href="lagda.2023-11-21-nbe.html#13819" class="Function">ρ-≤</a> <a id="60109" href="lagda.2023-11-21-nbe.html#60018" class="Bound">Γ″≤Γ′</a> <a id="60115" class="Symbol">(</a><a id="60116" href="lagda.2023-11-21-nbe.html#13819" class="Function">ρ-≤</a> <a id="60120" href="lagda.2023-11-21-nbe.html#60050" class="Bound">Γ′≤Γ</a> <a id="60125" href="lagda.2023-11-21-nbe.html#60080" class="Bound">x</a><a id="60126" class="Symbol">)</a> <a id="60128" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="60130" href="lagda.2023-11-21-nbe.html#13819" class="Function">ρ-≤</a> <a id="60134" class="Symbol">(</a><a id="60135" href="lagda.2023-11-21-nbe.html#9166" class="Function">≤-trans</a> <a id="60143" href="lagda.2023-11-21-nbe.html#60018" class="Bound">Γ″≤Γ′</a> <a id="60149" href="lagda.2023-11-21-nbe.html#60050" class="Bound">Γ′≤Γ</a><a id="60153" class="Symbol">)</a> <a id="60155" href="lagda.2023-11-21-nbe.html#60080" class="Bound">x</a>
<a id="60157" href="lagda.2023-11-21-nbe.html#59960" class="Function">compose-ρ-≤</a> <a id="60169" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a> <a id="60174" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a> <a id="60179" class="Symbol">_</a>                    <a id="60200" class="Symbol">=</a> <a id="60202" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="60207" href="lagda.2023-11-21-nbe.html#59960" class="Function">compose-ρ-≤</a> <a id="60219" class="Symbol">(</a><a id="60220" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="60226" class="Symbol">_)</a> <a id="60229" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a> <a id="60234" class="Symbol">_</a>               <a id="60250" class="Symbol">=</a> <a id="60252" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="60257" href="lagda.2023-11-21-nbe.html#59960" class="Function">compose-ρ-≤</a> <a id="60269" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a> <a id="60274" class="Symbol">(</a><a id="60275" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="60281" class="Symbol">_)</a> <a id="60284" class="Symbol">_</a>               <a id="60300" class="Symbol">=</a> <a id="60302" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="60307" href="lagda.2023-11-21-nbe.html#59960" class="Function">compose-ρ-≤</a> <a id="60319" class="Symbol">(</a><a id="60320" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="60326" href="lagda.2023-11-21-nbe.html#60326" class="Bound">Γ″≤Γ′</a><a id="60331" class="Symbol">)</a> <a id="60333" class="Symbol">(</a><a id="60334" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="60340" href="lagda.2023-11-21-nbe.html#60340" class="Bound">Γ′≤Γ</a><a id="60344" class="Symbol">)</a> <a id="60346" href="lagda.2023-11-21-nbe.html#60346" class="Bound">x</a>
  <a id="60350" class="Keyword">rewrite</a> <a id="60358" href="lagda.2023-11-21-nbe.html#59960" class="Function">compose-ρ-≤</a> <a id="60370" href="lagda.2023-11-21-nbe.html#60326" class="Bound">Γ″≤Γ′</a><a id="60375" class="Symbol">(</a><a id="60376" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="60382" href="lagda.2023-11-21-nbe.html#60340" class="Bound">Γ′≤Γ</a><a id="60386" class="Symbol">)</a> <a id="60388" href="lagda.2023-11-21-nbe.html#60346" class="Bound">x</a>  <a id="60391" class="Symbol">=</a> <a id="60393" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

</pre>--->
<pre class="Agda"><a id="compose-weaken"></a><a id="60417" href="lagda.2023-11-21-nbe.html#60417" class="Function">compose-weaken</a> <a id="60432" class="Symbol">:</a> <a id="60434" class="Symbol">∀</a> <a id="60436" class="Symbol">{</a><a id="60437" href="lagda.2023-11-21-nbe.html#60437" class="Bound">Γ″</a> <a id="60440" href="lagda.2023-11-21-nbe.html#60440" class="Bound">Γ′</a> <a id="60443" href="lagda.2023-11-21-nbe.html#60443" class="Bound">Γ</a> <a id="60445" class="Symbol">:</a> <a id="60447" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="60450" class="Symbol">}</a> <a id="60452" class="Symbol">{</a><a id="60453" href="lagda.2023-11-21-nbe.html#60453" class="Bound">T</a> <a id="60455" class="Symbol">:</a> <a id="60457" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="60461" class="Symbol">}</a>
               <a id="60478" class="Symbol">→</a> <a id="60480" class="Symbol">(</a><a id="60481" href="lagda.2023-11-21-nbe.html#60481" class="Bound">Γ″≤Γ′</a> <a id="60487" class="Symbol">:</a> <a id="60489" href="lagda.2023-11-21-nbe.html#60437" class="Bound">Γ″</a> <a id="60492" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="60494" href="lagda.2023-11-21-nbe.html#60440" class="Bound">Γ′</a><a id="60496" class="Symbol">)</a>
               <a id="60513" class="Symbol">→</a> <a id="60515" class="Symbol">(</a><a id="60516" href="lagda.2023-11-21-nbe.html#60516" class="Bound">Γ′≤Γ</a> <a id="60521" class="Symbol">:</a> <a id="60523" href="lagda.2023-11-21-nbe.html#60440" class="Bound">Γ′</a> <a id="60526" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="60528" href="lagda.2023-11-21-nbe.html#60443" class="Bound">Γ</a><a id="60529" class="Symbol">)</a>
               <a id="60546" class="Symbol">→</a> <a id="60548" class="Symbol">(</a><a id="60549" href="lagda.2023-11-21-nbe.html#60549" class="Bound">t</a> <a id="60551" class="Symbol">:</a> <a id="60553" href="lagda.2023-11-21-nbe.html#60443" class="Bound">Γ</a> <a id="60555" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="60557" href="lagda.2023-11-21-nbe.html#60453" class="Bound">T</a><a id="60558" class="Symbol">)</a>
               <a id="60575" class="Symbol">→</a> <a id="60577" href="lagda.2023-11-21-nbe.html#60481" class="Bound">Γ″≤Γ′</a> <a id="60583" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="60586" href="lagda.2023-11-21-nbe.html#60516" class="Bound">Γ′≤Γ</a> <a id="60591" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="60594" href="lagda.2023-11-21-nbe.html#60549" class="Bound">t</a> <a id="60596" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="60598" class="Symbol">(</a><a id="60599" href="lagda.2023-11-21-nbe.html#9166" class="Function">≤-trans</a> <a id="60607" href="lagda.2023-11-21-nbe.html#60481" class="Bound">Γ″≤Γ′</a> <a id="60613" href="lagda.2023-11-21-nbe.html#60516" class="Bound">Γ′≤Γ</a><a id="60617" class="Symbol">)</a> <a id="60619" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="60622" href="lagda.2023-11-21-nbe.html#60549" class="Bound">t</a>
</pre>
<!---
<pre class="Agda"><a id="60643" href="lagda.2023-11-21-nbe.html#60417" class="Function">compose-weaken</a> <a id="60658" href="lagda.2023-11-21-nbe.html#60658" class="Bound">Γ″≤Γ′</a> <a id="60664" href="lagda.2023-11-21-nbe.html#60664" class="Bound">Γ′≤Γ</a> <a id="60669" href="lagda.2023-11-21-nbe.html#60669" class="Bound">t</a>
  <a id="60673" class="Keyword">rewrite</a> <a id="60681" href="lagda.2023-11-21-nbe.html#25552" class="Function">sub-sub</a> <a id="60689" class="Symbol">{</a><a id="60690" class="Argument">τ</a> <a id="60692" class="Symbol">=</a> <a id="60694" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="60701" href="lagda.2023-11-21-nbe.html#60658" class="Bound">Γ″≤Γ′</a><a id="60706" class="Symbol">}</a> <a id="60708" class="Symbol">{</a><a id="60709" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="60716" href="lagda.2023-11-21-nbe.html#60664" class="Bound">Γ′≤Γ</a><a id="60720" class="Symbol">}</a> <a id="60722" class="Symbol">{</a><a id="60723" href="lagda.2023-11-21-nbe.html#60669" class="Bound">t</a><a id="60724" class="Symbol">}</a> <a id="60726" class="Symbol">=</a>
    <a id="60732" href="lagda.2023-11-21-nbe.html#19474" class="Function">cong-sub</a> <a id="60741" class="Symbol">{</a><a id="60742" class="Argument">t</a> <a id="60744" class="Symbol">=</a> <a id="60746" href="lagda.2023-11-21-nbe.html#60669" class="Bound">t</a><a id="60747" class="Symbol">}</a>
      <a id="60755" class="Symbol">(</a><a id="60756" href="lagda.2023-11-21-nbe.html#2744" class="Postulate">extensionality</a> <a id="60771" class="Symbol">λ{</a><a id="60773" href="lagda.2023-11-21-nbe.html#60773" class="Bound">x</a> <a id="60775" class="Symbol">→</a> <a id="60777" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="60782" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#_</a> <a id="60785" class="Symbol">(</a><a id="60786" href="lagda.2023-11-21-nbe.html#59960" class="Function">compose-ρ-≤</a> <a id="60798" href="lagda.2023-11-21-nbe.html#60658" class="Bound">Γ″≤Γ′</a> <a id="60804" href="lagda.2023-11-21-nbe.html#60664" class="Bound">Γ′≤Γ</a> <a id="60809" href="lagda.2023-11-21-nbe.html#60773" class="Bound">x</a><a id="60810" class="Symbol">)})</a>
      <a id="60820" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
</pre>--->
<pre class="Agda"><a id="Ⓡ-weaken"></a><a id="60843" href="lagda.2023-11-21-nbe.html#60843" class="Function">Ⓡ-weaken</a> <a id="60852" class="Symbol">:</a> <a id="60854" class="Symbol">∀</a> <a id="60856" class="Symbol">{</a><a id="60857" href="lagda.2023-11-21-nbe.html#60857" class="Bound">Γ′</a> <a id="60860" href="lagda.2023-11-21-nbe.html#60860" class="Bound">Γ</a> <a id="60862" class="Symbol">:</a> <a id="60864" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="60867" class="Symbol">}</a> <a id="60869" class="Symbol">{</a><a id="60870" href="lagda.2023-11-21-nbe.html#60870" class="Bound">T</a> <a id="60872" class="Symbol">:</a> <a id="60874" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="60878" class="Symbol">}</a> <a id="60880" class="Symbol">{</a><a id="60881" href="lagda.2023-11-21-nbe.html#60881" class="Bound">Γ′≤Γ</a> <a id="60886" class="Symbol">:</a> <a id="60888" href="lagda.2023-11-21-nbe.html#60857" class="Bound">Γ′</a> <a id="60891" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="60893" href="lagda.2023-11-21-nbe.html#60860" class="Bound">Γ</a><a id="60894" class="Symbol">}</a> <a id="60896" class="Symbol">{</a><a id="60897" href="lagda.2023-11-21-nbe.html#60897" class="Bound">t</a> <a id="60899" class="Symbol">:</a> <a id="60901" href="lagda.2023-11-21-nbe.html#60860" class="Bound">Γ</a> <a id="60903" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="60905" href="lagda.2023-11-21-nbe.html#60870" class="Bound">T</a><a id="60906" class="Symbol">}</a> <a id="60908" class="Symbol">{</a><a id="60909" href="lagda.2023-11-21-nbe.html#60909" class="Bound">a</a> <a id="60911" class="Symbol">:</a> <a id="60913" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="60915" href="lagda.2023-11-21-nbe.html#60870" class="Bound">T</a> <a id="60917" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a><a id="60918" class="Symbol">}</a>
      <a id="60926" class="Symbol">→</a> <a id="60928" href="lagda.2023-11-21-nbe.html#60897" class="Bound">t</a> <a id="60930" href="lagda.2023-11-21-nbe.html#56802" class="Function Operator">Ⓡ</a> <a id="60932" href="lagda.2023-11-21-nbe.html#60909" class="Bound">a</a>
      <a id="60940" class="Symbol">→</a> <a id="60942" href="lagda.2023-11-21-nbe.html#60881" class="Bound">Γ′≤Γ</a> <a id="60947" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="60950" href="lagda.2023-11-21-nbe.html#60897" class="Bound">t</a> <a id="60952" href="lagda.2023-11-21-nbe.html#56802" class="Function Operator">Ⓡ</a> <a id="60954" href="lagda.2023-11-21-nbe.html#60909" class="Bound">a</a>
<a id="60956" href="lagda.2023-11-21-nbe.html#60843" class="Function">Ⓡ-weaken</a> <a id="60965" class="Symbol">{</a><a id="60966" class="Argument">T</a> <a id="60968" class="Symbol">=</a> <a id="60970" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a><a id="60971" class="Symbol">}</a> <a id="60973" class="Symbol">{</a><a id="60974" href="lagda.2023-11-21-nbe.html#60974" class="Bound">Γ′≤Γ</a><a id="60978" class="Symbol">}</a> <a id="60980" class="Symbol">{</a><a id="60981" href="lagda.2023-11-21-nbe.html#60981" class="Bound">t</a><a id="60982" class="Symbol">}</a> <a id="60984" href="lagda.2023-11-21-nbe.html#60984" class="Bound">pf</a> <a id="60987" href="lagda.2023-11-21-nbe.html#60987" class="Bound">Γ″≤Γ′</a>
  <a id="60995" class="Keyword">rewrite</a> <a id="61003" href="lagda.2023-11-21-nbe.html#60417" class="Function">compose-weaken</a> <a id="61018" href="lagda.2023-11-21-nbe.html#60987" class="Bound">Γ″≤Γ′</a> <a id="61024" href="lagda.2023-11-21-nbe.html#60974" class="Bound">Γ′≤Γ</a> <a id="61029" href="lagda.2023-11-21-nbe.html#60981" class="Bound">t</a> <a id="61031" class="Symbol">=</a> <a id="61033" href="lagda.2023-11-21-nbe.html#60984" class="Bound">pf</a> <a id="61036" class="Symbol">(</a><a id="61037" href="lagda.2023-11-21-nbe.html#9166" class="Function">≤-trans</a> <a id="61045" href="lagda.2023-11-21-nbe.html#60987" class="Bound">Γ″≤Γ′</a> <a id="61051" href="lagda.2023-11-21-nbe.html#60974" class="Bound">Γ′≤Γ</a><a id="61055" class="Symbol">)</a>
<a id="61057" href="lagda.2023-11-21-nbe.html#60843" class="Function">Ⓡ-weaken</a> <a id="61066" class="Symbol">{</a><a id="61067" class="Argument">T</a> <a id="61069" class="Symbol">=</a> <a id="61071" href="lagda.2023-11-21-nbe.html#61071" class="Bound">S</a> <a id="61073" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="61075" href="lagda.2023-11-21-nbe.html#61075" class="Bound">T</a><a id="61076" class="Symbol">}</a> <a id="61078" class="Symbol">{</a><a id="61079" href="lagda.2023-11-21-nbe.html#61079" class="Bound">Γ′≤Γ</a><a id="61083" class="Symbol">}</a> <a id="61085" class="Symbol">{</a><a id="61086" href="lagda.2023-11-21-nbe.html#61086" class="Bound">t</a><a id="61087" class="Symbol">}</a> <a id="61089" href="lagda.2023-11-21-nbe.html#61089" class="Bound">pf</a> <a id="61092" href="lagda.2023-11-21-nbe.html#61092" class="Bound">Γ″≤Γ′</a> <a id="61098" href="lagda.2023-11-21-nbe.html#61098" class="Bound">sⓇa</a>
  <a id="61104" class="Keyword">rewrite</a> <a id="61112" href="lagda.2023-11-21-nbe.html#60417" class="Function">compose-weaken</a> <a id="61127" href="lagda.2023-11-21-nbe.html#61092" class="Bound">Γ″≤Γ′</a> <a id="61133" href="lagda.2023-11-21-nbe.html#61079" class="Bound">Γ′≤Γ</a> <a id="61138" href="lagda.2023-11-21-nbe.html#61086" class="Bound">t</a> <a id="61140" class="Symbol">=</a> <a id="61142" href="lagda.2023-11-21-nbe.html#61089" class="Bound">pf</a> <a id="61145" class="Symbol">(</a><a id="61146" href="lagda.2023-11-21-nbe.html#9166" class="Function">≤-trans</a> <a id="61154" href="lagda.2023-11-21-nbe.html#61092" class="Bound">Γ″≤Γ′</a> <a id="61160" href="lagda.2023-11-21-nbe.html#61079" class="Bound">Γ′≤Γ</a><a id="61164" class="Symbol">)</a> <a id="61166" href="lagda.2023-11-21-nbe.html#61098" class="Bound">sⓇa</a>
</pre>
<p>The logical relation between terms and semantic objects is “sandwiched” between
reflection and reification – to arrive at a logical relation between a term and
a semantic object, the semantic object must be a reflection of a liftable
neutral that is definitionally equal to the term. Likewise, if a logical
relation holds between a term and a semantic object, then the term must be
definitionally equal to the reification of that semantic object.</p>
<p>This is intentional, as these results will be exactly what we will need to prove
the soundness of normalization by evaluation. We formalize them with the
following lemmas, which we will prove mutually (as reflection and reification
are themselves defined mutually) by induction on types.</p>
<p>The first lemma is that if the liftable variable <code>𝓊̂</code> is definitionally equal
to a term <code>𝓊</code> for all contexts <code>Γ′ ≤ Γ</code>, then <code>𝓊</code> is logically related to the
reflection of <code>𝓊̂</code>:</p>
<pre><code>(∀ Γ′ ≤ Γ. Γ′ ⊢ 𝓊 = 𝓊̂(Γ′) : T) ⇒ Γ ⊢ 𝓊 : T Ⓡ ↑ᵀ 𝓊̂</code></pre>
<pre class="Agda"><a id="==^→Ⓡ↑"></a><a id="62155" href="lagda.2023-11-21-nbe.html#62155" class="Function">==^→Ⓡ↑</a> <a id="62162" class="Symbol">:</a> <a id="62164" class="Symbol">∀</a> <a id="62166" class="Symbol">{</a><a id="62167" href="lagda.2023-11-21-nbe.html#62167" class="Bound">Γ</a> <a id="62169" class="Symbol">:</a> <a id="62171" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="62174" class="Symbol">}</a> <a id="62176" class="Symbol">{</a><a id="62177" href="lagda.2023-11-21-nbe.html#62177" class="Bound">T</a> <a id="62179" class="Symbol">:</a> <a id="62181" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="62185" class="Symbol">}</a> <a id="62187" class="Symbol">{</a><a id="62188" href="lagda.2023-11-21-nbe.html#62188" class="Bound">𝓊</a> <a id="62190" class="Symbol">:</a> <a id="62192" href="lagda.2023-11-21-nbe.html#62167" class="Bound">Γ</a> <a id="62194" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="62196" href="lagda.2023-11-21-nbe.html#62177" class="Bound">T</a><a id="62197" class="Symbol">}</a> <a id="62199" class="Symbol">{</a><a id="62200" href="lagda.2023-11-21-nbe.html#62200" class="Bound">𝓊̂</a> <a id="62203" class="Symbol">:</a> <a id="62205" href="lagda.2023-11-21-nbe.html#42004" class="Function">Ne^</a> <a id="62209" href="lagda.2023-11-21-nbe.html#62177" class="Bound">T</a><a id="62210" class="Symbol">}</a>
        <a id="62220" class="Symbol">→</a> <a id="62222" class="Symbol">(∀</a> <a id="62225" class="Symbol">{</a><a id="62226" href="lagda.2023-11-21-nbe.html#62226" class="Bound">Γ′</a> <a id="62229" class="Symbol">:</a> <a id="62231" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="62234" class="Symbol">}</a>
           <a id="62247" class="Symbol">→</a> <a id="62249" class="Symbol">(</a><a id="62250" href="lagda.2023-11-21-nbe.html#62250" class="Bound">Γ′≤Γ</a> <a id="62255" class="Symbol">:</a> <a id="62257" href="lagda.2023-11-21-nbe.html#62226" class="Bound">Γ′</a> <a id="62260" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="62262" href="lagda.2023-11-21-nbe.html#62167" class="Bound">Γ</a><a id="62263" class="Symbol">)</a>
           <a id="62276" class="Symbol">→</a> <a id="62278" href="lagda.2023-11-21-nbe.html#62250" class="Bound">Γ′≤Γ</a> <a id="62283" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="62286" href="lagda.2023-11-21-nbe.html#62188" class="Bound">𝓊</a> <a id="62288" href="lagda.2023-11-21-nbe.html#54952" class="Function Operator">==^</a> <a id="62292" href="lagda.2023-11-21-nbe.html#62200" class="Bound">𝓊̂</a><a id="62294" class="Symbol">)</a>
          <a id="62306" class="Comment">-------------------</a>
        <a id="62334" class="Symbol">→</a> <a id="62336" href="lagda.2023-11-21-nbe.html#62188" class="Bound">𝓊</a> <a id="62338" href="lagda.2023-11-21-nbe.html#56802" class="Function Operator">Ⓡ</a> <a id="62340" class="Symbol">(</a><a id="62341" href="lagda.2023-11-21-nbe.html#45236" class="Function">↑ᵀ</a> <a id="62344" href="lagda.2023-11-21-nbe.html#62200" class="Bound">𝓊̂</a><a id="62346" class="Symbol">)</a>
</pre>
<p>An immediate consequence of this lemma is that <code>Γ , x:T ⊢ x Ⓡ ↑ᵀ 𝓍̂ Γ</code>, which we
can define in Agda now as it will be necessary for proving the next lemma we
will introduce.</p>
<pre class="Agda"><a id="xⓇ↑ᵀ𝓍̂"></a><a id="62536" href="lagda.2023-11-21-nbe.html#62536" class="Function">xⓇ↑ᵀ𝓍̂</a> <a id="62543" class="Symbol">:</a> <a id="62545" class="Symbol">∀</a> <a id="62547" class="Symbol">{</a><a id="62548" href="lagda.2023-11-21-nbe.html#62548" class="Bound">Γ</a> <a id="62550" class="Symbol">:</a> <a id="62552" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="62555" class="Symbol">}</a> <a id="62557" class="Symbol">{</a><a id="62558" href="lagda.2023-11-21-nbe.html#62558" class="Bound">T</a> <a id="62560" class="Symbol">:</a> <a id="62562" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="62566" class="Symbol">}</a>
        <a id="62576" class="Comment">-------------------------</a>
      <a id="62608" class="Symbol">→</a> <a id="62610" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="62612" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a> <a id="62614" class="Symbol">{</a><a id="62615" href="lagda.2023-11-21-nbe.html#62548" class="Bound">Γ</a><a id="62616" class="Symbol">}</a> <a id="62618" class="Symbol">{</a><a id="62619" href="lagda.2023-11-21-nbe.html#62558" class="Bound">T</a><a id="62620" class="Symbol">}</a> <a id="62622" href="lagda.2023-11-21-nbe.html#56802" class="Function Operator">Ⓡ</a> <a id="62624" href="lagda.2023-11-21-nbe.html#45236" class="Function">↑ᵀ</a> <a id="62627" class="Symbol">(</a><a id="62628" href="lagda.2023-11-21-nbe.html#46066" class="Function">𝓍̂</a> <a id="62631" href="lagda.2023-11-21-nbe.html#62558" class="Bound">T</a> <a id="62633" href="lagda.2023-11-21-nbe.html#62548" class="Bound">Γ</a><a id="62634" class="Symbol">)</a>
</pre>
<p>The second lemma is that if <code>Γ ⊢ t : T</code> and <code>a ∈ ⟦ T ⟧</code> are logically related,
then <code>t</code> is definitionally equal to the reification of <code>a</code> for all contexts
<code>Γ′ ≤ Γ</code>:</p>
<pre><code>Γ ⊢ t : T Ⓡ a ⇒ ∀ Γ′ ≤ Γ. Γ′ ⊢ t = ↓ᵀ a Γ′ : T</code></pre>
<pre class="Agda"><a id="Ⓡ→==↓"></a><a id="62867" href="lagda.2023-11-21-nbe.html#62867" class="Function">Ⓡ→==↓</a> <a id="62873" class="Symbol">:</a> <a id="62875" class="Symbol">∀</a> <a id="62877" class="Symbol">{</a><a id="62878" href="lagda.2023-11-21-nbe.html#62878" class="Bound">Γ′</a> <a id="62881" href="lagda.2023-11-21-nbe.html#62881" class="Bound">Γ</a> <a id="62883" class="Symbol">:</a> <a id="62885" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="62888" class="Symbol">}</a> <a id="62890" class="Symbol">{</a><a id="62891" href="lagda.2023-11-21-nbe.html#62891" class="Bound">T</a> <a id="62893" class="Symbol">:</a> <a id="62895" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="62899" class="Symbol">}</a> <a id="62901" class="Symbol">{</a><a id="62902" href="lagda.2023-11-21-nbe.html#62902" class="Bound">t</a> <a id="62904" class="Symbol">:</a> <a id="62906" href="lagda.2023-11-21-nbe.html#62881" class="Bound">Γ</a> <a id="62908" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="62910" href="lagda.2023-11-21-nbe.html#62891" class="Bound">T</a><a id="62911" class="Symbol">}</a> <a id="62913" class="Symbol">{</a><a id="62914" href="lagda.2023-11-21-nbe.html#62914" class="Bound">a</a> <a id="62916" class="Symbol">:</a> <a id="62918" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="62920" href="lagda.2023-11-21-nbe.html#62891" class="Bound">T</a> <a id="62922" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a><a id="62923" class="Symbol">}</a>
      <a id="62931" class="Symbol">→</a> <a id="62933" href="lagda.2023-11-21-nbe.html#62902" class="Bound">t</a> <a id="62935" href="lagda.2023-11-21-nbe.html#56802" class="Function Operator">Ⓡ</a> <a id="62937" href="lagda.2023-11-21-nbe.html#62914" class="Bound">a</a>
        <a id="62947" class="Comment">----------------------------</a>
      <a id="62982" class="Symbol">→</a> <a id="62984" class="Symbol">(</a><a id="62985" href="lagda.2023-11-21-nbe.html#62985" class="Bound">Γ′≤Γ</a> <a id="62990" class="Symbol">:</a> <a id="62992" href="lagda.2023-11-21-nbe.html#62878" class="Bound">Γ′</a> <a id="62995" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="62997" href="lagda.2023-11-21-nbe.html#62881" class="Bound">Γ</a><a id="62998" class="Symbol">)</a>
      <a id="63006" class="Symbol">→</a> <a id="63008" href="lagda.2023-11-21-nbe.html#62985" class="Bound">Γ′≤Γ</a> <a id="63013" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="63016" href="lagda.2023-11-21-nbe.html#62902" class="Bound">t</a> <a id="63018" href="lagda.2023-11-21-nbe.html#30253" class="Datatype Operator">==</a> <a id="63021" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="63027" class="Symbol">(</a><a id="63028" href="lagda.2023-11-21-nbe.html#45341" class="Function">↓ᵀ</a> <a id="63031" href="lagda.2023-11-21-nbe.html#62914" class="Bound">a</a> <a id="63033" href="lagda.2023-11-21-nbe.html#62878" class="Bound">Γ′</a><a id="63035" class="Symbol">)</a>
</pre>
<p>This lemma is in fact what we wanted in the first place: that if a term is
logically related to a semantic object, then it is definitionally equal to the
reification of said object. It is stronger than we need it to be, but again this
is necessary to actually prove the implication.</p>
<p>We will start by proving the first lemma, focusing on each case of the proof
separately, before moving on to proving the second lemma. Again, the first
lemma is:</p>
<pre><code>(∀ Γ′ ≤ Γ. Γ′ ⊢ 𝓊 = 𝓊̂(Γ) : T) ⇒ Γ ⊢ 𝓊 : T Ⓡ ↑ᵀ 𝓊̂</code></pre>
<p>We prove this by induction on the type <code>T</code>. At type <code>𝟙</code>, our proof is
immediate, as <code>Γ ⊢ u : 𝟙 Ⓡ ↑ᵘⁿⁱᵗ 𝓊̂</code> is defined as:</p>
<pre><code>∀ Γ′ ≤ Γ. Γ′ ⊢ 𝓊 = 𝓊̂(Γ) : 𝟙</code></pre>
<p>Which is exactly our given proof.</p>
<pre class="Agda"><a id="63745" href="lagda.2023-11-21-nbe.html#62155" class="Function">==^→Ⓡ↑</a> <a id="63752" class="Symbol">{</a><a id="63753" class="Argument">T</a> <a id="63755" class="Symbol">=</a> <a id="63757" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a><a id="63758" class="Symbol">}</a> <a id="63760" href="lagda.2023-11-21-nbe.html#63760" class="Bound">pf</a> <a id="63763" href="lagda.2023-11-21-nbe.html#63763" class="Bound">Γ′≤Γ</a> <a id="63768" class="Symbol">=</a> <a id="63770" href="lagda.2023-11-21-nbe.html#63760" class="Bound">pf</a> <a id="63773" href="lagda.2023-11-21-nbe.html#63763" class="Bound">Γ′≤Γ</a>
</pre>
<p>At type <code>S → T</code>, the proof is more complicated. We want to prove that:</p>
<pre><code>(∀ Γ′ ≤ Γ. Γ′ ⊢ 𝓊 = 𝓊̂(Γ) : S → T) ⇒ Γ ⊢ 𝓊 : S → T Ⓡ ↑ˢ  ⃕ ᵗ 𝓊̂</code></pre>
<p>By definition of <code>Ⓡ</code>, this expands to:</p>
<pre><code>(∀ Γ′ ≤ Γ. Γ′ ⊢ 𝓊 = 𝓊̂(Γ) : S → T) ⇒
  ∀ Γ′ ≤ Γ. Γ′ ⊢ s Ⓡ a ⇒
    Γ′ ⊢ 𝓊 s Ⓡ (↑ˢ  ⃕ ᵗ 𝓊̂) a</code></pre>
<p>This simplifies further by the definition of reflection:</p>
<pre><code>(∀ Γ′ ≤ Γ. Γ′ ⊢ 𝓊 = 𝓊̂(Γ) : S → T) ⇒
  ∀ Γ′ ≤ Γ. Γ′ ⊢ s Ⓡ a ⇒
    Γ′ ⊢ 𝓊 s Ⓡ ↑ᵀ (𝓊̂ · ↓ˢ a)</code></pre>
<p>Our induction hypothesis gives us that at type <code>T</code>, the following holds:</p>
<pre><code>(∀ Γ″ ≤ Γ′. Γ″ ⊢ 𝓊 s = (𝓊̂ · ↓ˢ a) Γ″) ⇒
    Γ′ ⊢ 𝓊 s Ⓡ ↑ᵀ (𝓊̂ · ↓ˢ a)</code></pre>
<p>With our induction hypothesis, our new goal is to prove only that:</p>
<pre><code>∀ Γ″ ≤ Γ′. Γ″ ⊢ 𝓊 s = (𝓊̂ · (↓ˢ a)) Γ″ : T</code></pre>
<p>Note that <code>(𝓊̂ · (↓ˢ a)) Γ″</code> is equivalent to <code>𝓊̂(Γ″) · (↓ˢ a)(Γ″)</code> (application
of liftable neutrals is overloaded), so the final form of the property we have
to prove is:</p>
<pre><code>Γ″ ⊢ 𝓊 s = 𝓊̂(Γ″) · ↓ˢ a Γ″ : T</code></pre>
<p>Using the definitional equality rule of compatibility for application, we need
only prove that:</p>
<pre><code>Γ″ ⊢ 𝓊 = 𝓊̂(Γ″) : S → T
Γ″ ⊢ s = ↓ˢ a Γ″ : S</code></pre>
<p>The first property is our given evidence. We can use our other given proof (that
<code>Γ′ ⊢ s : S Ⓡ a</code>) with the the second lemma we will be proving to prove the
second property:</p>
<pre><code>Γ′ ⊢ s : T Ⓡ a ⇒ ∀ Γ″ ≤ Γ′. Γ″ ⊢ s = ↓ᵀ a Γ″ : T</code></pre>
<pre class="Agda"><a id="65102" href="lagda.2023-11-21-nbe.html#62155" class="Function">==^→Ⓡ↑</a> <a id="65109" class="Symbol">{</a><a id="65110" class="Argument">T</a> <a id="65112" class="Symbol">=</a> <a id="65114" class="Symbol">_</a> <a id="65116" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="65118" class="Symbol">_}</a> <a id="65121" class="Symbol">{</a><a id="65122" href="lagda.2023-11-21-nbe.html#65122" class="Bound">𝓊</a><a id="65123" class="Symbol">}</a> <a id="65125" class="Symbol">{</a><a id="65126" href="lagda.2023-11-21-nbe.html#65126" class="Bound">𝓊̂</a><a id="65128" class="Symbol">}</a> <a id="65130" href="lagda.2023-11-21-nbe.html#65130" class="Bound">pf</a> <a id="65133" class="Symbol">{</a><a id="65134" href="lagda.2023-11-21-nbe.html#65134" class="Bound">Γ′</a><a id="65136" class="Symbol">}</a> <a id="65138" href="lagda.2023-11-21-nbe.html#65138" class="Bound">Γ′≤Γ</a> <a id="65143" class="Symbol">{</a><a id="65144" href="lagda.2023-11-21-nbe.html#65144" class="Bound">s</a><a id="65145" class="Symbol">}</a> <a id="65147" class="Symbol">{</a><a id="65148" href="lagda.2023-11-21-nbe.html#65148" class="Bound">a</a><a id="65149" class="Symbol">}</a> <a id="65151" href="lagda.2023-11-21-nbe.html#65151" class="Bound">sⓇa</a> <a id="65155" class="Symbol">=</a>
  <a id="65159" href="lagda.2023-11-21-nbe.html#62155" class="Function">==^→Ⓡ↑</a> <a id="65166" href="lagda.2023-11-21-nbe.html#65194" class="Function">𝓊·s==𝓊̂·↓ˢa</a>
    <a id="65182" class="Keyword">where</a>
      <a id="65194" href="lagda.2023-11-21-nbe.html#65194" class="Function">𝓊·s==𝓊̂·↓ˢa</a> <a id="65206" class="Symbol">:</a> <a id="65208" class="Symbol">∀</a> <a id="65210" class="Symbol">{</a><a id="65211" href="lagda.2023-11-21-nbe.html#65211" class="Bound">Γ″</a> <a id="65214" class="Symbol">:</a> <a id="65216" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="65219" class="Symbol">}</a>
                 <a id="65238" class="Symbol">→</a> <a id="65240" class="Symbol">(</a><a id="65241" href="lagda.2023-11-21-nbe.html#65241" class="Bound">Γ″≤Γ′</a> <a id="65247" class="Symbol">:</a> <a id="65249" href="lagda.2023-11-21-nbe.html#65211" class="Bound">Γ″</a> <a id="65252" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="65254" href="lagda.2023-11-21-nbe.html#65134" class="Bound">Γ′</a><a id="65256" class="Symbol">)</a>
                 <a id="65275" class="Symbol">→</a> <a id="65277" href="lagda.2023-11-21-nbe.html#65241" class="Bound">Γ″≤Γ′</a> <a id="65283" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="65286" class="Symbol">(</a><a id="65287" href="lagda.2023-11-21-nbe.html#65138" class="Bound">Γ′≤Γ</a> <a id="65292" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="65295" href="lagda.2023-11-21-nbe.html#65122" class="Bound">𝓊</a><a id="65296" class="Symbol">)</a> <a id="65298" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="65300" href="lagda.2023-11-21-nbe.html#65144" class="Bound">s</a> <a id="65302" href="lagda.2023-11-21-nbe.html#54952" class="Function Operator">==^</a> <a id="65306" href="lagda.2023-11-21-nbe.html#65126" class="Bound">𝓊̂</a> <a id="65309" href="lagda.2023-11-21-nbe.html#43107" class="Function Operator">·^</a> <a id="65312" class="Symbol">(</a><a id="65313" href="lagda.2023-11-21-nbe.html#45341" class="Function">↓ᵀ</a> <a id="65316" href="lagda.2023-11-21-nbe.html#65148" class="Bound">a</a><a id="65317" class="Symbol">)</a>
      <a id="65325" href="lagda.2023-11-21-nbe.html#65194" class="Function">𝓊·s==𝓊̂·↓ˢa</a>  <a id="65338" class="Symbol">{</a><a id="65339" href="lagda.2023-11-21-nbe.html#65339" class="Bound">Γ″</a><a id="65341" class="Symbol">}</a> <a id="65343" href="lagda.2023-11-21-nbe.html#65343" class="Bound">Γ″≤Γ′</a>
        <a id="65357" class="Keyword">with</a> <a id="65362" href="lagda.2023-11-21-nbe.html#65126" class="Bound">𝓊̂</a> <a id="65365" href="lagda.2023-11-21-nbe.html#65339" class="Bound">Γ″</a>           <a id="65378" class="Symbol">|</a> <a id="65380" href="lagda.2023-11-21-nbe.html#65130" class="Bound">pf</a> <a id="65383" class="Symbol">(</a><a id="65384" href="lagda.2023-11-21-nbe.html#9166" class="Function">≤-trans</a> <a id="65392" href="lagda.2023-11-21-nbe.html#65343" class="Bound">Γ″≤Γ′</a> <a id="65398" href="lagda.2023-11-21-nbe.html#65138" class="Bound">Γ′≤Γ</a><a id="65402" class="Symbol">)</a>
      <a id="65410" class="Symbol">...</a> <a id="65414" class="Symbol">|</a> <a id="65416" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="65421" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="65423" href="lagda.2023-11-21-nbe.html#65423" class="Bound">𝓊″</a> <a id="65426" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="65428" class="Symbol">_</a> <a id="65430" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a> <a id="65432" class="Symbol">|</a> <a id="65434" href="lagda.2023-11-21-nbe.html#65434" class="Bound">𝓊==𝓊″</a>                   <a id="65458" class="Symbol">=</a>
        <a id="65468" href="lagda.2023-11-21-nbe.html#31874" class="Function Operator">begin==</a>
          <a id="65486" class="Bound">Γ″≤Γ′</a> <a id="65492" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="65495" class="Symbol">(</a><a id="65496" href="lagda.2023-11-21-nbe.html#65138" class="Bound">Γ′≤Γ</a> <a id="65501" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="65504" href="lagda.2023-11-21-nbe.html#65122" class="Bound">𝓊</a><a id="65505" class="Symbol">)</a> <a id="65507" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="65509" href="lagda.2023-11-21-nbe.html#65144" class="Bound">s</a>
        <a id="65519" href="lagda.2023-11-21-nbe.html#32007" class="Function Operator">==⟨</a> <a id="65523" href="lagda.2023-11-21-nbe.html#30868" class="InductiveConstructor">app-compatible</a> <a id="65538" class="Symbol">(</a><a id="65539" href="lagda.2023-11-21-nbe.html#32480" class="Function">≡→==</a> <a id="65544" class="Symbol">(</a><a id="65545" href="lagda.2023-11-21-nbe.html#60417" class="Function">compose-weaken</a> <a id="65560" class="Bound">Γ″≤Γ′</a> <a id="65566" href="lagda.2023-11-21-nbe.html#65138" class="Bound">Γ′≤Γ</a> <a id="65571" href="lagda.2023-11-21-nbe.html#65122" class="Bound">𝓊</a><a id="65572" class="Symbol">))</a> <a id="65575" href="lagda.2023-11-21-nbe.html#31125" class="InductiveConstructor">refl⁼⁼</a> <a id="65582" href="lagda.2023-11-21-nbe.html#32007" class="Function Operator">⟩</a>
          <a id="65594" class="Symbol">(</a><a id="65595" href="lagda.2023-11-21-nbe.html#65840" class="Function">Γ″≤Γ</a> <a id="65600" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="65603" href="lagda.2023-11-21-nbe.html#65122" class="Bound">𝓊</a><a id="65604" class="Symbol">)</a> <a id="65606" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="65608" class="Symbol">(</a><a id="65609" class="Bound">Γ″≤Γ′</a> <a id="65615" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="65618" href="lagda.2023-11-21-nbe.html#65144" class="Bound">s</a><a id="65619" class="Symbol">)</a>
        <a id="65629" href="lagda.2023-11-21-nbe.html#32007" class="Function Operator">==⟨</a> <a id="65633" href="lagda.2023-11-21-nbe.html#30868" class="InductiveConstructor">app-compatible</a> <a id="65648" href="lagda.2023-11-21-nbe.html#65434" class="Bound">𝓊==𝓊″</a> <a id="65654" href="lagda.2023-11-21-nbe.html#31125" class="InductiveConstructor">refl⁼⁼</a> <a id="65661" href="lagda.2023-11-21-nbe.html#32007" class="Function Operator">⟩</a>
          <a id="65673" href="lagda.2023-11-21-nbe.html#65423" class="Bound">𝓊″</a> <a id="65676" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="65678" class="Symbol">(</a><a id="65679" class="Bound">Γ″≤Γ′</a> <a id="65685" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="65688" href="lagda.2023-11-21-nbe.html#65144" class="Bound">s</a><a id="65689" class="Symbol">)</a>
        <a id="65699" href="lagda.2023-11-21-nbe.html#32007" class="Function Operator">==⟨</a> <a id="65703" href="lagda.2023-11-21-nbe.html#30868" class="InductiveConstructor">app-compatible</a> <a id="65718" href="lagda.2023-11-21-nbe.html#31125" class="InductiveConstructor">refl⁼⁼</a> <a id="65725" href="lagda.2023-11-21-nbe.html#65803" class="Function">s==↓ᵀaΓ″</a> <a id="65734" href="lagda.2023-11-21-nbe.html#32007" class="Function Operator">⟩</a>
          <a id="65746" href="lagda.2023-11-21-nbe.html#65423" class="Bound">𝓊″</a> <a id="65749" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="65751" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="65757" class="Symbol">(</a><a id="65758" href="lagda.2023-11-21-nbe.html#45341" class="Function">↓ᵀ</a> <a id="65761" href="lagda.2023-11-21-nbe.html#65148" class="Bound">a</a> <a id="65763" class="Bound">Γ″</a><a id="65765" class="Symbol">)</a>
        <a id="65775" href="lagda.2023-11-21-nbe.html#32215" class="Function Operator">==∎</a>
        <a id="65787" class="Keyword">where</a>
          <a id="65803" href="lagda.2023-11-21-nbe.html#65803" class="Function">s==↓ᵀaΓ″</a> <a id="65812" class="Symbol">=</a> <a id="65814" href="lagda.2023-11-21-nbe.html#62867" class="Function">Ⓡ→==↓</a> <a id="65820" href="lagda.2023-11-21-nbe.html#65151" class="Bound">sⓇa</a> <a id="65824" class="Bound">Γ″≤Γ′</a>
          <a id="65840" href="lagda.2023-11-21-nbe.html#65840" class="Function">Γ″≤Γ</a> <a id="65845" class="Symbol">=</a> <a id="65847" href="lagda.2023-11-21-nbe.html#9166" class="Function">≤-trans</a> <a id="65855" class="Bound">Γ″≤Γ′</a> <a id="65861" href="lagda.2023-11-21-nbe.html#65138" class="Bound">Γ′≤Γ</a>
</pre>
<p>This brings us to our second lemma:</p>
<pre><code>Γ ⊢ t : T Ⓡ a ⇒ ∀ Γ′ ≤ Γ. Γ′ ⊢ t = ↓ᵀ a Γ′ : T</code></pre>
<p>It will similarly be proven by induction on the type <code>T</code>. First, let us prove
the lemma for the type <code>𝟙</code>. At type <code>𝟙</code>, our lemma simplifies (by definition
of <code>Ⓡ</code>) to:</p>
<pre><code>(∀ Γ′ ≤ Γ. Γ′ ⊢ t : T = a (Γ′)) ⇒ ∀ Γ′ ≤ Γ. Γ′ ⊢ t = ↓ᵘⁿⁱᵗ a Γ′ : T</code></pre>
<p>We can break this down further into a case analysis on <code>a</code>, which can be either
<code>unit</code> or an embedded liftable neutral <code>𝓊̂</code>. In both cases, we can use our given
proof.</p>
<pre class="Agda"><a id="66378" href="lagda.2023-11-21-nbe.html#62867" class="Function">Ⓡ→==↓</a> <a id="66384" class="Symbol">{</a><a id="66385" class="Argument">T</a> <a id="66387" class="Symbol">=</a> <a id="66389" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a><a id="66390" class="Symbol">}</a> <a id="66392" class="Symbol">{</a><a id="66393" class="Argument">a</a> <a id="66395" class="Symbol">=</a> <a id="66397" href="lagda.2023-11-21-nbe.html#43666" class="InductiveConstructor">unit</a><a id="66401" class="Symbol">}</a> <a id="66403" href="lagda.2023-11-21-nbe.html#66403" class="Bound">pf</a> <a id="66406" class="Keyword">with</a> <a id="66411" href="lagda.2023-11-21-nbe.html#45341" class="Function">↓ᵀ</a> <a id="66414" class="Symbol">{</a><a id="66415" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a><a id="66416" class="Symbol">}</a> <a id="66418" href="lagda.2023-11-21-nbe.html#43666" class="InductiveConstructor">unit</a>
<a id="66423" class="Symbol">...</a> <a id="66427" class="Symbol">|</a> <a id="66429" class="Symbol">_</a> <a id="66431" class="Symbol">=</a> <a id="66433" class="Bound">pf</a>
<a id="66436" href="lagda.2023-11-21-nbe.html#62867" class="Function">Ⓡ→==↓</a> <a id="66442" class="Symbol">{</a><a id="66443" href="lagda.2023-11-21-nbe.html#66443" class="Bound">Γ′</a><a id="66445" class="Symbol">}</a> <a id="66447" class="Symbol">{</a><a id="66448" class="Argument">T</a> <a id="66450" class="Symbol">=</a> <a id="66452" href="lagda.2023-11-21-nbe.html#3162" class="InductiveConstructor">𝟙</a><a id="66453" class="Symbol">}</a> <a id="66455" class="Symbol">{</a><a id="66456" class="Argument">a</a> <a id="66458" class="Symbol">=</a> <a id="66460" href="lagda.2023-11-21-nbe.html#43678" class="InductiveConstructor">ne</a> <a id="66463" href="lagda.2023-11-21-nbe.html#66463" class="Bound">𝓊̂</a><a id="66465" class="Symbol">}</a> <a id="66467" href="lagda.2023-11-21-nbe.html#66467" class="Bound">pf</a> <a id="66470" href="lagda.2023-11-21-nbe.html#66470" class="Bound">Γ′≤Γ</a>
  <a id="66477" class="Keyword">with</a> <a id="66482" href="lagda.2023-11-21-nbe.html#66463" class="Bound">𝓊̂</a> <a id="66485" href="lagda.2023-11-21-nbe.html#66443" class="Bound">Γ′</a>           <a id="66498" class="Symbol">|</a> <a id="66500" href="lagda.2023-11-21-nbe.html#66467" class="Bound">pf</a> <a id="66503" href="lagda.2023-11-21-nbe.html#66470" class="Bound">Γ′≤Γ</a>
<a id="66508" class="Symbol">...</a> <a id="66512" class="Symbol">|</a> <a id="66514" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="66519" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="66521" href="lagda.2023-11-21-nbe.html#66521" class="Bound">𝓊</a> <a id="66523" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="66525" class="Symbol">_</a> <a id="66527" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a>  <a id="66530" class="Symbol">|</a> <a id="66532" href="lagda.2023-11-21-nbe.html#66532" class="Bound">t==𝓊</a> <a id="66537" class="Symbol">=</a> <a id="66539" href="lagda.2023-11-21-nbe.html#66532" class="Bound">t==𝓊</a>
</pre>
<p>For the case where we are at a function type <code>S → T</code>, our lemma now simplifies
to:</p>
<pre><code>(∀ Γ′ ≤ Γ. Γ′ ⊢ x : S Ⓡ a ⇒ Γ′ ⊢ t x : T Ⓡ f a) ⇒
  ∀ Γ′ ≤ Γ. Γ′ ⊢ t = ↓ˢ  ⃕  ᵗ f Γ′ : S → T</code></pre>
<p>We can once again expand out the definition of reification at type <code>S → T</code>,
simplifying the lemma to:</p>
<pre><code>(∀ Γ′ ≤ Γ. Γ′ ⊢ x : S Ⓡ a ⇒ Γ′ ⊢ t x : T Ⓡ f a) ⇒
  Γ′ ⊢ t = λx. ↓ᵀ f a (Γ′, x:S) : T , where a = ↑ˢ (𝓍̂ S Γ′)</code></pre>
<p>We prove this by η-expanding <code>t</code> to <code>λx. t x</code> and then using the compatibility
rule for abstractions to simplify our goal to proving:</p>
<pre><code>  Γ′, x:S ⊢ t x = λx. ↓ᵀ f a (Γ′, x:S) : T</code></pre>
<p>Our inductive hypothesis gives us that:</p>
<pre><code>  ∀ Γ″ ≤ Γ′. Γ″ ⊢ t x = ↓ᵀ f a : T</code></pre>
<p>With it, all we need to prove is:</p>
<pre><code>Γ′ , x : S ⊢ t x : T Ⓡ f a</code></pre>
<p>Our given proof further simplifies this goal to simply proving that
<code>∀ Γ″ ≤ Γ′, x:S. Γ″ ⊢ x : S Ⓡ a</code>. We have been using <code>a</code> for simplicity,
but again, <code>a = ↑ˢ (𝓍̂ S Γ′)</code>. Earlier, we established a lemma <code>xⓇ↑ᵀ𝓍̂</code> giving us
exactly this goal, so we use it here to finish our proof.</p>
<pre class="Agda"><a id="67579" href="lagda.2023-11-21-nbe.html#62867" class="Function">Ⓡ→==↓</a> <a id="67585" class="Symbol">{</a><a id="67586" href="lagda.2023-11-21-nbe.html#67586" class="Bound">Γ′</a><a id="67588" class="Symbol">}</a> <a id="67590" class="Symbol">{</a><a id="67591" class="Argument">T</a> <a id="67593" class="Symbol">=</a> <a id="67595" href="lagda.2023-11-21-nbe.html#67595" class="Bound">S</a> <a id="67597" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="67599" class="Symbol">_}</a> <a id="67602" class="Symbol">{</a><a id="67603" href="lagda.2023-11-21-nbe.html#67603" class="Bound">t</a><a id="67604" class="Symbol">}</a> <a id="67606" class="Symbol">{</a><a id="67607" href="lagda.2023-11-21-nbe.html#67607" class="Bound">f</a><a id="67608" class="Symbol">}</a> <a id="67610" href="lagda.2023-11-21-nbe.html#67610" class="Bound">pf</a> <a id="67613" href="lagda.2023-11-21-nbe.html#67613" class="Bound">Γ′≤Γ</a> <a id="67618" class="Symbol">=</a>
  <a id="67622" href="lagda.2023-11-21-nbe.html#31874" class="Function Operator">begin==</a>
    <a id="67634" href="lagda.2023-11-21-nbe.html#67613" class="Bound">Γ′≤Γ</a> <a id="67639" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="67642" href="lagda.2023-11-21-nbe.html#67603" class="Bound">t</a>
  <a id="67646" href="lagda.2023-11-21-nbe.html#32007" class="Function Operator">==⟨</a> <a id="67650" href="lagda.2023-11-21-nbe.html#30573" class="InductiveConstructor">η</a> <a id="67652" href="lagda.2023-11-21-nbe.html#32007" class="Function Operator">⟩</a>
    <a id="67658" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="67660" class="Symbol">(</a><a id="67661" href="lagda.2023-11-21-nbe.html#67595" class="Bound">S</a> <a id="67663" href="lagda.2023-11-21-nbe.html#17302" class="Function Operator">↥⊢</a> <a id="67666" href="lagda.2023-11-21-nbe.html#67613" class="Bound">Γ′≤Γ</a> <a id="67671" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="67674" href="lagda.2023-11-21-nbe.html#67603" class="Bound">t</a><a id="67675" class="Symbol">)</a> <a id="67677" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="67679" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="67681" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>
  <a id="67685" href="lagda.2023-11-21-nbe.html#32007" class="Function Operator">==⟨</a>
    <a id="67693" href="lagda.2023-11-21-nbe.html#30709" class="InductiveConstructor">abs-compatible</a> <a id="67708" class="Symbol">(</a>
      <a id="67716" href="lagda.2023-11-21-nbe.html#31874" class="Function Operator">begin==</a>
        <a id="67732" class="Symbol">(</a><a id="67733" href="lagda.2023-11-21-nbe.html#67595" class="Bound">S</a> <a id="67735" href="lagda.2023-11-21-nbe.html#17302" class="Function Operator">↥⊢</a> <a id="67738" href="lagda.2023-11-21-nbe.html#67613" class="Bound">Γ′≤Γ</a> <a id="67743" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="67746" href="lagda.2023-11-21-nbe.html#67603" class="Bound">t</a><a id="67747" class="Symbol">)</a> <a id="67749" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="67751" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="67753" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>
      <a id="67761" href="lagda.2023-11-21-nbe.html#32007" class="Function Operator">==⟨</a> <a id="67765" href="lagda.2023-11-21-nbe.html#30868" class="InductiveConstructor">app-compatible</a> <a id="67780" href="lagda.2023-11-21-nbe.html#68024" class="Function">subst-lemma</a> <a id="67792" href="lagda.2023-11-21-nbe.html#31125" class="InductiveConstructor">refl⁼⁼</a> <a id="67799" href="lagda.2023-11-21-nbe.html#32007" class="Function Operator">⟩</a>
        <a id="67809" class="Symbol">(</a><a id="67810" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="67816" href="lagda.2023-11-21-nbe.html#67613" class="Bound">Γ′≤Γ</a> <a id="67821" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="67824" href="lagda.2023-11-21-nbe.html#67603" class="Bound">t</a><a id="67825" class="Symbol">)</a> <a id="67827" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="67829" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="67832" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a> <a id="67834" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="67836" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="67838" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>
      <a id="67846" href="lagda.2023-11-21-nbe.html#32007" class="Function Operator">==⟨</a> <a id="67850" href="lagda.2023-11-21-nbe.html#62867" class="Function">Ⓡ→==↓</a> <a id="67856" class="Symbol">(</a><a id="67857" href="lagda.2023-11-21-nbe.html#67610" class="Bound">pf</a> <a id="67860" class="Symbol">(</a><a id="67861" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="67867" href="lagda.2023-11-21-nbe.html#67613" class="Bound">Γ′≤Γ</a><a id="67871" class="Symbol">)</a> <a id="67873" href="lagda.2023-11-21-nbe.html#67997" class="Function">xⓇa</a><a id="67876" class="Symbol">)</a> <a id="67878" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a> <a id="67883" href="lagda.2023-11-21-nbe.html#32007" class="Function Operator">⟩</a>
        <a id="67893" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="67899" class="Symbol">(</a><a id="67900" href="lagda.2023-11-21-nbe.html#45341" class="Function">↓ᵀ</a> <a id="67903" class="Symbol">(</a><a id="67904" href="lagda.2023-11-21-nbe.html#67607" class="Bound">f</a> <a id="67906" href="lagda.2023-11-21-nbe.html#67972" class="Function">a</a><a id="67907" class="Symbol">)</a> <a id="67909" class="Symbol">(</a><a id="67910" href="lagda.2023-11-21-nbe.html#67586" class="Bound">Γ′</a> <a id="67913" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="67915" href="lagda.2023-11-21-nbe.html#67595" class="Bound">S</a><a id="67916" class="Symbol">))</a>
      <a id="67925" href="lagda.2023-11-21-nbe.html#32215" class="Function Operator">==∎</a>
  <a id="67931" class="Symbol">)</a><a id="67932" href="lagda.2023-11-21-nbe.html#32007" class="Function Operator">⟩</a>
    <a id="67938" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="67944" class="Symbol">(</a><a id="67945" href="lagda.2023-11-21-nbe.html#45341" class="Function">↓ᵀ</a> <a id="67948" href="lagda.2023-11-21-nbe.html#67607" class="Bound">f</a> <a id="67950" href="lagda.2023-11-21-nbe.html#67586" class="Bound">Γ′</a><a id="67952" class="Symbol">)</a>
  <a id="67956" href="lagda.2023-11-21-nbe.html#32215" class="Function Operator">==∎</a>
  <a id="67962" class="Keyword">where</a>
    <a id="67972" href="lagda.2023-11-21-nbe.html#67972" class="Function">a</a> <a id="67974" class="Symbol">=</a> <a id="67976" href="lagda.2023-11-21-nbe.html#45236" class="Function">↑ᵀ</a> <a id="67979" class="Symbol">{</a><a id="67980" href="lagda.2023-11-21-nbe.html#67595" class="Bound">S</a><a id="67981" class="Symbol">}</a> <a id="67983" class="Symbol">(</a><a id="67984" href="lagda.2023-11-21-nbe.html#46066" class="Function">𝓍̂</a> <a id="67987" href="lagda.2023-11-21-nbe.html#67595" class="Bound">S</a> <a id="67989" href="lagda.2023-11-21-nbe.html#67586" class="Bound">Γ′</a><a id="67991" class="Symbol">)</a>
    <a id="67997" href="lagda.2023-11-21-nbe.html#67997" class="Function">xⓇa</a> <a id="68001" class="Symbol">=</a> <a id="68003" href="lagda.2023-11-21-nbe.html#62536" class="Function">xⓇ↑ᵀ𝓍̂</a> <a id="68010" class="Symbol">{</a><a id="68011" href="lagda.2023-11-21-nbe.html#67586" class="Bound">Γ′</a><a id="68013" class="Symbol">}</a> <a id="68015" class="Symbol">{</a><a id="68016" href="lagda.2023-11-21-nbe.html#67595" class="Bound">S</a><a id="68017" class="Symbol">}</a>

    <a id="68024" href="lagda.2023-11-21-nbe.html#68024" class="Function">subst-lemma</a> <a id="68036" class="Symbol">=</a>
      <a id="68044" href="lagda.2023-11-21-nbe.html#32480" class="Function">≡→==</a> <a id="68049" class="Symbol">(</a><a id="68050" href="Relation.Binary.PropositionalEquality.Core.html#1729" class="Function">trans</a>
             <a id="68069" class="Symbol">(</a><a id="68070" href="lagda.2023-11-21-nbe.html#25552" class="Function">sub-sub</a> <a id="68078" class="Symbol">{</a><a id="68079" class="Argument">τ</a> <a id="68081" class="Symbol">=</a> <a id="68083" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a><a id="68084" class="Symbol">}</a> <a id="68086" class="Symbol">{</a><a id="68087" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="68094" href="lagda.2023-11-21-nbe.html#67613" class="Bound">Γ′≤Γ</a><a id="68098" class="Symbol">}</a> <a id="68100" class="Symbol">{</a><a id="68101" href="lagda.2023-11-21-nbe.html#67603" class="Bound">t</a><a id="68102" class="Symbol">})</a>
             <a id="68118" class="Symbol">(</a><a id="68119" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="68123" href="lagda.2023-11-21-nbe.html#22591" class="Function">[id]-identity</a><a id="68136" class="Symbol">))</a>
</pre>
<p>Lastly, we can quickly derive the lemma <code>Γ, x:T ⊢ x : T Ⓡ ↑ᵀ 𝓍̂ Γ</code> as a special
case of <code>(∀ Γ′ ≤ Γ. Γ′ ⊢ 𝓊 = 𝓊̂(Γ′) : T) ⇒ Γ ⊢ 𝓊 Ⓡ ↑ᵀ 𝓊̂</code>. The proof requires an
additional lemma with its proof ommitted, <code>≤-pf-irrelevance</code>: any proof of
context extension is equivalent.</p>
<pre class="Agda"><a id="≤-pf-irrelevance"></a><a id="68422" href="lagda.2023-11-21-nbe.html#68422" class="Function">≤-pf-irrelevance</a> <a id="68439" class="Symbol">:</a> <a id="68441" class="Symbol">∀</a> <a id="68443" class="Symbol">{</a><a id="68444" href="lagda.2023-11-21-nbe.html#68444" class="Bound">Γ′</a> <a id="68447" href="lagda.2023-11-21-nbe.html#68447" class="Bound">Γ</a> <a id="68449" class="Symbol">:</a> <a id="68451" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="68454" class="Symbol">}</a>
                 <a id="68473" class="Symbol">→</a> <a id="68475" class="Symbol">(</a><a id="68476" href="lagda.2023-11-21-nbe.html#68476" class="Bound">pf₁</a> <a id="68480" class="Symbol">:</a> <a id="68482" href="lagda.2023-11-21-nbe.html#68444" class="Bound">Γ′</a> <a id="68485" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="68487" href="lagda.2023-11-21-nbe.html#68447" class="Bound">Γ</a><a id="68488" class="Symbol">)</a>
                 <a id="68507" class="Symbol">→</a> <a id="68509" class="Symbol">(</a><a id="68510" href="lagda.2023-11-21-nbe.html#68510" class="Bound">pf₂</a> <a id="68514" class="Symbol">:</a> <a id="68516" href="lagda.2023-11-21-nbe.html#68444" class="Bound">Γ′</a> <a id="68519" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="68521" href="lagda.2023-11-21-nbe.html#68447" class="Bound">Γ</a><a id="68522" class="Symbol">)</a>
                 <a id="68541" class="Symbol">→</a> <a id="68543" href="lagda.2023-11-21-nbe.html#68476" class="Bound">pf₁</a> <a id="68547" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="68549" href="lagda.2023-11-21-nbe.html#68510" class="Bound">pf₂</a>
</pre>
<!---
<pre class="Agda"><a id="68572" href="lagda.2023-11-21-nbe.html#68422" class="Function">≤-pf-irrelevance</a> <a id="68589" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a> <a id="68594" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a>               <a id="68613" class="Symbol">=</a> <a id="68615" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="68620" href="lagda.2023-11-21-nbe.html#68422" class="Function">≤-pf-irrelevance</a> <a id="68637" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a> <a id="68642" class="Symbol">(</a><a id="68643" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="68649" href="lagda.2023-11-21-nbe.html#68649" class="Bound">pf</a><a id="68651" class="Symbol">)</a>         <a id="68661" class="Symbol">=</a> <a id="68663" href="Data.Empty.html#628" class="Function">⊥-elim</a> <a id="68670" class="Symbol">(</a><a id="68671" href="lagda.2023-11-21-nbe.html#8333" class="Function">Γ≰Γ,T</a> <a id="68677" href="lagda.2023-11-21-nbe.html#68649" class="Bound">pf</a><a id="68679" class="Symbol">)</a>
<a id="68681" href="lagda.2023-11-21-nbe.html#68422" class="Function">≤-pf-irrelevance</a> <a id="68698" class="Symbol">(</a><a id="68699" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="68705" href="lagda.2023-11-21-nbe.html#68705" class="Bound">pf</a><a id="68707" class="Symbol">)</a> <a id="68709" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a>         <a id="68722" class="Symbol">=</a> <a id="68724" href="Data.Empty.html#628" class="Function">⊥-elim</a> <a id="68731" class="Symbol">(</a><a id="68732" href="lagda.2023-11-21-nbe.html#8333" class="Function">Γ≰Γ,T</a> <a id="68738" href="lagda.2023-11-21-nbe.html#68705" class="Bound">pf</a><a id="68740" class="Symbol">)</a>
<a id="68742" href="lagda.2023-11-21-nbe.html#68422" class="Function">≤-pf-irrelevance</a> <a id="68759" class="Symbol">(</a><a id="68760" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="68766" href="lagda.2023-11-21-nbe.html#68766" class="Bound">pf₁</a><a id="68769" class="Symbol">)</a> <a id="68771" class="Symbol">(</a><a id="68772" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="68778" href="lagda.2023-11-21-nbe.html#68778" class="Bound">pf₂</a><a id="68781" class="Symbol">)</a>
  <a id="68785" class="Keyword">rewrite</a> <a id="68793" href="lagda.2023-11-21-nbe.html#68422" class="Function">≤-pf-irrelevance</a> <a id="68810" href="lagda.2023-11-21-nbe.html#68766" class="Bound">pf₁</a> <a id="68814" href="lagda.2023-11-21-nbe.html#68778" class="Bound">pf₂</a>       <a id="68824" class="Symbol">=</a> <a id="68826" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
</pre>--->
<pre class="Agda"><a id="68849" href="lagda.2023-11-21-nbe.html#62536" class="Function">xⓇ↑ᵀ𝓍̂</a> <a id="68856" class="Symbol">{_}</a> <a id="68860" class="Symbol">{</a><a id="68861" href="lagda.2023-11-21-nbe.html#68861" class="Bound">T</a><a id="68862" class="Symbol">}</a> <a id="68864" class="Symbol">=</a> <a id="68866" href="lagda.2023-11-21-nbe.html#62155" class="Function">==^→Ⓡ↑</a> <a id="68873" href="lagda.2023-11-21-nbe.html#68887" class="Function">x==𝓍̂</a> <a id="68879" class="Keyword">where</a>
  <a id="68887" href="lagda.2023-11-21-nbe.html#68887" class="Function">x==𝓍̂</a> <a id="68893" class="Symbol">:</a> <a id="68895" class="Symbol">∀</a> <a id="68897" class="Symbol">{</a><a id="68898" href="lagda.2023-11-21-nbe.html#68898" class="Bound">Γ</a> <a id="68900" href="lagda.2023-11-21-nbe.html#68900" class="Bound">Γ′</a> <a id="68903" class="Symbol">:</a> <a id="68905" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="68908" class="Symbol">}</a>
       <a id="68917" class="Symbol">→</a> <a id="68919" class="Symbol">(</a><a id="68920" href="lagda.2023-11-21-nbe.html#68920" class="Bound">Γ′≤Γ,T</a> <a id="68927" class="Symbol">:</a> <a id="68929" href="lagda.2023-11-21-nbe.html#68900" class="Bound">Γ′</a> <a id="68932" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="68934" href="lagda.2023-11-21-nbe.html#68898" class="Bound">Γ</a> <a id="68936" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="68938" href="lagda.2023-11-21-nbe.html#68861" class="Bound">T</a><a id="68939" class="Symbol">)</a>
       <a id="68948" class="Symbol">→</a> <a id="68950" href="lagda.2023-11-21-nbe.html#68920" class="Bound">Γ′≤Γ,T</a> <a id="68957" href="lagda.2023-11-21-nbe.html#17104" class="Function Operator">≤⊢</a> <a id="68960" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="68962" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a> <a id="68964" href="lagda.2023-11-21-nbe.html#54952" class="Function Operator">==^</a> <a id="68968" href="lagda.2023-11-21-nbe.html#46066" class="Function">𝓍̂</a> <a id="68971" href="lagda.2023-11-21-nbe.html#68861" class="Bound">T</a> <a id="68973" href="lagda.2023-11-21-nbe.html#68898" class="Bound">Γ</a>
  <a id="68977" href="lagda.2023-11-21-nbe.html#68887" class="Function">x==𝓍̂</a> <a id="68983" class="Symbol">{</a><a id="68984" href="lagda.2023-11-21-nbe.html#68984" class="Bound">Γ</a><a id="68985" class="Symbol">}</a> <a id="68987" class="Symbol">{</a><a id="68988" href="lagda.2023-11-21-nbe.html#68988" class="Bound">Γ′</a><a id="68990" class="Symbol">}</a> <a id="68992" href="lagda.2023-11-21-nbe.html#68992" class="Bound">pf</a>
    <a id="68999" class="Keyword">with</a> <a id="69004" href="lagda.2023-11-21-nbe.html#68988" class="Bound">Γ′</a> <a id="69007" href="lagda.2023-11-21-nbe.html#10889" class="Function Operator">≤?</a> <a id="69010" class="Symbol">(</a><a id="69011" href="lagda.2023-11-21-nbe.html#68984" class="Bound">Γ</a> <a id="69013" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="69015" href="lagda.2023-11-21-nbe.html#68861" class="Bound">T</a><a id="69016" class="Symbol">)</a>
  <a id="69020" class="Symbol">...</a> <a id="69024" class="Symbol">|</a> <a id="69026" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="69029" href="lagda.2023-11-21-nbe.html#69029" class="Bound">¬pf</a>                           <a id="69059" class="Symbol">=</a> <a id="69061" href="lagda.2023-11-21-nbe.html#69029" class="Bound">¬pf</a> <a id="69065" class="Bound">pf</a>
  <a id="69070" class="Symbol">...</a> <a id="69074" class="Symbol">|</a> <a id="69076" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="69080" href="lagda.2023-11-21-nbe.html#69080" class="Bound">pf′</a>
    <a id="69088" class="Keyword">with</a> <a id="69093" href="lagda.2023-11-21-nbe.html#46066" class="Function">𝓍̂</a> <a id="69096" href="lagda.2023-11-21-nbe.html#68861" class="Bound">T</a> <a id="69098" class="Bound">Γ</a> <a id="69100" class="Symbol">|</a> <a id="69102" href="lagda.2023-11-21-nbe.html#68422" class="Function">≤-pf-irrelevance</a> <a id="69119" class="Bound">pf</a> <a id="69122" href="lagda.2023-11-21-nbe.html#69080" class="Bound">pf′</a>
  <a id="69128" class="Symbol">...</a> <a id="69132" class="Symbol">|</a> <a id="69134" class="Symbol">_</a>      <a id="69141" class="Symbol">|</a> <a id="69143" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
    <a id="69152" class="Keyword">with</a> <a id="69157" href="lagda.2023-11-21-nbe.html#13819" class="Function">ρ-≤</a> <a id="69161" class="Bound">pf′</a> <a id="69165" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>
  <a id="69169" class="Symbol">...|</a> <a id="69174" class="Symbol">_</a>                                 <a id="69208" class="Symbol">=</a> <a id="69210" href="lagda.2023-11-21-nbe.html#31125" class="InductiveConstructor">refl⁼⁼</a>
</pre>
<p>Let’s focus on one of the lemmas we have proven:</p>
<pre><code>Γ ⊢ t : T Ⓡ a ⇒ ∀ Γ′ ≤ Γ. Γ′ ⊢ t = ↓ᵀ a Γ : T</code></pre>
<p>We have defined our logical relation with the goal of having the following case
of this property:</p>
<pre><code>Γ ⊢ t : T Ⓡ a ⇒ Γ ⊢ t = ↓ᵀ a Γ : T</code></pre>
<p>We now need to show that:</p>
<pre><code>Γ ⊢ t : T Ⓡ ⟦t⟧ ↑Γ</code></pre>
<p>With this, we can arrive at the definitional equality of a term and its normal
form as obtained from our algorithm for normalization by evaluation:</p>
<pre><code>Γ ⊢ t = ↓ᵀ (⟦t⟧ ↑Γ) Γ : T</code></pre>
<p>To prove <code>Γ ⊢ t : T Ⓡ ⟦t⟧ ↑Γ</code>, we will need to extend our logical relation to
include substitutions and environments.</p>
<p>A parallel substitution <code>Γ ⊢ σ : Δ</code> will be logically related to an environment
<code>δ ∈ ⟦ Δ ⟧</code> if every term that the substitution <code>σ</code> is substituting for the
context <code>Δ</code> is logically related to the corresponding semantic object in the
environment <code>δ</code>. In Agda, we will use <code>Ⓡˢ</code> as <code>Ⓡ</code> is already reserved for terms
and semantic objects, though we will refer to the relation as <code>Γ ⊢ σ : Δ Ⓡ δ</code>.</p>
<pre class="Agda"><a id="_Ⓡˢ_"></a><a id="70213" href="lagda.2023-11-21-nbe.html#70213" class="Function Operator">_Ⓡˢ_</a> <a id="70218" class="Symbol">:</a> <a id="70220" class="Symbol">∀</a> <a id="70222" class="Symbol">{</a><a id="70223" href="lagda.2023-11-21-nbe.html#70223" class="Bound">Γ</a> <a id="70225" href="lagda.2023-11-21-nbe.html#70225" class="Bound">Δ</a> <a id="70227" class="Symbol">:</a> <a id="70229" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="70232" class="Symbol">}</a> <a id="70234" class="Symbol">→</a> <a id="70236" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="70240" href="lagda.2023-11-21-nbe.html#70223" class="Bound">Γ</a> <a id="70242" href="lagda.2023-11-21-nbe.html#70225" class="Bound">Δ</a> <a id="70244" class="Symbol">→</a> <a id="70246" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="70248" href="lagda.2023-11-21-nbe.html#70225" class="Bound">Δ</a> <a id="70250" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a> <a id="70252" class="Symbol">→</a> <a id="70254" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="70258" href="lagda.2023-11-21-nbe.html#70213" class="Function Operator">_Ⓡˢ_</a> <a id="70263" class="Symbol">{</a><a id="70264" class="Argument">Δ</a> <a id="70266" class="Symbol">=</a> <a id="70268" href="lagda.2023-11-21-nbe.html#70268" class="Bound">Δ</a><a id="70269" class="Symbol">}</a> <a id="70271" href="lagda.2023-11-21-nbe.html#70271" class="Bound">σ</a> <a id="70273" href="lagda.2023-11-21-nbe.html#70273" class="Bound">δ</a> <a id="70275" class="Symbol">=</a> <a id="70277" class="Symbol">∀</a> <a id="70279" class="Symbol">{</a><a id="70280" href="lagda.2023-11-21-nbe.html#70280" class="Bound">T</a> <a id="70282" class="Symbol">:</a> <a id="70284" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="70288" class="Symbol">}</a> <a id="70290" class="Symbol">→</a> <a id="70292" class="Symbol">(</a><a id="70293" href="lagda.2023-11-21-nbe.html#70293" class="Bound">x</a> <a id="70295" class="Symbol">:</a> <a id="70297" href="lagda.2023-11-21-nbe.html#70268" class="Bound">Δ</a> <a id="70299" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="70301" href="lagda.2023-11-21-nbe.html#70280" class="Bound">T</a><a id="70302" class="Symbol">)</a> <a id="70304" class="Symbol">→</a> <a id="70306" href="lagda.2023-11-21-nbe.html#70271" class="Bound">σ</a> <a id="70308" href="lagda.2023-11-21-nbe.html#70293" class="Bound">x</a> <a id="70310" href="lagda.2023-11-21-nbe.html#56802" class="Function Operator">Ⓡ</a> <a id="70312" href="lagda.2023-11-21-nbe.html#43825" class="Function">env-lookup</a> <a id="70323" href="lagda.2023-11-21-nbe.html#70293" class="Bound">x</a> <a id="70325" href="lagda.2023-11-21-nbe.html#70273" class="Bound">δ</a>
</pre>
<!---
<pre class="Agda"><a id="70346" class="Keyword">infix</a> <a id="70352" class="Number">4</a> <a id="70354" href="lagda.2023-11-21-nbe.html#70213" class="Function Operator">_Ⓡˢ_</a>
</pre>--->
<p>Similarly as for the logical relation between terms and semantic objects, if a
logical relation holds between a substitution and an environment, it holds for
any weakening of the substitution. The proof is immediate using <code>Ⓡ-weaken</code>.</p>
<pre class="Agda"><a id="Ⓡˢ-weaken"></a><a id="70612" href="lagda.2023-11-21-nbe.html#70612" class="Function">Ⓡˢ-weaken</a> <a id="70622" class="Symbol">:</a> <a id="70624" class="Symbol">∀</a> <a id="70626" class="Symbol">{</a><a id="70627" href="lagda.2023-11-21-nbe.html#70627" class="Bound">Γ′</a> <a id="70630" href="lagda.2023-11-21-nbe.html#70630" class="Bound">Γ</a> <a id="70632" href="lagda.2023-11-21-nbe.html#70632" class="Bound">Δ</a> <a id="70634" class="Symbol">:</a> <a id="70636" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="70639" class="Symbol">}</a> <a id="70641" class="Symbol">{</a><a id="70642" href="lagda.2023-11-21-nbe.html#70642" class="Bound">Γ′≤Γ</a> <a id="70647" class="Symbol">:</a> <a id="70649" href="lagda.2023-11-21-nbe.html#70627" class="Bound">Γ′</a> <a id="70652" href="lagda.2023-11-21-nbe.html#7532" class="Datatype Operator">≤</a> <a id="70654" href="lagda.2023-11-21-nbe.html#70630" class="Bound">Γ</a><a id="70655" class="Symbol">}</a> <a id="70657" class="Symbol">{</a><a id="70658" href="lagda.2023-11-21-nbe.html#70658" class="Bound">σ</a> <a id="70660" class="Symbol">:</a> <a id="70662" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="70666" href="lagda.2023-11-21-nbe.html#70630" class="Bound">Γ</a> <a id="70668" href="lagda.2023-11-21-nbe.html#70632" class="Bound">Δ</a><a id="70669" class="Symbol">}</a> <a id="70671" class="Symbol">{</a><a id="70672" href="lagda.2023-11-21-nbe.html#70672" class="Bound">δ</a> <a id="70674" class="Symbol">:</a> <a id="70676" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="70678" href="lagda.2023-11-21-nbe.html#70632" class="Bound">Δ</a> <a id="70680" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a><a id="70681" class="Symbol">}</a>
           <a id="70694" class="Symbol">→</a> <a id="70696" href="lagda.2023-11-21-nbe.html#70658" class="Bound">σ</a> <a id="70698" href="lagda.2023-11-21-nbe.html#70213" class="Function Operator">Ⓡˢ</a> <a id="70701" href="lagda.2023-11-21-nbe.html#70672" class="Bound">δ</a>
           <a id="70714" class="Symbol">→</a> <a id="70716" href="lagda.2023-11-21-nbe.html#70658" class="Bound">σ</a> <a id="70718" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="70720" class="Symbol">(</a><a id="70721" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="70728" href="lagda.2023-11-21-nbe.html#70642" class="Bound">Γ′≤Γ</a><a id="70732" class="Symbol">)</a> <a id="70734" href="lagda.2023-11-21-nbe.html#70213" class="Function Operator">Ⓡˢ</a> <a id="70737" href="lagda.2023-11-21-nbe.html#70672" class="Bound">δ</a>
<a id="70739" href="lagda.2023-11-21-nbe.html#70612" class="Function">Ⓡˢ-weaken</a> <a id="70749" class="Symbol">{</a><a id="70750" class="Argument">Γ′≤Γ</a> <a id="70755" class="Symbol">=</a> <a id="70757" href="lagda.2023-11-21-nbe.html#70757" class="Bound">Γ′≤Γ</a><a id="70761" class="Symbol">}</a> <a id="70763" href="lagda.2023-11-21-nbe.html#70763" class="Bound">σⓇδ</a> <a id="70767" href="lagda.2023-11-21-nbe.html#70767" class="Bound">x</a> <a id="70769" class="Symbol">=</a> <a id="70771" href="lagda.2023-11-21-nbe.html#60843" class="Function">Ⓡ-weaken</a> <a id="70780" class="Symbol">{</a><a id="70781" class="Argument">Γ′≤Γ</a> <a id="70786" class="Symbol">=</a> <a id="70788" href="lagda.2023-11-21-nbe.html#70757" class="Bound">Γ′≤Γ</a><a id="70792" class="Symbol">}</a> <a id="70794" class="Symbol">(</a><a id="70795" href="lagda.2023-11-21-nbe.html#70763" class="Bound">σⓇδ</a> <a id="70799" href="lagda.2023-11-21-nbe.html#70767" class="Bound">x</a><a id="70800" class="Symbol">)</a>
</pre>
<p>With the logical relation extended to substitutions and environments, we can
introduce the semantic typing judgement <code>Δ ⊨ t : T</code>: for any substitution
<code>Γ ⊢ σ : Δ</code> that is logically related to an environment <code>δ ∈ ⟦ Δ ⟧</code>,
<code>Γ ⊢ t[σ] : T</code> must be logically related to <code>⟦ t ⟧ δ</code>. Using the semantic typing
judgement, we will be able to derive that <code>Γ ⊢ t Ⓡ ⟦ t ⟧ ↑Γ</code>.</p>
<pre class="Agda"><a id="_⊨_"></a><a id="71179" href="lagda.2023-11-21-nbe.html#71179" class="Function Operator">_⊨_</a> <a id="71183" class="Symbol">:</a> <a id="71185" class="Symbol">∀</a> <a id="71187" class="Symbol">{</a><a id="71188" href="lagda.2023-11-21-nbe.html#71188" class="Bound">T</a> <a id="71190" class="Symbol">:</a> <a id="71192" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="71196" class="Symbol">}</a> <a id="71198" class="Symbol">→</a> <a id="71200" class="Symbol">(</a><a id="71201" href="lagda.2023-11-21-nbe.html#71201" class="Bound">Δ</a> <a id="71203" class="Symbol">:</a> <a id="71205" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="71208" class="Symbol">)</a> <a id="71210" class="Symbol">→</a> <a id="71212" href="lagda.2023-11-21-nbe.html#71201" class="Bound">Δ</a> <a id="71214" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="71216" href="lagda.2023-11-21-nbe.html#71188" class="Bound">T</a> <a id="71218" class="Symbol">→</a> <a id="71220" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="71224" href="lagda.2023-11-21-nbe.html#71179" class="Function Operator">_⊨_</a> <a id="71228" class="Symbol">{</a><a id="71229" href="lagda.2023-11-21-nbe.html#71229" class="Bound">T</a><a id="71230" class="Symbol">}</a> <a id="71232" href="lagda.2023-11-21-nbe.html#71232" class="Bound">Δ</a> <a id="71234" href="lagda.2023-11-21-nbe.html#71234" class="Bound">t</a> <a id="71236" class="Symbol">=</a>
  <a id="71240" class="Symbol">∀</a> <a id="71242" class="Symbol">{</a><a id="71243" href="lagda.2023-11-21-nbe.html#71243" class="Bound">Γ</a> <a id="71245" class="Symbol">:</a> <a id="71247" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="71250" class="Symbol">}</a> <a id="71252" class="Symbol">{</a><a id="71253" href="lagda.2023-11-21-nbe.html#71253" class="Bound">σ</a> <a id="71255" class="Symbol">:</a> <a id="71257" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="71261" href="lagda.2023-11-21-nbe.html#71243" class="Bound">Γ</a> <a id="71263" href="lagda.2023-11-21-nbe.html#71232" class="Bound">Δ</a><a id="71264" class="Symbol">}</a> <a id="71266" class="Symbol">{</a><a id="71267" href="lagda.2023-11-21-nbe.html#71267" class="Bound">δ</a> <a id="71269" class="Symbol">:</a> <a id="71271" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="71273" href="lagda.2023-11-21-nbe.html#71232" class="Bound">Δ</a> <a id="71275" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a><a id="71276" class="Symbol">}</a>
  <a id="71280" class="Symbol">→</a> <a id="71282" href="lagda.2023-11-21-nbe.html#71253" class="Bound">σ</a> <a id="71284" href="lagda.2023-11-21-nbe.html#70213" class="Function Operator">Ⓡˢ</a> <a id="71287" href="lagda.2023-11-21-nbe.html#71267" class="Bound">δ</a>
    <a id="71293" class="Comment">-------</a>
  <a id="71303" class="Symbol">→</a> <a id="71305" href="lagda.2023-11-21-nbe.html#71234" class="Bound">t</a> <a id="71307" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="71309" href="lagda.2023-11-21-nbe.html#71253" class="Bound">σ</a> <a id="71311" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a> <a id="71313" href="lagda.2023-11-21-nbe.html#56802" class="Function Operator">Ⓡ</a> <a id="71315" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟦⊢</a> <a id="71318" href="lagda.2023-11-21-nbe.html#71234" class="Bound">t</a> <a id="71320" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟧</a> <a id="71322" href="lagda.2023-11-21-nbe.html#71267" class="Bound">δ</a>
</pre>
<p>We can prove the semantic typing judgement <code>Δ ⊨ t : T</code> by induction on the
typing judgement <code>Δ ⊢ t : T</code>; this is called the fundamental lemma of logical
relations.</p>
<p>For <code>unit</code>, the proof follows immediately from how we have defined the logical
relation between terms and semantic objects at type <code>𝟙</code>. In the case of
variables, the given proof is exactly what we need. Application follows from our
inductive hypotheses, leaving us at the abstraction case, which is the most
complicated to prove. Here are the first three cases:</p>
<pre class="Agda"><a id="fundamental-lemma"></a><a id="71865" href="lagda.2023-11-21-nbe.html#71865" class="Function">fundamental-lemma</a> <a id="71883" class="Symbol">:</a> <a id="71885" class="Symbol">∀</a> <a id="71887" class="Symbol">{</a><a id="71888" href="lagda.2023-11-21-nbe.html#71888" class="Bound">Δ</a> <a id="71890" class="Symbol">:</a> <a id="71892" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="71895" class="Symbol">}</a> <a id="71897" class="Symbol">{</a><a id="71898" href="lagda.2023-11-21-nbe.html#71898" class="Bound">T</a> <a id="71900" class="Symbol">:</a> <a id="71902" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="71906" class="Symbol">}</a> <a id="71908" class="Symbol">{</a><a id="71909" href="lagda.2023-11-21-nbe.html#71909" class="Bound">t</a> <a id="71911" class="Symbol">:</a> <a id="71913" href="lagda.2023-11-21-nbe.html#71888" class="Bound">Δ</a> <a id="71915" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="71917" href="lagda.2023-11-21-nbe.html#71898" class="Bound">T</a><a id="71918" class="Symbol">}</a>
                  <a id="71938" class="Symbol">→</a> <a id="71940" href="lagda.2023-11-21-nbe.html#71888" class="Bound">Δ</a> <a id="71942" href="lagda.2023-11-21-nbe.html#71179" class="Function Operator">⊨</a> <a id="71944" href="lagda.2023-11-21-nbe.html#71909" class="Bound">t</a>
<a id="71946" href="lagda.2023-11-21-nbe.html#71865" class="Function">fundamental-lemma</a> <a id="71964" class="Symbol">{</a><a id="71965" class="Argument">t</a> <a id="71967" class="Symbol">=</a> <a id="71969" href="lagda.2023-11-21-nbe.html#5867" class="InductiveConstructor">unit</a><a id="71973" class="Symbol">}</a> <a id="71975" href="lagda.2023-11-21-nbe.html#71975" class="Bound">σⓇδ</a> <a id="71979" class="Symbol">_</a> <a id="71981" class="Symbol">=</a> <a id="71983" href="lagda.2023-11-21-nbe.html#31125" class="InductiveConstructor">refl⁼⁼</a>
<a id="71990" href="lagda.2023-11-21-nbe.html#71865" class="Function">fundamental-lemma</a> <a id="72008" class="Symbol">{</a><a id="72009" class="Argument">t</a> <a id="72011" class="Symbol">=</a> <a id="72013" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="72015" href="lagda.2023-11-21-nbe.html#72015" class="Bound">x</a><a id="72016" class="Symbol">}</a> <a id="72018" href="lagda.2023-11-21-nbe.html#72018" class="Bound">σⓇδ</a> <a id="72022" class="Symbol">=</a> <a id="72024" href="lagda.2023-11-21-nbe.html#72018" class="Bound">σⓇδ</a> <a id="72028" href="lagda.2023-11-21-nbe.html#72015" class="Bound">x</a>
<a id="72030" href="lagda.2023-11-21-nbe.html#71865" class="Function">fundamental-lemma</a> <a id="72048" class="Symbol">{</a><a id="72049" class="Argument">t</a> <a id="72051" class="Symbol">=</a> <a id="72053" href="lagda.2023-11-21-nbe.html#72053" class="Bound">r</a> <a id="72055" href="lagda.2023-11-21-nbe.html#6065" class="InductiveConstructor Operator">·</a> <a id="72057" href="lagda.2023-11-21-nbe.html#72057" class="Bound">s</a><a id="72058" class="Symbol">}</a> <a id="72060" class="Symbol">{</a><a id="72061" class="Argument">σ</a> <a id="72063" class="Symbol">=</a> <a id="72065" href="lagda.2023-11-21-nbe.html#72065" class="Bound">σ</a><a id="72066" class="Symbol">}</a> <a id="72068" href="lagda.2023-11-21-nbe.html#72068" class="Bound">σⓇδ</a>
  <a id="72074" class="Keyword">with</a> <a id="72079" href="lagda.2023-11-21-nbe.html#71865" class="Function">fundamental-lemma</a> <a id="72097" class="Symbol">{</a><a id="72098" class="Argument">t</a> <a id="72100" class="Symbol">=</a> <a id="72102" href="lagda.2023-11-21-nbe.html#72053" class="Bound">r</a><a id="72103" class="Symbol">}</a> <a id="72105" href="lagda.2023-11-21-nbe.html#72068" class="Bound">σⓇδ</a> <a id="72109" class="Symbol">|</a> <a id="72111" href="lagda.2023-11-21-nbe.html#71865" class="Function">fundamental-lemma</a> <a id="72129" class="Symbol">{</a><a id="72130" class="Argument">t</a> <a id="72132" class="Symbol">=</a> <a id="72134" href="lagda.2023-11-21-nbe.html#72057" class="Bound">s</a><a id="72135" class="Symbol">}</a> <a id="72137" href="lagda.2023-11-21-nbe.html#72068" class="Bound">σⓇδ</a>
<a id="72141" class="Symbol">...</a> <a id="72145" class="Symbol">|</a> <a id="72147" href="lagda.2023-11-21-nbe.html#72147" class="Bound">Γ⊨r</a>                             <a id="72179" class="Symbol">|</a> <a id="72181" href="lagda.2023-11-21-nbe.html#72181" class="Bound">Γ⊨s</a>
  <a id="72187" class="Keyword">with</a> <a id="72192" href="lagda.2023-11-21-nbe.html#72147" class="Bound">Γ⊨r</a> <a id="72196" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a> <a id="72201" href="lagda.2023-11-21-nbe.html#72181" class="Bound">Γ⊨s</a>
<a id="72205" class="Symbol">...</a> <a id="72209" class="Symbol">|</a> <a id="72211" href="lagda.2023-11-21-nbe.html#72211" class="Bound">pf</a>
  <a id="72216" class="Keyword">rewrite</a> <a id="72224" href="lagda.2023-11-21-nbe.html#22591" class="Function">[id]-identity</a> <a id="72238" class="Symbol">{</a><a id="72239" class="Argument">t</a> <a id="72241" class="Symbol">=</a> <a id="72243" class="Bound">r</a> <a id="72245" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="72247" class="Bound">σ</a> <a id="72249" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a><a id="72250" class="Symbol">}</a> <a id="72252" class="Symbol">=</a> <a id="72254" href="lagda.2023-11-21-nbe.html#72211" class="Bound">pf</a>
</pre>
<p>In the case of an abstraction <code>Γ ⊢ λx. t : S → T</code>, we want to prove:</p>
<pre><code>Γ ⊢ σ : Δ Ⓡ δ ⇒
  Γ ⊢ (λx. t)[σ] : S → T Ⓡ ⟦ Γ ⊢ λx. t : S → T ⟧ δ</code></pre>
<p>By the definition of the application of a substitution to an abstraction, as
well as the definition of evaluation of an abstraction, this simplifies to:</p>
<pre><code>Γ ⊢ σ : Δ Ⓡ δ ⇒
  Γ ⊢ λx. t[exts σ] : S → T Ⓡ f

      where f = λ a → ⟦ Γ, x:S ⊢ t : T ⟧ (δ , a)</code></pre>
<p>We can also expand this using the definition of <code>Ⓡ</code> for functions (and
immediately reducing the application of <code>f</code> to <code>a</code>):</p>
<pre><code>Γ ⊢ σ : Δ Ⓡ δ ⇒
  ∀ Γ′ ≤ Γ. Γ′ ⊢ s : S Ⓡ a ⇒
    Γ′ ⊢ (λx. t[exts σ]) · s : T Ⓡ ⟦ Γ, x:S ⊢ t : T ⟧ (δ , a)</code></pre>
<p>Already, this is a tricky property to parse. To start, we can use our lemma
that <code>Ⓡ</code> is transitive with respect to definitional equality, and use the <code>β</code>
rule to reduce <code>(λx. t[exts σ]) · s</code> to <code>t[exts σ][s/x]</code>. Now, we need only
prove:</p>
<pre><code>Γ′ ⊢ t[exts σ][s/x] : T Ⓡ ⟦ Γ, x:S ⊢ t : T ⟧ (δ , a)</code></pre>
<p>Here, we can use a few substitution lemma to compose these two substitutions and
reduce them into just <code>σ ∷ s</code>, giving us:</p>
<pre><code>Γ′ ⊢ t [σ ∷ s] : T Ⓡ ⟦ Γ, x:S ⊢ t : T ⟧ (δ , a)</code></pre>
<p>The property we want to show now looks like our induction hypothesis! Using the
induction hypothesis, we only need to show that:</p>
<pre><code> Γ′ ⊢ σ ∷ s : (Δ, x:S) Ⓡ (δ , a)</code></pre>
<p>In other words, we need to prove that for any variable <code>x</code> in the context
<code>Δ, x:S</code> that <code>σ</code> is substituting a term for, the term being substituted for
that variable must be logically related to its corresponding semantic object in
the environment <code>(δ , a)</code>. We can do a case analysis on <code>x</code> to break this down
further. The first case is what the relation simplifies to in the case that the
variable being substituted for is <code>𝑍</code> ─ all that needs to be proven is that the
term being substituted for the first variable in <code>Δ, x:S</code> (which is <code>s</code>) is
logically related to the first semantic object in <code>(δ , a)</code>. In other words,
for this case, what needs to be proven is:</p>
<pre><code>Γ′ ⊢ s : S Ⓡ a</code></pre>
<p>This is already our given proof, so this case follows immediately. The second
case is what the relation simplifies to in the case that the variable being
substituted for is in <code>Δ</code>, meaning <code>x</code> is <code>𝑆 x</code>:</p>
<pre><code>Γ′ ⊢ (σ ∷ s) (𝑆 x) : U Ⓡ env-lookup x δ</code></pre>
<p>Here, we need to use a few substitution lemmas (which have been omitted as their
proofs are unrelated to the logical relation itself) to rewrite this to:</p>
<pre><code>Γ′ ⊢ σ x : U Ⓡ env-lookup x δ</code></pre>
<p>This is again already given to us from our given proof that <code>Γ ⊢ σ : Δ Ⓡ δ</code>.
There is one small problem: we are now considering the context <code>Γ′</code> while our
given proof is over the context <code>Γ</code>. There was, in fact, an implict <em>weakening</em>
of <code>σ</code> in the changing of contexts (and it would be more correct to have been
writing <code>σ ∘ weaken Γ′≤Γ</code> throughout, though the explanation used <code>σ</code> for
simplicity). Here, we can use the earlier lemma that if a substitution is
logically related to an environment, then so is a weakening of the substitution.
With that, the abstraction case is proven.</p>
<p>In Agda, we require some substitution lemmas (both for the conversion of
<code>t[exts σ][s/x]</code> to <code>t[σ ∷ s]</code> and to handle the implcit weakening) which have
been omitted (and for convenience, we use the variables <code>t[exts-σ]</code> and <code>σ∷s</code>,
whose definitions are also omitted).</p>
<pre class="Agda"><a id="75552" href="lagda.2023-11-21-nbe.html#71865" class="Function">fundamental-lemma</a> <a id="75570" class="Symbol">{</a><a id="75571" href="lagda.2023-11-21-nbe.html#75571" class="Bound">Δ</a><a id="75572" class="Symbol">}</a> <a id="75574" class="Symbol">{</a><a id="75575" href="lagda.2023-11-21-nbe.html#75575" class="Bound">S</a> <a id="75577" href="lagda.2023-11-21-nbe.html#3191" class="InductiveConstructor Operator">⇒</a> <a id="75579" href="lagda.2023-11-21-nbe.html#75579" class="Bound">T</a><a id="75580" class="Symbol">}</a> <a id="75582" class="Symbol">{</a><a id="75583" href="lagda.2023-11-21-nbe.html#5974" class="InductiveConstructor Operator">ƛ</a> <a id="75585" href="lagda.2023-11-21-nbe.html#75585" class="Bound">t</a><a id="75586" class="Symbol">}</a> <a id="75588" class="Symbol">{</a><a id="75589" class="Argument">σ</a> <a id="75591" class="Symbol">=</a> <a id="75593" href="lagda.2023-11-21-nbe.html#75593" class="Bound">σ</a><a id="75594" class="Symbol">}</a> <a id="75596" class="Symbol">{</a><a id="75597" href="lagda.2023-11-21-nbe.html#75597" class="Bound">δ</a><a id="75598" class="Symbol">}</a> <a id="75600" href="lagda.2023-11-21-nbe.html#75600" class="Bound">σⓇδ</a> <a id="75604" class="Symbol">{</a><a id="75605" href="lagda.2023-11-21-nbe.html#75605" class="Bound">Γ′</a><a id="75607" class="Symbol">}</a> <a id="75609" href="lagda.2023-11-21-nbe.html#75609" class="Bound">Γ′≤Γ</a> <a id="75614" class="Symbol">{</a><a id="75615" href="lagda.2023-11-21-nbe.html#75615" class="Bound">s</a><a id="75616" class="Symbol">}</a> <a id="75618" class="Symbol">{</a><a id="75619" href="lagda.2023-11-21-nbe.html#75619" class="Bound">a</a><a id="75620" class="Symbol">}</a> <a id="75622" href="lagda.2023-11-21-nbe.html#75622" class="Bound">sⓇa</a> <a id="75626" class="Symbol">=</a>
  <a id="75630" href="lagda.2023-11-21-nbe.html#58832" class="Function">==-Ⓡ-trans</a> <a id="75641" class="Symbol">(</a><a id="75642" href="lagda.2023-11-21-nbe.html#31208" class="InductiveConstructor">sym⁼⁼</a> <a id="75648" href="lagda.2023-11-21-nbe.html#30351" class="InductiveConstructor">β</a><a id="75649" class="Symbol">)</a> <a id="75651" href="lagda.2023-11-21-nbe.html#77165" class="Function">t[exts-σ][s/x]Ⓡ⟦t⟧⟨δ,a⟩</a>
  <a id="75677" class="Keyword">where</a>
    <a id="75687" href="lagda.2023-11-21-nbe.html#75687" class="Function">t[exts-σ]</a> <a id="75697" class="Symbol">:</a> <a id="75699" href="lagda.2023-11-21-nbe.html#75605" class="Bound">Γ′</a> <a id="75702" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="75704" href="lagda.2023-11-21-nbe.html#75575" class="Bound">S</a> <a id="75706" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="75708" href="lagda.2023-11-21-nbe.html#75579" class="Bound">T</a>
    <a id="75714" href="lagda.2023-11-21-nbe.html#75714" class="Function">σ∷s</a> <a id="75718" class="Symbol">:</a> <a id="75720" href="lagda.2023-11-21-nbe.html#11638" class="Function">Sub</a> <a id="75724" href="lagda.2023-11-21-nbe.html#75605" class="Bound">Γ′</a> <a id="75727" class="Symbol">(</a><a id="75728" href="lagda.2023-11-21-nbe.html#75571" class="Bound">Δ</a> <a id="75730" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="75732" href="lagda.2023-11-21-nbe.html#75575" class="Bound">S</a><a id="75733" class="Symbol">)</a>
</pre>
<!---
<pre class="Agda">    <a id="75758" href="lagda.2023-11-21-nbe.html#75687" class="Function">t[exts-σ]</a> <a id="75768" class="Symbol">=</a> <a id="75770" href="lagda.2023-11-21-nbe.html#75585" class="Bound">t</a> <a id="75772" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="75774" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="75779" href="lagda.2023-11-21-nbe.html#75593" class="Bound">σ</a> <a id="75781" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a> <a id="75783" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="75785" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="75790" class="Symbol">(</a><a id="75791" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="75798" href="lagda.2023-11-21-nbe.html#75609" class="Bound">Γ′≤Γ</a><a id="75802" class="Symbol">)</a> <a id="75804" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a>
    <a id="75810" href="lagda.2023-11-21-nbe.html#75714" class="Function">σ∷s</a> <a id="75814" class="Symbol">=</a> <a id="75816" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="75821" href="lagda.2023-11-21-nbe.html#75593" class="Bound">σ</a> <a id="75823" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="75825" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="75830" class="Symbol">(</a><a id="75831" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="75838" href="lagda.2023-11-21-nbe.html#75609" class="Bound">Γ′≤Γ</a><a id="75842" class="Symbol">)</a> <a id="75844" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="75846" class="Symbol">(</a><a id="75847" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="75850" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="75852" href="lagda.2023-11-21-nbe.html#75615" class="Bound">s</a><a id="75853" class="Symbol">)</a>

    <a id="75860" href="lagda.2023-11-21-nbe.html#75860" class="Function">subst-lemma₁</a> <a id="75873" class="Symbol">:</a> <a id="75875" class="Symbol">∀</a> <a id="75877" class="Symbol">{</a><a id="75878" href="lagda.2023-11-21-nbe.html#75878" class="Bound">U</a> <a id="75880" class="Symbol">:</a> <a id="75882" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="75886" class="Symbol">}</a> <a id="75888" class="Symbol">{</a><a id="75889" href="lagda.2023-11-21-nbe.html#75889" class="Bound">x</a> <a id="75891" class="Symbol">:</a> <a id="75893" href="lagda.2023-11-21-nbe.html#75571" class="Bound">Δ</a> <a id="75895" href="lagda.2023-11-21-nbe.html#4554" class="Datatype Operator">∋</a> <a id="75897" href="lagda.2023-11-21-nbe.html#75878" class="Bound">U</a><a id="75898" class="Symbol">}</a> <a id="75900" class="Symbol">→</a> <a id="75902" href="lagda.2023-11-21-nbe.html#75714" class="Function">σ∷s</a> <a id="75906" class="Symbol">(</a><a id="75907" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="75909" href="lagda.2023-11-21-nbe.html#75889" class="Bound">x</a><a id="75910" class="Symbol">)</a> <a id="75912" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="75914" class="Symbol">(</a><a id="75915" href="lagda.2023-11-21-nbe.html#75593" class="Bound">σ</a> <a id="75917" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="75919" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="75926" href="lagda.2023-11-21-nbe.html#75609" class="Bound">Γ′≤Γ</a><a id="75930" class="Symbol">)</a> <a id="75932" href="lagda.2023-11-21-nbe.html#75889" class="Bound">x</a>
    <a id="75938" href="lagda.2023-11-21-nbe.html#75860" class="Function">subst-lemma₁</a> <a id="75951" class="Symbol">{</a><a id="75952" class="Argument">x</a> <a id="75954" class="Symbol">=</a> <a id="75956" href="lagda.2023-11-21-nbe.html#75956" class="Bound">x</a><a id="75957" class="Symbol">}</a> <a id="75959" class="Symbol">=</a>
      <a id="75967" href="Relation.Binary.PropositionalEquality.Core.html#2806" class="Function Operator">begin</a>
        <a id="75981" href="lagda.2023-11-21-nbe.html#75714" class="Function">σ∷s</a> <a id="75985" class="Symbol">(</a><a id="75986" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="75988" href="lagda.2023-11-21-nbe.html#75956" class="Bound">x</a><a id="75989" class="Symbol">)</a>
      <a id="75997" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="76000" href="lagda.2023-11-21-nbe.html#25008" class="Function">sub-𝑆-shift</a> <a id="76012" class="Symbol">{</a><a id="76013" class="Argument">σ</a> <a id="76015" class="Symbol">=</a> <a id="76017" href="lagda.2023-11-21-nbe.html#75714" class="Function">σ∷s</a><a id="76020" class="Symbol">}</a> <a id="76022" class="Symbol">{</a><a id="76023" href="lagda.2023-11-21-nbe.html#75956" class="Bound">x</a><a id="76024" class="Symbol">}</a> <a id="76026" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
        <a id="76036" class="Symbol">(</a><a id="76037" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a> <a id="76039" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76041" href="lagda.2023-11-21-nbe.html#75714" class="Function">σ∷s</a><a id="76044" class="Symbol">)</a> <a id="76046" href="lagda.2023-11-21-nbe.html#75956" class="Bound">x</a>
      <a id="76054" href="Relation.Binary.PropositionalEquality.Core.html#2864" class="Function Operator">≡⟨⟩</a>
        <a id="76066" class="Symbol">(</a><a id="76067" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a> <a id="76069" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76071" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="76076" href="lagda.2023-11-21-nbe.html#75593" class="Bound">σ</a> <a id="76078" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76080" class="Symbol">(</a><a id="76081" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="76086" class="Symbol">(</a><a id="76087" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="76094" href="lagda.2023-11-21-nbe.html#75609" class="Bound">Γ′≤Γ</a><a id="76098" class="Symbol">)</a> <a id="76100" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76102" class="Symbol">(</a><a id="76103" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="76106" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="76108" href="lagda.2023-11-21-nbe.html#75615" class="Bound">s</a><a id="76109" class="Symbol">)))</a> <a id="76113" href="lagda.2023-11-21-nbe.html#75956" class="Bound">x</a>
      <a id="76121" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="76124" href="Relation.Binary.PropositionalEquality.Core.html#1461" class="Function">cong-app</a> <a id="76133" class="Symbol">(</a><a id="76134" href="lagda.2023-11-21-nbe.html#20470" class="Function">cong-seq</a> <a id="76143" class="Symbol">{</a><a id="76144" class="Argument">σ</a> <a id="76146" class="Symbol">=</a> <a id="76148" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a> <a id="76150" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76152" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="76157" href="lagda.2023-11-21-nbe.html#75593" class="Bound">σ</a><a id="76158" class="Symbol">}</a> <a id="76160" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="76165" href="lagda.2023-11-21-nbe.html#26389" class="Function">subst-zero-exts-cons</a><a id="76185" class="Symbol">)</a> <a id="76187" href="lagda.2023-11-21-nbe.html#75956" class="Bound">x</a> <a id="76189" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
        <a id="76199" class="Symbol">(</a><a id="76200" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a> <a id="76202" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76204" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="76209" href="lagda.2023-11-21-nbe.html#75593" class="Bound">σ</a> <a id="76211" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76213" class="Symbol">(</a><a id="76214" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="76221" href="lagda.2023-11-21-nbe.html#75609" class="Bound">Γ′≤Γ</a> <a id="76226" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="76228" href="lagda.2023-11-21-nbe.html#75615" class="Bound">s</a><a id="76229" class="Symbol">))</a> <a id="76232" href="lagda.2023-11-21-nbe.html#75956" class="Bound">x</a>
      <a id="76240" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="76243" href="Relation.Binary.PropositionalEquality.Core.html#1461" class="Function">cong-app</a> <a id="76252" class="Symbol">(</a><a id="76253" href="lagda.2023-11-21-nbe.html#20470" class="Function">cong-seq</a> <a id="76262" class="Symbol">{</a><a id="76263" class="Argument">σ</a> <a id="76265" class="Symbol">=</a> <a id="76267" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a><a id="76268" class="Symbol">}</a> <a id="76270" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="76275" class="Symbol">(</a><a id="76276" href="lagda.2023-11-21-nbe.html#20470" class="Function">cong-seq</a> <a id="76285" class="Symbol">{</a><a id="76286" class="Argument">σ</a> <a id="76288" class="Symbol">=</a> <a id="76290" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="76295" href="lagda.2023-11-21-nbe.html#75593" class="Bound">σ</a><a id="76296" class="Symbol">}</a> <a id="76298" href="lagda.2023-11-21-nbe.html#22075" class="Function">exts-cons-shift</a> <a id="76314" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="76318" class="Symbol">))</a> <a id="76321" href="lagda.2023-11-21-nbe.html#75956" class="Bound">x</a> <a id="76323" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
        <a id="76333" class="Symbol">(</a><a id="76334" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a> <a id="76336" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76338" class="Symbol">((</a><a id="76340" href="lagda.2023-11-21-nbe.html#75593" class="Bound">σ</a> <a id="76342" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76344" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a><a id="76345" class="Symbol">)</a> <a id="76347" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="76349" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="76351" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a><a id="76352" class="Symbol">)</a> <a id="76354" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76356" class="Symbol">(</a><a id="76357" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="76364" href="lagda.2023-11-21-nbe.html#75609" class="Bound">Γ′≤Γ</a> <a id="76369" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="76371" href="lagda.2023-11-21-nbe.html#75615" class="Bound">s</a><a id="76372" class="Symbol">))</a> <a id="76375" href="lagda.2023-11-21-nbe.html#75956" class="Bound">x</a>
      <a id="76383" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="76386" href="Relation.Binary.PropositionalEquality.Core.html#1461" class="Function">cong-app</a> <a id="76395" class="Symbol">(</a><a id="76396" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="76400" class="Symbol">(</a><a id="76401" href="lagda.2023-11-21-nbe.html#26083" class="Function">sub-assoc</a> <a id="76411" class="Symbol">{</a><a id="76412" class="Argument">σ</a> <a id="76414" class="Symbol">=</a> <a id="76416" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a><a id="76417" class="Symbol">}</a> <a id="76419" class="Symbol">{(</a><a id="76421" href="lagda.2023-11-21-nbe.html#75593" class="Bound">σ</a> <a id="76423" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76425" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a><a id="76426" class="Symbol">)</a> <a id="76428" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="76430" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="76432" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a><a id="76433" class="Symbol">}</a> <a id="76435" class="Symbol">{</a><a id="76436" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="76443" href="lagda.2023-11-21-nbe.html#75609" class="Bound">Γ′≤Γ</a> <a id="76448" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="76450" href="lagda.2023-11-21-nbe.html#75615" class="Bound">s</a><a id="76451" class="Symbol">}))</a> <a id="76455" href="lagda.2023-11-21-nbe.html#75956" class="Bound">x</a> <a id="76457" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
        <a id="76467" class="Symbol">((</a><a id="76469" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a> <a id="76471" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76473" class="Symbol">((</a><a id="76475" href="lagda.2023-11-21-nbe.html#75593" class="Bound">σ</a> <a id="76477" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76479" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a><a id="76480" class="Symbol">)</a> <a id="76482" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="76484" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="76486" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a><a id="76487" class="Symbol">))</a> <a id="76490" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76492" class="Symbol">(</a><a id="76493" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="76500" href="lagda.2023-11-21-nbe.html#75609" class="Bound">Γ′≤Γ</a> <a id="76505" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="76507" href="lagda.2023-11-21-nbe.html#75615" class="Bound">s</a><a id="76508" class="Symbol">))</a> <a id="76511" href="lagda.2023-11-21-nbe.html#75956" class="Bound">x</a>
      <a id="76519" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="76522" href="Relation.Binary.PropositionalEquality.Core.html#1461" class="Function">cong-app</a> <a id="76531" class="Symbol">(</a><a id="76532" href="lagda.2023-11-21-nbe.html#20470" class="Function">cong-seq</a> <a id="76541" class="Symbol">(</a><a id="76542" href="lagda.2023-11-21-nbe.html#17835" class="Function">sub-tail</a> <a id="76551" class="Symbol">{</a><a id="76552" class="Argument">s</a> <a id="76554" class="Symbol">=</a> <a id="76556" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="76558" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a><a id="76559" class="Symbol">}</a> <a id="76561" class="Symbol">{</a><a id="76562" href="lagda.2023-11-21-nbe.html#75593" class="Bound">σ</a> <a id="76564" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76566" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a><a id="76567" class="Symbol">})</a> <a id="76570" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="76574" class="Symbol">)</a> <a id="76576" href="lagda.2023-11-21-nbe.html#75956" class="Bound">x</a> <a id="76578" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
        <a id="76588" class="Symbol">((</a><a id="76590" href="lagda.2023-11-21-nbe.html#75593" class="Bound">σ</a> <a id="76592" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76594" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a><a id="76595" class="Symbol">)</a> <a id="76597" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76599" class="Symbol">(</a><a id="76600" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="76607" href="lagda.2023-11-21-nbe.html#75609" class="Bound">Γ′≤Γ</a> <a id="76612" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="76614" href="lagda.2023-11-21-nbe.html#75615" class="Bound">s</a><a id="76615" class="Symbol">))</a> <a id="76618" href="lagda.2023-11-21-nbe.html#75956" class="Bound">x</a>
      <a id="76626" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="76629" href="Relation.Binary.PropositionalEquality.Core.html#1461" class="Function">cong-app</a> <a id="76638" class="Symbol">(</a><a id="76639" href="lagda.2023-11-21-nbe.html#26083" class="Function">sub-assoc</a> <a id="76649" class="Symbol">{</a><a id="76650" class="Argument">σ</a> <a id="76652" class="Symbol">=</a> <a id="76654" href="lagda.2023-11-21-nbe.html#75593" class="Bound">σ</a><a id="76655" class="Symbol">}</a> <a id="76657" class="Symbol">{</a><a id="76658" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a><a id="76659" class="Symbol">}</a> <a id="76661" class="Symbol">{</a><a id="76662" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="76669" href="lagda.2023-11-21-nbe.html#75609" class="Bound">Γ′≤Γ</a> <a id="76674" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="76676" href="lagda.2023-11-21-nbe.html#75615" class="Bound">s</a><a id="76677" class="Symbol">})</a> <a id="76680" href="lagda.2023-11-21-nbe.html#75956" class="Bound">x</a> <a id="76682" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
        <a id="76692" class="Symbol">(</a><a id="76693" href="lagda.2023-11-21-nbe.html#75593" class="Bound">σ</a> <a id="76695" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76697" href="lagda.2023-11-21-nbe.html#16037" class="Function">↥</a> <a id="76699" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76701" class="Symbol">(</a><a id="76702" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="76709" href="lagda.2023-11-21-nbe.html#75609" class="Bound">Γ′≤Γ</a> <a id="76714" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="76716" href="lagda.2023-11-21-nbe.html#75615" class="Bound">s</a><a id="76717" class="Symbol">))</a> <a id="76720" href="lagda.2023-11-21-nbe.html#75956" class="Bound">x</a>
      <a id="76728" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="76731" href="Relation.Binary.PropositionalEquality.Core.html#1461" class="Function">cong-app</a> <a id="76740" class="Symbol">(</a><a id="76741" href="lagda.2023-11-21-nbe.html#20470" class="Function">cong-seq</a> <a id="76750" class="Symbol">{</a><a id="76751" class="Argument">σ</a> <a id="76753" class="Symbol">=</a> <a id="76755" href="lagda.2023-11-21-nbe.html#75593" class="Bound">σ</a><a id="76756" class="Symbol">}</a> <a id="76758" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="76763" class="Symbol">(</a><a id="76764" href="lagda.2023-11-21-nbe.html#17835" class="Function">sub-tail</a> <a id="76773" class="Symbol">{</a><a id="76774" class="Argument">s</a> <a id="76776" class="Symbol">=</a> <a id="76778" href="lagda.2023-11-21-nbe.html#75615" class="Bound">s</a><a id="76779" class="Symbol">}</a> <a id="76781" class="Symbol">{</a><a id="76782" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="76789" href="lagda.2023-11-21-nbe.html#75609" class="Bound">Γ′≤Γ</a><a id="76793" class="Symbol">}))</a> <a id="76797" href="lagda.2023-11-21-nbe.html#75956" class="Bound">x</a> <a id="76799" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
        <a id="76809" class="Symbol">(</a><a id="76810" href="lagda.2023-11-21-nbe.html#75593" class="Bound">σ</a> <a id="76812" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76814" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="76821" href="lagda.2023-11-21-nbe.html#75609" class="Bound">Γ′≤Γ</a><a id="76825" class="Symbol">)</a> <a id="76827" href="lagda.2023-11-21-nbe.html#75956" class="Bound">x</a>
      <a id="76835" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>

    <a id="76842" href="lagda.2023-11-21-nbe.html#76842" class="Function">subst-lemma₂</a> <a id="76855" class="Symbol">=</a> <a id="76857" href="lagda.2023-11-21-nbe.html#25552" class="Function">sub-sub</a> <a id="76865" class="Symbol">{</a><a id="76866" class="Argument">τ</a> <a id="76868" class="Symbol">=</a> <a id="76870" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="76873" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="76875" href="lagda.2023-11-21-nbe.html#75615" class="Bound">s</a><a id="76876" class="Symbol">}</a> <a id="76878" class="Symbol">{</a><a id="76879" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="76884" class="Symbol">(</a><a id="76885" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="76892" href="lagda.2023-11-21-nbe.html#75609" class="Bound">Γ′≤Γ</a><a id="76896" class="Symbol">)}</a> <a id="76899" class="Symbol">{</a><a id="76900" href="lagda.2023-11-21-nbe.html#75585" class="Bound">t</a> <a id="76902" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="76904" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="76909" href="lagda.2023-11-21-nbe.html#75593" class="Bound">σ</a> <a id="76911" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a><a id="76912" class="Symbol">}</a>
    <a id="76918" href="lagda.2023-11-21-nbe.html#76918" class="Function">subst-lemma₃</a> <a id="76931" class="Symbol">=</a> <a id="76933" href="lagda.2023-11-21-nbe.html#25552" class="Function">sub-sub</a> <a id="76941" class="Symbol">{</a><a id="76942" class="Argument">τ</a> <a id="76944" class="Symbol">=</a> <a id="76946" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="76951" class="Symbol">(</a><a id="76952" href="lagda.2023-11-21-nbe.html#17002" class="Function">weaken</a> <a id="76959" href="lagda.2023-11-21-nbe.html#75609" class="Bound">Γ′≤Γ</a><a id="76963" class="Symbol">)</a> <a id="76965" href="lagda.2023-11-21-nbe.html#16093" class="Function Operator">∘</a> <a id="76967" class="Symbol">(</a><a id="76968" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="76971" href="lagda.2023-11-21-nbe.html#16540" class="Function Operator">∷</a> <a id="76973" href="lagda.2023-11-21-nbe.html#75615" class="Bound">s</a><a id="76974" class="Symbol">)}</a> <a id="76977" class="Symbol">{</a><a id="76978" href="lagda.2023-11-21-nbe.html#15372" class="Function">exts</a> <a id="76983" href="lagda.2023-11-21-nbe.html#75593" class="Bound">σ</a><a id="76984" class="Symbol">}</a> <a id="76986" class="Symbol">{</a><a id="76987" href="lagda.2023-11-21-nbe.html#75585" class="Bound">t</a><a id="76988" class="Symbol">}</a>
</pre>--->
<pre class="Agda">    <a id="77012" href="lagda.2023-11-21-nbe.html#77012" class="Function">σ∷sⓇ⟨δ,a⟩</a> <a id="77022" class="Symbol">:</a> <a id="77024" href="lagda.2023-11-21-nbe.html#75714" class="Function">σ∷s</a>  <a id="77029" href="lagda.2023-11-21-nbe.html#70213" class="Function Operator">Ⓡˢ</a> <a id="77032" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="77034" href="lagda.2023-11-21-nbe.html#75597" class="Bound">δ</a> <a id="77036" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="77038" href="lagda.2023-11-21-nbe.html#75619" class="Bound">a</a> <a id="77040" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a>
    <a id="77046" href="lagda.2023-11-21-nbe.html#77012" class="Function">σ∷sⓇ⟨δ,a⟩</a> <a id="77056" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a> <a id="77058" class="Symbol">=</a> <a id="77060" href="lagda.2023-11-21-nbe.html#75622" class="Bound">sⓇa</a>
    <a id="77068" href="lagda.2023-11-21-nbe.html#77012" class="Function">σ∷sⓇ⟨δ,a⟩</a> <a id="77078" class="Symbol">(</a><a id="77079" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆_</a> <a id="77082" class="Symbol">{</a><a id="77083" class="Argument">T</a> <a id="77085" class="Symbol">=</a> <a id="77087" href="lagda.2023-11-21-nbe.html#77087" class="Bound">U</a><a id="77088" class="Symbol">}</a> <a id="77090" href="lagda.2023-11-21-nbe.html#77090" class="Bound">x</a><a id="77091" class="Symbol">)</a> <a id="77093" class="Keyword">rewrite</a> <a id="77101" href="lagda.2023-11-21-nbe.html#75860" class="Function">subst-lemma₁</a> <a id="77114" class="Symbol">{</a><a id="77115" class="Argument">x</a> <a id="77117" class="Symbol">=</a> <a id="77119" href="lagda.2023-11-21-nbe.html#77090" class="Bound">x</a><a id="77120" class="Symbol">}</a> <a id="77122" class="Symbol">=</a>
      <a id="77130" href="lagda.2023-11-21-nbe.html#70612" class="Function">Ⓡˢ-weaken</a> <a id="77140" class="Symbol">{</a><a id="77141" class="Argument">Γ′≤Γ</a> <a id="77146" class="Symbol">=</a> <a id="77148" href="lagda.2023-11-21-nbe.html#75609" class="Bound">Γ′≤Γ</a><a id="77152" class="Symbol">}</a> <a id="77154" href="lagda.2023-11-21-nbe.html#75600" class="Bound">σⓇδ</a> <a id="77158" href="lagda.2023-11-21-nbe.html#77090" class="Bound">x</a>

    <a id="77165" href="lagda.2023-11-21-nbe.html#77165" class="Function">t[exts-σ][s/x]Ⓡ⟦t⟧⟨δ,a⟩</a> <a id="77189" class="Symbol">:</a> <a id="77191" href="lagda.2023-11-21-nbe.html#75687" class="Function">t[exts-σ]</a> <a id="77201" href="lagda.2023-11-21-nbe.html#29366" class="Function Operator">[</a> <a id="77203" href="lagda.2023-11-21-nbe.html#75615" class="Bound">s</a> <a id="77205" href="lagda.2023-11-21-nbe.html#29366" class="Function Operator">]₀</a> <a id="77208" href="lagda.2023-11-21-nbe.html#56802" class="Function Operator">Ⓡ</a> <a id="77210" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟦⊢</a> <a id="77213" href="lagda.2023-11-21-nbe.html#75585" class="Bound">t</a> <a id="77215" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟧</a> <a id="77217" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="77219" href="lagda.2023-11-21-nbe.html#75597" class="Bound">δ</a> <a id="77221" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="77223" href="lagda.2023-11-21-nbe.html#75619" class="Bound">a</a> <a id="77225" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a>
    <a id="77231" href="lagda.2023-11-21-nbe.html#77165" class="Function">t[exts-σ][s/x]Ⓡ⟦t⟧⟨δ,a⟩</a> <a id="77255" class="Keyword">rewrite</a> <a id="77263" href="lagda.2023-11-21-nbe.html#76842" class="Function">subst-lemma₂</a> <a id="77276" class="Symbol">|</a> <a id="77278" href="lagda.2023-11-21-nbe.html#76918" class="Function">subst-lemma₃</a> <a id="77291" class="Symbol">=</a>
        <a id="77301" href="lagda.2023-11-21-nbe.html#71865" class="Function">fundamental-lemma</a> <a id="77319" class="Symbol">{</a><a id="77320" class="Argument">t</a> <a id="77322" class="Symbol">=</a> <a id="77324" href="lagda.2023-11-21-nbe.html#75585" class="Bound">t</a><a id="77325" class="Symbol">}</a> <a id="77327" href="lagda.2023-11-21-nbe.html#77012" class="Function">σ∷sⓇ⟨δ,a⟩</a>
</pre>
<p>Separately, we have that the identity substitution is logically related to
our environment of reflected variables, <code>Γ ⊢ id : Γ Ⓡ ↑Γ</code>. We prove this by
induction on the variable being substituted for, using the lemma that
<code>Γ, x:T ⊢ x : T Ⓡ ↑ᵀ 𝓍̂ Γ</code> for the base case. For the inductive step, there is a
need to weaken the inductive hypothesis (which gives us that
<code>Γ ⊢ y : T Ⓡ ↑ᵀ 𝓍̂ Γ</code>) to the context <code>Γ, x:S</code>.</p>
<pre class="Agda"><a id="idⓇ↑Γ"></a><a id="77762" href="lagda.2023-11-21-nbe.html#77762" class="Function">idⓇ↑Γ</a> <a id="77768" class="Symbol">:</a> <a id="77770" class="Symbol">∀</a> <a id="77772" class="Symbol">{</a><a id="77773" href="lagda.2023-11-21-nbe.html#77773" class="Bound">Γ</a> <a id="77775" class="Symbol">:</a> <a id="77777" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="77780" class="Symbol">}</a>
       <a id="77789" class="Symbol">→</a> <a id="77791" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="77794" href="lagda.2023-11-21-nbe.html#70213" class="Function Operator">Ⓡˢ</a> <a id="77797" class="Symbol">(</a><a id="77798" href="lagda.2023-11-21-nbe.html#46420" class="Function">↑ᶜᵗˣ</a> <a id="77803" href="lagda.2023-11-21-nbe.html#77773" class="Bound">Γ</a><a id="77804" class="Symbol">)</a>
<a id="77806" href="lagda.2023-11-21-nbe.html#77762" class="Function">idⓇ↑Γ</a> <a id="77812" href="lagda.2023-11-21-nbe.html#4585" class="InductiveConstructor">𝑍</a>             <a id="77826" class="Symbol">=</a> <a id="77828" href="lagda.2023-11-21-nbe.html#62536" class="Function">xⓇ↑ᵀ𝓍̂</a>
<a id="77835" href="lagda.2023-11-21-nbe.html#77762" class="Function">idⓇ↑Γ</a> <a id="77841" class="Symbol">{</a><a id="77842" href="lagda.2023-11-21-nbe.html#77842" class="Bound">Γ</a> <a id="77844" href="lagda.2023-11-21-nbe.html#3954" class="InductiveConstructor Operator">,</a> <a id="77846" href="lagda.2023-11-21-nbe.html#77846" class="Bound">T</a><a id="77847" class="Symbol">}</a> <a id="77849" class="Symbol">(</a><a id="77850" href="lagda.2023-11-21-nbe.html#4651" class="InductiveConstructor Operator">𝑆</a> <a id="77852" href="lagda.2023-11-21-nbe.html#77852" class="Bound">x</a><a id="77853" class="Symbol">)</a> <a id="77855" class="Symbol">=</a> <a id="77857" href="lagda.2023-11-21-nbe.html#60843" class="Function">Ⓡ-weaken</a> <a id="77866" class="Symbol">{</a><a id="77867" class="Argument">Γ′≤Γ</a> <a id="77872" class="Symbol">=</a> <a id="77874" href="lagda.2023-11-21-nbe.html#7592" class="InductiveConstructor">≤-ext</a> <a id="77880" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a><a id="77884" class="Symbol">}</a> <a id="77886" class="Symbol">{</a><a id="77887" class="Argument">t</a> <a id="77889" class="Symbol">=</a> <a id="77891" href="lagda.2023-11-21-nbe.html#5897" class="InductiveConstructor Operator">#</a> <a id="77893" href="lagda.2023-11-21-nbe.html#77852" class="Bound">x</a><a id="77894" class="Symbol">}</a> <a id="77896" class="Symbol">(</a><a id="77897" href="lagda.2023-11-21-nbe.html#77762" class="Function">idⓇ↑Γ</a> <a id="77903" class="Symbol">{</a><a id="77904" href="lagda.2023-11-21-nbe.html#77842" class="Bound">Γ</a><a id="77905" class="Symbol">}</a> <a id="77907" href="lagda.2023-11-21-nbe.html#77852" class="Bound">x</a><a id="77908" class="Symbol">)</a>
</pre>
<p>Now, we can arrive at the soundness of our algorithm for normalization by
evaluation. We have <code>Γ ⊢ id : Γ Ⓡ ↑Γ</code>, so we can use the fundamental lemma
here:</p>
<pre><code>Γ ⊢ t [ id ] Ⓡ ⟦ t ⟧ ↑Γ</code></pre>
<p>Note also that <code>t [ id ] ≡ t</code>. Using the lemma that a logical relation between a
term and a semantic object implies the definitional equality of the term to the
reification of the semantic object, we have:</p>
<pre><code>Γ ⊢ t = ↓ᵀ (⟦ t ⟧ ↑Γ) Γ : T</code></pre>
<p>Thus, our algorithm for normalization by evaluation preserves the meaning of a
term that it normalizes. By extension, the algorithm is also idempotent (as we
have already shown it is complete), so the algorithm as a whole satisifies the
soundness properties we wanted (as a reminder, the well-typedness of the
algorithm is given automatically with our intrinsically typed representation).</p>
<pre class="Agda"><a id="nf-=="></a><a id="78738" href="lagda.2023-11-21-nbe.html#78738" class="Function">nf-==</a> <a id="78744" class="Symbol">:</a> <a id="78746" class="Symbol">∀</a> <a id="78748" class="Symbol">{</a><a id="78749" href="lagda.2023-11-21-nbe.html#78749" class="Bound">Γ</a> <a id="78751" class="Symbol">:</a> <a id="78753" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="78756" class="Symbol">}</a> <a id="78758" class="Symbol">{</a><a id="78759" href="lagda.2023-11-21-nbe.html#78759" class="Bound">T</a> <a id="78761" class="Symbol">:</a> <a id="78763" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="78767" class="Symbol">}</a> <a id="78769" class="Symbol">{</a><a id="78770" href="lagda.2023-11-21-nbe.html#78770" class="Bound">t</a> <a id="78772" class="Symbol">:</a> <a id="78774" href="lagda.2023-11-21-nbe.html#78749" class="Bound">Γ</a> <a id="78776" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="78778" href="lagda.2023-11-21-nbe.html#78759" class="Bound">T</a><a id="78779" class="Symbol">}</a>
      <a id="78787" class="Symbol">→</a> <a id="78789" href="lagda.2023-11-21-nbe.html#78770" class="Bound">t</a> <a id="78791" href="lagda.2023-11-21-nbe.html#30253" class="Datatype Operator">==</a> <a id="78794" href="lagda.2023-11-21-nbe.html#46844" class="Function">nf</a> <a id="78797" href="lagda.2023-11-21-nbe.html#78770" class="Bound">t</a>
<a id="78799" href="lagda.2023-11-21-nbe.html#78738" class="Function">nf-==</a> <a id="78805" class="Symbol">{</a><a id="78806" href="lagda.2023-11-21-nbe.html#78806" class="Bound">Γ</a><a id="78807" class="Symbol">}</a> <a id="78809" class="Symbol">{</a><a id="78810" href="lagda.2023-11-21-nbe.html#78810" class="Bound">T</a><a id="78811" class="Symbol">}</a> <a id="78813" class="Symbol">{</a><a id="78814" href="lagda.2023-11-21-nbe.html#78814" class="Bound">t</a><a id="78815" class="Symbol">}</a>
  <a id="78819" class="Keyword">with</a> <a id="78824" href="lagda.2023-11-21-nbe.html#71865" class="Function">fundamental-lemma</a> <a id="78842" class="Symbol">{</a><a id="78843" class="Argument">t</a> <a id="78845" class="Symbol">=</a> <a id="78847" href="lagda.2023-11-21-nbe.html#78814" class="Bound">t</a><a id="78848" class="Symbol">}</a> <a id="78850" class="Symbol">(</a><a id="78851" href="lagda.2023-11-21-nbe.html#77762" class="Function">idⓇ↑Γ</a> <a id="78857" class="Symbol">{</a><a id="78858" href="lagda.2023-11-21-nbe.html#78806" class="Bound">Γ</a><a id="78859" class="Symbol">})</a>
<a id="78862" class="Symbol">...</a> <a id="78866" class="Symbol">|</a> <a id="78868" href="lagda.2023-11-21-nbe.html#78868" class="Bound">tⓇ⟦t⟧↑Γ</a>
  <a id="78878" class="Keyword">with</a> <a id="78883" href="lagda.2023-11-21-nbe.html#62867" class="Function">Ⓡ→==↓</a> <a id="78889" href="lagda.2023-11-21-nbe.html#78868" class="Bound">tⓇ⟦t⟧↑Γ</a> <a id="78897" href="lagda.2023-11-21-nbe.html#7562" class="InductiveConstructor">≤-id</a>
<a id="78902" class="Symbol">...</a> <a id="78906" class="Symbol">|</a> <a id="78908" href="lagda.2023-11-21-nbe.html#78908" class="Bound">t==↓ᵀ⟦t⟧↑Γ</a>
  <a id="78921" class="Keyword">rewrite</a> <a id="78929" href="lagda.2023-11-21-nbe.html#22591" class="Function">[id]-identity</a> <a id="78943" class="Symbol">{</a><a id="78944" class="Argument">t</a> <a id="78946" class="Symbol">=</a> <a id="78948" class="Bound">t</a> <a id="78950" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">[</a> <a id="78952" href="lagda.2023-11-21-nbe.html#15998" class="Function">id</a> <a id="78955" href="lagda.2023-11-21-nbe.html#15489" class="Function Operator">]</a><a id="78956" class="Symbol">}</a>
        <a id="78966" class="Symbol">|</a> <a id="78968" href="lagda.2023-11-21-nbe.html#22591" class="Function">[id]-identity</a> <a id="78982" class="Symbol">{</a><a id="78983" class="Argument">t</a> <a id="78985" class="Symbol">=</a> <a id="78987" class="Bound">t</a><a id="78988" class="Symbol">}</a>                <a id="79005" class="Symbol">=</a> <a id="79007" href="lagda.2023-11-21-nbe.html#78908" class="Bound">t==↓ᵀ⟦t⟧↑Γ</a>

<a id="nf-preserves-meaning"></a><a id="79019" href="lagda.2023-11-21-nbe.html#79019" class="Function">nf-preserves-meaning</a> <a id="79040" class="Symbol">:</a> <a id="79042" class="Symbol">∀</a> <a id="79044" class="Symbol">{</a><a id="79045" href="lagda.2023-11-21-nbe.html#79045" class="Bound">Γ</a> <a id="79047" class="Symbol">:</a> <a id="79049" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="79052" class="Symbol">}</a> <a id="79054" class="Symbol">{</a><a id="79055" href="lagda.2023-11-21-nbe.html#79055" class="Bound">T</a> <a id="79057" class="Symbol">:</a> <a id="79059" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="79063" class="Symbol">}</a> <a id="79065" class="Symbol">{</a><a id="79066" href="lagda.2023-11-21-nbe.html#79066" class="Bound">t</a> <a id="79068" class="Symbol">:</a> <a id="79070" href="lagda.2023-11-21-nbe.html#79045" class="Bound">Γ</a> <a id="79072" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="79074" href="lagda.2023-11-21-nbe.html#79055" class="Bound">T</a><a id="79075" class="Symbol">}</a> <a id="79077" class="Symbol">{</a><a id="79078" href="lagda.2023-11-21-nbe.html#79078" class="Bound">γ</a> <a id="79080" class="Symbol">:</a> <a id="79082" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="79084" href="lagda.2023-11-21-nbe.html#79045" class="Bound">Γ</a> <a id="79086" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a><a id="79087" class="Symbol">}</a>
                     <a id="79110" class="Symbol">→</a> <a id="79112" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟦⊢</a> <a id="79115" href="lagda.2023-11-21-nbe.html#79066" class="Bound">t</a> <a id="79117" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟧</a> <a id="79119" href="lagda.2023-11-21-nbe.html#79078" class="Bound">γ</a> <a id="79121" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="79123" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟦⊢</a> <a id="79126" href="lagda.2023-11-21-nbe.html#46844" class="Function">nf</a> <a id="79129" href="lagda.2023-11-21-nbe.html#79066" class="Bound">t</a> <a id="79131" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟧</a> <a id="79133" href="lagda.2023-11-21-nbe.html#79078" class="Bound">γ</a>
<a id="79135" href="lagda.2023-11-21-nbe.html#79019" class="Function">nf-preserves-meaning</a> <a id="79156" class="Symbol">{</a><a id="79157" class="Argument">t</a> <a id="79159" class="Symbol">=</a> <a id="79161" href="lagda.2023-11-21-nbe.html#79161" class="Bound">t</a><a id="79162" class="Symbol">}</a> <a id="79164" class="Symbol">=</a> <a id="79166" href="lagda.2023-11-21-nbe.html#51577" class="Function">==→⟦≡⟧</a> <a id="79173" class="Symbol">(</a><a id="79174" href="lagda.2023-11-21-nbe.html#78738" class="Function">nf-==</a> <a id="79180" class="Symbol">{</a><a id="79181" class="Argument">t</a> <a id="79183" class="Symbol">=</a> <a id="79185" href="lagda.2023-11-21-nbe.html#79161" class="Bound">t</a><a id="79186" class="Symbol">})</a>

<a id="nf-idempotent"></a><a id="79190" href="lagda.2023-11-21-nbe.html#79190" class="Function">nf-idempotent</a> <a id="79204" class="Symbol">:</a> <a id="79206" class="Symbol">∀</a> <a id="79208" class="Symbol">{</a><a id="79209" href="lagda.2023-11-21-nbe.html#79209" class="Bound">Γ</a> <a id="79211" class="Symbol">:</a> <a id="79213" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="79216" class="Symbol">}</a> <a id="79218" class="Symbol">{</a><a id="79219" href="lagda.2023-11-21-nbe.html#79219" class="Bound">T</a> <a id="79221" class="Symbol">:</a> <a id="79223" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="79227" class="Symbol">}</a> <a id="79229" class="Symbol">{</a><a id="79230" href="lagda.2023-11-21-nbe.html#79230" class="Bound">t</a> <a id="79232" class="Symbol">:</a> <a id="79234" href="lagda.2023-11-21-nbe.html#79209" class="Bound">Γ</a> <a id="79236" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="79238" href="lagda.2023-11-21-nbe.html#79219" class="Bound">T</a><a id="79239" class="Symbol">}</a>
              <a id="79255" class="Symbol">→</a> <a id="79257" href="lagda.2023-11-21-nbe.html#46844" class="Function">nf</a> <a id="79260" href="lagda.2023-11-21-nbe.html#79230" class="Bound">t</a> <a id="79262" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="79264" href="lagda.2023-11-21-nbe.html#46844" class="Function">nf</a> <a id="79267" class="Symbol">(</a><a id="79268" href="lagda.2023-11-21-nbe.html#46844" class="Function">nf</a> <a id="79271" href="lagda.2023-11-21-nbe.html#79230" class="Bound">t</a><a id="79272" class="Symbol">)</a>
<a id="79274" href="lagda.2023-11-21-nbe.html#79190" class="Function">nf-idempotent</a> <a id="79288" class="Symbol">{</a><a id="79289" class="Argument">t</a> <a id="79291" class="Symbol">=</a> <a id="79293" href="lagda.2023-11-21-nbe.html#79293" class="Bound">t</a><a id="79294" class="Symbol">}</a> <a id="79296" class="Symbol">=</a> <a id="79298" href="lagda.2023-11-21-nbe.html#52717" class="Function">completeness</a> <a id="79311" class="Symbol">(</a><a id="79312" href="lagda.2023-11-21-nbe.html#78738" class="Function">nf-==</a> <a id="79318" class="Symbol">{</a><a id="79319" class="Argument">t</a> <a id="79321" class="Symbol">=</a> <a id="79323" href="lagda.2023-11-21-nbe.html#79293" class="Bound">t</a><a id="79324" class="Symbol">})</a>

<a id="soundness"></a><a id="79328" href="lagda.2023-11-21-nbe.html#79328" class="Function">soundness</a> <a id="79338" class="Symbol">:</a> <a id="79340" class="Symbol">∀</a> <a id="79342" class="Symbol">{</a><a id="79343" href="lagda.2023-11-21-nbe.html#79343" class="Bound">Γ</a> <a id="79345" class="Symbol">:</a> <a id="79347" href="lagda.2023-11-21-nbe.html#3926" class="Datatype">Ctx</a><a id="79350" class="Symbol">}</a> <a id="79352" class="Symbol">{</a><a id="79353" href="lagda.2023-11-21-nbe.html#79353" class="Bound">T</a> <a id="79355" class="Symbol">:</a> <a id="79357" href="lagda.2023-11-21-nbe.html#3133" class="Datatype">Type</a><a id="79361" class="Symbol">}</a> <a id="79363" class="Symbol">{</a><a id="79364" href="lagda.2023-11-21-nbe.html#79364" class="Bound">t</a> <a id="79366" class="Symbol">:</a> <a id="79368" href="lagda.2023-11-21-nbe.html#79343" class="Bound">Γ</a> <a id="79370" href="lagda.2023-11-21-nbe.html#5817" class="Datatype Operator">⊢</a> <a id="79372" href="lagda.2023-11-21-nbe.html#79353" class="Bound">T</a><a id="79373" class="Symbol">}</a> <a id="79375" class="Symbol">{</a><a id="79376" href="lagda.2023-11-21-nbe.html#79376" class="Bound">γ</a> <a id="79378" class="Symbol">:</a> <a id="79380" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟦</a> <a id="79382" href="lagda.2023-11-21-nbe.html#79343" class="Bound">Γ</a> <a id="79384" href="lagda.2023-11-21-nbe.html#34541" class="Field Operator">⟧</a> <a id="79386" class="Symbol">}</a>
          <a id="79398" class="Symbol">→</a> <a id="79400" class="Symbol">(</a><a id="79401" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟦⊢</a> <a id="79404" href="lagda.2023-11-21-nbe.html#79364" class="Bound">t</a> <a id="79406" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟧</a> <a id="79408" href="lagda.2023-11-21-nbe.html#79376" class="Bound">γ</a> <a id="79410" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="79412" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟦⊢</a> <a id="79415" href="lagda.2023-11-21-nbe.html#46844" class="Function">nf</a> <a id="79418" href="lagda.2023-11-21-nbe.html#79364" class="Bound">t</a> <a id="79420" href="lagda.2023-11-21-nbe.html#43977" class="Function Operator">⟧</a> <a id="79422" href="lagda.2023-11-21-nbe.html#79376" class="Bound">γ</a><a id="79423" class="Symbol">)</a> <a id="79425" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="79427" class="Symbol">(</a><a id="79428" href="lagda.2023-11-21-nbe.html#46844" class="Function">nf</a> <a id="79431" href="lagda.2023-11-21-nbe.html#79364" class="Bound">t</a> <a id="79433" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="79435" href="lagda.2023-11-21-nbe.html#46844" class="Function">nf</a> <a id="79438" class="Symbol">(</a><a id="79439" href="lagda.2023-11-21-nbe.html#46844" class="Function">nf</a> <a id="79442" href="lagda.2023-11-21-nbe.html#79364" class="Bound">t</a><a id="79443" class="Symbol">))</a>
<a id="79446" href="lagda.2023-11-21-nbe.html#79328" class="Function">soundness</a> <a id="79456" class="Symbol">{</a><a id="79457" class="Argument">t</a> <a id="79459" class="Symbol">=</a> <a id="79461" href="lagda.2023-11-21-nbe.html#79461" class="Bound">t</a><a id="79462" class="Symbol">}</a> <a id="79464" class="Symbol">=</a> <a id="79466" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟨</a> <a id="79468" href="lagda.2023-11-21-nbe.html#79019" class="Function">nf-preserves-meaning</a> <a id="79489" class="Symbol">{</a><a id="79490" class="Argument">t</a> <a id="79492" class="Symbol">=</a> <a id="79494" href="lagda.2023-11-21-nbe.html#79461" class="Bound">t</a><a id="79495" class="Symbol">}</a> <a id="79497" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">,</a> <a id="79499" href="lagda.2023-11-21-nbe.html#79190" class="Function">nf-idempotent</a> <a id="79513" class="Symbol">{</a><a id="79514" class="Argument">t</a> <a id="79516" class="Symbol">=</a> <a id="79518" href="lagda.2023-11-21-nbe.html#79461" class="Bound">t</a><a id="79519" class="Symbol">}</a> <a id="79521" href="lagda.2023-11-21-nbe.html#2520" class="InductiveConstructor Operator">⟩</a>
</pre>
<h3 id="conclusion">Conclusion</h3>
<p>In the end, we have formalized an algorithm in Agda for normalization by
evaluation that is based on the intuition of leaving the parts of a term that
cannot be evaluated (i.e. “unknowns”) unchanged while still evaluating the parts
of the term that we do know how to reduce. The algorithm is both complete and
sound with respect to definitional equality, as we have proven. Completeness
followed quickly from the definition of the algorithm, while soundness required
a more in-depth proof involving the use of logical relations and their
fundamental lemma.</p>
<p>In his habilitation thesis, Andreas Abel goes on to introduce the algorithm for
the untyped lambda calculus after introducing normalization by evaluation for
System T (an extension of the simply typed lambda calculus with primitive
recursion). He continues to build upon these concepts, arriving at an algorithm
for a language with dependent types and a language with impredicativity. This
introduction to normalization to evaluation should hopefully be a good starting
point to explore these and other extensions of the algorithm, such as simply
trying out these proofs for yourself with a different extension of the simply
typed lambda calculus, or implementing the algorithm in a language other than
Agda.</p>
<h4 id="unicode">Unicode</h4>
<p>This site uses the following unicode in its Agda source code<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>:</p>
<pre><code>λ  U+03BB  GREEK SMALL LETTER LAMBDA (\Gl)
⊥  U+22A5  UP TACK (\bot)
⊤  U+22A4  DOWN TACK (\top)
⊎  U+228E  MULTISET UNION (\u+)
₁  U+2081  SUBSCRIPT ONE (\_1)
₂  U+2082  SUBSCRIPT TWO (\_2)
×  U+00D7  MULTIPLICATION SIGN (\x)
∃  U+2203  THERE EXISTS (\ex)
⟨  U+27E8  MATHEMATICAL LEFT ANGLE BRACKET (\&lt;)
⟩  U+27E9  MATHEMATICAL RIGHT ANGLE BRACKET (\&gt;)
¬  U+00AC  NOT SIGN (\neg)
≡  U+2261  IDENTICAL TO (\==)
⇒  U+21D2  RIGHTWARDS DOUBLE ARROW (\=&gt;)
∀  U+2200  FOR ALL (\all)
→  U+2192  RIGHTWARDS ARROW
‌≟  U+225F  QUESTIONED EQUAL TO (\?=)
∅  U+2205  EMPTY SET (\0)
∋  U+220B  CONTAINS AS MEMBER (\ni)
𝑍  U+1D44D  MATHEMATICAL ITALIC CAPITAL Z (\MiZ)
Γ  U+0393  GREEK CAPITAL LETTER GAMMA (\GG)
𝑆  U+1D446  MATHEMATICAL ITALIC CAPITAL S (\MiS)
≤  U+2264  LESS-THAN OR EQUAL TO (\le)
′  U+2032  PRIME (\'1)
≢  U+2262  NOT IDENTICAL TO (\==n)
⊢  U+22A2  RIGHT TACK (\|-)
ƛ  U+019B  LATIN SMALL LETTER LAMBDA WITH STROKE (\Gl-)
·  U+00B7  MIDDLE DOT (\cdot)
σ  U+03C3  GREEK SMALL LETTER SIGMA (\Gs)
Δ  U+0394  GREEK CAPITAL LETTER DELTA (\GD)
ʳ  U+02B3  MODIFIER LETTER SMALL R (\^r4)
↥  U+21A5  UPWARDS ARROW FROM BAR (\u-|)
Σ  U+03A3  GREE CAPITAL LETTER SIGMA (\GS)
∘  U+2218  RING OPERATOR (\o)
ω  U+03C9  GREEK SMALL LETTER OMEGA (\Go)
∷  U+2237  PROPORTION (\::)
θ  U+03B8  GREEK SMALL LETTER THETA (\Gth)
Φ  U+03A6  GREEK CAPITAL LETTER PHI (\Gf)
⟦  U+27E6  MATHEMATICAL LEFT WHITE SQUARE BRACKET (\[[)
⟦  U+27E7  MATHEMATICAL RIGHT WHITE SQUARE BRACKET (\]])
β  U+03B2  GREEK SMALL LETTER BETA (\Gb)
η  U+03B7  GREEK SMALL LETTER ETA (\Gh)
∎  U+220E  END OF PROOF (\qed)
⦃  U+2983  LEFT WHITE CURLY BRACKET (\{{)
⦄  U+2984  RIGHT WHITE CURLY BRACKET (\}})
𝓊  U+1D4CA  MATHEMATICAL SCRIPT SMALL U (\Mcu)
𝓋  U+1D4CB  MATHEMATICAL SCRIPT SMALL V (\Mcv)
γ  U+03B3  GREEK SMALL LETTER GAMMA (\Gg)
↑  U+2191  UPWARDS ARROW (\u)
ᵀ  U+1D40  MODIFIER LETTER CAPITAL T (\^T)
↓  U+2193  DOWNWARDS ARROW (\d)
ᶜ  U+1D9C  MODIFIER LETTER SMALL C (\^c)
ᵗ  U+1D57  MODIFIER LETTER SMALL T (\^t)
ˣ  U+02E3  MODIFIER LETTER SMALL X (\^x)
̂  U+0302  COMBINING CIRCUMFLEX ACCENT (\^)
𝓍  U+1D4CD  MATHEMATICAL SCRIPT SMALL X (\Mcx)
≰  U+2270  NEITHER LESS THAN NOR EQUAL TO (\len)
₃  U+2083  SUBSCRIPT 3 (\_3)
Ⓡ  U+24C7  CIRCLED LATIN CAPITAL LETTER R (\(r)2)
″  U+2033  DOUBLE PRIME (\'2)
δ  U+03B4  GREEK SMALL LETTER DELTA (\Gd)</code></pre>
<aside id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr />
<ol>
<li id="fn1"><p>̂ (<code>\^</code>) may be displayed on top of another character when written after it (e.g. <code>\Mcu\^</code> produces 𝓊̂)<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</aside>
    </section>
</article>

        </main>

        <footer>
            Site generated with <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        </footer>
    </body>
</html>
